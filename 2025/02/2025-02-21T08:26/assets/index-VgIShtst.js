var aS=Object.defineProperty;var oS=(i,n,a)=>n in i?aS(i,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):i[n]=a;var qp=(i,n,a)=>oS(i,typeof n!="symbol"?n+"":n,a);function sS(i,n){for(var a=0;a<n.length;a++){const h=n[a];if(typeof h!="string"&&!Array.isArray(h)){for(const p in h)if(p!=="default"&&!(p in i)){const v=Object.getOwnPropertyDescriptor(h,p);v&&Object.defineProperty(i,p,v.get?v:{enumerable:!0,get:()=>h[p]})}}}return Object.freeze(Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}))}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const p of document.querySelectorAll('link[rel="modulepreload"]'))h(p);new MutationObserver(p=>{for(const v of p)if(v.type==="childList")for(const g of v.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&h(g)}).observe(document,{childList:!0,subtree:!0});function a(p){const v={};return p.integrity&&(v.integrity=p.integrity),p.referrerPolicy&&(v.referrerPolicy=p.referrerPolicy),p.crossOrigin==="use-credentials"?v.credentials="include":p.crossOrigin==="anonymous"?v.credentials="omit":v.credentials="same-origin",v}function h(p){if(p.ep)return;p.ep=!0;const v=a(p);fetch(p.href,v)}})();function fm(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var jv={exports:{}},Uy={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hx;function lS(){if(Hx)return Uy;Hx=1;var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");function a(h,p,v){var g=null;if(v!==void 0&&(g=""+v),p.key!==void 0&&(g=""+p.key),"key"in p){v={};for(var c in p)c!=="key"&&(v[c]=p[c])}else v=p;return p=v.ref,{$$typeof:i,type:h,key:g,ref:p!==void 0?p:null,props:v}}return Uy.Fragment=n,Uy.jsx=a,Uy.jsxs=a,Uy}var Xx;function cS(){return Xx||(Xx=1,jv.exports=lS()),jv.exports}var se=cS(),Fv={exports:{}},Gn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wx;function uS(){if(Wx)return Gn;Wx=1;var i=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),v=Symbol.for("react.consumer"),g=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),D=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),L=Symbol.iterator;function F(Ie){return Ie===null||typeof Ie!="object"?null:(Ie=L&&Ie[L]||Ie["@@iterator"],typeof Ie=="function"?Ie:null)}var V={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},$=Object.assign,J={};function ae(Ie,ut,Bt){this.props=Ie,this.context=ut,this.refs=J,this.updater=Bt||V}ae.prototype.isReactComponent={},ae.prototype.setState=function(Ie,ut){if(typeof Ie!="object"&&typeof Ie!="function"&&Ie!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ie,ut,"setState")},ae.prototype.forceUpdate=function(Ie){this.updater.enqueueForceUpdate(this,Ie,"forceUpdate")};function fe(){}fe.prototype=ae.prototype;function ve(Ie,ut,Bt){this.props=Ie,this.context=ut,this.refs=J,this.updater=Bt||V}var Ce=ve.prototype=new fe;Ce.constructor=ve,$(Ce,ae.prototype),Ce.isPureReactComponent=!0;var Me=Array.isArray,Te={H:null,A:null,T:null,S:null},De=Object.prototype.hasOwnProperty;function Ne(Ie,ut,Bt,Lt,Tt,jt){return Bt=jt.ref,{$$typeof:i,type:Ie,key:ut,ref:Bt!==void 0?Bt:null,props:jt}}function je(Ie,ut){return Ne(Ie.type,ut,void 0,void 0,void 0,Ie.props)}function ye(Ie){return typeof Ie=="object"&&Ie!==null&&Ie.$$typeof===i}function Qe(Ie){var ut={"=":"=0",":":"=2"};return"$"+Ie.replace(/[=:]/g,function(Bt){return ut[Bt]})}var bt=/\/+/g;function Ot(Ie,ut){return typeof Ie=="object"&&Ie!==null&&Ie.key!=null?Qe(""+Ie.key):ut.toString(36)}function mt(){}function Dt(Ie){switch(Ie.status){case"fulfilled":return Ie.value;case"rejected":throw Ie.reason;default:switch(typeof Ie.status=="string"?Ie.then(mt,mt):(Ie.status="pending",Ie.then(function(ut){Ie.status==="pending"&&(Ie.status="fulfilled",Ie.value=ut)},function(ut){Ie.status==="pending"&&(Ie.status="rejected",Ie.reason=ut)})),Ie.status){case"fulfilled":return Ie.value;case"rejected":throw Ie.reason}}throw Ie}function vt(Ie,ut,Bt,Lt,Tt){var jt=typeof Ie;(jt==="undefined"||jt==="boolean")&&(Ie=null);var qt=!1;if(Ie===null)qt=!0;else switch(jt){case"bigint":case"string":case"number":qt=!0;break;case"object":switch(Ie.$$typeof){case i:case n:qt=!0;break;case N:return qt=Ie._init,vt(qt(Ie._payload),ut,Bt,Lt,Tt)}}if(qt)return Tt=Tt(Ie),qt=Lt===""?"."+Ot(Ie,0):Lt,Me(Tt)?(Bt="",qt!=null&&(Bt=qt.replace(bt,"$&/")+"/"),vt(Tt,ut,Bt,"",function(An){return An})):Tt!=null&&(ye(Tt)&&(Tt=je(Tt,Bt+(Tt.key==null||Ie&&Ie.key===Tt.key?"":(""+Tt.key).replace(bt,"$&/")+"/")+qt)),ut.push(Tt)),1;qt=0;var Sn=Lt===""?".":Lt+":";if(Me(Ie))for(var dn=0;dn<Ie.length;dn++)Lt=Ie[dn],jt=Sn+Ot(Lt,dn),qt+=vt(Lt,ut,Bt,jt,Tt);else if(dn=F(Ie),typeof dn=="function")for(Ie=dn.call(Ie),dn=0;!(Lt=Ie.next()).done;)Lt=Lt.value,jt=Sn+Ot(Lt,dn++),qt+=vt(Lt,ut,Bt,jt,Tt);else if(jt==="object"){if(typeof Ie.then=="function")return vt(Dt(Ie),ut,Bt,Lt,Tt);throw ut=String(Ie),Error("Objects are not valid as a React child (found: "+(ut==="[object Object]"?"object with keys {"+Object.keys(Ie).join(", ")+"}":ut)+"). If you meant to render a collection of children, use an array instead.")}return qt}function Ge(Ie,ut,Bt){if(Ie==null)return Ie;var Lt=[],Tt=0;return vt(Ie,Lt,"","",function(jt){return ut.call(Bt,jt,Tt++)}),Lt}function dt(Ie){if(Ie._status===-1){var ut=Ie._result;ut=ut(),ut.then(function(Bt){(Ie._status===0||Ie._status===-1)&&(Ie._status=1,Ie._result=Bt)},function(Bt){(Ie._status===0||Ie._status===-1)&&(Ie._status=2,Ie._result=Bt)}),Ie._status===-1&&(Ie._status=0,Ie._result=ut)}if(Ie._status===1)return Ie._result.default;throw Ie._result}var ot=typeof reportError=="function"?reportError:function(Ie){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ut=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ie=="object"&&Ie!==null&&typeof Ie.message=="string"?String(Ie.message):String(Ie),error:Ie});if(!window.dispatchEvent(ut))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ie);return}console.error(Ie)};function Ut(){}return Gn.Children={map:Ge,forEach:function(Ie,ut,Bt){Ge(Ie,function(){ut.apply(this,arguments)},Bt)},count:function(Ie){var ut=0;return Ge(Ie,function(){ut++}),ut},toArray:function(Ie){return Ge(Ie,function(ut){return ut})||[]},only:function(Ie){if(!ye(Ie))throw Error("React.Children.only expected to receive a single React element child.");return Ie}},Gn.Component=ae,Gn.Fragment=a,Gn.Profiler=p,Gn.PureComponent=ve,Gn.StrictMode=h,Gn.Suspense=A,Gn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=Te,Gn.act=function(){throw Error("act(...) is not supported in production builds of React.")},Gn.cache=function(Ie){return function(){return Ie.apply(null,arguments)}},Gn.cloneElement=function(Ie,ut,Bt){if(Ie==null)throw Error("The argument must be a React element, but you passed "+Ie+".");var Lt=$({},Ie.props),Tt=Ie.key,jt=void 0;if(ut!=null)for(qt in ut.ref!==void 0&&(jt=void 0),ut.key!==void 0&&(Tt=""+ut.key),ut)!De.call(ut,qt)||qt==="key"||qt==="__self"||qt==="__source"||qt==="ref"&&ut.ref===void 0||(Lt[qt]=ut[qt]);var qt=arguments.length-2;if(qt===1)Lt.children=Bt;else if(1<qt){for(var Sn=Array(qt),dn=0;dn<qt;dn++)Sn[dn]=arguments[dn+2];Lt.children=Sn}return Ne(Ie.type,Tt,void 0,void 0,jt,Lt)},Gn.createContext=function(Ie){return Ie={$$typeof:g,_currentValue:Ie,_currentValue2:Ie,_threadCount:0,Provider:null,Consumer:null},Ie.Provider=Ie,Ie.Consumer={$$typeof:v,_context:Ie},Ie},Gn.createElement=function(Ie,ut,Bt){var Lt,Tt={},jt=null;if(ut!=null)for(Lt in ut.key!==void 0&&(jt=""+ut.key),ut)De.call(ut,Lt)&&Lt!=="key"&&Lt!=="__self"&&Lt!=="__source"&&(Tt[Lt]=ut[Lt]);var qt=arguments.length-2;if(qt===1)Tt.children=Bt;else if(1<qt){for(var Sn=Array(qt),dn=0;dn<qt;dn++)Sn[dn]=arguments[dn+2];Tt.children=Sn}if(Ie&&Ie.defaultProps)for(Lt in qt=Ie.defaultProps,qt)Tt[Lt]===void 0&&(Tt[Lt]=qt[Lt]);return Ne(Ie,jt,void 0,void 0,null,Tt)},Gn.createRef=function(){return{current:null}},Gn.forwardRef=function(Ie){return{$$typeof:c,render:Ie}},Gn.isValidElement=ye,Gn.lazy=function(Ie){return{$$typeof:N,_payload:{_status:-1,_result:Ie},_init:dt}},Gn.memo=function(Ie,ut){return{$$typeof:D,type:Ie,compare:ut===void 0?null:ut}},Gn.startTransition=function(Ie){var ut=Te.T,Bt={};Te.T=Bt;try{var Lt=Ie(),Tt=Te.S;Tt!==null&&Tt(Bt,Lt),typeof Lt=="object"&&Lt!==null&&typeof Lt.then=="function"&&Lt.then(Ut,ot)}catch(jt){ot(jt)}finally{Te.T=ut}},Gn.unstable_useCacheRefresh=function(){return Te.H.useCacheRefresh()},Gn.use=function(Ie){return Te.H.use(Ie)},Gn.useActionState=function(Ie,ut,Bt){return Te.H.useActionState(Ie,ut,Bt)},Gn.useCallback=function(Ie,ut){return Te.H.useCallback(Ie,ut)},Gn.useContext=function(Ie){return Te.H.useContext(Ie)},Gn.useDebugValue=function(){},Gn.useDeferredValue=function(Ie,ut){return Te.H.useDeferredValue(Ie,ut)},Gn.useEffect=function(Ie,ut){return Te.H.useEffect(Ie,ut)},Gn.useId=function(){return Te.H.useId()},Gn.useImperativeHandle=function(Ie,ut,Bt){return Te.H.useImperativeHandle(Ie,ut,Bt)},Gn.useInsertionEffect=function(Ie,ut){return Te.H.useInsertionEffect(Ie,ut)},Gn.useLayoutEffect=function(Ie,ut){return Te.H.useLayoutEffect(Ie,ut)},Gn.useMemo=function(Ie,ut){return Te.H.useMemo(Ie,ut)},Gn.useOptimistic=function(Ie,ut){return Te.H.useOptimistic(Ie,ut)},Gn.useReducer=function(Ie,ut,Bt){return Te.H.useReducer(Ie,ut,Bt)},Gn.useRef=function(Ie){return Te.H.useRef(Ie)},Gn.useState=function(Ie){return Te.H.useState(Ie)},Gn.useSyncExternalStore=function(Ie,ut,Bt){return Te.H.useSyncExternalStore(Ie,ut,Bt)},Gn.useTransition=function(){return Te.H.useTransition()},Gn.version="19.0.0",Gn}var Qx;function qb(){return Qx||(Qx=1,Fv.exports=uS()),Fv.exports}var he=qb();const ec=fm(he);var Uv={exports:{}},Vy={},Vv={exports:{}},Gv={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kx;function hS(){return Kx||(Kx=1,function(i){function n(Ge,dt){var ot=Ge.length;Ge.push(dt);e:for(;0<ot;){var Ut=ot-1>>>1,Ie=Ge[Ut];if(0<p(Ie,dt))Ge[Ut]=dt,Ge[ot]=Ie,ot=Ut;else break e}}function a(Ge){return Ge.length===0?null:Ge[0]}function h(Ge){if(Ge.length===0)return null;var dt=Ge[0],ot=Ge.pop();if(ot!==dt){Ge[0]=ot;e:for(var Ut=0,Ie=Ge.length,ut=Ie>>>1;Ut<ut;){var Bt=2*(Ut+1)-1,Lt=Ge[Bt],Tt=Bt+1,jt=Ge[Tt];if(0>p(Lt,ot))Tt<Ie&&0>p(jt,Lt)?(Ge[Ut]=jt,Ge[Tt]=ot,Ut=Tt):(Ge[Ut]=Lt,Ge[Bt]=ot,Ut=Bt);else if(Tt<Ie&&0>p(jt,ot))Ge[Ut]=jt,Ge[Tt]=ot,Ut=Tt;else break e}}return dt}function p(Ge,dt){var ot=Ge.sortIndex-dt.sortIndex;return ot!==0?ot:Ge.id-dt.id}if(i.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var v=performance;i.unstable_now=function(){return v.now()}}else{var g=Date,c=g.now();i.unstable_now=function(){return g.now()-c}}var A=[],D=[],N=1,L=null,F=3,V=!1,$=!1,J=!1,ae=typeof setTimeout=="function"?setTimeout:null,fe=typeof clearTimeout=="function"?clearTimeout:null,ve=typeof setImmediate<"u"?setImmediate:null;function Ce(Ge){for(var dt=a(D);dt!==null;){if(dt.callback===null)h(D);else if(dt.startTime<=Ge)h(D),dt.sortIndex=dt.expirationTime,n(A,dt);else break;dt=a(D)}}function Me(Ge){if(J=!1,Ce(Ge),!$)if(a(A)!==null)$=!0,Dt();else{var dt=a(D);dt!==null&&vt(Me,dt.startTime-Ge)}}var Te=!1,De=-1,Ne=5,je=-1;function ye(){return!(i.unstable_now()-je<Ne)}function Qe(){if(Te){var Ge=i.unstable_now();je=Ge;var dt=!0;try{e:{$=!1,J&&(J=!1,fe(De),De=-1),V=!0;var ot=F;try{t:{for(Ce(Ge),L=a(A);L!==null&&!(L.expirationTime>Ge&&ye());){var Ut=L.callback;if(typeof Ut=="function"){L.callback=null,F=L.priorityLevel;var Ie=Ut(L.expirationTime<=Ge);if(Ge=i.unstable_now(),typeof Ie=="function"){L.callback=Ie,Ce(Ge),dt=!0;break t}L===a(A)&&h(A),Ce(Ge)}else h(A);L=a(A)}if(L!==null)dt=!0;else{var ut=a(D);ut!==null&&vt(Me,ut.startTime-Ge),dt=!1}}break e}finally{L=null,F=ot,V=!1}dt=void 0}}finally{dt?bt():Te=!1}}}var bt;if(typeof ve=="function")bt=function(){ve(Qe)};else if(typeof MessageChannel<"u"){var Ot=new MessageChannel,mt=Ot.port2;Ot.port1.onmessage=Qe,bt=function(){mt.postMessage(null)}}else bt=function(){ae(Qe,0)};function Dt(){Te||(Te=!0,bt())}function vt(Ge,dt){De=ae(function(){Ge(i.unstable_now())},dt)}i.unstable_IdlePriority=5,i.unstable_ImmediatePriority=1,i.unstable_LowPriority=4,i.unstable_NormalPriority=3,i.unstable_Profiling=null,i.unstable_UserBlockingPriority=2,i.unstable_cancelCallback=function(Ge){Ge.callback=null},i.unstable_continueExecution=function(){$||V||($=!0,Dt())},i.unstable_forceFrameRate=function(Ge){0>Ge||125<Ge?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ne=0<Ge?Math.floor(1e3/Ge):5},i.unstable_getCurrentPriorityLevel=function(){return F},i.unstable_getFirstCallbackNode=function(){return a(A)},i.unstable_next=function(Ge){switch(F){case 1:case 2:case 3:var dt=3;break;default:dt=F}var ot=F;F=dt;try{return Ge()}finally{F=ot}},i.unstable_pauseExecution=function(){},i.unstable_requestPaint=function(){},i.unstable_runWithPriority=function(Ge,dt){switch(Ge){case 1:case 2:case 3:case 4:case 5:break;default:Ge=3}var ot=F;F=Ge;try{return dt()}finally{F=ot}},i.unstable_scheduleCallback=function(Ge,dt,ot){var Ut=i.unstable_now();switch(typeof ot=="object"&&ot!==null?(ot=ot.delay,ot=typeof ot=="number"&&0<ot?Ut+ot:Ut):ot=Ut,Ge){case 1:var Ie=-1;break;case 2:Ie=250;break;case 5:Ie=1073741823;break;case 4:Ie=1e4;break;default:Ie=5e3}return Ie=ot+Ie,Ge={id:N++,callback:dt,priorityLevel:Ge,startTime:ot,expirationTime:Ie,sortIndex:-1},ot>Ut?(Ge.sortIndex=ot,n(D,Ge),a(A)===null&&Ge===a(D)&&(J?(fe(De),De=-1):J=!0,vt(Me,ot-Ut))):(Ge.sortIndex=Ie,n(A,Ge),$||V||($=!0,Dt())),Ge},i.unstable_shouldYield=ye,i.unstable_wrapCallback=function(Ge){var dt=F;return function(){var ot=F;F=dt;try{return Ge.apply(this,arguments)}finally{F=ot}}}}(Gv)),Gv}var Jx;function dS(){return Jx||(Jx=1,Vv.exports=hS()),Vv.exports}var Zv={exports:{}},Ho={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e1;function fS(){if(e1)return Ho;e1=1;var i=qb();function n(A){var D="https://react.dev/errors/"+A;if(1<arguments.length){D+="?args[]="+encodeURIComponent(arguments[1]);for(var N=2;N<arguments.length;N++)D+="&args[]="+encodeURIComponent(arguments[N])}return"Minified React error #"+A+"; visit "+D+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var h={d:{f:a,r:function(){throw Error(n(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},p=Symbol.for("react.portal");function v(A,D,N){var L=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:p,key:L==null?null:""+L,children:A,containerInfo:D,implementation:N}}var g=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(A,D){if(A==="font")return"";if(typeof D=="string")return D==="use-credentials"?D:""}return Ho.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=h,Ho.createPortal=function(A,D){var N=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!D||D.nodeType!==1&&D.nodeType!==9&&D.nodeType!==11)throw Error(n(299));return v(A,D,null,N)},Ho.flushSync=function(A){var D=g.T,N=h.p;try{if(g.T=null,h.p=2,A)return A()}finally{g.T=D,h.p=N,h.d.f()}},Ho.preconnect=function(A,D){typeof A=="string"&&(D?(D=D.crossOrigin,D=typeof D=="string"?D==="use-credentials"?D:"":void 0):D=null,h.d.C(A,D))},Ho.prefetchDNS=function(A){typeof A=="string"&&h.d.D(A)},Ho.preinit=function(A,D){if(typeof A=="string"&&D&&typeof D.as=="string"){var N=D.as,L=c(N,D.crossOrigin),F=typeof D.integrity=="string"?D.integrity:void 0,V=typeof D.fetchPriority=="string"?D.fetchPriority:void 0;N==="style"?h.d.S(A,typeof D.precedence=="string"?D.precedence:void 0,{crossOrigin:L,integrity:F,fetchPriority:V}):N==="script"&&h.d.X(A,{crossOrigin:L,integrity:F,fetchPriority:V,nonce:typeof D.nonce=="string"?D.nonce:void 0})}},Ho.preinitModule=function(A,D){if(typeof A=="string")if(typeof D=="object"&&D!==null){if(D.as==null||D.as==="script"){var N=c(D.as,D.crossOrigin);h.d.M(A,{crossOrigin:N,integrity:typeof D.integrity=="string"?D.integrity:void 0,nonce:typeof D.nonce=="string"?D.nonce:void 0})}}else D==null&&h.d.M(A)},Ho.preload=function(A,D){if(typeof A=="string"&&typeof D=="object"&&D!==null&&typeof D.as=="string"){var N=D.as,L=c(N,D.crossOrigin);h.d.L(A,N,{crossOrigin:L,integrity:typeof D.integrity=="string"?D.integrity:void 0,nonce:typeof D.nonce=="string"?D.nonce:void 0,type:typeof D.type=="string"?D.type:void 0,fetchPriority:typeof D.fetchPriority=="string"?D.fetchPriority:void 0,referrerPolicy:typeof D.referrerPolicy=="string"?D.referrerPolicy:void 0,imageSrcSet:typeof D.imageSrcSet=="string"?D.imageSrcSet:void 0,imageSizes:typeof D.imageSizes=="string"?D.imageSizes:void 0,media:typeof D.media=="string"?D.media:void 0})}},Ho.preloadModule=function(A,D){if(typeof A=="string")if(D){var N=c(D.as,D.crossOrigin);h.d.m(A,{as:typeof D.as=="string"&&D.as!=="script"?D.as:void 0,crossOrigin:N,integrity:typeof D.integrity=="string"?D.integrity:void 0})}else h.d.m(A)},Ho.requestFormReset=function(A){h.d.r(A)},Ho.unstable_batchedUpdates=function(A,D){return A(D)},Ho.useFormState=function(A,D,N){return g.H.useFormState(A,D,N)},Ho.useFormStatus=function(){return g.H.useHostTransitionStatus()},Ho.version="19.0.0",Ho}var t1;function Kw(){if(t1)return Zv.exports;t1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),Zv.exports=fS(),Zv.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n1;function pS(){if(n1)return Vy;n1=1;var i=dS(),n=qb(),a=Kw();function h(r){var u="https://react.dev/errors/"+r;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)u+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+r+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function p(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}var v=Symbol.for("react.element"),g=Symbol.for("react.transitional.element"),c=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),L=Symbol.for("react.provider"),F=Symbol.for("react.consumer"),V=Symbol.for("react.context"),$=Symbol.for("react.forward_ref"),J=Symbol.for("react.suspense"),ae=Symbol.for("react.suspense_list"),fe=Symbol.for("react.memo"),ve=Symbol.for("react.lazy"),Ce=Symbol.for("react.offscreen"),Me=Symbol.for("react.memo_cache_sentinel"),Te=Symbol.iterator;function De(r){return r===null||typeof r!="object"?null:(r=Te&&r[Te]||r["@@iterator"],typeof r=="function"?r:null)}var Ne=Symbol.for("react.client.reference");function je(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Ne?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case A:return"Fragment";case c:return"Portal";case N:return"Profiler";case D:return"StrictMode";case J:return"Suspense";case ae:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case V:return(r.displayName||"Context")+".Provider";case F:return(r._context.displayName||"Context")+".Consumer";case $:var u=r.render;return r=r.displayName,r||(r=u.displayName||u.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case fe:return u=r.displayName||null,u!==null?u:je(r.type)||"Memo";case ve:u=r._payload,r=r._init;try{return je(r(u))}catch{}}return null}var ye=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Qe=Object.assign,bt,Ot;function mt(r){if(bt===void 0)try{throw Error()}catch(m){var u=m.stack.trim().match(/\n( *(at )?)/);bt=u&&u[1]||"",Ot=-1<m.stack.indexOf(`
    at`)?" (<anonymous>)":-1<m.stack.indexOf("@")?"@unknown:0:0":""}return`
`+bt+r+Ot}var Dt=!1;function vt(r,u){if(!r||Dt)return"";Dt=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(u){var At=function(){throw Error()};if(Object.defineProperty(At.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(At,[])}catch(ft){var it=ft}Reflect.construct(r,[],At)}else{try{At.call()}catch(ft){it=ft}r.call(At.prototype)}}else{try{throw Error()}catch(ft){it=ft}(At=r())&&typeof At.catch=="function"&&At.catch(function(){})}}catch(ft){if(ft&&it&&typeof ft.stack=="string")return[ft.stack,it.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var M=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");M&&M.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var O=x.DetermineComponentFrameRoot(),Q=O[0],le=O[1];if(Q&&le){var Ae=Q.split(`
`),Ze=le.split(`
`);for(M=x=0;x<Ae.length&&!Ae[x].includes("DetermineComponentFrameRoot");)x++;for(;M<Ze.length&&!Ze[M].includes("DetermineComponentFrameRoot");)M++;if(x===Ae.length||M===Ze.length)for(x=Ae.length-1,M=Ze.length-1;1<=x&&0<=M&&Ae[x]!==Ze[M];)M--;for(;1<=x&&0<=M;x--,M--)if(Ae[x]!==Ze[M]){if(x!==1||M!==1)do if(x--,M--,0>M||Ae[x]!==Ze[M]){var pt=`
`+Ae[x].replace(" at new "," at ");return r.displayName&&pt.includes("<anonymous>")&&(pt=pt.replace("<anonymous>",r.displayName)),pt}while(1<=x&&0<=M);break}}}finally{Dt=!1,Error.prepareStackTrace=m}return(m=r?r.displayName||r.name:"")?mt(m):""}function Ge(r){switch(r.tag){case 26:case 27:case 5:return mt(r.type);case 16:return mt("Lazy");case 13:return mt("Suspense");case 19:return mt("SuspenseList");case 0:case 15:return r=vt(r.type,!1),r;case 11:return r=vt(r.type.render,!1),r;case 1:return r=vt(r.type,!0),r;default:return""}}function dt(r){try{var u="";do u+=Ge(r),r=r.return;while(r);return u}catch(m){return`
Error generating stack: `+m.message+`
`+m.stack}}function ot(r){var u=r,m=r;if(r.alternate)for(;u.return;)u=u.return;else{r=u;do u=r,u.flags&4098&&(m=u.return),r=u.return;while(r)}return u.tag===3?m:null}function Ut(r){if(r.tag===13){var u=r.memoizedState;if(u===null&&(r=r.alternate,r!==null&&(u=r.memoizedState)),u!==null)return u.dehydrated}return null}function Ie(r){if(ot(r)!==r)throw Error(h(188))}function ut(r){var u=r.alternate;if(!u){if(u=ot(r),u===null)throw Error(h(188));return u!==r?null:r}for(var m=r,x=u;;){var M=m.return;if(M===null)break;var O=M.alternate;if(O===null){if(x=M.return,x!==null){m=x;continue}break}if(M.child===O.child){for(O=M.child;O;){if(O===m)return Ie(M),r;if(O===x)return Ie(M),u;O=O.sibling}throw Error(h(188))}if(m.return!==x.return)m=M,x=O;else{for(var Q=!1,le=M.child;le;){if(le===m){Q=!0,m=M,x=O;break}if(le===x){Q=!0,x=M,m=O;break}le=le.sibling}if(!Q){for(le=O.child;le;){if(le===m){Q=!0,m=O,x=M;break}if(le===x){Q=!0,x=O,m=M;break}le=le.sibling}if(!Q)throw Error(h(189))}}if(m.alternate!==x)throw Error(h(190))}if(m.tag!==3)throw Error(h(188));return m.stateNode.current===m?r:u}function Bt(r){var u=r.tag;if(u===5||u===26||u===27||u===6)return r;for(r=r.child;r!==null;){if(u=Bt(r),u!==null)return u;r=r.sibling}return null}var Lt=Array.isArray,Tt=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,jt={pending:!1,data:null,method:null,action:null},qt=[],Sn=-1;function dn(r){return{current:r}}function An(r){0>Sn||(r.current=qt[Sn],qt[Sn]=null,Sn--)}function Un(r,u){Sn++,qt[Sn]=r.current,r.current=u}var Wn=dn(null),ai=dn(null),Ni=dn(null),ci=dn(null);function Jn(r,u){switch(Un(Ni,u),Un(ai,r),Un(Wn,null),r=u.nodeType,r){case 9:case 11:u=(u=u.documentElement)&&(u=u.namespaceURI)?Gp(u):0;break;default:if(r=r===8?u.parentNode:u,u=r.tagName,r=r.namespaceURI)r=Gp(r),u=Ny(r,u);else switch(u){case"svg":u=1;break;case"math":u=2;break;default:u=0}}An(Wn),Un(Wn,u)}function Xr(){An(Wn),An(ai),An(Ni)}function kr(r){r.memoizedState!==null&&Un(ci,r);var u=Wn.current,m=Ny(u,r.type);u!==m&&(Un(ai,r),Un(Wn,m))}function eo(r){ai.current===r&&(An(Wn),An(ai)),ci.current===r&&(An(ci),qe._currentValue=jt)}var Co=Object.prototype.hasOwnProperty,ar=i.unstable_scheduleCallback,ja=i.unstable_cancelCallback,xs=i.unstable_shouldYield,Wo=i.unstable_requestPaint,Wr=i.unstable_now,ws=i.unstable_getCurrentPriorityLevel,to=i.unstable_ImmediatePriority,Qo=i.unstable_UserBlockingPriority,Ea=i.unstable_NormalPriority,ac=i.unstable_LowPriority,Gs=i.unstable_IdlePriority,tu=i.log,nu=i.unstable_setDisableYieldValue,Zs=null,Rr=null;function de(r){if(Rr&&typeof Rr.onCommitFiberRoot=="function")try{Rr.onCommitFiberRoot(Zs,r,void 0,(r.current.flags&128)===128)}catch{}}function te(r){if(typeof tu=="function"&&nu(r),Rr&&typeof Rr.setStrictMode=="function")try{Rr.setStrictMode(Zs,r)}catch{}}var re=Math.clz32?Math.clz32:ze,oe=Math.log,xe=Math.LN2;function ze(r){return r>>>=0,r===0?32:31-(oe(r)/xe|0)|0}var Ve=128,We=4194304;function Fe(r){var u=r&42;if(u!==0)return u;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function at(r,u){var m=r.pendingLanes;if(m===0)return 0;var x=0,M=r.suspendedLanes,O=r.pingedLanes,Q=r.warmLanes;r=r.finishedLanes!==0;var le=m&134217727;return le!==0?(m=le&~M,m!==0?x=Fe(m):(O&=le,O!==0?x=Fe(O):r||(Q=le&~Q,Q!==0&&(x=Fe(Q))))):(le=m&~M,le!==0?x=Fe(le):O!==0?x=Fe(O):r||(Q=m&~Q,Q!==0&&(x=Fe(Q)))),x===0?0:u!==0&&u!==x&&!(u&M)&&(M=x&-x,Q=u&-u,M>=Q||M===32&&(Q&4194176)!==0)?u:x}function tt(r,u){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&u)===0}function $e(r,u){switch(r){case 1:case 2:case 4:case 8:return u+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Be(){var r=Ve;return Ve<<=1,!(Ve&4194176)&&(Ve=128),r}function Rt(){var r=We;return We<<=1,!(We&62914560)&&(We=4194304),r}function It(r){for(var u=[],m=0;31>m;m++)u.push(r);return u}function tn(r,u){r.pendingLanes|=u,u!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function fn(r,u,m,x,M,O){var Q=r.pendingLanes;r.pendingLanes=m,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=m,r.entangledLanes&=m,r.errorRecoveryDisabledLanes&=m,r.shellSuspendCounter=0;var le=r.entanglements,Ae=r.expirationTimes,Ze=r.hiddenUpdates;for(m=Q&~m;0<m;){var pt=31-re(m),At=1<<pt;le[pt]=0,Ae[pt]=-1;var it=Ze[pt];if(it!==null)for(Ze[pt]=null,pt=0;pt<it.length;pt++){var ft=it[pt];ft!==null&&(ft.lane&=-536870913)}m&=~At}x!==0&&ct(r,x,0),O!==0&&M===0&&r.tag!==0&&(r.suspendedLanes|=O&~(Q&~u))}function ct(r,u,m){r.pendingLanes|=u,r.suspendedLanes&=~u;var x=31-re(u);r.entangledLanes|=u,r.entanglements[x]=r.entanglements[x]|1073741824|m&4194218}function Pt(r,u){var m=r.entangledLanes|=u;for(r=r.entanglements;m;){var x=31-re(m),M=1<<x;M&u|r[x]&u&&(r[x]|=u),m&=~M}}function Yt(r){return r&=-r,2<r?8<r?r&134217727?32:268435456:8:2}function Cn(){var r=Tt.p;return r!==0?r:(r=window.event,r===void 0?32:sa(r.type))}function Zn(r,u){var m=Tt.p;try{return Tt.p=r,u()}finally{Tt.p=m}}var en=Math.random().toString(36).slice(2),Nt="__reactFiber$"+en,$n="__reactProps$"+en,no="__reactContainer$"+en,Ar="__reactEvents$"+en,Nr="__reactListeners$"+en,Fi="__reactHandles$"+en,Fa="__reactResources$"+en,wi="__reactMarker$"+en;function oc(r){delete r[Nt],delete r[$n],delete r[Ar],delete r[Nr],delete r[Fi]}function Mo(r){var u=r[Nt];if(u)return u;for(var m=r.parentNode;m;){if(u=m[no]||m[Nt]){if(m=u.alternate,u.child!==null||m!==null&&m.child!==null)for(r=d0(r);r!==null;){if(m=r[Nt])return m;r=d0(r)}return u}r=m,m=r.parentNode}return null}function vl(r){if(r=r[Nt]||r[no]){var u=r.tag;if(u===5||u===6||u===13||u===26||u===27||u===3)return r}return null}function Ko(r){var u=r.tag;if(u===5||u===26||u===27||u===6)return r.stateNode;throw Error(h(33))}function Do(r){var u=r[Fa];return u||(u=r[Fa]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Zr(r){r[wi]=!0}var yd=new Set,Uf={};function Io(r,u){sc(r,u),sc(r+"Capture",u)}function sc(r,u){for(Uf[r]=u,r=0;r<u.length;r++)yd.add(u[r])}var $s=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Kg=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),vm={},Vf={};function Gf(r){return Co.call(Vf,r)?!0:Co.call(vm,r)?!1:Kg.test(r)?Vf[r]=!0:(vm[r]=!0,!1)}function Ts(r,u,m){if(Gf(u))if(m===null)r.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":r.removeAttribute(u);return;case"boolean":var x=u.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){r.removeAttribute(u);return}}r.setAttribute(u,""+m)}}function iu(r,u,m){if(m===null)r.removeAttribute(u);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(u);return}r.setAttribute(u,""+m)}}function Es(r,u,m,x){if(x===null)r.removeAttribute(m);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(m);return}r.setAttributeNS(u,m,""+x)}}function Qr(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function _d(r){var u=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function vd(r){var u=_d(r)?"checked":"value",m=Object.getOwnPropertyDescriptor(r.constructor.prototype,u),x=""+r[u];if(!r.hasOwnProperty(u)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var M=m.get,O=m.set;return Object.defineProperty(r,u,{configurable:!0,get:function(){return M.call(this)},set:function(Q){x=""+Q,O.call(this,Q)}}),Object.defineProperty(r,u,{enumerable:m.enumerable}),{getValue:function(){return x},setValue:function(Q){x=""+Q},stopTracking:function(){r._valueTracker=null,delete r[u]}}}}function ah(r){r._valueTracker||(r._valueTracker=vd(r))}function bl(r){if(!r)return!1;var u=r._valueTracker;if(!u)return!0;var m=u.getValue(),x="";return r&&(x=_d(r)?r.checked?"true":"false":r.value),r=x,r!==m?(u.setValue(r),!0):!1}function ru(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var Ss=/[\n"\\]/g;function hn(r){return r.replace(Ss,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function ko(r,u,m,x,M,O,Q,le){r.name="",Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"?r.type=Q:r.removeAttribute("type"),u!=null?Q==="number"?(u===0&&r.value===""||r.value!=u)&&(r.value=""+Qr(u)):r.value!==""+Qr(u)&&(r.value=""+Qr(u)):Q!=="submit"&&Q!=="reset"||r.removeAttribute("value"),u!=null?au(r,Q,Qr(u)):m!=null?au(r,Q,Qr(m)):x!=null&&r.removeAttribute("value"),M==null&&O!=null&&(r.defaultChecked=!!O),M!=null&&(r.checked=M&&typeof M!="function"&&typeof M!="symbol"),le!=null&&typeof le!="function"&&typeof le!="symbol"&&typeof le!="boolean"?r.name=""+Qr(le):r.removeAttribute("name")}function Dn(r,u,m,x,M,O,Q,le){if(O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(r.type=O),u!=null||m!=null){if(!(O!=="submit"&&O!=="reset"||u!=null))return;m=m!=null?""+Qr(m):"",u=u!=null?""+Qr(u):m,le||u===r.value||(r.value=u),r.defaultValue=u}x=x??M,x=typeof x!="function"&&typeof x!="symbol"&&!!x,r.checked=le?r.checked:!!x,r.defaultChecked=!!x,Q!=null&&typeof Q!="function"&&typeof Q!="symbol"&&typeof Q!="boolean"&&(r.name=Q)}function au(r,u,m){u==="number"&&ru(r.ownerDocument)===r||r.defaultValue===""+m||(r.defaultValue=""+m)}function lc(r,u,m,x){if(r=r.options,u){u={};for(var M=0;M<m.length;M++)u["$"+m[M]]=!0;for(m=0;m<r.length;m++)M=u.hasOwnProperty("$"+r[m].value),r[m].selected!==M&&(r[m].selected=M),M&&x&&(r[m].defaultSelected=!0)}else{for(m=""+Qr(m),u=null,M=0;M<r.length;M++){if(r[M].value===m){r[M].selected=!0,x&&(r[M].defaultSelected=!0);return}u!==null||r[M].disabled||(u=r[M])}u!==null&&(u.selected=!0)}}function ou(r,u,m){if(u!=null&&(u=""+Qr(u),u!==r.value&&(r.value=u),m==null)){r.defaultValue!==u&&(r.defaultValue=u);return}r.defaultValue=m!=null?""+Qr(m):""}function or(r,u,m,x){if(u==null){if(x!=null){if(m!=null)throw Error(h(92));if(Lt(x)){if(1<x.length)throw Error(h(93));x=x[0]}m=x}m==null&&(m=""),u=m}m=Qr(u),r.defaultValue=m,x=r.textContent,x===m&&x!==""&&x!==null&&(r.value=x)}function qi(r,u){if(u){var m=r.firstChild;if(m&&m===r.lastChild&&m.nodeType===3){m.nodeValue=u;return}}r.textContent=u}var Hi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function bd(r,u,m){var x=u.indexOf("--")===0;m==null||typeof m=="boolean"||m===""?x?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="":x?r.setProperty(u,m):typeof m!="number"||m===0||Hi.has(u)?u==="float"?r.cssFloat=m:r[u]=(""+m).trim():r[u]=m+"px"}function oa(r,u,m){if(u!=null&&typeof u!="object")throw Error(h(62));if(r=r.style,m!=null){for(var x in m)!m.hasOwnProperty(x)||u!=null&&u.hasOwnProperty(x)||(x.indexOf("--")===0?r.setProperty(x,""):x==="float"?r.cssFloat="":r[x]="");for(var M in u)x=u[M],u.hasOwnProperty(M)&&m[M]!==x&&bd(r,M,x)}else for(var O in u)u.hasOwnProperty(O)&&bd(r,O,u[O])}function Kr(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var da=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Zf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function As(r){return Zf.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var Ai=null;function cc(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Sa=null,Ua=null;function io(r){var u=vl(r);if(u&&(r=u.stateNode)){var m=r[$n]||null;e:switch(r=u.stateNode,u.type){case"input":if(ko(r,m.value,m.defaultValue,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name),u=m.name,m.type==="radio"&&u!=null){for(m=r;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll('input[name="'+hn(""+u)+'"][type="radio"]'),u=0;u<m.length;u++){var x=m[u];if(x!==r&&x.form===r.form){var M=x[$n]||null;if(!M)throw Error(h(90));ko(x,M.value,M.defaultValue,M.defaultValue,M.checked,M.defaultChecked,M.type,M.name)}}for(u=0;u<m.length;u++)x=m[u],x.form===r.form&&bl(x)}break e;case"textarea":ou(r,m.value,m.defaultValue);break e;case"select":u=m.value,u!=null&&lc(r,!!m.multiple,u,!1)}}}var oh=!1;function Cs(r,u,m){if(oh)return r(u,m);oh=!0;try{var x=r(u);return x}finally{if(oh=!1,(Sa!==null||Ua!==null)&&(Rp(),Sa&&(u=Sa,r=Ua,Ua=Sa=null,io(u),r)))for(u=0;u<r.length;u++)io(r[u])}}function xl(r,u){var m=r.stateNode;if(m===null)return null;var x=m[$n]||null;if(x===null)return null;m=x[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(r=r.type,x=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!x;break e;default:r=!1}if(r)return null;if(m&&typeof m!="function")throw Error(h(231,u,typeof m));return m}var Ci=!1;if($s)try{var Ms={};Object.defineProperty(Ms,"passive",{get:function(){Ci=!0}}),window.addEventListener("test",Ms,Ms),window.removeEventListener("test",Ms,Ms)}catch{Ci=!1}var Tn=null,pn=null,wl=null;function Vn(){if(wl)return wl;var r,u=pn,m=u.length,x,M="value"in Tn?Tn.value:Tn.textContent,O=M.length;for(r=0;r<m&&u[r]===M[r];r++);var Q=m-r;for(x=1;x<=Q&&u[m-x]===M[O-x];x++);return wl=M.slice(r,1<x?1-x:void 0)}function Ys(r){var u=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&u===13&&(r=13)):r=u,r===10&&(r=13),32<=r||r===13?r:0}function Va(){return!0}function su(){return!1}function Jr(r){function u(m,x,M,O,Q){this._reactName=m,this._targetInst=M,this.type=x,this.nativeEvent=O,this.target=Q,this.currentTarget=null;for(var le in r)r.hasOwnProperty(le)&&(m=r[le],this[le]=m?m(O):O[le]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?Va:su,this.isPropagationStopped=su,this}return Qe(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Va)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Va)},persist:function(){},isPersistent:Va}),u}var Jo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ds=Jr(Jo),lu=Qe({},Jo,{view:0,detail:0}),$f=Jr(lu),sh,xd,qs,ui=Qe({},lu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:El,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==qs&&(qs&&r.type==="mousemove"?(sh=r.screenX-qs.screenX,xd=r.screenY-qs.screenY):xd=sh=0,qs=r),sh)},movementY:function(r){return"movementY"in r?r.movementY:xd}}),uc=Jr(ui),es=Qe({},ui,{dataTransfer:0}),hc=Jr(es),$r=Qe({},lu,{relatedTarget:0}),lh=Jr($r),Tl=Qe({},Jo,{animationName:0,elapsedTime:0,pseudoElement:0}),bm=Jr(Tl),Jg=Qe({},Jo,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),wd=Jr(Jg),Yf=Qe({},Jo,{data:0}),xm=Jr(Yf),Td={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dc={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ro={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ch(r){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(r):(r=ro[r])?!!u[r]:!1}function El(){return ch}var qf=Qe({},lu,{key:function(r){if(r.key){var u=Td[r.key]||r.key;if(u!=="Unidentified")return u}return r.type==="keypress"?(r=Ys(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?dc[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:El,charCode:function(r){return r.type==="keypress"?Ys(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ys(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Ro=Jr(qf),ey=Qe({},ui,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ed=Jr(ey),uh=Qe({},lu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:El}),hh=Jr(uh),Sd=Qe({},Jo,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ad=Jr(Sd),wm=Qe({},ui,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),fc=Jr(wm),ty=Qe({},Jo,{newState:0,oldState:0}),Hf=Jr(ty),ny=[9,13,27,32],Cd=$s&&"CompositionEvent"in window,pc=null;$s&&"documentMode"in document&&(pc=document.documentMode);var Tm=$s&&"TextEvent"in window&&!pc,Xf=$s&&(!Cd||pc&&8<pc&&11>=pc),Md=" ",Dd=!1;function Hs(r,u){switch(r){case"keyup":return ny.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wf(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var mc=!1;function dh(r,u){switch(r){case"compositionend":return Wf(u);case"keypress":return u.which!==32?null:(Dd=!0,Md);case"textInput":return r=u.data,r===Md&&Dd?null:r;default:return null}}function Qf(r,u){if(mc)return r==="compositionend"||!Cd&&Hs(r,u)?(r=Vn(),wl=pn=Tn=null,mc=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Xf&&u.locale!=="ko"?null:u.data;default:return null}}var Id={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Em(r){var u=r&&r.nodeName&&r.nodeName.toLowerCase();return u==="input"?!!Id[r.type]:u==="textarea"}function Sm(r,u,m,x){Sa?Ua?Ua.push(x):Ua=[x]:Sa=x,u=Fp(u,"onChange"),0<u.length&&(m=new Ds("onChange","change",null,m,x),r.push({event:m,listeners:u}))}var gc=null,yc=null;function Am(r){Dy(r,0)}function cu(r){var u=Ko(r);if(bl(u))return r}function kd(r,u){if(r==="change")return u}var uu=!1;if($s){var ts;if($s){var fh="oninput"in document;if(!fh){var Rd=document.createElement("div");Rd.setAttribute("oninput","return;"),fh=typeof Rd.oninput=="function"}ts=fh}else ts=!1;uu=ts&&(!document.documentMode||9<document.documentMode)}function ph(){gc&&(gc.detachEvent("onpropertychange",Kf),yc=gc=null)}function Kf(r){if(r.propertyName==="value"&&cu(yc)){var u=[];Sm(u,yc,r,cc(r)),Cs(Am,u)}}function Jf(r,u,m){r==="focusin"?(ph(),gc=u,yc=m,gc.attachEvent("onpropertychange",Kf)):r==="focusout"&&ph()}function _c(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return cu(yc)}function ep(r,u){if(r==="click")return cu(u)}function oi(r,u){if(r==="input"||r==="change")return cu(u)}function iy(r,u){return r===u&&(r!==0||1/r===1/u)||r!==r&&u!==u}var ao=typeof Object.is=="function"?Object.is:iy;function mh(r,u){if(ao(r,u))return!0;if(typeof r!="object"||r===null||typeof u!="object"||u===null)return!1;var m=Object.keys(r),x=Object.keys(u);if(m.length!==x.length)return!1;for(x=0;x<m.length;x++){var M=m[x];if(!Co.call(u,M)||!ao(r[M],u[M]))return!1}return!0}function tp(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Cm(r,u){var m=tp(r);r=0;for(var x;m;){if(m.nodeType===3){if(x=r+m.textContent.length,r<=u&&x>=u)return{node:m,offset:u-r};r=x}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=tp(m)}}function np(r,u){return r&&u?r===u?!0:r&&r.nodeType===3?!1:u&&u.nodeType===3?np(r,u.parentNode):"contains"in r?r.contains(u):r.compareDocumentPosition?!!(r.compareDocumentPosition(u)&16):!1:!1}function gh(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var u=ru(r.document);u instanceof r.HTMLIFrameElement;){try{var m=typeof u.contentWindow.location.href=="string"}catch{m=!1}if(m)r=u.contentWindow;else break;u=ru(r.document)}return u}function hu(r){var u=r&&r.nodeName&&r.nodeName.toLowerCase();return u&&(u==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||u==="textarea"||r.contentEditable==="true")}function Nd(r,u){var m=gh(u);u=r.focusedElem;var x=r.selectionRange;if(m!==u&&u&&u.ownerDocument&&np(u.ownerDocument.documentElement,u)){if(x!==null&&hu(u)){if(r=x.start,m=x.end,m===void 0&&(m=r),"selectionStart"in u)u.selectionStart=r,u.selectionEnd=Math.min(m,u.value.length);else if(m=(r=u.ownerDocument||document)&&r.defaultView||window,m.getSelection){m=m.getSelection();var M=u.textContent.length,O=Math.min(x.start,M);x=x.end===void 0?O:Math.min(x.end,M),!m.extend&&O>x&&(M=x,x=O,O=M),M=Cm(u,O);var Q=Cm(u,x);M&&Q&&(m.rangeCount!==1||m.anchorNode!==M.node||m.anchorOffset!==M.offset||m.focusNode!==Q.node||m.focusOffset!==Q.offset)&&(r=r.createRange(),r.setStart(M.node,M.offset),m.removeAllRanges(),O>x?(m.addRange(r),m.extend(Q.node,Q.offset)):(r.setEnd(Q.node,Q.offset),m.addRange(r)))}}for(r=[],m=u;m=m.parentNode;)m.nodeType===1&&r.push({element:m,left:m.scrollLeft,top:m.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<r.length;u++)m=r[u],m.element.scrollLeft=m.left,m.element.scrollTop=m.top}}var ip=$s&&"documentMode"in document&&11>=document.documentMode,No=null,Sl=null,fa=null,Pd=!1;function rp(r,u,m){var x=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;Pd||No==null||No!==ru(x)||(x=No,"selectionStart"in x&&hu(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),fa&&mh(fa,x)||(fa=x,x=Fp(Sl,"onSelect"),0<x.length&&(u=new Ds("onSelect","select",null,u,m),r.push({event:u,listeners:x}),u.target=No)))}function Xs(r,u){var m={};return m[r.toLowerCase()]=u.toLowerCase(),m["Webkit"+r]="webkit"+u,m["Moz"+r]="moz"+u,m}var Po={animationend:Xs("Animation","AnimationEnd"),animationiteration:Xs("Animation","AnimationIteration"),animationstart:Xs("Animation","AnimationStart"),transitionrun:Xs("Transition","TransitionRun"),transitionstart:Xs("Transition","TransitionStart"),transitioncancel:Xs("Transition","TransitionCancel"),transitionend:Xs("Transition","TransitionEnd")},du={},yh={};$s&&(yh=document.createElement("div").style,"AnimationEvent"in window||(delete Po.animationend.animation,delete Po.animationiteration.animation,delete Po.animationstart.animation),"TransitionEvent"in window||delete Po.transitionend.transition);function ns(r){if(du[r])return du[r];if(!Po[r])return r;var u=Po[r],m;for(m in u)if(u.hasOwnProperty(m)&&m in yh)return du[r]=u[m];return r}var _h=ns("animationend"),ap=ns("animationiteration"),vc=ns("animationstart"),fu=ns("transitionrun"),Mm=ns("transitionstart"),op=ns("transitioncancel"),Yn=ns("transitionend"),vh=new Map,Dm="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function zo(r,u){vh.set(r,u),Io(u,[r])}var pa=[],Al=0,sp=0;function bh(){for(var r=Al,u=sp=Al=0;u<r;){var m=pa[u];pa[u++]=null;var x=pa[u];pa[u++]=null;var M=pa[u];pa[u++]=null;var O=pa[u];if(pa[u++]=null,x!==null&&M!==null){var Q=x.pending;Q===null?M.next=M:(M.next=Q.next,Q.next=M),x.pending=M}O!==0&&xh(m,M,O)}}function zd(r,u,m,x){pa[Al++]=r,pa[Al++]=u,pa[Al++]=m,pa[Al++]=x,sp|=x,r.lanes|=x,r=r.alternate,r!==null&&(r.lanes|=x)}function pu(r,u,m,x){return zd(r,u,m,x),Ws(r)}function is(r,u){return zd(r,null,null,u),Ws(r)}function xh(r,u,m){r.lanes|=m;var x=r.alternate;x!==null&&(x.lanes|=m);for(var M=!1,O=r.return;O!==null;)O.childLanes|=m,x=O.alternate,x!==null&&(x.childLanes|=m),O.tag===22&&(r=O.stateNode,r===null||r._visibility&1||(M=!0)),r=O,O=O.return;M&&u!==null&&r.tag===3&&(O=r.stateNode,M=31-re(m),O=O.hiddenUpdates,r=O[M],r===null?O[M]=[u]:r.push(u),u.lane=m|536870912)}function Ws(r){if(50<cf)throw cf=0,ql=null,Error(h(185));for(var u=r.return;u!==null;)r=u,u=r.return;return r.tag===3?r.stateNode:null}var Qs={},lp=new WeakMap;function Aa(r,u){if(typeof r=="object"&&r!==null){var m=lp.get(r);return m!==void 0?m:(u={value:r,source:u,stack:dt(u)},lp.set(r,u),u)}return{value:r,source:u,stack:dt(u)}}var Ks=[],Cl=0,Od=null,bc=0,oo=[],so=0,Is=null,Oo=1,rs="";function Js(r,u){Ks[Cl++]=bc,Ks[Cl++]=Od,Od=r,bc=u}function mu(r,u,m){oo[so++]=Oo,oo[so++]=rs,oo[so++]=Is,Is=r;var x=Oo;r=rs;var M=32-re(x)-1;x&=~(1<<M),m+=1;var O=32-re(u)+M;if(30<O){var Q=M-M%5;O=(x&(1<<Q)-1).toString(32),x>>=Q,M-=Q,Oo=1<<32-re(u)+M|m<<M|x,rs=O+r}else Oo=1<<O|m<<M|x,rs=r}function xc(r){r.return!==null&&(Js(r,1),mu(r,1,0))}function wh(r){for(;r===Od;)Od=Ks[--Cl],Ks[Cl]=null,bc=Ks[--Cl],Ks[Cl]=null;for(;r===Is;)Is=oo[--so],oo[so]=null,rs=oo[--so],oo[so]=null,Oo=oo[--so],oo[so]=null}var ea=null,Rn=null,Bn=!1,fr=null,Lo=!1,Th=Error(h(519));function Ml(r){var u=Error(h(418,""));throw gu(Aa(u,r)),Th}function wc(r){var u=r.stateNode,m=r.type,x=r.memoizedProps;switch(u[Nt]=r,u[$n]=x,m){case"dialog":Qn("cancel",u),Qn("close",u);break;case"iframe":case"object":case"embed":Qn("load",u);break;case"video":case"audio":for(m=0;m<gf.length;m++)Qn(gf[m],u);break;case"source":Qn("error",u);break;case"img":case"image":case"link":Qn("error",u),Qn("load",u);break;case"details":Qn("toggle",u);break;case"input":Qn("invalid",u),Dn(u,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0),ah(u);break;case"select":Qn("invalid",u);break;case"textarea":Qn("invalid",u),or(u,x.value,x.defaultValue,x.children),ah(u)}m=x.children,typeof m!="string"&&typeof m!="number"&&typeof m!="bigint"||u.textContent===""+m||x.suppressHydrationWarning===!0||Ry(u.textContent,m)?(x.popover!=null&&(Qn("beforetoggle",u),Qn("toggle",u)),x.onScroll!=null&&Qn("scroll",u),x.onScrollEnd!=null&&Qn("scrollend",u),x.onClick!=null&&(u.onclick=Up),u=!0):u=!1,u||Ml(r)}function Tc(r){for(ea=r.return;ea;)switch(ea.tag){case 3:case 27:Lo=!0;return;case 5:case 13:Lo=!1;return;default:ea=ea.return}}function Dl(r){if(r!==ea)return!1;if(!Bn)return Tc(r),Bn=!0,!1;var u=!1,m;if((m=r.tag!==3&&r.tag!==27)&&((m=r.tag===5)&&(m=r.type,m=!(m!=="form"&&m!=="button")||_f(r.type,r.memoizedProps)),m=!m),m&&(u=!0),u&&Rn&&Ml(r),Tc(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(h(317));e:{for(r=r.nextSibling,u=0;r;){if(r.nodeType===8)if(m=r.data,m==="/$"){if(u===0){Rn=fs(r.nextSibling);break e}u--}else m!=="$"&&m!=="$!"&&m!=="$?"||u++;r=r.nextSibling}Rn=null}}else Rn=ea?fs(r.stateNode.nextSibling):null;return!0}function el(){Rn=ea=null,Bn=!1}function gu(r){fr===null?fr=[r]:fr.push(r)}var Ec=Error(h(460)),Ld=Error(h(474)),Bd={then:function(){}};function tl(r){return r=r.status,r==="fulfilled"||r==="rejected"}function yu(){}function Sc(r,u,m){switch(m=r[m],m===void 0?r.push(u):m!==u&&(u.then(yu,yu),u=m),u.status){case"fulfilled":return u.value;case"rejected":throw r=u.reason,r===Ec?Error(h(483)):r;default:if(typeof u.status=="string")u.then(yu,yu);else{if(r=Ji,r!==null&&100<r.shellSuspendCounter)throw Error(h(482));r=u,r.status="pending",r.then(function(x){if(u.status==="pending"){var M=u;M.status="fulfilled",M.value=x}},function(x){if(u.status==="pending"){var M=u;M.status="rejected",M.reason=x}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw r=u.reason,r===Ec?Error(h(483)):r}throw _u=u,Ec}}var _u=null;function cp(){if(_u===null)throw Error(h(459));var r=_u;return _u=null,r}var Ac=null,vu=0;function Eh(r){var u=vu;return vu+=1,Ac===null&&(Ac=[]),Sc(Ac,r,u)}function Il(r,u){u=u.props.ref,r.ref=u!==void 0?u:null}function nl(r,u){throw u.$$typeof===v?Error(h(525)):(r=Object.prototype.toString.call(u),Error(h(31,r==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":r)))}function ma(r){var u=r._init;return u(r._payload)}function sr(r){function u(Ye,Ue){if(r){var Je=Ye.deletions;Je===null?(Ye.deletions=[Ue],Ye.flags|=16):Je.push(Ue)}}function m(Ye,Ue){if(!r)return null;for(;Ue!==null;)u(Ye,Ue),Ue=Ue.sibling;return null}function x(Ye){for(var Ue=new Map;Ye!==null;)Ye.key!==null?Ue.set(Ye.key,Ye):Ue.set(Ye.index,Ye),Ye=Ye.sibling;return Ue}function M(Ye,Ue){return Ye=Nu(Ye,Ue),Ye.index=0,Ye.sibling=null,Ye}function O(Ye,Ue,Je){return Ye.index=Je,r?(Je=Ye.alternate,Je!==null?(Je=Je.index,Je<Ue?(Ye.flags|=33554434,Ue):Je):(Ye.flags|=33554434,Ue)):(Ye.flags|=1048576,Ue)}function Q(Ye){return r&&Ye.alternate===null&&(Ye.flags|=33554434),Ye}function le(Ye,Ue,Je,xt){return Ue===null||Ue.tag!==6?(Ue=Uh(Je,Ye.mode,xt),Ue.return=Ye,Ue):(Ue=M(Ue,Je),Ue.return=Ye,Ue)}function Ae(Ye,Ue,Je,xt){var nn=Je.type;return nn===A?pt(Ye,Ue,Je.props.children,xt,Je.key):Ue!==null&&(Ue.elementType===nn||typeof nn=="object"&&nn!==null&&nn.$$typeof===ve&&ma(nn)===Ue.type)?(Ue=M(Ue,Je.props),Il(Ue,Je),Ue.return=Ye,Ue):(Ue=Ap(Je.type,Je.key,Je.props,null,Ye.mode,xt),Il(Ue,Je),Ue.return=Ye,Ue)}function Ze(Ye,Ue,Je,xt){return Ue===null||Ue.tag!==4||Ue.stateNode.containerInfo!==Je.containerInfo||Ue.stateNode.implementation!==Je.implementation?(Ue=Zm(Je,Ye.mode,xt),Ue.return=Ye,Ue):(Ue=M(Ue,Je.children||[]),Ue.return=Ye,Ue)}function pt(Ye,Ue,Je,xt,nn){return Ue===null||Ue.tag!==7?(Ue=Fh(Je,Ye.mode,xt,nn),Ue.return=Ye,Ue):(Ue=M(Ue,Je),Ue.return=Ye,Ue)}function At(Ye,Ue,Je){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint")return Ue=Uh(""+Ue,Ye.mode,Je),Ue.return=Ye,Ue;if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case g:return Je=Ap(Ue.type,Ue.key,Ue.props,null,Ye.mode,Je),Il(Je,Ue),Je.return=Ye,Je;case c:return Ue=Zm(Ue,Ye.mode,Je),Ue.return=Ye,Ue;case ve:var xt=Ue._init;return Ue=xt(Ue._payload),At(Ye,Ue,Je)}if(Lt(Ue)||De(Ue))return Ue=Fh(Ue,Ye.mode,Je,null),Ue.return=Ye,Ue;if(typeof Ue.then=="function")return At(Ye,Eh(Ue),Je);if(Ue.$$typeof===V)return At(Ye,vp(Ye,Ue),Je);nl(Ye,Ue)}return null}function it(Ye,Ue,Je,xt){var nn=Ue!==null?Ue.key:null;if(typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint")return nn!==null?null:le(Ye,Ue,""+Je,xt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case g:return Je.key===nn?Ae(Ye,Ue,Je,xt):null;case c:return Je.key===nn?Ze(Ye,Ue,Je,xt):null;case ve:return nn=Je._init,Je=nn(Je._payload),it(Ye,Ue,Je,xt)}if(Lt(Je)||De(Je))return nn!==null?null:pt(Ye,Ue,Je,xt,null);if(typeof Je.then=="function")return it(Ye,Ue,Eh(Je),xt);if(Je.$$typeof===V)return it(Ye,Ue,vp(Ye,Je),xt);nl(Ye,Je)}return null}function ft(Ye,Ue,Je,xt,nn){if(typeof xt=="string"&&xt!==""||typeof xt=="number"||typeof xt=="bigint")return Ye=Ye.get(Je)||null,le(Ue,Ye,""+xt,nn);if(typeof xt=="object"&&xt!==null){switch(xt.$$typeof){case g:return Ye=Ye.get(xt.key===null?Je:xt.key)||null,Ae(Ue,Ye,xt,nn);case c:return Ye=Ye.get(xt.key===null?Je:xt.key)||null,Ze(Ue,Ye,xt,nn);case ve:var Hn=xt._init;return xt=Hn(xt._payload),ft(Ye,Ue,Je,xt,nn)}if(Lt(xt)||De(xt))return Ye=Ye.get(Je)||null,pt(Ue,Ye,xt,nn,null);if(typeof xt.then=="function")return ft(Ye,Ue,Je,Eh(xt),nn);if(xt.$$typeof===V)return ft(Ye,Ue,Je,vp(Ue,xt),nn);nl(Ue,xt)}return null}function ln(Ye,Ue,Je,xt){for(var nn=null,Hn=null,un=Ue,Kt=Ue=0,Di=null;un!==null&&Kt<Je.length;Kt++){un.index>Kt?(Di=un,un=null):Di=un.sibling;var Xn=it(Ye,un,Je[Kt],xt);if(Xn===null){un===null&&(un=Di);break}r&&un&&Xn.alternate===null&&u(Ye,un),Ue=O(Xn,Ue,Kt),Hn===null?nn=Xn:Hn.sibling=Xn,Hn=Xn,un=Di}if(Kt===Je.length)return m(Ye,un),Bn&&Js(Ye,Kt),nn;if(un===null){for(;Kt<Je.length;Kt++)un=At(Ye,Je[Kt],xt),un!==null&&(Ue=O(un,Ue,Kt),Hn===null?nn=un:Hn.sibling=un,Hn=un);return Bn&&Js(Ye,Kt),nn}for(un=x(un);Kt<Je.length;Kt++)Di=ft(un,Ye,Kt,Je[Kt],xt),Di!==null&&(r&&Di.alternate!==null&&un.delete(Di.key===null?Kt:Di.key),Ue=O(Di,Ue,Kt),Hn===null?nn=Di:Hn.sibling=Di,Hn=Di);return r&&un.forEach(function(xa){return u(Ye,xa)}),Bn&&Js(Ye,Kt),nn}function In(Ye,Ue,Je,xt){if(Je==null)throw Error(h(151));for(var nn=null,Hn=null,un=Ue,Kt=Ue=0,Di=null,Xn=Je.next();un!==null&&!Xn.done;Kt++,Xn=Je.next()){un.index>Kt?(Di=un,un=null):Di=un.sibling;var xa=it(Ye,un,Xn.value,xt);if(xa===null){un===null&&(un=Di);break}r&&un&&xa.alternate===null&&u(Ye,un),Ue=O(xa,Ue,Kt),Hn===null?nn=xa:Hn.sibling=xa,Hn=xa,un=Di}if(Xn.done)return m(Ye,un),Bn&&Js(Ye,Kt),nn;if(un===null){for(;!Xn.done;Kt++,Xn=Je.next())Xn=At(Ye,Xn.value,xt),Xn!==null&&(Ue=O(Xn,Ue,Kt),Hn===null?nn=Xn:Hn.sibling=Xn,Hn=Xn);return Bn&&Js(Ye,Kt),nn}for(un=x(un);!Xn.done;Kt++,Xn=Je.next())Xn=ft(un,Ye,Kt,Xn.value,xt),Xn!==null&&(r&&Xn.alternate!==null&&un.delete(Xn.key===null?Kt:Xn.key),Ue=O(Xn,Ue,Kt),Hn===null?nn=Xn:Hn.sibling=Xn,Hn=Xn);return r&&un.forEach(function(Wh){return u(Ye,Wh)}),Bn&&Js(Ye,Kt),nn}function Ur(Ye,Ue,Je,xt){if(typeof Je=="object"&&Je!==null&&Je.type===A&&Je.key===null&&(Je=Je.props.children),typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case g:e:{for(var nn=Je.key;Ue!==null;){if(Ue.key===nn){if(nn=Je.type,nn===A){if(Ue.tag===7){m(Ye,Ue.sibling),xt=M(Ue,Je.props.children),xt.return=Ye,Ye=xt;break e}}else if(Ue.elementType===nn||typeof nn=="object"&&nn!==null&&nn.$$typeof===ve&&ma(nn)===Ue.type){m(Ye,Ue.sibling),xt=M(Ue,Je.props),Il(xt,Je),xt.return=Ye,Ye=xt;break e}m(Ye,Ue);break}else u(Ye,Ue);Ue=Ue.sibling}Je.type===A?(xt=Fh(Je.props.children,Ye.mode,xt,Je.key),xt.return=Ye,Ye=xt):(xt=Ap(Je.type,Je.key,Je.props,null,Ye.mode,xt),Il(xt,Je),xt.return=Ye,Ye=xt)}return Q(Ye);case c:e:{for(nn=Je.key;Ue!==null;){if(Ue.key===nn)if(Ue.tag===4&&Ue.stateNode.containerInfo===Je.containerInfo&&Ue.stateNode.implementation===Je.implementation){m(Ye,Ue.sibling),xt=M(Ue,Je.children||[]),xt.return=Ye,Ye=xt;break e}else{m(Ye,Ue);break}else u(Ye,Ue);Ue=Ue.sibling}xt=Zm(Je,Ye.mode,xt),xt.return=Ye,Ye=xt}return Q(Ye);case ve:return nn=Je._init,Je=nn(Je._payload),Ur(Ye,Ue,Je,xt)}if(Lt(Je))return ln(Ye,Ue,Je,xt);if(De(Je)){if(nn=De(Je),typeof nn!="function")throw Error(h(150));return Je=nn.call(Je),In(Ye,Ue,Je,xt)}if(typeof Je.then=="function")return Ur(Ye,Ue,Eh(Je),xt);if(Je.$$typeof===V)return Ur(Ye,Ue,vp(Ye,Je),xt);nl(Ye,Je)}return typeof Je=="string"&&Je!==""||typeof Je=="number"||typeof Je=="bigint"?(Je=""+Je,Ue!==null&&Ue.tag===6?(m(Ye,Ue.sibling),xt=M(Ue,Je),xt.return=Ye,Ye=xt):(m(Ye,Ue),xt=Uh(Je,Ye.mode,xt),xt.return=Ye,Ye=xt),Q(Ye)):m(Ye,Ue)}return function(Ye,Ue,Je,xt){try{vu=0;var nn=Ur(Ye,Ue,Je,xt);return Ac=null,nn}catch(un){if(un===Ec)throw un;var Hn=$o(29,un,null,Ye.mode);return Hn.lanes=xt,Hn.return=Ye,Hn}finally{}}}var Bo=sr(!0),jo=sr(!1),as=dn(null),jd=dn(0);function bu(r,u){r=Fc,Un(jd,r),Un(as,u),Fc=r|u.baseLanes}function Fd(){Un(jd,Fc),Un(as,as.current)}function Sh(){Fc=jd.current,An(as),An(jd)}var lo=dn(null),ga=null;function ya(r){var u=r.alternate;Un(Pr,Pr.current&1),Un(lo,r),ga===null&&(u===null||as.current!==null||u.memoizedState!==null)&&(ga=r)}function Ft(r){if(r.tag===22){if(Un(Pr,Pr.current),Un(lo,r),ga===null){var u=r.alternate;u!==null&&u.memoizedState!==null&&(ga=r)}}else il()}function il(){Un(Pr,Pr.current),Un(lo,lo.current)}function Ca(r){An(lo),ga===r&&(ga=null),An(Pr)}var Pr=dn(0);function kl(r){for(var u=r;u!==null;){if(u.tag===13){var m=u.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if(u.flags&128)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Rl=typeof AbortController<"u"?AbortController:function(){var r=[],u=this.signal={aborted:!1,addEventListener:function(m,x){r.push(x)}};this.abort=function(){u.aborted=!0,r.forEach(function(m){return m()})}},Im=i.unstable_scheduleCallback,zn=i.unstable_NormalPriority,Xi={$$typeof:V,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ud(){return{controller:new Rl,data:new Map,refCount:0}}function Nl(r){r.refCount--,r.refCount===0&&Im(zn,function(){r.controller.abort()})}var xu=null,Vd=0,rl=0,al=null;function km(r,u){if(xu===null){var m=xu=[];Vd=0,rl=Bp(),al={status:"pending",value:void 0,then:function(x){m.push(x)}}}return Vd++,u.then(up,up),u}function up(){if(--Vd===0&&xu!==null){al!==null&&(al.status="fulfilled");var r=xu;xu=null,rl=0,al=null;for(var u=0;u<r.length;u++)(0,r[u])()}}function Rm(r,u){var m=[],x={status:"pending",value:null,reason:null,then:function(M){m.push(M)}};return r.then(function(){x.status="fulfilled",x.value=u;for(var M=0;M<m.length;M++)(0,m[M])(u)},function(M){for(x.status="rejected",x.reason=M,M=0;M<m.length;M++)(0,m[M])(void 0)}),x}var hp=ye.S;ye.S=function(r,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&km(r,u),hp!==null&&hp(r,u)};var Pl=dn(null);function os(){var r=Pl.current;return r!==null?r:Ji.pooledCache}function Mi(r,u){u===null?Un(Pl,Pl.current):Un(Pl,u.pool)}function Ah(){var r=os();return r===null?null:{parent:Xi._currentValue,pool:r}}var ss=0,Nn=null,mi=null,pr=null,Cc=!1,Ma=!1,Fo=!1,Wt=0,rn=0,ks=null,Gd=0;function Wi(){throw Error(h(321))}function _a(r,u){if(u===null)return!1;for(var m=0;m<u.length&&m<r.length;m++)if(!ao(r[m],u[m]))return!1;return!0}function Zd(r,u,m,x,M,O){return ss=O,Nn=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,ye.H=r===null||r.memoizedState===null?Pi:mr,Fo=!1,O=m(x,M),Fo=!1,Ma&&(O=Nm(u,m,x,M)),ls(r),O}function ls(r){ye.H=Ei;var u=mi!==null&&mi.next!==null;if(ss=0,pr=mi=Nn=null,Cc=!1,rn=0,ks=null,u)throw Error(h(300));r===null||zr||(r=r.dependencies,r!==null&&_p(r)&&(zr=!0))}function Nm(r,u,m,x){Nn=r;var M=0;do{if(Ma&&(ks=null),rn=0,Ma=!1,25<=M)throw Error(h(301));if(M+=1,pr=mi=null,r.updateQueue!=null){var O=r.updateQueue;O.lastEffect=null,O.events=null,O.stores=null,O.memoCache!=null&&(O.memoCache.index=0)}ye.H=Da,O=u(m,x)}while(Ma);return O}function Ch(){var r=ye.H,u=r.useState()[0];return u=typeof u.then=="function"?Mc(u):u,r=r.useState()[0],(mi!==null?mi.memoizedState:null)!==r&&(Nn.flags|=1024),u}function gi(){var r=Wt!==0;return Wt=0,r}function lr(r,u,m){u.updateQueue=r.updateQueue,u.flags&=-2053,r.lanes&=~m}function $d(r){if(Cc){for(r=r.memoizedState;r!==null;){var u=r.queue;u!==null&&(u.pending=null),r=r.next}Cc=!1}ss=0,pr=mi=Nn=null,Ma=!1,rn=Wt=0,ks=null}function ta(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pr===null?Nn.memoizedState=pr=r:pr=pr.next=r,pr}function Qi(){if(mi===null){var r=Nn.alternate;r=r!==null?r.memoizedState:null}else r=mi.next;var u=pr===null?Nn.memoizedState:pr.next;if(u!==null)pr=u,mi=r;else{if(r===null)throw Nn.alternate===null?Error(h(467)):Error(h(310));mi=r,r={memoizedState:mi.memoizedState,baseState:mi.baseState,baseQueue:mi.baseQueue,queue:mi.queue,next:null},pr===null?Nn.memoizedState=pr=r:pr=pr.next=r}return pr}var wu;wu=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Mc(r){var u=rn;return rn+=1,ks===null&&(ks=[]),r=Sc(ks,r,u),u=Nn,(pr===null?u.memoizedState:pr.next)===null&&(u=u.alternate,ye.H=u===null||u.memoizedState===null?Pi:mr),r}function Uo(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Mc(r);if(r.$$typeof===V)return Za(r)}throw Error(h(438,String(r)))}function zl(r){var u=null,m=Nn.updateQueue;if(m!==null&&(u=m.memoCache),u==null){var x=Nn.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(u={data:x.data.map(function(M){return M.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),m===null&&(m=wu(),Nn.updateQueue=m),m.memoCache=u,m=u.data[u.index],m===void 0)for(m=u.data[u.index]=Array(r),x=0;x<r;x++)m[x]=Me;return u.index++,m}function co(r,u){return typeof u=="function"?u(r):u}function Dc(r){var u=Qi();return Ic(u,mi,r)}function Ic(r,u,m){var x=r.queue;if(x===null)throw Error(h(311));x.lastRenderedReducer=m;var M=r.baseQueue,O=x.pending;if(O!==null){if(M!==null){var Q=M.next;M.next=O.next,O.next=Q}u.baseQueue=M=O,x.pending=null}if(O=r.baseState,M===null)r.memoizedState=O;else{u=M.next;var le=Q=null,Ae=null,Ze=u,pt=!1;do{var At=Ze.lane&-536870913;if(At!==Ze.lane?(si&At)===At:(ss&At)===At){var it=Ze.revertLane;if(it===0)Ae!==null&&(Ae=Ae.next={lane:0,revertLane:0,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null}),At===rl&&(pt=!0);else if((ss&it)===it){Ze=Ze.next,it===rl&&(pt=!0);continue}else At={lane:0,revertLane:Ze.revertLane,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null},Ae===null?(le=Ae=At,Q=O):Ae=Ae.next=At,Nn.lanes|=it,Os|=it;At=Ze.action,Fo&&m(O,At),O=Ze.hasEagerState?Ze.eagerState:m(O,At)}else it={lane:At,revertLane:Ze.revertLane,action:Ze.action,hasEagerState:Ze.hasEagerState,eagerState:Ze.eagerState,next:null},Ae===null?(le=Ae=it,Q=O):Ae=Ae.next=it,Nn.lanes|=At,Os|=At;Ze=Ze.next}while(Ze!==null&&Ze!==u);if(Ae===null?Q=O:Ae.next=le,!ao(O,r.memoizedState)&&(zr=!0,pt&&(m=al,m!==null)))throw m;r.memoizedState=O,r.baseState=Q,r.baseQueue=Ae,x.lastRenderedState=O}return M===null&&(x.lanes=0),[r.memoizedState,x.dispatch]}function Mh(r){var u=Qi(),m=u.queue;if(m===null)throw Error(h(311));m.lastRenderedReducer=r;var x=m.dispatch,M=m.pending,O=u.memoizedState;if(M!==null){m.pending=null;var Q=M=M.next;do O=r(O,Q.action),Q=Q.next;while(Q!==M);ao(O,u.memoizedState)||(zr=!0),u.memoizedState=O,u.baseQueue===null&&(u.baseState=O),m.lastRenderedState=O}return[O,x]}function kc(r,u,m){var x=Nn,M=Qi(),O=Bn;if(O){if(m===void 0)throw Error(h(407));m=m()}else m=u();var Q=!ao((mi||M).memoizedState,m);if(Q&&(M.memoizedState=m,zr=!0),M=M.queue,pe(Dh.bind(null,x,M,r),[r]),M.getSnapshot!==u||Q||pr!==null&&pr.memoizedState.tag&1){if(x.flags|=2048,Y(9,Yd.bind(null,x,M,m,u),{destroy:void 0},null),Ji===null)throw Error(h(349));O||ss&60||Ol(x,u,m)}return m}function Ol(r,u,m){r.flags|=16384,r={getSnapshot:u,value:m},u=Nn.updateQueue,u===null?(u=wu(),Nn.updateQueue=u,u.stores=[r]):(m=u.stores,m===null?u.stores=[r]:m.push(r))}function Yd(r,u,m,x){u.value=m,u.getSnapshot=x,ol(u)&&qd(r)}function Dh(r,u,m){return m(function(){ol(u)&&qd(r)})}function ol(r){var u=r.getSnapshot;r=r.value;try{var m=u();return!ao(r,m)}catch{return!0}}function qd(r){var u=is(r,2);u!==null&&ra(u,r,2)}function Ih(r){var u=ta();if(typeof r=="function"){var m=r;if(r=m(),Fo){te(!0);try{m()}finally{te(!1)}}}return u.memoizedState=u.baseState=r,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:co,lastRenderedState:r},u}function Tu(r,u,m,x){return r.baseState=m,Ic(r,mi,typeof x=="function"?x:co)}function dp(r,u,m,x,M){if(ii(r))throw Error(h(485));if(r=u.action,r!==null){var O={payload:M,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Q){O.listeners.push(Q)}};ye.T!==null?m(!0):O.isTransition=!1,x(O),m=u.pending,m===null?(O.next=u.pending=O,b(u,O)):(O.next=m.next,u.pending=m.next=O)}}function b(r,u){var m=u.action,x=u.payload,M=r.state;if(u.isTransition){var O=ye.T,Q={};ye.T=Q;try{var le=m(M,x),Ae=ye.S;Ae!==null&&Ae(Q,le),e(r,u,le)}catch(Ze){f(r,u,Ze)}finally{ye.T=O}}else try{O=m(M,x),e(r,u,O)}catch(Ze){f(r,u,Ze)}}function e(r,u,m){m!==null&&typeof m=="object"&&typeof m.then=="function"?m.then(function(x){o(r,u,x)},function(x){return f(r,u,x)}):o(r,u,m)}function o(r,u,m){u.status="fulfilled",u.value=m,y(u),r.state=m,u=r.pending,u!==null&&(m=u.next,m===u?r.pending=null:(m=m.next,u.next=m,b(r,m)))}function f(r,u,m){var x=r.pending;if(r.pending=null,x!==null){x=x.next;do u.status="rejected",u.reason=m,y(u),u=u.next;while(u!==x)}r.action=null}function y(r){r=r.listeners;for(var u=0;u<r.length;u++)(0,r[u])()}function w(r,u){return u}function S(r,u){if(Bn){var m=Ji.formState;if(m!==null){e:{var x=Nn;if(Bn){if(Rn){t:{for(var M=Rn,O=Lo;M.nodeType!==8;){if(!O){M=null;break t}if(M=fs(M.nextSibling),M===null){M=null;break t}}O=M.data,M=O==="F!"||O==="F"?M:null}if(M){Rn=fs(M.nextSibling),x=M.data==="F!";break e}}Ml(x)}x=!1}x&&(u=m[0])}}return m=ta(),m.memoizedState=m.baseState=u,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:w,lastRenderedState:u},m.queue=x,m=yi.bind(null,Nn,x),x.dispatch=m,x=Ih(!1),O=hi.bind(null,Nn,!1,x.queue),x=ta(),M={state:u,dispatch:null,action:r,pending:null},x.queue=M,m=dp.bind(null,Nn,M,O,m),M.dispatch=m,x.memoizedState=r,[u,m,!1]}function I(r){var u=Qi();return P(u,mi,r)}function P(r,u,m){u=Ic(r,u,w)[0],r=Dc(co)[0],u=typeof u=="object"&&u!==null&&typeof u.then=="function"?Mc(u):u;var x=Qi(),M=x.queue,O=M.dispatch;return m!==x.memoizedState&&(Nn.flags|=2048,Y(9,j.bind(null,M,m),{destroy:void 0},null)),[u,O,r]}function j(r,u){r.action=u}function Z(r){var u=Qi(),m=mi;if(m!==null)return P(u,m,r);Qi(),u=u.memoizedState,m=Qi();var x=m.queue.dispatch;return m.memoizedState=r,[u,x,!1]}function Y(r,u,m,x){return r={tag:r,create:u,inst:m,deps:x,next:null},u=Nn.updateQueue,u===null&&(u=wu(),Nn.updateQueue=u),m=u.lastEffect,m===null?u.lastEffect=r.next=r:(x=m.next,m.next=r,r.next=x,u.lastEffect=r),r}function H(){return Qi().memoizedState}function ee(r,u,m,x){var M=ta();Nn.flags|=r,M.memoizedState=Y(1|u,m,{destroy:void 0},x===void 0?null:x)}function ie(r,u,m,x){var M=Qi();x=x===void 0?null:x;var O=M.memoizedState.inst;mi!==null&&x!==null&&_a(x,mi.memoizedState.deps)?M.memoizedState=Y(u,m,O,x):(Nn.flags|=r,M.memoizedState=Y(1|u,m,O,x))}function me(r,u){ee(8390656,8,r,u)}function pe(r,u){ie(2048,8,r,u)}function ge(r,u){return ie(4,2,r,u)}function be(r,u){return ie(4,4,r,u)}function Se(r,u){if(typeof u=="function"){r=r();var m=u(r);return function(){typeof m=="function"?m():u(null)}}if(u!=null)return r=r(),u.current=r,function(){u.current=null}}function ke(r,u,m){m=m!=null?m.concat([r]):null,ie(4,4,Se.bind(null,u,r),m)}function Re(){}function Oe(r,u){var m=Qi();u=u===void 0?null:u;var x=m.memoizedState;return u!==null&&_a(u,x[1])?x[0]:(m.memoizedState=[r,u],r)}function Pe(r,u){var m=Qi();u=u===void 0?null:u;var x=m.memoizedState;if(u!==null&&_a(u,x[1]))return x[0];if(x=r(),Fo){te(!0);try{r()}finally{te(!1)}}return m.memoizedState=[x,u],x}function He(r,u,m){return m===void 0||ss&1073741824?r.memoizedState=u:(r.memoizedState=m,r=uf(),Nn.lanes|=r,Os|=r,m)}function Ke(r,u,m,x){return ao(m,u)?m:as.current!==null?(r=He(r,m,x),ao(r,u)||(zr=!0),r):ss&42?(r=uf(),Nn.lanes|=r,Os|=r,u):(zr=!0,r.memoizedState=m)}function st(r,u,m,x,M){var O=Tt.p;Tt.p=O!==0&&8>O?O:8;var Q=ye.T,le={};ye.T=le,hi(r,!1,u,m);try{var Ae=M(),Ze=ye.S;if(Ze!==null&&Ze(le,Ae),Ae!==null&&typeof Ae=="object"&&typeof Ae.then=="function"){var pt=Rm(Ae,x);Ti(r,u,pt,$a(r))}else Ti(r,u,x,$a(r))}catch(At){Ti(r,u,{then:function(){},status:"rejected",reason:At},$a())}finally{Tt.p=O,ye.T=Q}}function ht(){}function nt(r,u,m,x){if(r.tag!==5)throw Error(h(476));var M=kt(r).queue;st(r,M,u,jt,m===null?ht:function(){return Mt(r),m(x)})}function kt(r){var u=r.memoizedState;if(u!==null)return u;u={memoizedState:jt,baseState:jt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:co,lastRenderedState:jt},next:null};var m={};return u.next={memoizedState:m,baseState:m,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:co,lastRenderedState:m},next:null},r.memoizedState=u,r=r.alternate,r!==null&&(r.memoizedState=u),u}function Mt(r){var u=kt(r).next.queue;Ti(r,u,{},$a())}function gt(){return Za(qe)}function zt(){return Qi().memoizedState}function gn(){return Qi().memoizedState}function qn(r){for(var u=r.return;u!==null;){switch(u.tag){case 24:case 3:var m=$a();r=Vl(m);var x=Gl(u,r,m);x!==null&&(ra(x,u,m),Qd(x,u,m)),u={cache:Ud()},r.payload=u;return}u=u.return}}function Ui(r,u,m){var x=$a();m={lane:x,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null},ii(r)?_i(u,m):(m=pu(r,u,m,x),m!==null&&(ra(m,r,x),na(m,u,x)))}function yi(r,u,m){var x=$a();Ti(r,u,m,x)}function Ti(r,u,m,x){var M={lane:x,revertLane:0,action:m,hasEagerState:!1,eagerState:null,next:null};if(ii(r))_i(u,M);else{var O=r.alternate;if(r.lanes===0&&(O===null||O.lanes===0)&&(O=u.lastRenderedReducer,O!==null))try{var Q=u.lastRenderedState,le=O(Q,m);if(M.hasEagerState=!0,M.eagerState=le,ao(le,Q))return zd(r,u,M,0),Ji===null&&bh(),!1}catch{}finally{}if(m=pu(r,u,M,x),m!==null)return ra(m,r,x),na(m,u,x),!0}return!1}function hi(r,u,m,x){if(x={lane:2,revertLane:Bp(),action:x,hasEagerState:!1,eagerState:null,next:null},ii(r)){if(u)throw Error(h(479))}else u=pu(r,m,x,2),u!==null&&ra(u,r,2)}function ii(r){var u=r.alternate;return r===Nn||u!==null&&u===Nn}function _i(r,u){Ma=Cc=!0;var m=r.pending;m===null?u.next=u:(u.next=m.next,m.next=u),r.pending=u}function na(r,u,m){if(m&4194176){var x=u.lanes;x&=r.pendingLanes,m|=x,u.lanes=m,Pt(r,m)}}var Ei={readContext:Za,use:Uo,useCallback:Wi,useContext:Wi,useEffect:Wi,useImperativeHandle:Wi,useLayoutEffect:Wi,useInsertionEffect:Wi,useMemo:Wi,useReducer:Wi,useRef:Wi,useState:Wi,useDebugValue:Wi,useDeferredValue:Wi,useTransition:Wi,useSyncExternalStore:Wi,useId:Wi};Ei.useCacheRefresh=Wi,Ei.useMemoCache=Wi,Ei.useHostTransitionStatus=Wi,Ei.useFormState=Wi,Ei.useActionState=Wi,Ei.useOptimistic=Wi;var Pi={readContext:Za,use:Uo,useCallback:function(r,u){return ta().memoizedState=[r,u===void 0?null:u],r},useContext:Za,useEffect:me,useImperativeHandle:function(r,u,m){m=m!=null?m.concat([r]):null,ee(4194308,4,Se.bind(null,u,r),m)},useLayoutEffect:function(r,u){return ee(4194308,4,r,u)},useInsertionEffect:function(r,u){ee(4,2,r,u)},useMemo:function(r,u){var m=ta();u=u===void 0?null:u;var x=r();if(Fo){te(!0);try{r()}finally{te(!1)}}return m.memoizedState=[x,u],x},useReducer:function(r,u,m){var x=ta();if(m!==void 0){var M=m(u);if(Fo){te(!0);try{m(u)}finally{te(!1)}}}else M=u;return x.memoizedState=x.baseState=M,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:M},x.queue=r,r=r.dispatch=Ui.bind(null,Nn,r),[x.memoizedState,r]},useRef:function(r){var u=ta();return r={current:r},u.memoizedState=r},useState:function(r){r=Ih(r);var u=r.queue,m=yi.bind(null,Nn,u);return u.dispatch=m,[r.memoizedState,m]},useDebugValue:Re,useDeferredValue:function(r,u){var m=ta();return He(m,r,u)},useTransition:function(){var r=Ih(!1);return r=st.bind(null,Nn,r.queue,!0,!1),ta().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,u,m){var x=Nn,M=ta();if(Bn){if(m===void 0)throw Error(h(407));m=m()}else{if(m=u(),Ji===null)throw Error(h(349));si&60||Ol(x,u,m)}M.memoizedState=m;var O={value:m,getSnapshot:u};return M.queue=O,me(Dh.bind(null,x,O,r),[r]),x.flags|=2048,Y(9,Yd.bind(null,x,O,m,u),{destroy:void 0},null),m},useId:function(){var r=ta(),u=Ji.identifierPrefix;if(Bn){var m=rs,x=Oo;m=(x&~(1<<32-re(x)-1)).toString(32)+m,u=":"+u+"R"+m,m=Wt++,0<m&&(u+="H"+m.toString(32)),u+=":"}else m=Gd++,u=":"+u+"r"+m.toString(32)+":";return r.memoizedState=u},useCacheRefresh:function(){return ta().memoizedState=qn.bind(null,Nn)}};Pi.useMemoCache=zl,Pi.useHostTransitionStatus=gt,Pi.useFormState=S,Pi.useActionState=S,Pi.useOptimistic=function(r){var u=ta();u.memoizedState=u.baseState=r;var m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=m,u=hi.bind(null,Nn,!0,m),m.dispatch=u,[r,u]};var mr={readContext:Za,use:Uo,useCallback:Oe,useContext:Za,useEffect:pe,useImperativeHandle:ke,useInsertionEffect:ge,useLayoutEffect:be,useMemo:Pe,useReducer:Dc,useRef:H,useState:function(){return Dc(co)},useDebugValue:Re,useDeferredValue:function(r,u){var m=Qi();return Ke(m,mi.memoizedState,r,u)},useTransition:function(){var r=Dc(co)[0],u=Qi().memoizedState;return[typeof r=="boolean"?r:Mc(r),u]},useSyncExternalStore:kc,useId:zt};mr.useCacheRefresh=gn,mr.useMemoCache=zl,mr.useHostTransitionStatus=gt,mr.useFormState=I,mr.useActionState=I,mr.useOptimistic=function(r,u){var m=Qi();return Tu(m,mi,r,u)};var Da={readContext:Za,use:Uo,useCallback:Oe,useContext:Za,useEffect:pe,useImperativeHandle:ke,useInsertionEffect:ge,useLayoutEffect:be,useMemo:Pe,useReducer:Mh,useRef:H,useState:function(){return Mh(co)},useDebugValue:Re,useDeferredValue:function(r,u){var m=Qi();return mi===null?He(m,r,u):Ke(m,mi.memoizedState,r,u)},useTransition:function(){var r=Mh(co)[0],u=Qi().memoizedState;return[typeof r=="boolean"?r:Mc(r),u]},useSyncExternalStore:kc,useId:zt};Da.useCacheRefresh=gn,Da.useMemoCache=zl,Da.useHostTransitionStatus=gt,Da.useFormState=Z,Da.useActionState=Z,Da.useOptimistic=function(r,u){var m=Qi();return mi!==null?Tu(m,mi,r,u):(m.baseState=r,[r,m.queue.dispatch])};function Vo(r,u,m,x){u=r.memoizedState,m=m(x,u),m=m==null?u:Qe({},u,m),r.memoizedState=m,r.lanes===0&&(r.updateQueue.baseState=m)}var Ia={isMounted:function(r){return(r=r._reactInternals)?ot(r)===r:!1},enqueueSetState:function(r,u,m){r=r._reactInternals;var x=$a(),M=Vl(x);M.payload=u,m!=null&&(M.callback=m),u=Gl(r,M,x),u!==null&&(ra(u,r,x),Qd(u,r,x))},enqueueReplaceState:function(r,u,m){r=r._reactInternals;var x=$a(),M=Vl(x);M.tag=1,M.payload=u,m!=null&&(M.callback=m),u=Gl(r,M,x),u!==null&&(ra(u,r,x),Qd(u,r,x))},enqueueForceUpdate:function(r,u){r=r._reactInternals;var m=$a(),x=Vl(m);x.tag=2,u!=null&&(x.callback=u),u=Gl(r,x,m),u!==null&&(ra(u,r,m),Qd(u,r,m))}};function Rs(r,u,m,x,M,O,Q){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(x,O,Q):u.prototype&&u.prototype.isPureReactComponent?!mh(m,x)||!mh(M,O):!0}function Eu(r,u,m,x){r=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(m,x),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(m,x),u.state!==r&&Ia.enqueueReplaceState(u,u.state,null)}function cs(r,u){var m=u;if("ref"in u){m={};for(var x in u)x!=="ref"&&(m[x]=u[x])}if(r=r.defaultProps){m===u&&(m=Qe({},m));for(var M in r)m[M]===void 0&&(m[M]=r[M])}return m}var sl=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function ka(r){sl(r)}function uo(r){console.error(r)}function ho(r){sl(r)}function va(r,u){try{var m=r.onUncaughtError;m(u.value,{componentStack:u.stack})}catch(x){setTimeout(function(){throw x})}}function vi(r,u,m){try{var x=r.onCaughtError;x(m.value,{componentStack:m.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(M){setTimeout(function(){throw M})}}function Ii(r,u,m){return m=Vl(m),m.tag=3,m.payload={element:null},m.callback=function(){va(r,u)},m}function Ga(r){return r=Vl(r),r.tag=3,r}function Vi(r,u,m,x){var M=m.type.getDerivedStateFromError;if(typeof M=="function"){var O=x.value;r.payload=function(){return M(O)},r.callback=function(){vi(u,m,x)}}var Q=m.stateNode;Q!==null&&typeof Q.componentDidCatch=="function"&&(r.callback=function(){vi(u,m,x),typeof M!="function"&&(zu===null?zu=new Set([this]):zu.add(this));var le=x.stack;this.componentDidCatch(x.value,{componentStack:le!==null?le:""})})}function ry(r,u,m,x,M){if(m.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(u=m.alternate,u!==null&&Ra(u,m,M,!0),m=lo.current,m!==null){switch(m.tag){case 13:return ga===null?wy():m.alternate===null&&Lr===0&&(Lr=3),m.flags&=-257,m.flags|=65536,m.lanes=M,x===Bd?m.flags|=16384:(u=m.updateQueue,u===null?m.updateQueue=new Set([x]):u.add(x),ff(r,x,M)),!1;case 22:return m.flags|=65536,x===Bd?m.flags|=16384:(u=m.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([x])},m.updateQueue=u):(m=u.retryQueue,m===null?u.retryQueue=new Set([x]):m.add(x)),ff(r,x,M)),!1}throw Error(h(435,m.tag))}return ff(r,x,M),wy(),!1}if(Bn)return u=lo.current,u!==null?(!(u.flags&65536)&&(u.flags|=256),u.flags|=65536,u.lanes=M,x!==Th&&(r=Error(h(422),{cause:x}),gu(Aa(r,m)))):(x!==Th&&(u=Error(h(423),{cause:x}),gu(Aa(u,m))),r=r.current.alternate,r.flags|=65536,M&=-M,r.lanes|=M,x=Aa(x,m),M=Ii(r.stateNode,x,M),zc(r,M),Lr!==4&&(Lr=2)),!1;var O=Error(h(520),{cause:x});if(O=Aa(O,m),Vh===null?Vh=[O]:Vh.push(O),Lr!==4&&(Lr=2),u===null)return!0;x=Aa(x,m),m=u;do{switch(m.tag){case 3:return m.flags|=65536,r=M&-M,m.lanes|=r,r=Ii(m.stateNode,x,r),zc(m,r),!1;case 1:if(u=m.type,O=m.stateNode,(m.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||O!==null&&typeof O.componentDidCatch=="function"&&(zu===null||!zu.has(O))))return m.flags|=65536,M&=-M,m.lanes|=M,M=Ga(M),Vi(M,r,m,x),zc(m,M),!1}m=m.return}while(m!==null);return!1}var fp=Error(h(461)),zr=!1;function ia(r,u,m,x){u.child=r===null?jo(u,null,m,x):Bo(u,r.child,m,x)}function Ll(r,u,m,x,M){m=m.render;var O=u.ref;if("ref"in x){var Q={};for(var le in x)le!=="ref"&&(Q[le]=x[le])}else Q=x;return Pc(u),x=Zd(r,u,m,Q,O,M),le=gi(),r!==null&&!zr?(lr(r,u,M),jl(r,u,M)):(Bn&&le&&xc(u),u.flags|=1,ia(r,u,x,M),u.child)}function Bl(r,u,m,x,M){if(r===null){var O=m.type;return typeof O=="function"&&!_y(O)&&O.defaultProps===void 0&&m.compare===null?(u.tag=15,u.type=O,ll(r,u,O,x,M)):(r=Ap(m.type,null,x,u,u.mode,M),r.ref=u.ref,r.return=u,u.child=r)}if(O=r.child,!cy(r,M)){var Q=O.memoizedProps;if(m=m.compare,m=m!==null?m:mh,m(Q,x)&&r.ref===u.ref)return jl(r,u,M)}return u.flags|=1,r=Nu(O,x),r.ref=u.ref,r.return=u,u.child=r}function ll(r,u,m,x,M){if(r!==null){var O=r.memoizedProps;if(mh(O,x)&&r.ref===u.ref)if(zr=!1,u.pendingProps=x=O,cy(r,M))r.flags&131072&&(zr=!0);else return u.lanes=r.lanes,jl(r,u,M)}return Rh(r,u,m,x,M)}function pp(r,u,m){var x=u.pendingProps,M=x.children,O=(u.stateNode._pendingVisibility&2)!==0,Q=r!==null?r.memoizedState:null;if(Rc(r,u),x.mode==="hidden"||O){if(u.flags&128){if(x=Q!==null?Q.baseLanes|m:m,r!==null){for(M=u.child=r.child,O=0;M!==null;)O=O|M.lanes|M.childLanes,M=M.sibling;u.childLanes=O&~x}else u.childLanes=0,u.child=null;return kh(r,u,x,m)}if(m&536870912)u.memoizedState={baseLanes:0,cachePool:null},r!==null&&Mi(u,Q!==null?Q.cachePool:null),Q!==null?bu(u,Q):Fd(),Ft(u);else return u.lanes=u.childLanes=536870912,kh(r,u,Q!==null?Q.baseLanes|m:m,m)}else Q!==null?(Mi(u,Q.cachePool),bu(u,Q),il(),u.memoizedState=null):(r!==null&&Mi(u,null),Fd(),il());return ia(r,u,M,m),u.child}function kh(r,u,m,x){var M=os();return M=M===null?null:{parent:Xi._currentValue,pool:M},u.memoizedState={baseLanes:m,cachePool:M},r!==null&&Mi(u,null),Fd(),Ft(u),r!==null&&Ra(r,u,x,!0),null}function Rc(r,u){var m=u.ref;if(m===null)r!==null&&r.ref!==null&&(u.flags|=2097664);else{if(typeof m!="function"&&typeof m!="object")throw Error(h(284));(r===null||r.ref!==m)&&(u.flags|=2097664)}}function Rh(r,u,m,x,M){return Pc(u),m=Zd(r,u,m,x,void 0,M),x=gi(),r!==null&&!zr?(lr(r,u,M),jl(r,u,M)):(Bn&&x&&xc(u),u.flags|=1,ia(r,u,m,M),u.child)}function Hd(r,u,m,x,M,O){return Pc(u),u.updateQueue=null,m=Nm(u,x,m,M),ls(r),x=gi(),r!==null&&!zr?(lr(r,u,O),jl(r,u,O)):(Bn&&x&&xc(u),u.flags|=1,ia(r,u,m,O),u.child)}function Xd(r,u,m,x,M){if(Pc(u),u.stateNode===null){var O=Qs,Q=m.contextType;typeof Q=="object"&&Q!==null&&(O=Za(Q)),O=new m(x,O),u.memoizedState=O.state!==null&&O.state!==void 0?O.state:null,O.updater=Ia,u.stateNode=O,O._reactInternals=u,O=u.stateNode,O.props=x,O.state=u.memoizedState,O.refs={},hy(u),Q=m.contextType,O.context=typeof Q=="object"&&Q!==null?Za(Q):Qs,O.state=u.memoizedState,Q=m.getDerivedStateFromProps,typeof Q=="function"&&(Vo(u,m,Q,x),O.state=u.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof O.getSnapshotBeforeUpdate=="function"||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(Q=O.state,typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount(),Q!==O.state&&Ia.enqueueReplaceState(O,O.state,null),xp(u,x,O,M),bp(),O.state=u.memoizedState),typeof O.componentDidMount=="function"&&(u.flags|=4194308),x=!0}else if(r===null){O=u.stateNode;var le=u.memoizedProps,Ae=cs(m,le);O.props=Ae;var Ze=O.context,pt=m.contextType;Q=Qs,typeof pt=="object"&&pt!==null&&(Q=Za(pt));var At=m.getDerivedStateFromProps;pt=typeof At=="function"||typeof O.getSnapshotBeforeUpdate=="function",le=u.pendingProps!==le,pt||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(le||Ze!==Q)&&Eu(u,O,x,Q),Cu=!1;var it=u.memoizedState;O.state=it,xp(u,x,O,M),bp(),Ze=u.memoizedState,le||it!==Ze||Cu?(typeof At=="function"&&(Vo(u,m,At,x),Ze=u.memoizedState),(Ae=Cu||Rs(u,m,Ae,x,it,Ze,Q))?(pt||typeof O.UNSAFE_componentWillMount!="function"&&typeof O.componentWillMount!="function"||(typeof O.componentWillMount=="function"&&O.componentWillMount(),typeof O.UNSAFE_componentWillMount=="function"&&O.UNSAFE_componentWillMount()),typeof O.componentDidMount=="function"&&(u.flags|=4194308)):(typeof O.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=x,u.memoizedState=Ze),O.props=x,O.state=Ze,O.context=Q,x=Ae):(typeof O.componentDidMount=="function"&&(u.flags|=4194308),x=!1)}else{O=u.stateNode,dy(r,u),Q=u.memoizedProps,pt=cs(m,Q),O.props=pt,At=u.pendingProps,it=O.context,Ze=m.contextType,Ae=Qs,typeof Ze=="object"&&Ze!==null&&(Ae=Za(Ze)),le=m.getDerivedStateFromProps,(Ze=typeof le=="function"||typeof O.getSnapshotBeforeUpdate=="function")||typeof O.UNSAFE_componentWillReceiveProps!="function"&&typeof O.componentWillReceiveProps!="function"||(Q!==At||it!==Ae)&&Eu(u,O,x,Ae),Cu=!1,it=u.memoizedState,O.state=it,xp(u,x,O,M),bp();var ft=u.memoizedState;Q!==At||it!==ft||Cu||r!==null&&r.dependencies!==null&&_p(r.dependencies)?(typeof le=="function"&&(Vo(u,m,le,x),ft=u.memoizedState),(pt=Cu||Rs(u,m,pt,x,it,ft,Ae)||r!==null&&r.dependencies!==null&&_p(r.dependencies))?(Ze||typeof O.UNSAFE_componentWillUpdate!="function"&&typeof O.componentWillUpdate!="function"||(typeof O.componentWillUpdate=="function"&&O.componentWillUpdate(x,ft,Ae),typeof O.UNSAFE_componentWillUpdate=="function"&&O.UNSAFE_componentWillUpdate(x,ft,Ae)),typeof O.componentDidUpdate=="function"&&(u.flags|=4),typeof O.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof O.componentDidUpdate!="function"||Q===r.memoizedProps&&it===r.memoizedState||(u.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||Q===r.memoizedProps&&it===r.memoizedState||(u.flags|=1024),u.memoizedProps=x,u.memoizedState=ft),O.props=x,O.state=ft,O.context=Ae,x=pt):(typeof O.componentDidUpdate!="function"||Q===r.memoizedProps&&it===r.memoizedState||(u.flags|=4),typeof O.getSnapshotBeforeUpdate!="function"||Q===r.memoizedProps&&it===r.memoizedState||(u.flags|=1024),x=!1)}return O=x,Rc(r,u),x=(u.flags&128)!==0,O||x?(O=u.stateNode,m=x&&typeof m.getDerivedStateFromError!="function"?null:O.render(),u.flags|=1,r!==null&&x?(u.child=Bo(u,r.child,null,M),u.child=Bo(u,null,m,M)):ia(r,u,m,M),u.memoizedState=O.state,r=u.child):r=jl(r,u,M),r}function Pm(r,u,m,x){return el(),u.flags|=256,ia(r,u,m,x),u.child}var ay={dehydrated:null,treeContext:null,retryLane:0};function mp(r){return{baseLanes:r,cachePool:Ah()}}function zm(r,u,m){return r=r!==null?r.childLanes&~m:0,u&&(r|=ds),r}function oy(r,u,m){var x=u.pendingProps,M=!1,O=(u.flags&128)!==0,Q;if((Q=O)||(Q=r!==null&&r.memoizedState===null?!1:(Pr.current&2)!==0),Q&&(M=!0,u.flags&=-129),Q=(u.flags&32)!==0,u.flags&=-33,r===null){if(Bn){if(M?ya(u):il(),Bn){var le=Rn,Ae;if(Ae=le){e:{for(Ae=le,le=Lo;Ae.nodeType!==8;){if(!le){le=null;break e}if(Ae=fs(Ae.nextSibling),Ae===null){le=null;break e}}le=Ae}le!==null?(u.memoizedState={dehydrated:le,treeContext:Is!==null?{id:Oo,overflow:rs}:null,retryLane:536870912},Ae=$o(18,null,null,0),Ae.stateNode=le,Ae.return=u,u.child=Ae,ea=u,Rn=null,Ae=!0):Ae=!1}Ae||Ml(u)}if(le=u.memoizedState,le!==null&&(le=le.dehydrated,le!==null))return le.data==="$!"?u.lanes=16:u.lanes=536870912,null;Ca(u)}return le=x.children,x=x.fallback,M?(il(),M=u.mode,le=sy({mode:"hidden",children:le},M),x=Fh(x,M,m,null),le.return=u,x.return=u,le.sibling=x,u.child=le,M=u.child,M.memoizedState=mp(m),M.childLanes=zm(r,Q,m),u.memoizedState=ay,x):(ya(u),Su(u,le))}if(Ae=r.memoizedState,Ae!==null&&(le=Ae.dehydrated,le!==null)){if(O)u.flags&256?(ya(u),u.flags&=-257,u=Nh(r,u,m)):u.memoizedState!==null?(il(),u.child=r.child,u.flags|=128,u=null):(il(),M=x.fallback,le=u.mode,x=sy({mode:"visible",children:x.children},le),M=Fh(M,le,m,null),M.flags|=2,x.return=u,M.return=u,x.sibling=M,u.child=x,Bo(u,r.child,null,m),x=u.child,x.memoizedState=mp(m),x.childLanes=zm(r,Q,m),u.memoizedState=ay,u=M);else if(ya(u),le.data==="$!"){if(Q=le.nextSibling&&le.nextSibling.dataset,Q)var Ze=Q.dgst;Q=Ze,x=Error(h(419)),x.stack="",x.digest=Q,gu({value:x,source:null,stack:null}),u=Nh(r,u,m)}else if(zr||Ra(r,u,m,!1),Q=(m&r.childLanes)!==0,zr||Q){if(Q=Ji,Q!==null){if(x=m&-m,x&42)x=1;else switch(x){case 2:x=1;break;case 8:x=4;break;case 32:x=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:x=64;break;case 268435456:x=134217728;break;default:x=0}if(x=x&(Q.suspendedLanes|m)?0:x,x!==0&&x!==Ae.retryLane)throw Ae.retryLane=x,is(r,x),ra(Q,r,x),fp}le.data==="$?"||wy(),u=Nh(r,u,m)}else le.data==="$?"?(u.flags|=128,u.child=r.child,u=Sy.bind(null,r),le._reactRetry=u,u=null):(r=Ae.treeContext,Rn=fs(le.nextSibling),ea=u,Bn=!0,fr=null,Lo=!1,r!==null&&(oo[so++]=Oo,oo[so++]=rs,oo[so++]=Is,Oo=r.id,rs=r.overflow,Is=u),u=Su(u,x.children),u.flags|=4096);return u}return M?(il(),M=x.fallback,le=u.mode,Ae=r.child,Ze=Ae.sibling,x=Nu(Ae,{mode:"hidden",children:x.children}),x.subtreeFlags=Ae.subtreeFlags&31457280,Ze!==null?M=Nu(Ze,M):(M=Fh(M,le,m,null),M.flags|=2),M.return=u,x.return=u,x.sibling=M,u.child=x,x=M,M=u.child,le=r.child.memoizedState,le===null?le=mp(m):(Ae=le.cachePool,Ae!==null?(Ze=Xi._currentValue,Ae=Ae.parent!==Ze?{parent:Ze,pool:Ze}:Ae):Ae=Ah(),le={baseLanes:le.baseLanes|m,cachePool:Ae}),M.memoizedState=le,M.childLanes=zm(r,Q,m),u.memoizedState=ay,x):(ya(u),m=r.child,r=m.sibling,m=Nu(m,{mode:"visible",children:x.children}),m.return=u,m.sibling=null,r!==null&&(Q=u.deletions,Q===null?(u.deletions=[r],u.flags|=16):Q.push(r)),u.child=m,u.memoizedState=null,m)}function Su(r,u){return u=sy({mode:"visible",children:u},r.mode),u.return=r,r.child=u}function sy(r,u){return $_(r,u,0,null)}function Nh(r,u,m){return Bo(u,r.child,null,m),r=Su(u,u.pendingProps.children),r.flags|=2,u.memoizedState=null,r}function gp(r,u,m){r.lanes|=u;var x=r.alternate;x!==null&&(x.lanes|=u),yp(r.return,u,m)}function Wd(r,u,m,x,M){var O=r.memoizedState;O===null?r.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:x,tail:m,tailMode:M}:(O.isBackwards=u,O.rendering=null,O.renderingStartTime=0,O.last=x,O.tail=m,O.tailMode=M)}function ly(r,u,m){var x=u.pendingProps,M=x.revealOrder,O=x.tail;if(ia(r,u,x.children,m),x=Pr.current,x&2)x=x&1|2,u.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=u.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&gp(r,m,u);else if(r.tag===19)gp(r,m,u);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===u)break e;for(;r.sibling===null;){if(r.return===null||r.return===u)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}x&=1}switch(Un(Pr,x),M){case"forwards":for(m=u.child,M=null;m!==null;)r=m.alternate,r!==null&&kl(r)===null&&(M=m),m=m.sibling;m=M,m===null?(M=u.child,u.child=null):(M=m.sibling,m.sibling=null),Wd(u,!1,M,m,O);break;case"backwards":for(m=null,M=u.child,u.child=null;M!==null;){if(r=M.alternate,r!==null&&kl(r)===null){u.child=M;break}r=M.sibling,M.sibling=m,m=M,M=r}Wd(u,!0,m,null,O);break;case"together":Wd(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function jl(r,u,m){if(r!==null&&(u.dependencies=r.dependencies),Os|=u.lanes,!(m&u.childLanes))if(r!==null){if(Ra(r,u,m,!1),(m&u.childLanes)===0)return null}else return null;if(r!==null&&u.child!==r.child)throw Error(h(153));if(u.child!==null){for(r=u.child,m=Nu(r,r.pendingProps),u.child=m,m.return=u;r.sibling!==null;)r=r.sibling,m=m.sibling=Nu(r,r.pendingProps),m.return=u;m.sibling=null}return u.child}function cy(r,u){return r.lanes&u?!0:(r=r.dependencies,!!(r!==null&&_p(r)))}function Dv(r,u,m){switch(u.tag){case 3:Jn(u,u.stateNode.containerInfo),Fl(u,Xi,r.memoizedState.cache),el();break;case 27:case 5:kr(u);break;case 4:Jn(u,u.stateNode.containerInfo);break;case 10:Fl(u,u.type,u.memoizedProps.value);break;case 13:var x=u.memoizedState;if(x!==null)return x.dehydrated!==null?(ya(u),u.flags|=128,null):m&u.child.childLanes?oy(r,u,m):(ya(u),r=jl(r,u,m),r!==null?r.sibling:null);ya(u);break;case 19:var M=(r.flags&128)!==0;if(x=(m&u.childLanes)!==0,x||(Ra(r,u,m,!1),x=(m&u.childLanes)!==0),M){if(x)return ly(r,u,m);u.flags|=128}if(M=u.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),Un(Pr,Pr.current),x)break;return null;case 22:case 23:return u.lanes=0,pp(r,u,m);case 24:Fl(u,Xi,r.memoizedState.cache)}return jl(r,u,m)}function uy(r,u,m){if(r!==null)if(r.memoizedProps!==u.pendingProps)zr=!0;else{if(!cy(r,m)&&!(u.flags&128))return zr=!1,Dv(r,u,m);zr=!!(r.flags&131072)}else zr=!1,Bn&&u.flags&1048576&&mu(u,bc,u.index);switch(u.lanes=0,u.tag){case 16:e:{r=u.pendingProps;var x=u.elementType,M=x._init;if(x=M(x._payload),u.type=x,typeof x=="function")_y(x)?(r=cs(x,r),u.tag=1,u=Xd(null,u,x,r,m)):(u.tag=0,u=Rh(null,u,x,r,m));else{if(x!=null){if(M=x.$$typeof,M===$){u.tag=11,u=Ll(null,u,x,r,m);break e}else if(M===fe){u.tag=14,u=Bl(null,u,x,r,m);break e}}throw u=je(x)||x,Error(h(306,u,""))}}return u;case 0:return Rh(r,u,u.type,u.pendingProps,m);case 1:return x=u.type,M=cs(x,u.pendingProps),Xd(r,u,x,M,m);case 3:e:{if(Jn(u,u.stateNode.containerInfo),r===null)throw Error(h(387));var O=u.pendingProps;M=u.memoizedState,x=M.element,dy(r,u),xp(u,O,null,m);var Q=u.memoizedState;if(O=Q.cache,Fl(u,Xi,O),O!==M.cache&&Ph(u,[Xi],m,!0),bp(),O=Q.element,M.isDehydrated)if(M={element:O,isDehydrated:!1,cache:Q.cache},u.updateQueue.baseState=M,u.memoizedState=M,u.flags&256){u=Pm(r,u,O,m);break e}else if(O!==x){x=Aa(Error(h(424)),u),gu(x),u=Pm(r,u,O,m);break e}else for(Rn=fs(u.stateNode.containerInfo.firstChild),ea=u,Bn=!0,fr=null,Lo=!0,m=jo(u,null,O,m),u.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(el(),O===x){u=jl(r,u,m);break e}ia(r,u,O,m)}u=u.child}return u;case 26:return Rc(r,u),r===null?(m=g0(u.type,null,u.pendingProps,null))?u.memoizedState=m:Bn||(m=u.type,r=u.pendingProps,x=Vp(Ni.current).createElement(m),x[Nt]=u,x[$n]=r,Pa(x,m,r),Zr(x),u.stateNode=x):u.memoizedState=g0(u.type,r.memoizedProps,u.pendingProps,r.memoizedState),null;case 27:return kr(u),r===null&&Bn&&(x=u.stateNode=Py(u.type,u.pendingProps,Ni.current),ea=u,Lo=!0,Rn=fs(x.firstChild)),x=u.pendingProps.children,r!==null||Bn?ia(r,u,x,m):u.child=Bo(u,null,x,m),Rc(r,u),u.child;case 5:return r===null&&Bn&&((M=x=Rn)&&(x=u0(x,u.type,u.pendingProps,Lo),x!==null?(u.stateNode=x,ea=u,Rn=fs(x.firstChild),Lo=!1,M=!0):M=!1),M||Ml(u)),kr(u),M=u.type,O=u.pendingProps,Q=r!==null?r.memoizedProps:null,x=O.children,_f(M,O)?x=null:Q!==null&&_f(M,Q)&&(u.flags|=32),u.memoizedState!==null&&(M=Zd(r,u,Ch,null,null,m),qe._currentValue=M),Rc(r,u),ia(r,u,x,m),u.child;case 6:return r===null&&Bn&&((r=m=Rn)&&(m=h0(m,u.pendingProps,Lo),m!==null?(u.stateNode=m,ea=u,Rn=null,r=!0):r=!1),r||Ml(u)),null;case 13:return oy(r,u,m);case 4:return Jn(u,u.stateNode.containerInfo),x=u.pendingProps,r===null?u.child=Bo(u,null,x,m):ia(r,u,x,m),u.child;case 11:return Ll(r,u,u.type,u.pendingProps,m);case 7:return ia(r,u,u.pendingProps,m),u.child;case 8:return ia(r,u,u.pendingProps.children,m),u.child;case 12:return ia(r,u,u.pendingProps.children,m),u.child;case 10:return x=u.pendingProps,Fl(u,u.type,x.value),ia(r,u,x.children,m),u.child;case 9:return M=u.type._context,x=u.pendingProps.children,Pc(u),M=Za(M),x=x(M),u.flags|=1,ia(r,u,x,m),u.child;case 14:return Bl(r,u,u.type,u.pendingProps,m);case 15:return ll(r,u,u.type,u.pendingProps,m);case 19:return ly(r,u,m);case 22:return pp(r,u,m);case 24:return Pc(u),x=Za(Xi),r===null?(M=os(),M===null&&(M=Ji,O=Ud(),M.pooledCache=O,O.refCount++,O!==null&&(M.pooledCacheLanes|=m),M=O),u.memoizedState={parent:x,cache:M},hy(u),Fl(u,Xi,M)):(r.lanes&m&&(dy(r,u),xp(u,null,null,m),bp()),M=r.memoizedState,O=u.memoizedState,M.parent!==x?(M={parent:x,cache:x},u.memoizedState=M,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=M),Fl(u,Xi,x)):(x=O.cache,Fl(u,Xi,x),x!==M.cache&&Ph(u,[Xi],m,!0))),ia(r,u,u.pendingProps.children,m),u.child;case 29:throw u.pendingProps}throw Error(h(156,u.tag))}var Om=dn(null),Au=null,Nc=null;function Fl(r,u,m){Un(Om,u._currentValue),u._currentValue=m}function Ul(r){r._currentValue=Om.current,An(Om)}function yp(r,u,m){for(;r!==null;){var x=r.alternate;if((r.childLanes&u)!==u?(r.childLanes|=u,x!==null&&(x.childLanes|=u)):x!==null&&(x.childLanes&u)!==u&&(x.childLanes|=u),r===m)break;r=r.return}}function Ph(r,u,m,x){var M=r.child;for(M!==null&&(M.return=r);M!==null;){var O=M.dependencies;if(O!==null){var Q=M.child;O=O.firstContext;e:for(;O!==null;){var le=O;O=M;for(var Ae=0;Ae<u.length;Ae++)if(le.context===u[Ae]){O.lanes|=m,le=O.alternate,le!==null&&(le.lanes|=m),yp(O.return,m,r),x||(Q=null);break e}O=le.next}}else if(M.tag===18){if(Q=M.return,Q===null)throw Error(h(341));Q.lanes|=m,O=Q.alternate,O!==null&&(O.lanes|=m),yp(Q,m,r),Q=null}else Q=M.child;if(Q!==null)Q.return=M;else for(Q=M;Q!==null;){if(Q===r){Q=null;break}if(M=Q.sibling,M!==null){M.return=Q.return,Q=M;break}Q=Q.return}M=Q}}function Ra(r,u,m,x){r=null;for(var M=u,O=!1;M!==null;){if(!O){if(M.flags&524288)O=!0;else if(M.flags&262144)break}if(M.tag===10){var Q=M.alternate;if(Q===null)throw Error(h(387));if(Q=Q.memoizedProps,Q!==null){var le=M.type;ao(M.pendingProps.value,Q.value)||(r!==null?r.push(le):r=[le])}}else if(M===ci.current){if(Q=M.alternate,Q===null)throw Error(h(387));Q.memoizedState.memoizedState!==M.memoizedState.memoizedState&&(r!==null?r.push(qe):r=[qe])}M=M.return}r!==null&&Ph(u,r,m,x),u.flags|=262144}function _p(r){for(r=r.firstContext;r!==null;){if(!ao(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Pc(r){Au=r,Nc=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Za(r){return L_(Au,r)}function vp(r,u){return Au===null&&Pc(r),L_(r,u)}function L_(r,u){var m=u._currentValue;if(u={context:u,memoizedValue:m,next:null},Nc===null){if(r===null)throw Error(h(308));Nc=u,r.dependencies={lanes:0,firstContext:u},r.flags|=524288}else Nc=Nc.next=u;return m}var Cu=!1;function hy(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function dy(r,u){r=r.updateQueue,u.updateQueue===r&&(u.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Vl(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Gl(r,u,m){var x=r.updateQueue;if(x===null)return null;if(x=x.shared,_r&2){var M=x.pending;return M===null?u.next=u:(u.next=M.next,M.next=u),x.pending=u,u=Ws(r),xh(r,null,m),u}return zd(r,x,u,m),Ws(r)}function Qd(r,u,m){if(u=u.updateQueue,u!==null&&(u=u.shared,(m&4194176)!==0)){var x=u.lanes;x&=r.pendingLanes,m|=x,u.lanes=m,Pt(r,m)}}function zc(r,u){var m=r.updateQueue,x=r.alternate;if(x!==null&&(x=x.updateQueue,m===x)){var M=null,O=null;if(m=m.firstBaseUpdate,m!==null){do{var Q={lane:m.lane,tag:m.tag,payload:m.payload,callback:null,next:null};O===null?M=O=Q:O=O.next=Q,m=m.next}while(m!==null);O===null?M=O=u:O=O.next=u}else M=O=u;m={baseState:x.baseState,firstBaseUpdate:M,lastBaseUpdate:O,shared:x.shared,callbacks:x.callbacks},r.updateQueue=m;return}r=m.lastBaseUpdate,r===null?m.firstBaseUpdate=u:r.next=u,m.lastBaseUpdate=u}var zh=!1;function bp(){if(zh){var r=al;if(r!==null)throw r}}function xp(r,u,m,x){zh=!1;var M=r.updateQueue;Cu=!1;var O=M.firstBaseUpdate,Q=M.lastBaseUpdate,le=M.shared.pending;if(le!==null){M.shared.pending=null;var Ae=le,Ze=Ae.next;Ae.next=null,Q===null?O=Ze:Q.next=Ze,Q=Ae;var pt=r.alternate;pt!==null&&(pt=pt.updateQueue,le=pt.lastBaseUpdate,le!==Q&&(le===null?pt.firstBaseUpdate=Ze:le.next=Ze,pt.lastBaseUpdate=Ae))}if(O!==null){var At=M.baseState;Q=0,pt=Ze=Ae=null,le=O;do{var it=le.lane&-536870913,ft=it!==le.lane;if(ft?(si&it)===it:(x&it)===it){it!==0&&it===rl&&(zh=!0),pt!==null&&(pt=pt.next={lane:0,tag:le.tag,payload:le.payload,callback:null,next:null});e:{var ln=r,In=le;it=u;var Ur=m;switch(In.tag){case 1:if(ln=In.payload,typeof ln=="function"){At=ln.call(Ur,At,it);break e}At=ln;break e;case 3:ln.flags=ln.flags&-65537|128;case 0:if(ln=In.payload,it=typeof ln=="function"?ln.call(Ur,At,it):ln,it==null)break e;At=Qe({},At,it);break e;case 2:Cu=!0}}it=le.callback,it!==null&&(r.flags|=64,ft&&(r.flags|=8192),ft=M.callbacks,ft===null?M.callbacks=[it]:ft.push(it))}else ft={lane:it,tag:le.tag,payload:le.payload,callback:le.callback,next:null},pt===null?(Ze=pt=ft,Ae=At):pt=pt.next=ft,Q|=it;if(le=le.next,le===null){if(le=M.shared.pending,le===null)break;ft=le,le=ft.next,ft.next=null,M.lastBaseUpdate=ft,M.shared.pending=null}}while(!0);pt===null&&(Ae=At),M.baseState=Ae,M.firstBaseUpdate=Ze,M.lastBaseUpdate=pt,O===null&&(M.shared.lanes=0),Os|=Q,r.lanes=Q,r.memoizedState=At}}function B_(r,u){if(typeof r!="function")throw Error(h(191,r));r.call(u)}function j_(r,u){var m=r.callbacks;if(m!==null)for(r.callbacks=null,r=0;r<m.length;r++)B_(m[r],u)}function wp(r,u){try{var m=u.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var M=x.next;m=M;do{if((m.tag&r)===r){x=void 0;var O=m.create,Q=m.inst;x=O(),Q.destroy=x}m=m.next}while(m!==M)}}catch(le){Zi(u,u.return,le)}}function Mu(r,u,m){try{var x=u.updateQueue,M=x!==null?x.lastEffect:null;if(M!==null){var O=M.next;x=O;do{if((x.tag&r)===r){var Q=x.inst,le=Q.destroy;if(le!==void 0){Q.destroy=void 0,M=u;var Ae=m;try{le()}catch(Ze){Zi(M,Ae,Ze)}}}x=x.next}while(x!==O)}}catch(Ze){Zi(u,u.return,Ze)}}function F_(r){var u=r.updateQueue;if(u!==null){var m=r.stateNode;try{j_(u,m)}catch(x){Zi(r,r.return,x)}}}function Lm(r,u,m){m.props=cs(r.type,r.memoizedProps),m.state=r.memoizedState;try{m.componentWillUnmount()}catch(x){Zi(r,u,x)}}function Oh(r,u){try{var m=r.ref;if(m!==null){var x=r.stateNode;switch(r.tag){case 26:case 27:case 5:var M=x;break;default:M=x}typeof m=="function"?r.refCleanup=m(M):m.current=M}}catch(O){Zi(r,u,O)}}function Go(r,u){var m=r.ref,x=r.refCleanup;if(m!==null)if(typeof x=="function")try{x()}catch(M){Zi(r,u,M)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof m=="function")try{m(null)}catch(M){Zi(r,u,M)}else m.current=null}function Kd(r){var u=r.type,m=r.memoizedProps,x=r.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":m.autoFocus&&x.focus();break e;case"img":m.src?x.src=m.src:m.srcSet&&(x.srcset=m.srcSet)}}catch(M){Zi(r,r.return,M)}}function U_(r,u,m){try{var x=r.stateNode;Lv(x,r.type,m,u),x[$n]=u}catch(M){Zi(r,r.return,M)}}function gr(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27||r.tag===4}function Du(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||gr(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==27&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Bm(r,u,m){var x=r.tag;if(x===5||x===6)r=r.stateNode,u?m.nodeType===8?m.parentNode.insertBefore(r,u):m.insertBefore(r,u):(m.nodeType===8?(u=m.parentNode,u.insertBefore(r,m)):(u=m,u.appendChild(r)),m=m._reactRootContainer,m!=null||u.onclick!==null||(u.onclick=Up));else if(x!==4&&x!==27&&(r=r.child,r!==null))for(Bm(r,u,m),r=r.sibling;r!==null;)Bm(r,u,m),r=r.sibling}function Lh(r,u,m){var x=r.tag;if(x===5||x===6)r=r.stateNode,u?m.insertBefore(r,u):m.appendChild(r);else if(x!==4&&x!==27&&(r=r.child,r!==null))for(Lh(r,u,m),r=r.sibling;r!==null;)Lh(r,u,m),r=r.sibling}var Ns=!1,Ki=!1,jm=!1,fy=typeof WeakSet=="function"?WeakSet:Set,Or=null,Fm=!1;function Jd(r,u){if(r=r.containerInfo,ag=Zt,r=gh(r),hu(r)){if("selectionStart"in r)var m={start:r.selectionStart,end:r.selectionEnd};else e:{m=(m=r.ownerDocument)&&m.defaultView||window;var x=m.getSelection&&m.getSelection();if(x&&x.rangeCount!==0){m=x.anchorNode;var M=x.anchorOffset,O=x.focusNode;x=x.focusOffset;try{m.nodeType,O.nodeType}catch{m=null;break e}var Q=0,le=-1,Ae=-1,Ze=0,pt=0,At=r,it=null;t:for(;;){for(var ft;At!==m||M!==0&&At.nodeType!==3||(le=Q+M),At!==O||x!==0&&At.nodeType!==3||(Ae=Q+x),At.nodeType===3&&(Q+=At.nodeValue.length),(ft=At.firstChild)!==null;)it=At,At=ft;for(;;){if(At===r)break t;if(it===m&&++Ze===M&&(le=Q),it===O&&++pt===x&&(Ae=Q),(ft=At.nextSibling)!==null)break;At=it,it=At.parentNode}At=ft}m=le===-1||Ae===-1?null:{start:le,end:Ae}}else m=null}m=m||{start:0,end:0}}else m=null;for(Hh={focusedElem:r,selectionRange:m},Zt=!1,Or=u;Or!==null;)if(u=Or,r=u.child,(u.subtreeFlags&1028)!==0&&r!==null)r.return=u,Or=r;else for(;Or!==null;){switch(u=Or,O=u.alternate,r=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if(r&1024&&O!==null){r=void 0,m=u,M=O.memoizedProps,O=O.memoizedState,x=m.stateNode;try{var ln=cs(m.type,M,m.elementType===m.type);r=x.getSnapshotBeforeUpdate(ln,O),x.__reactInternalSnapshotBeforeUpdate=r}catch(In){Zi(m,m.return,In)}}break;case 3:if(r&1024){if(r=u.stateNode.containerInfo,m=r.nodeType,m===9)Zp(r);else if(m===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Zp(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if(r&1024)throw Error(h(163))}if(r=u.sibling,r!==null){r.return=u.return,Or=r;break}Or=u.return}return ln=Fm,Fm=!1,ln}function Tp(r,u,m){var x=m.flags;switch(m.tag){case 0:case 11:case 15:Oc(r,m),x&4&&wp(5,m);break;case 1:if(Oc(r,m),x&4)if(r=m.stateNode,u===null)try{r.componentDidMount()}catch(le){Zi(m,m.return,le)}else{var M=cs(m.type,u.memoizedProps);u=u.memoizedState;try{r.componentDidUpdate(M,u,r.__reactInternalSnapshotBeforeUpdate)}catch(le){Zi(m,m.return,le)}}x&64&&F_(m),x&512&&Oh(m,m.return);break;case 3:if(Oc(r,m),x&64&&(x=m.updateQueue,x!==null)){if(r=null,m.child!==null)switch(m.child.tag){case 27:case 5:r=m.child.stateNode;break;case 1:r=m.child.stateNode}try{j_(x,r)}catch(le){Zi(m,m.return,le)}}break;case 26:Oc(r,m),x&512&&Oh(m,m.return);break;case 27:case 5:Oc(r,m),u===null&&x&4&&Kd(m),x&512&&Oh(m,m.return);break;case 12:Oc(r,m);break;case 13:Oc(r,m),x&4&&V_(r,m);break;case 22:if(M=m.memoizedState!==null||Ns,!M){u=u!==null&&u.memoizedState!==null||Ki;var O=Ns,Q=Ki;Ns=M,(Ki=u)&&!Q?ku(r,m,(m.subtreeFlags&8772)!==0):Oc(r,m),Ns=O,Ki=Q}x&512&&(m.memoizedProps.mode==="manual"?Oh(m,m.return):Go(m,m.return));break;default:Oc(r,m)}}function Bh(r){var u=r.alternate;u!==null&&(r.alternate=null,Bh(u)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(u=r.stateNode,u!==null&&oc(u)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var yr=null,us=!1;function Zl(r,u,m){for(m=m.child;m!==null;)Iu(r,u,m),m=m.sibling}function Iu(r,u,m){if(Rr&&typeof Rr.onCommitFiberUnmount=="function")try{Rr.onCommitFiberUnmount(Zs,m)}catch{}switch(m.tag){case 26:Ki||Go(m,u),Zl(r,u,m),m.memoizedState?m.memoizedState.count--:m.stateNode&&(m=m.stateNode,m.parentNode.removeChild(m));break;case 27:Ki||Go(m,u);var x=yr,M=us;for(yr=m.stateNode,Zl(r,u,m),m=m.stateNode,u=m.attributes;u.length;)m.removeAttributeNode(u[0]);oc(m),yr=x,us=M;break;case 5:Ki||Go(m,u);case 6:M=yr;var O=us;if(yr=null,Zl(r,u,m),yr=M,us=O,yr!==null)if(us)try{r=yr,x=m.stateNode,r.nodeType===8?r.parentNode.removeChild(x):r.removeChild(x)}catch(Q){Zi(m,u,Q)}else try{yr.removeChild(m.stateNode)}catch(Q){Zi(m,u,Q)}break;case 18:yr!==null&&(us?(u=yr,m=m.stateNode,u.nodeType===8?Wl(u.parentNode,m):u.nodeType===1&&Wl(u,m),mo(u)):Wl(yr,m.stateNode));break;case 4:x=yr,M=us,yr=m.stateNode.containerInfo,us=!0,Zl(r,u,m),yr=x,us=M;break;case 0:case 11:case 14:case 15:Ki||Mu(2,m,u),Ki||Mu(4,m,u),Zl(r,u,m);break;case 1:Ki||(Go(m,u),x=m.stateNode,typeof x.componentWillUnmount=="function"&&Lm(m,u,x)),Zl(r,u,m);break;case 21:Zl(r,u,m);break;case 22:Ki||Go(m,u),Ki=(x=Ki)||m.memoizedState!==null,Zl(r,u,m),Ki=x;break;default:Zl(r,u,m)}}function V_(r,u){if(u.memoizedState===null&&(r=u.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{mo(r)}catch(m){Zi(u,u.return,m)}}function G_(r){switch(r.tag){case 13:case 19:var u=r.stateNode;return u===null&&(u=r.stateNode=new fy),u;case 22:return r=r.stateNode,u=r._retryCache,u===null&&(u=r._retryCache=new fy),u;default:throw Error(h(435,r.tag))}}function jh(r,u){var m=G_(r);u.forEach(function(x){var M=Ay.bind(null,r,x);m.has(x)||(m.add(x),x.then(M,M))})}function Zo(r,u){var m=u.deletions;if(m!==null)for(var x=0;x<m.length;x++){var M=m[x],O=r,Q=u,le=Q;e:for(;le!==null;){switch(le.tag){case 27:case 5:yr=le.stateNode,us=!1;break e;case 3:yr=le.stateNode.containerInfo,us=!0;break e;case 4:yr=le.stateNode.containerInfo,us=!0;break e}le=le.return}if(yr===null)throw Error(h(160));Iu(O,Q,M),yr=null,us=!1,O=M.alternate,O!==null&&(O.return=null),M.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)py(u,r),u=u.sibling}var Ps=null;function py(r,u){var m=r.alternate,x=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:Zo(u,r),zs(r),x&4&&(Mu(3,r,r.return),wp(3,r),Mu(5,r,r.return));break;case 1:Zo(u,r),zs(r),x&512&&(Ki||m===null||Go(m,m.return)),x&64&&Ns&&(r=r.updateQueue,r!==null&&(x=r.callbacks,x!==null&&(m=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=m===null?x:m.concat(x))));break;case 26:var M=Ps;if(Zo(u,r),zs(r),x&512&&(Ki||m===null||Go(m,m.return)),x&4){var O=m!==null?m.memoizedState:null;if(x=r.memoizedState,m===null)if(x===null)if(r.stateNode===null){e:{x=r.type,m=r.memoizedProps,M=M.ownerDocument||M;t:switch(x){case"title":O=M.getElementsByTagName("title")[0],(!O||O[wi]||O[Nt]||O.namespaceURI==="http://www.w3.org/2000/svg"||O.hasAttribute("itemprop"))&&(O=M.createElement(x),M.head.insertBefore(O,M.querySelector("head > title"))),Pa(O,x,m),O[Nt]=r,Zr(O),x=O;break e;case"link":var Q=G("link","href",M).get(x+(m.href||""));if(Q){for(var le=0;le<Q.length;le++)if(O=Q[le],O.getAttribute("href")===(m.href==null?null:m.href)&&O.getAttribute("rel")===(m.rel==null?null:m.rel)&&O.getAttribute("title")===(m.title==null?null:m.title)&&O.getAttribute("crossorigin")===(m.crossOrigin==null?null:m.crossOrigin)){Q.splice(le,1);break t}}O=M.createElement(x),Pa(O,x,m),M.head.appendChild(O);break;case"meta":if(Q=G("meta","content",M).get(x+(m.content||""))){for(le=0;le<Q.length;le++)if(O=Q[le],O.getAttribute("content")===(m.content==null?null:""+m.content)&&O.getAttribute("name")===(m.name==null?null:m.name)&&O.getAttribute("property")===(m.property==null?null:m.property)&&O.getAttribute("http-equiv")===(m.httpEquiv==null?null:m.httpEquiv)&&O.getAttribute("charset")===(m.charSet==null?null:m.charSet)){Q.splice(le,1);break t}}O=M.createElement(x),Pa(O,x,m),M.head.appendChild(O);break;default:throw Error(h(468,x))}O[Nt]=r,Zr(O),x=O}r.stateNode=x}else q(M,r.type,r.stateNode);else r.stateNode=E(M,x,r.memoizedProps);else O!==x?(O===null?m.stateNode!==null&&(m=m.stateNode,m.parentNode.removeChild(m)):O.count--,x===null?q(M,r.type,r.stateNode):E(M,x,r.memoizedProps)):x===null&&r.stateNode!==null&&U_(r,r.memoizedProps,m.memoizedProps)}break;case 27:if(x&4&&r.alternate===null){M=r.stateNode,O=r.memoizedProps;try{for(var Ae=M.firstChild;Ae;){var Ze=Ae.nextSibling,pt=Ae.nodeName;Ae[wi]||pt==="HEAD"||pt==="BODY"||pt==="SCRIPT"||pt==="STYLE"||pt==="LINK"&&Ae.rel.toLowerCase()==="stylesheet"||M.removeChild(Ae),Ae=Ze}for(var At=r.type,it=M.attributes;it.length;)M.removeAttributeNode(it[0]);Pa(M,At,O),M[Nt]=r,M[$n]=O}catch(ln){Zi(r,r.return,ln)}}case 5:if(Zo(u,r),zs(r),x&512&&(Ki||m===null||Go(m,m.return)),r.flags&32){M=r.stateNode;try{qi(M,"")}catch(ln){Zi(r,r.return,ln)}}x&4&&r.stateNode!=null&&(M=r.memoizedProps,U_(r,M,m!==null?m.memoizedProps:M)),x&1024&&(jm=!0);break;case 6:if(Zo(u,r),zs(r),x&4){if(r.stateNode===null)throw Error(h(162));x=r.memoizedProps,m=r.stateNode;try{m.nodeValue=x}catch(ln){Zi(r,r.return,ln)}}break;case 3:if(U=null,M=Ps,Ps=$p(u.containerInfo),Zo(u,r),Ps=M,zs(r),x&4&&m!==null&&m.memoizedState.isDehydrated)try{mo(u.containerInfo)}catch(ln){Zi(r,r.return,ln)}jm&&(jm=!1,Z_(r));break;case 4:x=Ps,Ps=$p(r.stateNode.containerInfo),Zo(u,r),zs(r),Ps=x;break;case 12:Zo(u,r),zs(r);break;case 13:Zo(u,r),zs(r),r.child.flags&8192&&r.memoizedState!==null!=(m!==null&&m.memoizedState!==null)&&(Dp=Wr()),x&4&&(x=r.updateQueue,x!==null&&(r.updateQueue=null,jh(r,x)));break;case 22:if(x&512&&(Ki||m===null||Go(m,m.return)),Ae=r.memoizedState!==null,Ze=m!==null&&m.memoizedState!==null,pt=Ns,At=Ki,Ns=pt||Ae,Ki=At||Ze,Zo(u,r),Ki=At,Ns=pt,zs(r),u=r.stateNode,u._current=r,u._visibility&=-3,u._visibility|=u._pendingVisibility&2,x&8192&&(u._visibility=Ae?u._visibility&-2:u._visibility|1,Ae&&(u=Ns||Ki,m===null||Ze||u||ef(r)),r.memoizedProps===null||r.memoizedProps.mode!=="manual"))e:for(m=null,u=r;;){if(u.tag===5||u.tag===26||u.tag===27){if(m===null){Ze=m=u;try{if(M=Ze.stateNode,Ae)O=M.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{Q=Ze.stateNode,le=Ze.memoizedProps.style;var ft=le!=null&&le.hasOwnProperty("display")?le.display:null;Q.style.display=ft==null||typeof ft=="boolean"?"":(""+ft).trim()}}catch(ln){Zi(Ze,Ze.return,ln)}}}else if(u.tag===6){if(m===null){Ze=u;try{Ze.stateNode.nodeValue=Ae?"":Ze.memoizedProps}catch(ln){Zi(Ze,Ze.return,ln)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===r)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break e;for(;u.sibling===null;){if(u.return===null||u.return===r)break e;m===u&&(m=null),u=u.return}m===u&&(m=null),u.sibling.return=u.return,u=u.sibling}x&4&&(x=r.updateQueue,x!==null&&(m=x.retryQueue,m!==null&&(x.retryQueue=null,jh(r,m))));break;case 19:Zo(u,r),zs(r),x&4&&(x=r.updateQueue,x!==null&&(r.updateQueue=null,jh(r,x)));break;case 21:break;default:Zo(u,r),zs(r)}}function zs(r){var u=r.flags;if(u&2){try{if(r.tag!==27){e:{for(var m=r.return;m!==null;){if(gr(m)){var x=m;break e}m=m.return}throw Error(h(160))}switch(x.tag){case 27:var M=x.stateNode,O=Du(r);Lh(r,O,M);break;case 5:var Q=x.stateNode;x.flags&32&&(qi(Q,""),x.flags&=-33);var le=Du(r);Lh(r,le,Q);break;case 3:case 4:var Ae=x.stateNode.containerInfo,Ze=Du(r);Bm(r,Ze,Ae);break;default:throw Error(h(161))}}}catch(pt){Zi(r,r.return,pt)}r.flags&=-3}u&4096&&(r.flags&=-4097)}function Z_(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var u=r;Z_(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),r=r.sibling}}function Oc(r,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Tp(r,u.alternate,u),u=u.sibling}function ef(r){for(r=r.child;r!==null;){var u=r;switch(u.tag){case 0:case 11:case 14:case 15:Mu(4,u,u.return),ef(u);break;case 1:Go(u,u.return);var m=u.stateNode;typeof m.componentWillUnmount=="function"&&Lm(u,u.return,m),ef(u);break;case 26:case 27:case 5:Go(u,u.return),ef(u);break;case 22:Go(u,u.return),u.memoizedState===null&&ef(u);break;default:ef(u)}r=r.sibling}}function ku(r,u,m){for(m=m&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var x=u.alternate,M=r,O=u,Q=O.flags;switch(O.tag){case 0:case 11:case 15:ku(M,O,m),wp(4,O);break;case 1:if(ku(M,O,m),x=O,M=x.stateNode,typeof M.componentDidMount=="function")try{M.componentDidMount()}catch(Ze){Zi(x,x.return,Ze)}if(x=O,M=x.updateQueue,M!==null){var le=x.stateNode;try{var Ae=M.shared.hiddenCallbacks;if(Ae!==null)for(M.shared.hiddenCallbacks=null,M=0;M<Ae.length;M++)B_(Ae[M],le)}catch(Ze){Zi(x,x.return,Ze)}}m&&Q&64&&F_(O),Oh(O,O.return);break;case 26:case 27:case 5:ku(M,O,m),m&&x===null&&Q&4&&Kd(O),Oh(O,O.return);break;case 12:ku(M,O,m);break;case 13:ku(M,O,m),m&&Q&4&&V_(M,O);break;case 22:O.memoizedState===null&&ku(M,O,m),Oh(O,O.return);break;default:ku(M,O,m)}u=u.sibling}}function Ep(r,u){var m=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(m=r.memoizedState.cachePool.pool),r=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(r=u.memoizedState.cachePool.pool),r!==m&&(r!=null&&r.refCount++,m!=null&&Nl(m))}function Um(r,u){r=null,u.alternate!==null&&(r=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==r&&(u.refCount++,r!=null&&Nl(r))}function $l(r,u,m,x){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)my(r,u,m,x),u=u.sibling}function my(r,u,m,x){var M=u.flags;switch(u.tag){case 0:case 11:case 15:$l(r,u,m,x),M&2048&&wp(9,u);break;case 3:$l(r,u,m,x),M&2048&&(r=null,u.alternate!==null&&(r=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==r&&(u.refCount++,r!=null&&Nl(r)));break;case 12:if(M&2048){$l(r,u,m,x),r=u.stateNode;try{var O=u.memoizedProps,Q=O.id,le=O.onPostCommit;typeof le=="function"&&le(Q,u.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(Ae){Zi(u,u.return,Ae)}}else $l(r,u,m,x);break;case 23:break;case 22:O=u.stateNode,u.memoizedState!==null?O._visibility&4?$l(r,u,m,x):tf(r,u):O._visibility&4?$l(r,u,m,x):(O._visibility|=4,Ru(r,u,m,x,(u.subtreeFlags&10256)!==0)),M&2048&&Ep(u.alternate,u);break;case 24:$l(r,u,m,x),M&2048&&Um(u.alternate,u);break;default:$l(r,u,m,x)}}function Ru(r,u,m,x,M){for(M=M&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var O=r,Q=u,le=m,Ae=x,Ze=Q.flags;switch(Q.tag){case 0:case 11:case 15:Ru(O,Q,le,Ae,M),wp(8,Q);break;case 23:break;case 22:var pt=Q.stateNode;Q.memoizedState!==null?pt._visibility&4?Ru(O,Q,le,Ae,M):tf(O,Q):(pt._visibility|=4,Ru(O,Q,le,Ae,M)),M&&Ze&2048&&Ep(Q.alternate,Q);break;case 24:Ru(O,Q,le,Ae,M),M&&Ze&2048&&Um(Q.alternate,Q);break;default:Ru(O,Q,le,Ae,M)}u=u.sibling}}function tf(r,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var m=r,x=u,M=x.flags;switch(x.tag){case 22:tf(m,x),M&2048&&Ep(x.alternate,x);break;case 24:tf(m,x),M&2048&&Um(x.alternate,x);break;default:tf(m,x)}u=u.sibling}}var nf=8192;function Lc(r){if(r.subtreeFlags&nf)for(r=r.child;r!==null;)gy(r),r=r.sibling}function gy(r){switch(r.tag){case 26:Lc(r),r.flags&nf&&r.memoizedState!==null&&_e(Ps,r.memoizedState,r.memoizedProps);break;case 5:Lc(r);break;case 3:case 4:var u=Ps;Ps=$p(r.stateNode.containerInfo),Lc(r),Ps=u;break;case 22:r.memoizedState===null&&(u=r.alternate,u!==null&&u.memoizedState!==null?(u=nf,nf=16777216,Lc(r),nf=u):Lc(r));break;default:Lc(r)}}function yy(r){var u=r.alternate;if(u!==null&&(r=u.child,r!==null)){u.child=null;do u=r.sibling,r.sibling=null,r=u;while(r!==null)}}function rf(r){var u=r.deletions;if(r.flags&16){if(u!==null)for(var m=0;m<u.length;m++){var x=u[m];Or=x,Gm(x,r)}yy(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)af(r),r=r.sibling}function af(r){switch(r.tag){case 0:case 11:case 15:rf(r),r.flags&2048&&Mu(9,r,r.return);break;case 3:rf(r);break;case 12:rf(r);break;case 22:var u=r.stateNode;r.memoizedState!==null&&u._visibility&4&&(r.return===null||r.return.tag!==13)?(u._visibility&=-5,Vm(r)):rf(r);break;default:rf(r)}}function Vm(r){var u=r.deletions;if(r.flags&16){if(u!==null)for(var m=0;m<u.length;m++){var x=u[m];Or=x,Gm(x,r)}yy(r)}for(r=r.child;r!==null;){switch(u=r,u.tag){case 0:case 11:case 15:Mu(8,u,u.return),Vm(u);break;case 22:m=u.stateNode,m._visibility&4&&(m._visibility&=-5,Vm(u));break;default:Vm(u)}r=r.sibling}}function Gm(r,u){for(;Or!==null;){var m=Or;switch(m.tag){case 0:case 11:case 15:Mu(8,m,u);break;case 23:case 22:if(m.memoizedState!==null&&m.memoizedState.cachePool!==null){var x=m.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:Nl(m.memoizedState.cache)}if(x=m.child,x!==null)x.return=m,Or=x;else e:for(m=r;Or!==null;){x=Or;var M=x.sibling,O=x.return;if(Bh(x),x===m){Or=null;break e}if(M!==null){M.return=O,Or=M;break e}Or=O}}}function Sp(r,u,m,x){this.tag=r,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $o(r,u,m,x){return new Sp(r,u,m,x)}function _y(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Nu(r,u){var m=r.alternate;return m===null?(m=$o(r.tag,u,r.key,r.mode),m.elementType=r.elementType,m.type=r.type,m.stateNode=r.stateNode,m.alternate=r,r.alternate=m):(m.pendingProps=u,m.type=r.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=r.flags&31457280,m.childLanes=r.childLanes,m.lanes=r.lanes,m.child=r.child,m.memoizedProps=r.memoizedProps,m.memoizedState=r.memoizedState,m.updateQueue=r.updateQueue,u=r.dependencies,m.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},m.sibling=r.sibling,m.index=r.index,m.ref=r.ref,m.refCleanup=r.refCleanup,m}function vy(r,u){r.flags&=31457282;var m=r.alternate;return m===null?(r.childLanes=0,r.lanes=u,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=m.childLanes,r.lanes=m.lanes,r.child=m.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=m.memoizedProps,r.memoizedState=m.memoizedState,r.updateQueue=m.updateQueue,r.type=m.type,u=m.dependencies,r.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),r}function Ap(r,u,m,x,M,O){var Q=0;if(x=r,typeof r=="function")_y(r)&&(Q=1);else if(typeof r=="string")Q=W(r,m,Wn.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case A:return Fh(m.children,M,O,u);case D:Q=8,M|=24;break;case N:return r=$o(12,m,u,M|2),r.elementType=N,r.lanes=O,r;case J:return r=$o(13,m,u,M),r.elementType=J,r.lanes=O,r;case ae:return r=$o(19,m,u,M),r.elementType=ae,r.lanes=O,r;case Ce:return $_(m,M,O,u);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case L:case V:Q=10;break e;case F:Q=9;break e;case $:Q=11;break e;case fe:Q=14;break e;case ve:Q=16,x=null;break e}Q=29,m=Error(h(130,r===null?"null":typeof r,"")),x=null}return u=$o(Q,m,u,M),u.elementType=r,u.type=x,u.lanes=O,u}function Fh(r,u,m,x){return r=$o(7,r,x,u),r.lanes=m,r}function $_(r,u,m,x){r=$o(22,r,x,u),r.elementType=Ce,r.lanes=m;var M={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var O=M._current;if(O===null)throw Error(h(456));if(!(M._pendingVisibility&2)){var Q=is(O,2);Q!==null&&(M._pendingVisibility|=2,ra(Q,O,2))}},attach:function(){var O=M._current;if(O===null)throw Error(h(456));if(M._pendingVisibility&2){var Q=is(O,2);Q!==null&&(M._pendingVisibility&=-3,ra(Q,O,2))}}};return r.stateNode=M,r}function Uh(r,u,m){return r=$o(6,r,null,u),r.lanes=m,r}function Zm(r,u,m){return u=$o(4,r.children!==null?r.children:[],r.key,u),u.lanes=m,u.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},u}function Bc(r){r.flags|=4}function Y_(r,u){if(u.type!=="stylesheet"||u.state.loading&4)r.flags&=-16777217;else if(r.flags|=16777216,!K(u)){if(u=lo.current,u!==null&&((si&4194176)===si?ga!==null:(si&62914560)!==si&&!(si&536870912)||u!==ga))throw _u=Bd,Ld;r.flags|=8192}}function $m(r,u){u!==null&&(r.flags|=4),r.flags&16384&&(u=r.tag!==22?Rt():536870912,r.lanes|=u,er|=u)}function Cp(r,u){if(!Bn)switch(r.tailMode){case"hidden":u=r.tail;for(var m=null;u!==null;)u.alternate!==null&&(m=u),u=u.sibling;m===null?r.tail=null:m.sibling=null;break;case"collapsed":m=r.tail;for(var x=null;m!==null;)m.alternate!==null&&(x=m),m=m.sibling;x===null?u||r.tail===null?r.tail=null:r.tail.sibling=null:x.sibling=null}}function Cr(r){var u=r.alternate!==null&&r.alternate.child===r.child,m=0,x=0;if(u)for(var M=r.child;M!==null;)m|=M.lanes|M.childLanes,x|=M.subtreeFlags&31457280,x|=M.flags&31457280,M.return=r,M=M.sibling;else for(M=r.child;M!==null;)m|=M.lanes|M.childLanes,x|=M.subtreeFlags,x|=M.flags,M.return=r,M=M.sibling;return r.subtreeFlags|=x,r.childLanes=m,u}function Iv(r,u,m){var x=u.pendingProps;switch(wh(u),u.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Cr(u),null;case 1:return Cr(u),null;case 3:return m=u.stateNode,x=null,r!==null&&(x=r.memoizedState.cache),u.memoizedState.cache!==x&&(u.flags|=2048),Ul(Xi),Xr(),m.pendingContext&&(m.context=m.pendingContext,m.pendingContext=null),(r===null||r.child===null)&&(Dl(u)?Bc(u):r===null||r.memoizedState.isDehydrated&&!(u.flags&256)||(u.flags|=1024,fr!==null&&(hf(fr),fr=null))),Cr(u),null;case 26:return m=u.memoizedState,r===null?(Bc(u),m!==null?(Cr(u),Y_(u,m)):(Cr(u),u.flags&=-16777217)):m?m!==r.memoizedState?(Bc(u),Cr(u),Y_(u,m)):(Cr(u),u.flags&=-16777217):(r.memoizedProps!==x&&Bc(u),Cr(u),u.flags&=-16777217),null;case 27:eo(u),m=Ni.current;var M=u.type;if(r!==null&&u.stateNode!=null)r.memoizedProps!==x&&Bc(u);else{if(!x){if(u.stateNode===null)throw Error(h(166));return Cr(u),null}r=Wn.current,Dl(u)?wc(u):(r=Py(M,x,m),u.stateNode=r,Bc(u))}return Cr(u),null;case 5:if(eo(u),m=u.type,r!==null&&u.stateNode!=null)r.memoizedProps!==x&&Bc(u);else{if(!x){if(u.stateNode===null)throw Error(h(166));return Cr(u),null}if(r=Wn.current,Dl(u))wc(u);else{switch(M=Vp(Ni.current),r){case 1:r=M.createElementNS("http://www.w3.org/2000/svg",m);break;case 2:r=M.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;default:switch(m){case"svg":r=M.createElementNS("http://www.w3.org/2000/svg",m);break;case"math":r=M.createElementNS("http://www.w3.org/1998/Math/MathML",m);break;case"script":r=M.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof x.is=="string"?M.createElement("select",{is:x.is}):M.createElement("select"),x.multiple?r.multiple=!0:x.size&&(r.size=x.size);break;default:r=typeof x.is=="string"?M.createElement(m,{is:x.is}):M.createElement(m)}}r[Nt]=u,r[$n]=x;e:for(M=u.child;M!==null;){if(M.tag===5||M.tag===6)r.appendChild(M.stateNode);else if(M.tag!==4&&M.tag!==27&&M.child!==null){M.child.return=M,M=M.child;continue}if(M===u)break e;for(;M.sibling===null;){if(M.return===null||M.return===u)break e;M=M.return}M.sibling.return=M.return,M=M.sibling}u.stateNode=r;e:switch(Pa(r,m,x),m){case"button":case"input":case"select":case"textarea":r=!!x.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Bc(u)}}return Cr(u),u.flags&=-16777217,null;case 6:if(r&&u.stateNode!=null)r.memoizedProps!==x&&Bc(u);else{if(typeof x!="string"&&u.stateNode===null)throw Error(h(166));if(r=Ni.current,Dl(u)){if(r=u.stateNode,m=u.memoizedProps,x=null,M=ea,M!==null)switch(M.tag){case 27:case 5:x=M.memoizedProps}r[Nt]=u,r=!!(r.nodeValue===m||x!==null&&x.suppressHydrationWarning===!0||Ry(r.nodeValue,m)),r||Ml(u)}else r=Vp(r).createTextNode(x),r[Nt]=u,u.stateNode=r}return Cr(u),null;case 13:if(x=u.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(M=Dl(u),x!==null&&x.dehydrated!==null){if(r===null){if(!M)throw Error(h(318));if(M=u.memoizedState,M=M!==null?M.dehydrated:null,!M)throw Error(h(317));M[Nt]=u}else el(),!(u.flags&128)&&(u.memoizedState=null),u.flags|=4;Cr(u),M=!1}else fr!==null&&(hf(fr),fr=null),M=!0;if(!M)return u.flags&256?(Ca(u),u):(Ca(u),null)}if(Ca(u),u.flags&128)return u.lanes=m,u;if(m=x!==null,r=r!==null&&r.memoizedState!==null,m){x=u.child,M=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(M=x.alternate.memoizedState.cachePool.pool);var O=null;x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(O=x.memoizedState.cachePool.pool),O!==M&&(x.flags|=2048)}return m!==r&&m&&(u.child.flags|=8192),$m(u,u.updateQueue),Cr(u),null;case 4:return Xr(),r===null&&ju(u.stateNode.containerInfo),Cr(u),null;case 10:return Ul(u.type),Cr(u),null;case 19:if(An(Pr),M=u.memoizedState,M===null)return Cr(u),null;if(x=(u.flags&128)!==0,O=M.rendering,O===null)if(x)Cp(M,!1);else{if(Lr!==0||r!==null&&r.flags&128)for(r=u.child;r!==null;){if(O=kl(r),O!==null){for(u.flags|=128,Cp(M,!1),r=O.updateQueue,u.updateQueue=r,$m(u,r),u.subtreeFlags=0,r=m,m=u.child;m!==null;)vy(m,r),m=m.sibling;return Un(Pr,Pr.current&1|2),u.child}r=r.sibling}M.tail!==null&&Wr()>sf&&(u.flags|=128,x=!0,Cp(M,!1),u.lanes=4194304)}else{if(!x)if(r=kl(O),r!==null){if(u.flags|=128,x=!0,r=r.updateQueue,u.updateQueue=r,$m(u,r),Cp(M,!0),M.tail===null&&M.tailMode==="hidden"&&!O.alternate&&!Bn)return Cr(u),null}else 2*Wr()-M.renderingStartTime>sf&&m!==536870912&&(u.flags|=128,x=!0,Cp(M,!1),u.lanes=4194304);M.isBackwards?(O.sibling=u.child,u.child=O):(r=M.last,r!==null?r.sibling=O:u.child=O,M.last=O)}return M.tail!==null?(u=M.tail,M.rendering=u,M.tail=u.sibling,M.renderingStartTime=Wr(),u.sibling=null,r=Pr.current,Un(Pr,x?r&1|2:r&1),u):(Cr(u),null);case 22:case 23:return Ca(u),Sh(),x=u.memoizedState!==null,r!==null?r.memoizedState!==null!==x&&(u.flags|=8192):x&&(u.flags|=8192),x?m&536870912&&!(u.flags&128)&&(Cr(u),u.subtreeFlags&6&&(u.flags|=8192)):Cr(u),m=u.updateQueue,m!==null&&$m(u,m.retryQueue),m=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(m=r.memoizedState.cachePool.pool),x=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(x=u.memoizedState.cachePool.pool),x!==m&&(u.flags|=2048),r!==null&&An(Pl),null;case 24:return m=null,r!==null&&(m=r.memoizedState.cache),u.memoizedState.cache!==m&&(u.flags|=2048),Ul(Xi),Cr(u),null;case 25:return null}throw Error(h(156,u.tag))}function q_(r,u){switch(wh(u),u.tag){case 1:return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 3:return Ul(Xi),Xr(),r=u.flags,r&65536&&!(r&128)?(u.flags=r&-65537|128,u):null;case 26:case 27:case 5:return eo(u),null;case 13:if(Ca(u),r=u.memoizedState,r!==null&&r.dehydrated!==null){if(u.alternate===null)throw Error(h(340));el()}return r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 19:return An(Pr),null;case 4:return Xr(),null;case 10:return Ul(u.type),null;case 22:case 23:return Ca(u),Sh(),r!==null&&An(Pl),r=u.flags,r&65536?(u.flags=r&-65537|128,u):null;case 24:return Ul(Xi),null;case 25:return null;default:return null}}function Ym(r,u){switch(wh(u),u.tag){case 3:Ul(Xi),Xr();break;case 26:case 27:case 5:eo(u);break;case 4:Xr();break;case 13:Ca(u);break;case 19:An(Pr);break;case 10:Ul(u.type);break;case 22:case 23:Ca(u),Sh(),r!==null&&An(Pl);break;case 24:Ul(Xi)}}var H_={getCacheForType:function(r){var u=Za(Xi),m=u.data.get(r);return m===void 0&&(m=r(),u.data.set(r,m)),m}},X_=typeof WeakMap=="function"?WeakMap:Map,_r=0,Ji=null,jn=null,si=0,Gi=0,hs=null,jc=!1,of=!1,qm=!1,Fc=0,Lr=0,Os=0,Pu=0,Mp=0,ds=0,er=0,Vh=null,Yl=null,Hm=!1,Dp=0,sf=1/0,Xm=null,zu=null,Wm=!1,Gh=null,lf=0,Na=0,Ip=null,cf=0,ql=null;function $a(){if(_r&2&&si!==0)return si&-si;if(ye.T!==null){var r=rl;return r!==0?r:Bp()}return Cn()}function uf(){ds===0&&(ds=!(si&536870912)||Bn?Be():536870912);var r=lo.current;return r!==null&&(r.flags|=32),ds}function ra(r,u,m){(r===Ji&&Gi===2||r.cancelPendingCommit!==null)&&(Zh(r,0),Hl(r,si,ds,!1)),tn(r,m),(!(_r&2)||r!==Ji)&&(r===Ji&&(!(_r&2)&&(Pu|=m),Lr===4&&Hl(r,si,ds,!1)),Xl(r))}function kp(r,u,m){if(_r&6)throw Error(h(327));var x=!m&&(u&60)===0&&(u&r.expiredLanes)===0||tt(r,u),M=x?Nv(r,u):Jm(r,u,!0),O=x;do{if(M===0){of&&!x&&Hl(r,u,0,!1);break}else if(M===6)Hl(r,u,0,!jc);else{if(m=r.current.alternate,O&&!kv(m)){M=Jm(r,u,!1),O=!1;continue}if(M===2){if(O=u,r.errorRecoveryDisabledLanes&O)var Q=0;else Q=r.pendingLanes&-536870913,Q=Q!==0?Q:Q&536870912?536870912:0;if(Q!==0){u=Q;e:{var le=r;M=Vh;var Ae=le.current.memoizedState.isDehydrated;if(Ae&&(Zh(le,Q).flags|=256),Q=Jm(le,Q,!1),Q!==2){if(qm&&!Ae){le.errorRecoveryDisabledLanes|=O,Pu|=O,M=4;break e}O=Yl,Yl=M,O!==null&&hf(O)}M=Q}if(O=!1,M!==2)continue}}if(M===1){Zh(r,0),Hl(r,u,0,!0);break}e:{switch(x=r,M){case 0:case 1:throw Error(h(345));case 4:if((u&4194176)===u){Hl(x,u,ds,!jc);break e}break;case 2:Yl=null;break;case 3:case 5:break;default:throw Error(h(329))}if(x.finishedWork=m,x.finishedLanes=u,(u&62914560)===u&&(O=Dp+300-Wr(),10<O)){if(Hl(x,u,ds,!jc),at(x,0)!==0)break e;x.timeoutHandle=l0(W_.bind(null,x,m,Yl,Xm,Hm,u,ds,Pu,er,jc,2,-0,0),O);break e}W_(x,m,Yl,Xm,Hm,u,ds,Pu,er,jc,0,-0,0)}}break}while(!0);Xl(r)}function hf(r){Yl===null?Yl=r:Yl.push.apply(Yl,r)}function W_(r,u,m,x,M,O,Q,le,Ae,Ze,pt,At,it){var ft=u.subtreeFlags;if((ft&8192||(ft&16785408)===16785408)&&(ne={stylesheets:null,count:0,unsuspend:ue},gy(u),u=Le(),u!==null)){r.cancelPendingCommit=u(cl.bind(null,r,m,x,M,Q,le,Ae,1,At,it)),Hl(r,O,Q,!Ze);return}cl(r,m,x,M,Q,le,Ae,pt,At,it)}function kv(r){for(var u=r;;){var m=u.tag;if((m===0||m===11||m===15)&&u.flags&16384&&(m=u.updateQueue,m!==null&&(m=m.stores,m!==null)))for(var x=0;x<m.length;x++){var M=m[x],O=M.getSnapshot;M=M.value;try{if(!ao(O(),M))return!1}catch{return!1}}if(m=u.child,u.subtreeFlags&16384&&m!==null)m.return=u,u=m;else{if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Hl(r,u,m,x){u&=~Mp,u&=~Pu,r.suspendedLanes|=u,r.pingedLanes&=~u,x&&(r.warmLanes|=u),x=r.expirationTimes;for(var M=u;0<M;){var O=31-re(M),Q=1<<O;x[O]=-1,M&=~Q}m!==0&&ct(r,m,u)}function Rp(){return _r&6?!0:(Lp(0),!1)}function by(){if(jn!==null){if(Gi===0)var r=jn.return;else r=jn,Nc=Au=null,$d(r),Ac=null,vu=0,r=jn;for(;r!==null;)Ym(r.alternate,r),r=r.return;jn=null}}function Zh(r,u){r.finishedWork=null,r.finishedLanes=0;var m=r.timeoutHandle;m!==-1&&(r.timeoutHandle=-1,Bv(m)),m=r.cancelPendingCommit,m!==null&&(r.cancelPendingCommit=null,m()),by(),Ji=r,jn=m=Nu(r.current,null),si=u,Gi=0,hs=null,jc=!1,of=tt(r,u),qm=!1,er=ds=Mp=Pu=Os=Lr=0,Yl=Vh=null,Hm=!1,u&8&&(u|=u&32);var x=r.entangledLanes;if(x!==0)for(r=r.entanglements,x&=u;0<x;){var M=31-re(x),O=1<<M;u|=r[M],x&=~O}return Fc=u,bh(),m}function xy(r,u){Nn=null,ye.H=Ei,u===Ec?(u=cp(),Gi=3):u===Ld?(u=cp(),Gi=4):Gi=u===fp?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,hs=u,jn===null&&(Lr=1,va(r,Aa(u,r.current)))}function Qm(){var r=ye.H;return ye.H=Ei,r===null?Ei:r}function Km(){var r=ye.A;return ye.A=H_,r}function wy(){Lr=4,jc||(si&4194176)!==si&&lo.current!==null||(of=!0),!(Os&134217727)&&!(Pu&134217727)||Ji===null||Hl(Ji,si,ds,!1)}function Jm(r,u,m){var x=_r;_r|=2;var M=Qm(),O=Km();(Ji!==r||si!==u)&&(Xm=null,Zh(r,u)),u=!1;var Q=Lr;e:do try{if(Gi!==0&&jn!==null){var le=jn,Ae=hs;switch(Gi){case 8:by(),Q=6;break e;case 3:case 2:case 6:lo.current===null&&(u=!0);var Ze=Gi;if(Gi=0,hs=null,$h(r,le,Ae,Ze),m&&of){Q=0;break e}break;default:Ze=Gi,Gi=0,hs=null,$h(r,le,Ae,Ze)}}Rv(),Q=Lr;break}catch(pt){xy(r,pt)}while(!0);return u&&r.shellSuspendCounter++,Nc=Au=null,_r=x,ye.H=M,ye.A=O,jn===null&&(Ji=null,si=0,bh()),Q}function Rv(){for(;jn!==null;)Q_(jn)}function Nv(r,u){var m=_r;_r|=2;var x=Qm(),M=Km();Ji!==r||si!==u?(Xm=null,sf=Wr()+500,Zh(r,u)):of=tt(r,u);e:do try{if(Gi!==0&&jn!==null){u=jn;var O=hs;t:switch(Gi){case 1:Gi=0,hs=null,$h(r,u,O,1);break;case 2:if(tl(O)){Gi=0,hs=null,K_(u);break}u=function(){Gi===2&&Ji===r&&(Gi=7),Xl(r)},O.then(u,u);break e;case 3:Gi=7;break e;case 4:Gi=5;break e;case 7:tl(O)?(Gi=0,hs=null,K_(u)):(Gi=0,hs=null,$h(r,u,O,7));break;case 5:var Q=null;switch(jn.tag){case 26:Q=jn.memoizedState;case 5:case 27:var le=jn;if(!Q||K(Q)){Gi=0,hs=null;var Ae=le.sibling;if(Ae!==null)jn=Ae;else{var Ze=le.return;Ze!==null?(jn=Ze,Np(Ze)):jn=null}break t}}Gi=0,hs=null,$h(r,u,O,5);break;case 6:Gi=0,hs=null,$h(r,u,O,6);break;case 8:by(),Lr=6;break e;default:throw Error(h(462))}}Pv();break}catch(pt){xy(r,pt)}while(!0);return Nc=Au=null,ye.H=x,ye.A=M,_r=m,jn!==null?0:(Ji=null,si=0,bh(),Lr)}function Pv(){for(;jn!==null&&!xs();)Q_(jn)}function Q_(r){var u=uy(r.alternate,r,Fc);r.memoizedProps=r.pendingProps,u===null?Np(r):jn=u}function K_(r){var u=r,m=u.alternate;switch(u.tag){case 15:case 0:u=Hd(m,u,u.pendingProps,u.type,void 0,si);break;case 11:u=Hd(m,u,u.pendingProps,u.type.render,u.ref,si);break;case 5:$d(u);default:Ym(m,u),u=jn=vy(u,Fc),u=uy(m,u,Fc)}r.memoizedProps=r.pendingProps,u===null?Np(r):jn=u}function $h(r,u,m,x){Nc=Au=null,$d(u),Ac=null,vu=0;var M=u.return;try{if(ry(r,M,u,m,si)){Lr=1,va(r,Aa(m,r.current)),jn=null;return}}catch(O){if(M!==null)throw jn=M,O;Lr=1,va(r,Aa(m,r.current)),jn=null;return}u.flags&32768?(Bn||x===1?r=!0:of||si&536870912?r=!1:(jc=r=!0,(x===2||x===3||x===6)&&(x=lo.current,x!==null&&x.tag===13&&(x.flags|=16384))),df(u,r)):Np(u)}function Np(r){var u=r;do{if(u.flags&32768){df(u,jc);return}r=u.return;var m=Iv(u.alternate,u,Fc);if(m!==null){jn=m;return}if(u=u.sibling,u!==null){jn=u;return}jn=u=r}while(u!==null);Lr===0&&(Lr=5)}function df(r,u){do{var m=q_(r.alternate,r);if(m!==null){m.flags&=32767,jn=m;return}if(m=r.return,m!==null&&(m.flags|=32768,m.subtreeFlags=0,m.deletions=null),!u&&(r=r.sibling,r!==null)){jn=r;return}jn=r=m}while(r!==null);Lr=6,jn=null}function cl(r,u,m,x,M,O,Q,le,Ae,Ze){var pt=ye.T,At=Tt.p;try{Tt.p=2,ye.T=null,Ou(r,u,m,x,At,M,O,Q,le,Ae,Ze)}finally{ye.T=pt,Tt.p=At}}function Ou(r,u,m,x,M,O,Q,le){do Lu();while(Gh!==null);if(_r&6)throw Error(h(327));var Ae=r.finishedWork;if(x=r.finishedLanes,Ae===null)return null;if(r.finishedWork=null,r.finishedLanes=0,Ae===r.current)throw Error(h(177));r.callbackNode=null,r.callbackPriority=0,r.cancelPendingCommit=null;var Ze=Ae.lanes|Ae.childLanes;if(Ze|=sp,fn(r,x,Ze,O,Q,le),r===Ji&&(jn=Ji=null,si=0),!(Ae.subtreeFlags&10256)&&!(Ae.flags&10256)||Wm||(Wm=!0,Na=Ze,Ip=m,pf(Ea,function(){return Lu(),null})),m=(Ae.flags&15990)!==0,Ae.subtreeFlags&15990||m?(m=ye.T,ye.T=null,O=Tt.p,Tt.p=2,Q=_r,_r|=4,Jd(r,Ae),py(Ae,r),Nd(Hh,r.containerInfo),Zt=!!ag,Hh=ag=null,r.current=Ae,Tp(r,Ae.alternate,Ae),Wo(),_r=Q,Tt.p=O,ye.T=m):r.current=Ae,Wm?(Wm=!1,Gh=r,lf=x):Ty(r,Ze),Ze=r.pendingLanes,Ze===0&&(zu=null),de(Ae.stateNode),Xl(r),u!==null)for(M=r.onRecoverableError,Ae=0;Ae<u.length;Ae++)Ze=u[Ae],M(Ze.value,{componentStack:Ze.stack});return lf&3&&Lu(),Ze=r.pendingLanes,x&4194218&&Ze&42?r===ql?cf++:(cf=0,ql=r):cf=0,Lp(0),null}function Ty(r,u){(r.pooledCacheLanes&=u)===0&&(u=r.pooledCache,u!=null&&(r.pooledCache=null,Nl(u)))}function Lu(){if(Gh!==null){var r=Gh,u=Na;Na=0;var m=Yt(lf),x=ye.T,M=Tt.p;try{if(Tt.p=32>m?32:m,ye.T=null,Gh===null)var O=!1;else{m=Ip,Ip=null;var Q=Gh,le=lf;if(Gh=null,lf=0,_r&6)throw Error(h(331));var Ae=_r;if(_r|=4,af(Q.current),my(Q,Q.current,le,m),_r=Ae,Lp(0,!1),Rr&&typeof Rr.onPostCommitFiberRoot=="function")try{Rr.onPostCommitFiberRoot(Zs,Q)}catch{}O=!0}return O}finally{Tt.p=M,ye.T=x,Ty(r,u)}}return!1}function J_(r,u,m){u=Aa(m,u),u=Ii(r.stateNode,u,2),r=Gl(r,u,2),r!==null&&(tn(r,2),Xl(r))}function Zi(r,u,m){if(r.tag===3)J_(r,r,m);else for(;u!==null;){if(u.tag===3){J_(u,r,m);break}else if(u.tag===1){var x=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(zu===null||!zu.has(x))){r=Aa(m,r),m=Ga(2),x=Gl(u,m,2),x!==null&&(Vi(m,x,u,r),tn(x,2),Xl(x));break}}u=u.return}}function ff(r,u,m){var x=r.pingCache;if(x===null){x=r.pingCache=new X_;var M=new Set;x.set(u,M)}else M=x.get(u),M===void 0&&(M=new Set,x.set(u,M));M.has(m)||(qm=!0,M.add(m),r=Ey.bind(null,r,u,m),u.then(r,r))}function Ey(r,u,m){var x=r.pingCache;x!==null&&x.delete(u),r.pingedLanes|=r.suspendedLanes&m,r.warmLanes&=~m,Ji===r&&(si&m)===m&&(Lr===4||Lr===3&&(si&62914560)===si&&300>Wr()-Dp?!(_r&2)&&Zh(r,0):Mp|=m,er===si&&(er=0)),Xl(r)}function e0(r,u){u===0&&(u=Rt()),r=is(r,u),r!==null&&(tn(r,u),Xl(r))}function Sy(r){var u=r.memoizedState,m=0;u!==null&&(m=u.retryLane),e0(r,m)}function Ay(r,u){var m=0;switch(r.tag){case 13:var x=r.stateNode,M=r.memoizedState;M!==null&&(m=M.retryLane);break;case 19:x=r.stateNode;break;case 22:x=r.stateNode._retryCache;break;default:throw Error(h(314))}x!==null&&x.delete(u),e0(r,m)}function pf(r,u){return ar(r,u)}var Pp=null,Yh=null,zp=!1,Op=!1,mf=!1,Bu=0;function Xl(r){r!==Yh&&r.next===null&&(Yh===null?Pp=Yh=r:Yh=Yh.next=r),Op=!0,zp||(zp=!0,zv(t0))}function Lp(r,u){if(!mf&&Op){mf=!0;do for(var m=!1,x=Pp;x!==null;){if(r!==0){var M=x.pendingLanes;if(M===0)var O=0;else{var Q=x.suspendedLanes,le=x.pingedLanes;O=(1<<31-re(42|r)+1)-1,O&=M&~(Q&~le),O=O&201326677?O&201326677|1:O?O|2:0}O!==0&&(m=!0,r0(x,O))}else O=si,O=at(x,x===Ji?O:0),!(O&3)||tt(x,O)||(m=!0,r0(x,O));x=x.next}while(m);mf=!1}}function t0(){Op=zp=!1;var r=0;Bu!==0&&(og()&&(r=Bu),Bu=0);for(var u=Wr(),m=null,x=Pp;x!==null;){var M=x.next,O=n0(x,u);O===0?(x.next=null,m===null?Pp=M:m.next=M,M===null&&(Yh=m)):(m=x,(r!==0||O&3)&&(Op=!0)),x=M}Lp(r)}function n0(r,u){for(var m=r.suspendedLanes,x=r.pingedLanes,M=r.expirationTimes,O=r.pendingLanes&-62914561;0<O;){var Q=31-re(O),le=1<<Q,Ae=M[Q];Ae===-1?(!(le&m)||le&x)&&(M[Q]=$e(le,u)):Ae<=u&&(r.expiredLanes|=le),O&=~le}if(u=Ji,m=si,m=at(r,r===u?m:0),x=r.callbackNode,m===0||r===u&&Gi===2||r.cancelPendingCommit!==null)return x!==null&&x!==null&&ja(x),r.callbackNode=null,r.callbackPriority=0;if(!(m&3)||tt(r,m)){if(u=m&-m,u===r.callbackPriority)return u;switch(x!==null&&ja(x),Yt(m)){case 2:case 8:m=Qo;break;case 32:m=Ea;break;case 268435456:m=Gs;break;default:m=Ea}return x=i0.bind(null,r),m=ar(m,x),r.callbackPriority=u,r.callbackNode=m,u}return x!==null&&x!==null&&ja(x),r.callbackPriority=2,r.callbackNode=null,2}function i0(r,u){var m=r.callbackNode;if(Lu()&&r.callbackNode!==m)return null;var x=si;return x=at(r,r===Ji?x:0),x===0?null:(kp(r,x,u),n0(r,Wr()),r.callbackNode!=null&&r.callbackNode===m?i0.bind(null,r):null)}function r0(r,u){if(Lu())return null;kp(r,u,!0)}function zv(r){bf(function(){_r&6?ar(to,r):r()})}function Bp(){return Bu===0&&(Bu=Be()),Bu}function Uc(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:As(""+r)}function Cy(r,u){var m=u.ownerDocument.createElement("input");return m.name=u.name,m.value=u.value,r.id&&m.setAttribute("form",r.id),u.parentNode.insertBefore(m,u),r=new FormData(r),m.parentNode.removeChild(m),r}function a0(r,u,m,x,M){if(u==="submit"&&m&&m.stateNode===M){var O=Uc((M[$n]||null).action),Q=x.submitter;Q&&(u=(u=Q[$n]||null)?Uc(u.formAction):Q.getAttribute("formAction"),u!==null&&(O=u,Q=null));var le=new Ds("action","action",null,x,M);r.push({event:le,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Bu!==0){var Ae=Q?Cy(M,Q):new FormData(M);nt(m,{pending:!0,data:Ae,method:M.method,action:O},null,Ae)}}else typeof O=="function"&&(le.preventDefault(),Ae=Q?Cy(M,Q):new FormData(M),nt(m,{pending:!0,data:Ae,method:M.method,action:O},O,Ae))},currentTarget:M}]})}}for(var eg=0;eg<Dm.length;eg++){var tg=Dm[eg],o0=tg.toLowerCase(),My=tg[0].toUpperCase()+tg.slice(1);zo(o0,"on"+My)}zo(_h,"onAnimationEnd"),zo(ap,"onAnimationIteration"),zo(vc,"onAnimationStart"),zo("dblclick","onDoubleClick"),zo("focusin","onFocus"),zo("focusout","onBlur"),zo(fu,"onTransitionRun"),zo(Mm,"onTransitionStart"),zo(op,"onTransitionCancel"),zo(Yn,"onTransitionEnd"),sc("onMouseEnter",["mouseout","mouseover"]),sc("onMouseLeave",["mouseout","mouseover"]),sc("onPointerEnter",["pointerout","pointerover"]),sc("onPointerLeave",["pointerout","pointerover"]),Io("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Io("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Io("onBeforeInput",["compositionend","keypress","textInput","paste"]),Io("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Io("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Io("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var gf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jp=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(gf));function Dy(r,u){u=(u&4)!==0;for(var m=0;m<r.length;m++){var x=r[m],M=x.event;x=x.listeners;e:{var O=void 0;if(u)for(var Q=x.length-1;0<=Q;Q--){var le=x[Q],Ae=le.instance,Ze=le.currentTarget;if(le=le.listener,Ae!==O&&M.isPropagationStopped())break e;O=le,M.currentTarget=Ze;try{O(M)}catch(pt){sl(pt)}M.currentTarget=null,O=Ae}else for(Q=0;Q<x.length;Q++){if(le=x[Q],Ae=le.instance,Ze=le.currentTarget,le=le.listener,Ae!==O&&M.isPropagationStopped())break e;O=le,M.currentTarget=Ze;try{O(M)}catch(pt){sl(pt)}M.currentTarget=null,O=Ae}}}}function Qn(r,u){var m=u[Ar];m===void 0&&(m=u[Ar]=new Set);var x=r+"__bubble";m.has(x)||(Iy(u,r,2,!1),m.add(x))}function ng(r,u,m){var x=0;u&&(x|=4),Iy(m,r,x,u)}var Ya="_reactListening"+Math.random().toString(36).slice(2);function ju(r){if(!r[Ya]){r[Ya]=!0,yd.forEach(function(m){m!=="selectionchange"&&(jp.has(m)||ng(m,!1,r),ng(m,!0,r))});var u=r.nodeType===9?r:r.ownerDocument;u===null||u[Ya]||(u[Ya]=!0,ng("selectionchange",!1,u))}}function Iy(r,u,m,x){switch(sa(u)){case 2:var M=on;break;case 8:M=an;break;default:M=Xt}m=M.bind(null,u,m,r),M=void 0,!Ci||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(M=!0),x?M!==void 0?r.addEventListener(u,m,{capture:!0,passive:M}):r.addEventListener(u,m,!0):M!==void 0?r.addEventListener(u,m,{passive:M}):r.addEventListener(u,m,!1)}function ig(r,u,m,x,M){var O=x;if(!(u&1)&&!(u&2)&&x!==null)e:for(;;){if(x===null)return;var Q=x.tag;if(Q===3||Q===4){var le=x.stateNode.containerInfo;if(le===M||le.nodeType===8&&le.parentNode===M)break;if(Q===4)for(Q=x.return;Q!==null;){var Ae=Q.tag;if((Ae===3||Ae===4)&&(Ae=Q.stateNode.containerInfo,Ae===M||Ae.nodeType===8&&Ae.parentNode===M))return;Q=Q.return}for(;le!==null;){if(Q=Mo(le),Q===null)return;if(Ae=Q.tag,Ae===5||Ae===6||Ae===26||Ae===27){x=O=Q;continue e}le=le.parentNode}}x=x.return}Cs(function(){var Ze=O,pt=cc(m),At=[];e:{var it=vh.get(r);if(it!==void 0){var ft=Ds,ln=r;switch(r){case"keypress":if(Ys(m)===0)break e;case"keydown":case"keyup":ft=Ro;break;case"focusin":ln="focus",ft=lh;break;case"focusout":ln="blur",ft=lh;break;case"beforeblur":case"afterblur":ft=lh;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ft=uc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ft=hc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ft=hh;break;case _h:case ap:case vc:ft=bm;break;case Yn:ft=Ad;break;case"scroll":case"scrollend":ft=$f;break;case"wheel":ft=fc;break;case"copy":case"cut":case"paste":ft=wd;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ft=Ed;break;case"toggle":case"beforetoggle":ft=Hf}var In=(u&4)!==0,Ur=!In&&(r==="scroll"||r==="scrollend"),Ye=In?it!==null?it+"Capture":null:it;In=[];for(var Ue=Ze,Je;Ue!==null;){var xt=Ue;if(Je=xt.stateNode,xt=xt.tag,xt!==5&&xt!==26&&xt!==27||Je===null||Ye===null||(xt=xl(Ue,Ye),xt!=null&&In.push(yf(Ue,xt,Je))),Ur)break;Ue=Ue.return}0<In.length&&(it=new ft(it,ln,null,m,pt),At.push({event:it,listeners:In}))}}if(!(u&7)){e:{if(it=r==="mouseover"||r==="pointerover",ft=r==="mouseout"||r==="pointerout",it&&m!==Ai&&(ln=m.relatedTarget||m.fromElement)&&(Mo(ln)||ln[no]))break e;if((ft||it)&&(it=pt.window===pt?pt:(it=pt.ownerDocument)?it.defaultView||it.parentWindow:window,ft?(ln=m.relatedTarget||m.toElement,ft=Ze,ln=ln?Mo(ln):null,ln!==null&&(Ur=ot(ln),In=ln.tag,ln!==Ur||In!==5&&In!==27&&In!==6)&&(ln=null)):(ft=null,ln=Ze),ft!==ln)){if(In=uc,xt="onMouseLeave",Ye="onMouseEnter",Ue="mouse",(r==="pointerout"||r==="pointerover")&&(In=Ed,xt="onPointerLeave",Ye="onPointerEnter",Ue="pointer"),Ur=ft==null?it:Ko(ft),Je=ln==null?it:Ko(ln),it=new In(xt,Ue+"leave",ft,m,pt),it.target=Ur,it.relatedTarget=Je,xt=null,Mo(pt)===Ze&&(In=new In(Ye,Ue+"enter",ln,m,pt),In.target=Je,In.relatedTarget=Ur,xt=In),Ur=xt,ft&&ln)t:{for(In=ft,Ye=ln,Ue=0,Je=In;Je;Je=qh(Je))Ue++;for(Je=0,xt=Ye;xt;xt=qh(xt))Je++;for(;0<Ue-Je;)In=qh(In),Ue--;for(;0<Je-Ue;)Ye=qh(Ye),Je--;for(;Ue--;){if(In===Ye||Ye!==null&&In===Ye.alternate)break t;In=qh(In),Ye=qh(Ye)}In=null}else In=null;ft!==null&&ky(At,it,ft,In,!1),ln!==null&&Ur!==null&&ky(At,Ur,ln,In,!0)}}e:{if(it=Ze?Ko(Ze):window,ft=it.nodeName&&it.nodeName.toLowerCase(),ft==="select"||ft==="input"&&it.type==="file")var nn=kd;else if(Em(it))if(uu)nn=oi;else{nn=_c;var Hn=Jf}else ft=it.nodeName,!ft||ft.toLowerCase()!=="input"||it.type!=="checkbox"&&it.type!=="radio"?Ze&&Kr(Ze.elementType)&&(nn=kd):nn=ep;if(nn&&(nn=nn(r,Ze))){Sm(At,nn,m,pt);break e}Hn&&Hn(r,it,Ze),r==="focusout"&&Ze&&it.type==="number"&&Ze.memoizedProps.value!=null&&au(it,"number",it.value)}switch(Hn=Ze?Ko(Ze):window,r){case"focusin":(Em(Hn)||Hn.contentEditable==="true")&&(No=Hn,Sl=Ze,fa=null);break;case"focusout":fa=Sl=No=null;break;case"mousedown":Pd=!0;break;case"contextmenu":case"mouseup":case"dragend":Pd=!1,rp(At,m,pt);break;case"selectionchange":if(ip)break;case"keydown":case"keyup":rp(At,m,pt)}var un;if(Cd)e:{switch(r){case"compositionstart":var Kt="onCompositionStart";break e;case"compositionend":Kt="onCompositionEnd";break e;case"compositionupdate":Kt="onCompositionUpdate";break e}Kt=void 0}else mc?Hs(r,m)&&(Kt="onCompositionEnd"):r==="keydown"&&m.keyCode===229&&(Kt="onCompositionStart");Kt&&(Xf&&m.locale!=="ko"&&(mc||Kt!=="onCompositionStart"?Kt==="onCompositionEnd"&&mc&&(un=Vn()):(Tn=pt,pn="value"in Tn?Tn.value:Tn.textContent,mc=!0)),Hn=Fp(Ze,Kt),0<Hn.length&&(Kt=new xm(Kt,r,null,m,pt),At.push({event:Kt,listeners:Hn}),un?Kt.data=un:(un=Wf(m),un!==null&&(Kt.data=un)))),(un=Tm?dh(r,m):Qf(r,m))&&(Kt=Fp(Ze,"onBeforeInput"),0<Kt.length&&(Hn=new xm("onBeforeInput","beforeinput",null,m,pt),At.push({event:Hn,listeners:Kt}),Hn.data=un)),a0(At,r,Ze,m,pt)}Dy(At,u)})}function yf(r,u,m){return{instance:r,listener:u,currentTarget:m}}function Fp(r,u){for(var m=u+"Capture",x=[];r!==null;){var M=r,O=M.stateNode;M=M.tag,M!==5&&M!==26&&M!==27||O===null||(M=xl(r,m),M!=null&&x.unshift(yf(r,M,O)),M=xl(r,u),M!=null&&x.push(yf(r,M,O))),r=r.return}return x}function qh(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function ky(r,u,m,x,M){for(var O=u._reactName,Q=[];m!==null&&m!==x;){var le=m,Ae=le.alternate,Ze=le.stateNode;if(le=le.tag,Ae!==null&&Ae===x)break;le!==5&&le!==26&&le!==27||Ze===null||(Ae=Ze,M?(Ze=xl(m,O),Ze!=null&&Q.unshift(yf(m,Ze,Ae))):M||(Ze=xl(m,O),Ze!=null&&Q.push(yf(m,Ze,Ae)))),m=m.return}Q.length!==0&&r.push({event:u,listeners:Q})}var Ov=/\r\n?/g,s0=/\u0000|\uFFFD/g;function Vc(r){return(typeof r=="string"?r:""+r).replace(Ov,`
`).replace(s0,"")}function Ry(r,u){return u=Vc(u),Vc(r)===u}function Up(){}function ki(r,u,m,x,M,O){switch(m){case"children":typeof x=="string"?u==="body"||u==="textarea"&&x===""||qi(r,x):(typeof x=="number"||typeof x=="bigint")&&u!=="body"&&qi(r,""+x);break;case"className":iu(r,"class",x);break;case"tabIndex":iu(r,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":iu(r,m,x);break;case"style":oa(r,x,O);break;case"data":if(u!=="object"){iu(r,"data",x);break}case"src":case"href":if(x===""&&(u!=="a"||m!=="href")){r.removeAttribute(m);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){r.removeAttribute(m);break}x=As(""+x),r.setAttribute(m,x);break;case"action":case"formAction":if(typeof x=="function"){r.setAttribute(m,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof O=="function"&&(m==="formAction"?(u!=="input"&&ki(r,u,"name",M.name,M,null),ki(r,u,"formEncType",M.formEncType,M,null),ki(r,u,"formMethod",M.formMethod,M,null),ki(r,u,"formTarget",M.formTarget,M,null)):(ki(r,u,"encType",M.encType,M,null),ki(r,u,"method",M.method,M,null),ki(r,u,"target",M.target,M,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){r.removeAttribute(m);break}x=As(""+x),r.setAttribute(m,x);break;case"onClick":x!=null&&(r.onclick=Up);break;case"onScroll":x!=null&&Qn("scroll",r);break;case"onScrollEnd":x!=null&&Qn("scrollend",r);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(h(61));if(m=x.__html,m!=null){if(M.children!=null)throw Error(h(60));r.innerHTML=m}}break;case"multiple":r.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":r.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){r.removeAttribute("xlink:href");break}m=As(""+x),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",m);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?r.setAttribute(m,""+x):r.removeAttribute(m);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?r.setAttribute(m,""):r.removeAttribute(m);break;case"capture":case"download":x===!0?r.setAttribute(m,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?r.setAttribute(m,x):r.removeAttribute(m);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?r.setAttribute(m,x):r.removeAttribute(m);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?r.removeAttribute(m):r.setAttribute(m,x);break;case"popover":Qn("beforetoggle",r),Qn("toggle",r),Ts(r,"popover",x);break;case"xlinkActuate":Es(r,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Es(r,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Es(r,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Es(r,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Es(r,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Es(r,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Es(r,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Es(r,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Es(r,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Ts(r,"is",x);break;case"innerText":case"textContent":break;default:(!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(m=da.get(m)||m,Ts(r,m,x))}}function rg(r,u,m,x,M,O){switch(m){case"style":oa(r,x,O);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(h(61));if(m=x.__html,m!=null){if(M.children!=null)throw Error(h(60));r.innerHTML=m}}break;case"children":typeof x=="string"?qi(r,x):(typeof x=="number"||typeof x=="bigint")&&qi(r,""+x);break;case"onScroll":x!=null&&Qn("scroll",r);break;case"onScrollEnd":x!=null&&Qn("scrollend",r);break;case"onClick":x!=null&&(r.onclick=Up);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Uf.hasOwnProperty(m))e:{if(m[0]==="o"&&m[1]==="n"&&(M=m.endsWith("Capture"),u=m.slice(2,M?m.length-7:void 0),O=r[$n]||null,O=O!=null?O[m]:null,typeof O=="function"&&r.removeEventListener(u,O,M),typeof x=="function")){typeof O!="function"&&O!==null&&(m in r?r[m]=null:r.hasAttribute(m)&&r.removeAttribute(m)),r.addEventListener(u,x,M);break e}m in r?r[m]=x:x===!0?r.setAttribute(m,""):Ts(r,m,x)}}}function Pa(r,u,m){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Qn("error",r),Qn("load",r);var x=!1,M=!1,O;for(O in m)if(m.hasOwnProperty(O)){var Q=m[O];if(Q!=null)switch(O){case"src":x=!0;break;case"srcSet":M=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(h(137,u));default:ki(r,u,O,Q,m,null)}}M&&ki(r,u,"srcSet",m.srcSet,m,null),x&&ki(r,u,"src",m.src,m,null);return;case"input":Qn("invalid",r);var le=O=Q=M=null,Ae=null,Ze=null;for(x in m)if(m.hasOwnProperty(x)){var pt=m[x];if(pt!=null)switch(x){case"name":M=pt;break;case"type":Q=pt;break;case"checked":Ae=pt;break;case"defaultChecked":Ze=pt;break;case"value":O=pt;break;case"defaultValue":le=pt;break;case"children":case"dangerouslySetInnerHTML":if(pt!=null)throw Error(h(137,u));break;default:ki(r,u,x,pt,m,null)}}Dn(r,O,le,Ae,Ze,Q,M,!1),ah(r);return;case"select":Qn("invalid",r),x=Q=O=null;for(M in m)if(m.hasOwnProperty(M)&&(le=m[M],le!=null))switch(M){case"value":O=le;break;case"defaultValue":Q=le;break;case"multiple":x=le;default:ki(r,u,M,le,m,null)}u=O,m=Q,r.multiple=!!x,u!=null?lc(r,!!x,u,!1):m!=null&&lc(r,!!x,m,!0);return;case"textarea":Qn("invalid",r),O=M=x=null;for(Q in m)if(m.hasOwnProperty(Q)&&(le=m[Q],le!=null))switch(Q){case"value":x=le;break;case"defaultValue":M=le;break;case"children":O=le;break;case"dangerouslySetInnerHTML":if(le!=null)throw Error(h(91));break;default:ki(r,u,Q,le,m,null)}or(r,x,M,O),ah(r);return;case"option":for(Ae in m)if(m.hasOwnProperty(Ae)&&(x=m[Ae],x!=null))switch(Ae){case"selected":r.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:ki(r,u,Ae,x,m,null)}return;case"dialog":Qn("cancel",r),Qn("close",r);break;case"iframe":case"object":Qn("load",r);break;case"video":case"audio":for(x=0;x<gf.length;x++)Qn(gf[x],r);break;case"image":Qn("error",r),Qn("load",r);break;case"details":Qn("toggle",r);break;case"embed":case"source":case"link":Qn("error",r),Qn("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ze in m)if(m.hasOwnProperty(Ze)&&(x=m[Ze],x!=null))switch(Ze){case"children":case"dangerouslySetInnerHTML":throw Error(h(137,u));default:ki(r,u,Ze,x,m,null)}return;default:if(Kr(u)){for(pt in m)m.hasOwnProperty(pt)&&(x=m[pt],x!==void 0&&rg(r,u,pt,x,m,void 0));return}}for(le in m)m.hasOwnProperty(le)&&(x=m[le],x!=null&&ki(r,u,le,x,m,null))}function Lv(r,u,m,x){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var M=null,O=null,Q=null,le=null,Ae=null,Ze=null,pt=null;for(ft in m){var At=m[ft];if(m.hasOwnProperty(ft)&&At!=null)switch(ft){case"checked":break;case"value":break;case"defaultValue":Ae=At;default:x.hasOwnProperty(ft)||ki(r,u,ft,null,x,At)}}for(var it in x){var ft=x[it];if(At=m[it],x.hasOwnProperty(it)&&(ft!=null||At!=null))switch(it){case"type":O=ft;break;case"name":M=ft;break;case"checked":Ze=ft;break;case"defaultChecked":pt=ft;break;case"value":Q=ft;break;case"defaultValue":le=ft;break;case"children":case"dangerouslySetInnerHTML":if(ft!=null)throw Error(h(137,u));break;default:ft!==At&&ki(r,u,it,ft,x,At)}}ko(r,Q,le,Ae,Ze,pt,O,M);return;case"select":ft=Q=le=it=null;for(O in m)if(Ae=m[O],m.hasOwnProperty(O)&&Ae!=null)switch(O){case"value":break;case"multiple":ft=Ae;default:x.hasOwnProperty(O)||ki(r,u,O,null,x,Ae)}for(M in x)if(O=x[M],Ae=m[M],x.hasOwnProperty(M)&&(O!=null||Ae!=null))switch(M){case"value":it=O;break;case"defaultValue":le=O;break;case"multiple":Q=O;default:O!==Ae&&ki(r,u,M,O,x,Ae)}u=le,m=Q,x=ft,it!=null?lc(r,!!m,it,!1):!!x!=!!m&&(u!=null?lc(r,!!m,u,!0):lc(r,!!m,m?[]:"",!1));return;case"textarea":ft=it=null;for(le in m)if(M=m[le],m.hasOwnProperty(le)&&M!=null&&!x.hasOwnProperty(le))switch(le){case"value":break;case"children":break;default:ki(r,u,le,null,x,M)}for(Q in x)if(M=x[Q],O=m[Q],x.hasOwnProperty(Q)&&(M!=null||O!=null))switch(Q){case"value":it=M;break;case"defaultValue":ft=M;break;case"children":break;case"dangerouslySetInnerHTML":if(M!=null)throw Error(h(91));break;default:M!==O&&ki(r,u,Q,M,x,O)}ou(r,it,ft);return;case"option":for(var ln in m)if(it=m[ln],m.hasOwnProperty(ln)&&it!=null&&!x.hasOwnProperty(ln))switch(ln){case"selected":r.selected=!1;break;default:ki(r,u,ln,null,x,it)}for(Ae in x)if(it=x[Ae],ft=m[Ae],x.hasOwnProperty(Ae)&&it!==ft&&(it!=null||ft!=null))switch(Ae){case"selected":r.selected=it&&typeof it!="function"&&typeof it!="symbol";break;default:ki(r,u,Ae,it,x,ft)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var In in m)it=m[In],m.hasOwnProperty(In)&&it!=null&&!x.hasOwnProperty(In)&&ki(r,u,In,null,x,it);for(Ze in x)if(it=x[Ze],ft=m[Ze],x.hasOwnProperty(Ze)&&it!==ft&&(it!=null||ft!=null))switch(Ze){case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(h(137,u));break;default:ki(r,u,Ze,it,x,ft)}return;default:if(Kr(u)){for(var Ur in m)it=m[Ur],m.hasOwnProperty(Ur)&&it!==void 0&&!x.hasOwnProperty(Ur)&&rg(r,u,Ur,void 0,x,it);for(pt in x)it=x[pt],ft=m[pt],!x.hasOwnProperty(pt)||it===ft||it===void 0&&ft===void 0||rg(r,u,pt,it,x,ft);return}}for(var Ye in m)it=m[Ye],m.hasOwnProperty(Ye)&&it!=null&&!x.hasOwnProperty(Ye)&&ki(r,u,Ye,null,x,it);for(At in x)it=x[At],ft=m[At],!x.hasOwnProperty(At)||it===ft||it==null&&ft==null||ki(r,u,At,it,x,ft)}var ag=null,Hh=null;function Vp(r){return r.nodeType===9?r:r.ownerDocument}function Gp(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Ny(r,u){if(r===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&u==="foreignObject"?0:r}function _f(r,u){return r==="textarea"||r==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var vf=null;function og(){var r=window.event;return r&&r.type==="popstate"?r===vf?!1:(vf=r,!0):(vf=null,!1)}var l0=typeof setTimeout=="function"?setTimeout:void 0,Bv=typeof clearTimeout=="function"?clearTimeout:void 0,c0=typeof Promise=="function"?Promise:void 0,bf=typeof queueMicrotask=="function"?queueMicrotask:typeof c0<"u"?function(r){return c0.resolve(null).then(r).catch(ba)}:l0;function ba(r){setTimeout(function(){throw r})}function Wl(r,u){var m=u,x=0;do{var M=m.nextSibling;if(r.removeChild(m),M&&M.nodeType===8)if(m=M.data,m==="/$"){if(x===0){r.removeChild(M),mo(u);return}x--}else m!=="$"&&m!=="$?"&&m!=="$!"||x++;m=M}while(m);mo(u)}function Zp(r){var u=r.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var m=u;switch(u=u.nextSibling,m.nodeName){case"HTML":case"HEAD":case"BODY":Zp(m),oc(m);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(m.rel.toLowerCase()==="stylesheet")continue}r.removeChild(m)}}function u0(r,u,m,x){for(;r.nodeType===1;){var M=m;if(r.nodeName.toLowerCase()!==u.toLowerCase()){if(!x&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(x){if(!r[wi])switch(u){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(O=r.getAttribute("rel"),O==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(O!==M.rel||r.getAttribute("href")!==(M.href==null?null:M.href)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin)||r.getAttribute("title")!==(M.title==null?null:M.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(O=r.getAttribute("src"),(O!==(M.src==null?null:M.src)||r.getAttribute("type")!==(M.type==null?null:M.type)||r.getAttribute("crossorigin")!==(M.crossOrigin==null?null:M.crossOrigin))&&O&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(u==="input"&&r.type==="hidden"){var O=M.name==null?null:""+M.name;if(M.type==="hidden"&&r.getAttribute("name")===O)return r}else return r;if(r=fs(r.nextSibling),r===null)break}return null}function h0(r,u,m){if(u==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!m||(r=fs(r.nextSibling),r===null))return null;return r}function fs(r){for(;r!=null;r=r.nextSibling){var u=r.nodeType;if(u===1||u===3)break;if(u===8){if(u=r.data,u==="$"||u==="$!"||u==="$?"||u==="F!"||u==="F")break;if(u==="/$")return null}}return r}function d0(r){r=r.previousSibling;for(var u=0;r;){if(r.nodeType===8){var m=r.data;if(m==="$"||m==="$!"||m==="$?"){if(u===0)return r;u--}else m==="/$"&&u++}r=r.previousSibling}return null}function Py(r,u,m){switch(u=Vp(m),r){case"html":if(r=u.documentElement,!r)throw Error(h(452));return r;case"head":if(r=u.head,!r)throw Error(h(453));return r;case"body":if(r=u.body,!r)throw Error(h(454));return r;default:throw Error(h(451))}}var ps=new Map,f0=new Set;function $p(r){return typeof r.getRootNode=="function"?r.getRootNode():r.ownerDocument}var ul=Tt.d;Tt.d={f:zy,r:p0,D:m0,C:Oy,L:lg,m:Yp,X:By,S:Ly,M:jy};function zy(){var r=ul.f(),u=Rp();return r||u}function p0(r){var u=vl(r);u!==null&&u.tag===5&&u.type==="form"?Mt(u):ul.r(r)}var Ql=typeof document>"u"?null:document;function sg(r,u,m){var x=Ql;if(x&&typeof u=="string"&&u){var M=hn(u);M='link[rel="'+r+'"][href="'+M+'"]',typeof m=="string"&&(M+='[crossorigin="'+m+'"]'),f0.has(M)||(f0.add(M),r={rel:r,crossOrigin:m,href:u},x.querySelector(M)===null&&(u=x.createElement("link"),Pa(u,"link",r),Zr(u),x.head.appendChild(u)))}}function m0(r){ul.D(r),sg("dns-prefetch",r,null)}function Oy(r,u){ul.C(r,u),sg("preconnect",r,u)}function lg(r,u,m){ul.L(r,u,m);var x=Ql;if(x&&r&&u){var M='link[rel="preload"][as="'+hn(u)+'"]';u==="image"&&m&&m.imageSrcSet?(M+='[imagesrcset="'+hn(m.imageSrcSet)+'"]',typeof m.imageSizes=="string"&&(M+='[imagesizes="'+hn(m.imageSizes)+'"]')):M+='[href="'+hn(r)+'"]';var O=M;switch(u){case"style":O=l(r);break;case"script":O=_(r)}ps.has(O)||(r=Qe({rel:"preload",href:u==="image"&&m&&m.imageSrcSet?void 0:r,as:u},m),ps.set(O,r),x.querySelector(M)!==null||u==="style"&&x.querySelector(t(O))||u==="script"&&x.querySelector(T(O))||(u=x.createElement("link"),Pa(u,"link",r),Zr(u),x.head.appendChild(u)))}}function Yp(r,u){ul.m(r,u);var m=Ql;if(m&&r){var x=u&&typeof u.as=="string"?u.as:"script",M='link[rel="modulepreload"][as="'+hn(x)+'"][href="'+hn(r)+'"]',O=M;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":O=_(r)}if(!ps.has(O)&&(r=Qe({rel:"modulepreload",href:r},u),ps.set(O,r),m.querySelector(M)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(m.querySelector(T(O)))return}x=m.createElement("link"),Pa(x,"link",r),Zr(x),m.head.appendChild(x)}}}function Ly(r,u,m){ul.S(r,u,m);var x=Ql;if(x&&r){var M=Do(x).hoistableStyles,O=l(r);u=u||"default";var Q=M.get(O);if(!Q){var le={loading:0,preload:null};if(Q=x.querySelector(t(O)))le.loading=5;else{r=Qe({rel:"stylesheet",href:r,"data-precedence":u},m),(m=ps.get(O))&&R(r,m);var Ae=Q=x.createElement("link");Zr(Ae),Pa(Ae,"link",r),Ae._p=new Promise(function(Ze,pt){Ae.onload=Ze,Ae.onerror=pt}),Ae.addEventListener("load",function(){le.loading|=1}),Ae.addEventListener("error",function(){le.loading|=2}),le.loading|=4,C(Q,u,x)}Q={type:"stylesheet",instance:Q,count:1,state:le},M.set(O,Q)}}}function By(r,u){ul.X(r,u);var m=Ql;if(m&&r){var x=Do(m).hoistableScripts,M=_(r),O=x.get(M);O||(O=m.querySelector(T(M)),O||(r=Qe({src:r,async:!0},u),(u=ps.get(M))&&B(r,u),O=m.createElement("script"),Zr(O),Pa(O,"link",r),m.head.appendChild(O)),O={type:"script",instance:O,count:1,state:null},x.set(M,O))}}function jy(r,u){ul.M(r,u);var m=Ql;if(m&&r){var x=Do(m).hoistableScripts,M=_(r),O=x.get(M);O||(O=m.querySelector(T(M)),O||(r=Qe({src:r,async:!0,type:"module"},u),(u=ps.get(M))&&B(r,u),O=m.createElement("script"),Zr(O),Pa(O,"link",r),m.head.appendChild(O)),O={type:"script",instance:O,count:1,state:null},x.set(M,O))}}function g0(r,u,m,x){var M=(M=Ni.current)?$p(M):null;if(!M)throw Error(h(446));switch(r){case"meta":case"title":return null;case"style":return typeof m.precedence=="string"&&typeof m.href=="string"?(u=l(m.href),m=Do(M).hoistableStyles,x=m.get(u),x||(x={type:"style",instance:null,count:0,state:null},m.set(u,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(m.rel==="stylesheet"&&typeof m.href=="string"&&typeof m.precedence=="string"){r=l(m.href);var O=Do(M).hoistableStyles,Q=O.get(r);if(Q||(M=M.ownerDocument||M,Q={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},O.set(r,Q),(O=M.querySelector(t(r)))&&!O._p&&(Q.instance=O,Q.state.loading=5),ps.has(r)||(m={rel:"preload",as:"style",href:m.href,crossOrigin:m.crossOrigin,integrity:m.integrity,media:m.media,hrefLang:m.hrefLang,referrerPolicy:m.referrerPolicy},ps.set(r,m),O||d(M,r,m,Q.state))),u&&x===null)throw Error(h(528,""));return Q}if(u&&x!==null)throw Error(h(529,""));return null;case"script":return u=m.async,m=m.src,typeof m=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=_(m),m=Do(M).hoistableScripts,x=m.get(u),x||(x={type:"script",instance:null,count:0,state:null},m.set(u,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(h(444,r))}}function l(r){return'href="'+hn(r)+'"'}function t(r){return'link[rel="stylesheet"]['+r+"]"}function s(r){return Qe({},r,{"data-precedence":r.precedence,precedence:null})}function d(r,u,m,x){r.querySelector('link[rel="preload"][as="style"]['+u+"]")?x.loading=1:(u=r.createElement("link"),x.preload=u,u.addEventListener("load",function(){return x.loading|=1}),u.addEventListener("error",function(){return x.loading|=2}),Pa(u,"link",m),Zr(u),r.head.appendChild(u))}function _(r){return'[src="'+hn(r)+'"]'}function T(r){return"script[async]"+r}function E(r,u,m){if(u.count++,u.instance===null)switch(u.type){case"style":var x=r.querySelector('style[data-href~="'+hn(m.href)+'"]');if(x)return u.instance=x,Zr(x),x;var M=Qe({},m,{"data-href":m.href,"data-precedence":m.precedence,href:null,precedence:null});return x=(r.ownerDocument||r).createElement("style"),Zr(x),Pa(x,"style",M),C(x,m.precedence,r),u.instance=x;case"stylesheet":M=l(m.href);var O=r.querySelector(t(M));if(O)return u.state.loading|=4,u.instance=O,Zr(O),O;x=s(m),(M=ps.get(M))&&R(x,M),O=(r.ownerDocument||r).createElement("link"),Zr(O);var Q=O;return Q._p=new Promise(function(le,Ae){Q.onload=le,Q.onerror=Ae}),Pa(O,"link",x),u.state.loading|=4,C(O,m.precedence,r),u.instance=O;case"script":return O=_(m.src),(M=r.querySelector(T(O)))?(u.instance=M,Zr(M),M):(x=m,(M=ps.get(O))&&(x=Qe({},m),B(x,M)),r=r.ownerDocument||r,M=r.createElement("script"),Zr(M),Pa(M,"link",x),r.head.appendChild(M),u.instance=M);case"void":return null;default:throw Error(h(443,u.type))}else u.type==="stylesheet"&&!(u.state.loading&4)&&(x=u.instance,u.state.loading|=4,C(x,m.precedence,r));return u.instance}function C(r,u,m){for(var x=m.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),M=x.length?x[x.length-1]:null,O=M,Q=0;Q<x.length;Q++){var le=x[Q];if(le.dataset.precedence===u)O=le;else if(O!==M)break}O?O.parentNode.insertBefore(r,O.nextSibling):(u=m.nodeType===9?m.head:m,u.insertBefore(r,u.firstChild))}function R(r,u){r.crossOrigin==null&&(r.crossOrigin=u.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=u.referrerPolicy),r.title==null&&(r.title=u.title)}function B(r,u){r.crossOrigin==null&&(r.crossOrigin=u.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=u.referrerPolicy),r.integrity==null&&(r.integrity=u.integrity)}var U=null;function G(r,u,m){if(U===null){var x=new Map,M=U=new Map;M.set(m,x)}else M=U,x=M.get(m),x||(x=new Map,M.set(m,x));if(x.has(r))return x;for(x.set(r,null),m=m.getElementsByTagName(r),M=0;M<m.length;M++){var O=m[M];if(!(O[wi]||O[Nt]||r==="link"&&O.getAttribute("rel")==="stylesheet")&&O.namespaceURI!=="http://www.w3.org/2000/svg"){var Q=O.getAttribute(u)||"";Q=r+Q;var le=x.get(Q);le?le.push(O):x.set(Q,[O])}}return x}function q(r,u,m){r=r.ownerDocument||r,r.head.insertBefore(m,u==="title"?r.querySelector("head > title"):null)}function W(r,u,m){if(m===1||u.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return r=u.disabled,typeof u.precedence=="string"&&r==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function K(r){return!(r.type==="stylesheet"&&!(r.state.loading&3))}var ne=null;function ue(){}function _e(r,u,m){if(ne===null)throw Error(h(475));var x=ne;if(u.type==="stylesheet"&&(typeof m.media!="string"||matchMedia(m.media).matches!==!1)&&!(u.state.loading&4)){if(u.instance===null){var M=l(m.href),O=r.querySelector(t(M));if(O){r=O._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(x.count++,x=we.bind(x),r.then(x,x)),u.state.loading|=4,u.instance=O,Zr(O);return}O=r.ownerDocument||r,m=s(m),(M=ps.get(M))&&R(m,M),O=O.createElement("link"),Zr(O);var Q=O;Q._p=new Promise(function(le,Ae){Q.onload=le,Q.onerror=Ae}),Pa(O,"link",m),u.instance=O}x.stylesheets===null&&(x.stylesheets=new Map),x.stylesheets.set(u,r),(r=u.state.preload)&&!(u.state.loading&3)&&(x.count++,u=we.bind(x),r.addEventListener("load",u),r.addEventListener("error",u))}}function Le(){if(ne===null)throw Error(h(475));var r=ne;return r.stylesheets&&r.count===0&&ce(r,r.stylesheets),0<r.count?function(u){var m=setTimeout(function(){if(r.stylesheets&&ce(r,r.stylesheets),r.unsuspend){var x=r.unsuspend;r.unsuspend=null,x()}},6e4);return r.unsuspend=u,function(){r.unsuspend=null,clearTimeout(m)}}:null}function we(){if(this.count--,this.count===0){if(this.stylesheets)ce(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var X=null;function ce(r,u){r.stylesheets=null,r.unsuspend!==null&&(r.count++,X=new Map,u.forEach(Ee,r),X=null,we.call(r))}function Ee(r,u){if(!(u.state.loading&4)){var m=X.get(r);if(m)var x=m.get(null);else{m=new Map,X.set(r,m);for(var M=r.querySelectorAll("link[data-precedence],style[data-precedence]"),O=0;O<M.length;O++){var Q=M[O];(Q.nodeName==="LINK"||Q.getAttribute("media")!=="not all")&&(m.set(Q.dataset.precedence,Q),x=Q)}x&&m.set(null,x)}M=u.instance,Q=M.getAttribute("data-precedence"),O=m.get(Q)||x,O===x&&m.set(null,M),m.set(Q,M),this.count++,x=we.bind(this),M.addEventListener("load",x),M.addEventListener("error",x),O?O.parentNode.insertBefore(M,O.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(M,r.firstChild)),u.state.loading|=4}}var qe={$$typeof:V,Provider:null,Consumer:null,_currentValue:jt,_currentValue2:jt,_threadCount:0};function yt(r,u,m,x,M,O,Q,le){this.tag=1,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=It(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=It(0),this.hiddenUpdates=It(null),this.identifierPrefix=x,this.onUncaughtError=M,this.onCaughtError=O,this.onRecoverableError=Q,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=le,this.incompleteTransitions=new Map}function et(r,u,m,x,M,O,Q,le,Ae,Ze,pt,At){return r=new yt(r,u,m,Q,le,Ae,Ze,At),u=1,O===!0&&(u|=24),O=$o(3,null,null,u),r.current=O,O.stateNode=r,u=Ud(),u.refCount++,r.pooledCache=u,u.refCount++,O.memoizedState={element:x,isDehydrated:m,cache:u},hy(O),r}function rt(r){return r?(r=Qs,r):Qs}function Et(r,u,m,x,M,O){M=rt(M),x.context===null?x.context=M:x.pendingContext=M,x=Vl(u),x.payload={element:m},O=O===void 0?null:O,O!==null&&(x.callback=O),m=Gl(r,x,u),m!==null&&(ra(m,r,u),Qd(m,r,u))}function _t(r,u){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var m=r.retryLane;r.retryLane=m!==0&&m<u?m:u}}function St(r,u){_t(r,u),(r=r.alternate)&&_t(r,u)}function lt(r){if(r.tag===13){var u=is(r,67108864);u!==null&&ra(u,r,67108864),St(r,67108864)}}var Zt=!0;function on(r,u,m,x){var M=ye.T;ye.T=null;var O=Tt.p;try{Tt.p=2,Xt(r,u,m,x)}finally{Tt.p=O,ye.T=M}}function an(r,u,m,x){var M=ye.T;ye.T=null;var O=Tt.p;try{Tt.p=8,Xt(r,u,m,x)}finally{Tt.p=O,ye.T=M}}function Xt(r,u,m,x){if(Zt){var M=Pn(x);if(M===null)ig(r,u,x,zi,m),Yo(r,x);else if(po(M,r,u,m,x))x.stopPropagation();else if(Yo(r,x),u&4&&-1<qa.indexOf(r)){for(;M!==null;){var O=vl(M);if(O!==null)switch(O.tag){case 3:if(O=O.stateNode,O.current.memoizedState.isDehydrated){var Q=Fe(O.pendingLanes);if(Q!==0){var le=O;for(le.pendingLanes|=2,le.entangledLanes|=2;Q;){var Ae=1<<31-re(Q);le.entanglements[1]|=Ae,Q&=~Ae}Xl(O),!(_r&6)&&(sf=Wr()+500,Lp(0))}}break;case 13:le=is(O,2),le!==null&&ra(le,O,2),Rp(),St(O,2)}if(O=Pn(x),O===null&&ig(r,u,x,zi,m),O===M)break;M=O}M!==null&&x.stopPropagation()}else ig(r,u,x,null,m)}}function Pn(r){return r=cc(r),Mr(r)}var zi=null;function Mr(r){if(zi=null,r=Mo(r),r!==null){var u=ot(r);if(u===null)r=null;else{var m=u.tag;if(m===13){if(r=Ut(u),r!==null)return r;r=null}else if(m===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;r=null}else u!==r&&(r=null)}}return zi=r,null}function sa(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ws()){case to:return 2;case Qo:return 8;case Ea:case ac:return 32;case Gs:return 268435456;default:return 32}default:return 32}}var fo=!1,Br=null,tr=null,di=null,vr=new Map,Dr=new Map,nr=[],qa="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Yo(r,u){switch(r){case"focusin":case"focusout":Br=null;break;case"dragenter":case"dragleave":tr=null;break;case"mouseover":case"mouseout":di=null;break;case"pointerover":case"pointerout":vr.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dr.delete(u.pointerId)}}function br(r,u,m,x,M,O){return r===null||r.nativeEvent!==O?(r={blockedOn:u,domEventName:m,eventSystemFlags:x,nativeEvent:O,targetContainers:[M]},u!==null&&(u=vl(u),u!==null&&lt(u)),r):(r.eventSystemFlags|=x,u=r.targetContainers,M!==null&&u.indexOf(M)===-1&&u.push(M),r)}function po(r,u,m,x,M){switch(u){case"focusin":return Br=br(Br,r,u,m,x,M),!0;case"dragenter":return tr=br(tr,r,u,m,x,M),!0;case"mouseover":return di=br(di,r,u,m,x,M),!0;case"pointerover":var O=M.pointerId;return vr.set(O,br(vr.get(O)||null,r,u,m,x,M)),!0;case"gotpointercapture":return O=M.pointerId,Dr.set(O,br(Dr.get(O)||null,r,u,m,x,M)),!0}return!1}function jr(r){var u=Mo(r.target);if(u!==null){var m=ot(u);if(m!==null){if(u=m.tag,u===13){if(u=Ut(m),u!==null){r.blockedOn=u,Zn(r.priority,function(){if(m.tag===13){var x=$a(),M=is(m,x);M!==null&&ra(M,m,x),St(m,x)}});return}}else if(u===3&&m.stateNode.current.memoizedState.isDehydrated){r.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Ir(r){if(r.blockedOn!==null)return!1;for(var u=r.targetContainers;0<u.length;){var m=Pn(r.nativeEvent);if(m===null){m=r.nativeEvent;var x=new m.constructor(m.type,m);Ai=x,m.target.dispatchEvent(x),Ai=null}else return u=vl(m),u!==null&&lt(u),r.blockedOn=m,!1;u.shift()}return!0}function Yr(r,u,m){Ir(r)&&m.delete(u)}function Fr(){fo=!1,Br!==null&&Ir(Br)&&(Br=null),tr!==null&&Ir(tr)&&(tr=null),di!==null&&Ir(di)&&(di=null),vr.forEach(Yr),Dr.forEach(Yr)}function Si(r,u){r.blockedOn===u&&(r.blockedOn=null,fo||(fo=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Fr)))}var qo=null;function Xh(r){qo!==r&&(qo=r,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){qo===r&&(qo=null);for(var u=0;u<r.length;u+=3){var m=r[u],x=r[u+1],M=r[u+2];if(typeof x!="function"){if(Mr(x||m)===null)continue;break}var O=vl(m);O!==null&&(r.splice(u,3),u-=3,nt(O,{pending:!0,data:M,method:m.method,action:x},x,M))}}))}function mo(r){function u(Ae){return Si(Ae,r)}Br!==null&&Si(Br,r),tr!==null&&Si(tr,r),di!==null&&Si(di,r),vr.forEach(u),Dr.forEach(u);for(var m=0;m<nr.length;m++){var x=nr[m];x.blockedOn===r&&(x.blockedOn=null)}for(;0<nr.length&&(m=nr[0],m.blockedOn===null);)jr(m),m.blockedOn===null&&nr.shift();if(m=(r.ownerDocument||r).$$reactFormReplay,m!=null)for(x=0;x<m.length;x+=3){var M=m[x],O=m[x+1],Q=M[$n]||null;if(typeof O=="function")Q||Xh(m);else if(Q){var le=null;if(O&&O.hasAttribute("formAction")){if(M=O,Q=O[$n]||null)le=Q.formAction;else if(Mr(M)!==null)continue}else le=Q.action;typeof le=="function"?m[x+1]=le:(m.splice(x,3),x-=3),Xh(m)}}}function Fy(r){this._internalRoot=r}Gc.prototype.render=Fy.prototype.render=function(r){var u=this._internalRoot;if(u===null)throw Error(h(409));var m=u.current,x=$a();Et(m,x,r,u,null,null)},Gc.prototype.unmount=Fy.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var u=r.containerInfo;r.tag===0&&Lu(),Et(r.current,2,null,r,null,null),Rp(),u[no]=null}};function Gc(r){this._internalRoot=r}Gc.prototype.unstable_scheduleHydration=function(r){if(r){var u=Cn();r={blockedOn:null,target:r,priority:u};for(var m=0;m<nr.length&&u!==0&&u<nr[m].priority;m++);nr.splice(m,0,r),m===0&&jr(r)}};var Fu=n.version;if(Fu!=="19.0.0")throw Error(h(527,Fu,"19.0.0"));Tt.findDOMNode=function(r){var u=r._reactInternals;if(u===void 0)throw typeof r.render=="function"?Error(h(188)):(r=Object.keys(r).join(","),Error(h(268,r)));return r=ut(u),r=r!==null?Bt(r):null,r=r===null?null:r.stateNode,r};var xf={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:ye,findFiberByHostInstance:Mo,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zc.isDisabled&&Zc.supportsFiber)try{Zs=Zc.inject(xf),Rr=Zc}catch{}}return Vy.createRoot=function(r,u){if(!p(r))throw Error(h(299));var m=!1,x="",M=ka,O=uo,Q=ho,le=null;return u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(x=u.identifierPrefix),u.onUncaughtError!==void 0&&(M=u.onUncaughtError),u.onCaughtError!==void 0&&(O=u.onCaughtError),u.onRecoverableError!==void 0&&(Q=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(le=u.unstable_transitionCallbacks)),u=et(r,1,!1,null,null,m,x,M,O,Q,le,null),r[no]=u.current,ju(r.nodeType===8?r.parentNode:r),new Fy(u)},Vy.hydrateRoot=function(r,u,m){if(!p(r))throw Error(h(299));var x=!1,M="",O=ka,Q=uo,le=ho,Ae=null,Ze=null;return m!=null&&(m.unstable_strictMode===!0&&(x=!0),m.identifierPrefix!==void 0&&(M=m.identifierPrefix),m.onUncaughtError!==void 0&&(O=m.onUncaughtError),m.onCaughtError!==void 0&&(Q=m.onCaughtError),m.onRecoverableError!==void 0&&(le=m.onRecoverableError),m.unstable_transitionCallbacks!==void 0&&(Ae=m.unstable_transitionCallbacks),m.formState!==void 0&&(Ze=m.formState)),u=et(r,1,!0,u,m??null,x,M,O,Q,le,Ae,Ze),u.context=rt(null),m=u.current,x=$a(),M=Vl(x),M.callback=null,Gl(m,M,x),u.current.lanes=x,tn(u,x),Xl(u),r[no]=u.current,ju(r),new Gc(u)},Vy.version="19.0.0",Vy}var i1;function mS(){if(i1)return Uv.exports;i1=1;function i(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(i)}catch(n){console.error(n)}}return i(),Uv.exports=pS(),Uv.exports}var gS=mS();const yS=fm(gS),_S="modulepreload",vS=function(i){return"https://www.opentripplanner.org/debug-client-assets/2025/02/2025-02-21T08:26/"+i},r1={},Jw=function(n,a,h){let p=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const g=document.querySelector("meta[property=csp-nonce]"),c=(g==null?void 0:g.nonce)||(g==null?void 0:g.getAttribute("nonce"));p=Promise.allSettled(a.map(A=>{if(A=vS(A),A in r1)return;r1[A]=!0;const D=A.endsWith(".css"),N=D?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${A}"]${N}`))return;const L=document.createElement("link");if(L.rel=D?"stylesheet":_S,D||(L.as="script"),L.crossOrigin="",L.href=A,c&&L.setAttribute("nonce",c),document.head.appendChild(L),D)return new Promise((F,V)=>{L.addEventListener("load",F),L.addEventListener("error",()=>V(new Error(`Unable to preload CSS for ${A}`)))})}))}function v(g){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=g,window.dispatchEvent(c),!c.defaultPrevented)throw g}return p.then(g=>{for(const c of g||[])c.status==="rejected"&&v(c.reason);return n().catch(v)})},bS=he.createContext(null);function xS(i,n){const a=Array.isArray(i)?i[0]:i?i.x:0,h=Array.isArray(i)?i[1]:i?i.y:0,p=Array.isArray(n)?n[0]:n?n.x:0,v=Array.isArray(n)?n[1]:n?n.y:0;return a===p&&h===v}function Bs(i,n){if(i===n)return!0;if(!i||!n)return!1;if(Array.isArray(i)){if(!Array.isArray(n)||i.length!==n.length)return!1;for(let a=0;a<i.length;a++)if(!Bs(i[a],n[a]))return!1;return!0}else if(Array.isArray(n))return!1;if(typeof i=="object"&&typeof n=="object"){const a=Object.keys(i),h=Object.keys(n);if(a.length!==h.length)return!1;for(const p of a)if(!n.hasOwnProperty(p)||!Bs(i[p],n[p]))return!1;return!0}return!1}function a1(i){return{longitude:i.center.lng,latitude:i.center.lat,zoom:i.zoom,pitch:i.pitch,bearing:i.bearing,padding:i.padding}}function o1(i,n){const a=n.viewState||n,h={};if("longitude"in a&&"latitude"in a&&(a.longitude!==i.center.lng||a.latitude!==i.center.lat)){const p=i.center.constructor;h.center=new p(a.longitude,a.latitude)}return"zoom"in a&&a.zoom!==i.zoom&&(h.zoom=a.zoom),"bearing"in a&&a.bearing!==i.bearing&&(h.bearing=a.bearing),"pitch"in a&&a.pitch!==i.pitch&&(h.pitch=a.pitch),a.padding&&i.padding&&!Bs(a.padding,i.padding)&&(h.padding=a.padding),h}const wS=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function s1(i){if(!i)return null;if(typeof i=="string"||("toJS"in i&&(i=i.toJS()),!i.layers))return i;const n={};for(const h of i.layers)n[h.id]=h;const a=i.layers.map(h=>{let p=null;"interactive"in h&&(p=Object.assign({},h),delete p.interactive);const v=n[h.ref];if(v){p=p||Object.assign({},h),delete p.ref;for(const g of wS)g in v&&(p[g]=v[g])}return p||h});return{...i,layers:a}}const l1={version:8,sources:{},layers:[]},c1={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},u1={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},h1={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},TS=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],ES=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Sg{constructor(n,a,h){this._map=null,this._internalUpdate=!1,this._hoveredFeatures=null,this._propsedCameraUpdate=null,this._styleComponents={},this._onEvent=p=>{const v=this.props[h1[p.type]];v?v(p):p.type==="error"&&console.error(p.error)},this._onCameraEvent=p=>{if(this._internalUpdate)return;p.viewState=this._propsedCameraUpdate||a1(this._map.transform);const v=this.props[u1[p.type]];v&&v(p)},this._onCameraUpdate=p=>this._internalUpdate?p:(this._propsedCameraUpdate=a1(p),o1(p,this.props)),this._onPointerEvent=p=>{(p.type==="mousemove"||p.type==="mouseout")&&this._updateHover(p);const v=this.props[c1[p.type]];v&&(this.props.interactiveLayerIds&&p.type!=="mouseover"&&p.type!=="mouseout"&&(p.features=this._hoveredFeatures||this._queryRenderedFeatures(p.point)),v(p),delete p.features)},this._MapClass=n,this.props=a,this._initialize(h)}get map(){return this._map}setProps(n){const a=this.props;this.props=n;const h=this._updateSettings(n,a),p=this._updateSize(n),v=this._updateViewState(n);this._updateStyle(n,a),this._updateStyleComponents(n),this._updateHandlers(n,a),(h||p||v&&!this._map.isMoving())&&this.redraw()}static reuse(n,a){const h=Sg.savedMaps.pop();if(!h)return null;const p=h.map,v=p.getContainer();for(a.className=v.className;v.childNodes.length>0;)a.appendChild(v.childNodes[0]);p._container=a;const g=p._resizeObserver;g&&(g.disconnect(),g.observe(a)),h.setProps({...n,styleDiffing:!1}),p.resize();const{initialViewState:c}=n;return c&&(c.bounds?p.fitBounds(c.bounds,{...c.fitBoundsOptions,duration:0}):h._updateViewState(c)),p.isStyleLoaded()?p.fire("load"):p.once("style.load",()=>p.fire("load")),p._update(),h}_initialize(n){const{props:a}=this,{mapStyle:h=l1}=a,p={...a,...a.initialViewState,container:n,style:s1(h)},v=p.initialViewState||p.viewState||p;if(Object.assign(p,{center:[v.longitude||0,v.latitude||0],zoom:v.zoom||0,pitch:v.pitch||0,bearing:v.bearing||0}),a.gl){const c=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=c,a.gl)}const g=new this._MapClass(p);v.padding&&g.setPadding(v.padding),a.cursor&&(g.getCanvas().style.cursor=a.cursor),g.transformCameraUpdate=this._onCameraUpdate,g.on("style.load",()=>{var c;this._styleComponents={light:g.getLight(),sky:g.getSky(),projection:(c=g.getProjection)==null?void 0:c.call(g),terrain:g.getTerrain()},this._updateStyleComponents(this.props)}),g.on("sourcedata",()=>{this._updateStyleComponents(this.props)});for(const c in c1)g.on(c,this._onPointerEvent);for(const c in u1)g.on(c,this._onCameraEvent);for(const c in h1)g.on(c,this._onEvent);this._map=g}recycle(){const a=this.map.getContainer().querySelector("[mapboxgl-children]");a==null||a.remove(),Sg.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const n=this._map;n.style&&(n._frame&&(n._frame.cancel(),n._frame=null),n._render())}_updateSize(n){const{viewState:a}=n;if(a){const h=this._map;if(a.width!==h.transform.width||a.height!==h.transform.height)return h.resize(),!0}return!1}_updateViewState(n){const a=this._map,h=a.transform;if(!a.isMoving()){const v=o1(h,n);if(Object.keys(v).length>0)return this._internalUpdate=!0,a.jumpTo(v),this._internalUpdate=!1,!0}return!1}_updateSettings(n,a){const h=this._map;let p=!1;for(const v of TS)if(v in n&&!Bs(n[v],a[v])){p=!0;const g=h[`set${v[0].toUpperCase()}${v.slice(1)}`];g==null||g.call(h,n[v])}return p}_updateStyle(n,a){if(n.cursor!==a.cursor&&(this._map.getCanvas().style.cursor=n.cursor||""),n.mapStyle!==a.mapStyle){const{mapStyle:h=l1,styleDiffing:p=!0}=n,v={diff:p};"localIdeographFontFamily"in n&&(v.localIdeographFontFamily=n.localIdeographFontFamily),this._map.setStyle(s1(h),v)}}_updateStyleComponents({light:n,projection:a,sky:h,terrain:p}){var c,A;const v=this._map,g=this._styleComponents;v.style._loaded&&(n&&!Bs(n,g.light)&&(g.light=n,v.setLight(n)),a&&!Bs(a,g.projection)&&a!==((c=g.projection)==null?void 0:c.type)&&(g.projection=typeof a=="string"?{type:a}:a,(A=v.setProjection)==null||A.call(v,g.projection)),h&&!Bs(h,g.sky)&&(g.sky=h,v.setSky(h)),p!==void 0&&!Bs(p,g.terrain)&&(!p||v.getSource(p.source))&&(g.terrain=p,v.setTerrain(p)))}_updateHandlers(n,a){const h=this._map;for(const p of ES){const v=n[p]??!0,g=a[p]??!0;Bs(v,g)||(v?h[p].enable(v):h[p].disable())}}_queryRenderedFeatures(n){const a=this._map,{interactiveLayerIds:h=[]}=this.props;try{return a.queryRenderedFeatures(n,{layers:h.filter(a.getLayer.bind(a))})}catch{return[]}}_updateHover(n){var p;const{props:a}=this;if(a.interactiveLayerIds&&(a.onMouseMove||a.onMouseEnter||a.onMouseLeave)){const v=n.type,g=((p=this._hoveredFeatures)==null?void 0:p.length)>0,c=this._queryRenderedFeatures(n.point),A=c.length>0;!A&&g&&(n.type="mouseleave",this._onPointerEvent(n)),this._hoveredFeatures=c,A&&!g&&(n.type="mouseenter",this._onPointerEvent(n)),n.type=v}else this._hoveredFeatures=null}}Sg.savedMaps=[];const SS=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function AS(i){if(!i)return null;const n=i.map,a={getMap:()=>n};for(const h of CS(n))!(h in a)&&!SS.includes(h)&&(a[h]=n[h].bind(n));return a}function CS(i){const n=new Set;let a=i;for(;a;){for(const h of Object.getOwnPropertyNames(a))h[0]!=="_"&&typeof i[h]=="function"&&h!=="fire"&&h!=="setEventedParent"&&n.add(h);a=Object.getPrototypeOf(a)}return Array.from(n)}const MS=typeof document<"u"?he.useLayoutEffect:he.useEffect;function DS(i,n){const{RTLTextPlugin:a,maxParallelImageRequests:h,workerCount:p,workerUrl:v}=n;if(a&&i.getRTLTextPluginStatus&&i.getRTLTextPluginStatus()==="unavailable"){const{pluginUrl:g,lazy:c=!0}=typeof a=="string"?{pluginUrl:a}:a;i.setRTLTextPlugin(g,A=>{A&&console.error(A)},c)}h!==void 0&&i.setMaxParallelImageRequests(h),p!==void 0&&i.setWorkerCount(p),v!==void 0&&i.setWorkerUrl(v)}const jg=he.createContext(null);function IS(i,n){const a=he.useContext(bS),[h,p]=he.useState(null),v=he.useRef(),{current:g}=he.useRef({mapLib:null,map:null});he.useEffect(()=>{const D=i.mapLib;let N=!0,L;return Promise.resolve(D||Jw(()=>Promise.resolve().then(()=>rT),void 0)).then(F=>{if(!N)return;if(!F)throw new Error("Invalid mapLib");const V="Map"in F?F:F.default;if(!V.Map)throw new Error("Invalid mapLib");if(DS(V,i),!V.supported||V.supported(i))i.reuseMaps&&(L=Sg.reuse(i,v.current)),L||(L=new Sg(V.Map,i,v.current)),g.map=AS(L),g.mapLib=V,p(L),a==null||a.onMapMount(g.map,i.id);else throw new Error("Map is not supported by this browser")}).catch(F=>{const{onError:V}=i;V?V({type:"error",target:null,originalEvent:null,error:F}):console.error(F)}),()=>{N=!1,L&&(a==null||a.onMapUnmount(i.id),i.reuseMaps?L.recycle():L.destroy())}},[]),MS(()=>{h&&h.setProps(i)}),he.useImperativeHandle(n,()=>g.map,[h]);const c=he.useMemo(()=>({position:"relative",width:"100%",height:"100%",...i.style}),[i.style]),A={height:"100%"};return he.createElement("div",{id:i.id,ref:v,style:c},h&&he.createElement(jg.Provider,{value:g},he.createElement("div",{"mapboxgl-children":"",style:A},i.children)))}const kS=he.forwardRef(IS);var Hb=Kw();const Wp=fm(Hb),RS=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function md(i,n){if(!i||!n)return;const a=i.style;for(const h in n){const p=n[h];Number.isFinite(p)&&!RS.test(h)?a[h]=`${p}px`:a[h]=p}}const d1=he.memo(he.forwardRef((i,n)=>{const{map:a,mapLib:h}=he.useContext(jg),p=he.useRef({props:i});p.current.props=i;const v=he.useMemo(()=>{let J=!1;he.Children.forEach(i.children,ve=>{ve&&(J=!0)});const ae={...i,element:J?document.createElement("div"):null},fe=new h.Marker(ae);return fe.setLngLat([i.longitude,i.latitude]),fe.getElement().addEventListener("click",ve=>{var Ce,Me;(Me=(Ce=p.current.props).onClick)==null||Me.call(Ce,{type:"click",target:fe,originalEvent:ve})}),fe.on("dragstart",ve=>{var Me,Te;const Ce=ve;Ce.lngLat=v.getLngLat(),(Te=(Me=p.current.props).onDragStart)==null||Te.call(Me,Ce)}),fe.on("drag",ve=>{var Me,Te;const Ce=ve;Ce.lngLat=v.getLngLat(),(Te=(Me=p.current.props).onDrag)==null||Te.call(Me,Ce)}),fe.on("dragend",ve=>{var Me,Te;const Ce=ve;Ce.lngLat=v.getLngLat(),(Te=(Me=p.current.props).onDragEnd)==null||Te.call(Me,Ce)}),fe},[]);he.useEffect(()=>(v.addTo(a.getMap()),()=>{v.remove()}),[]);const{longitude:g,latitude:c,offset:A,style:D,draggable:N=!1,popup:L=null,rotation:F=0,rotationAlignment:V="auto",pitchAlignment:$="auto"}=i;return he.useEffect(()=>{md(v.getElement(),D)},[D]),he.useImperativeHandle(n,()=>v,[]),(v.getLngLat().lng!==g||v.getLngLat().lat!==c)&&v.setLngLat([g,c]),A&&!xS(v.getOffset(),A)&&v.setOffset(A),v.isDraggable()!==N&&v.setDraggable(N),v.getRotation()!==F&&v.setRotation(F),v.getRotationAlignment()!==V&&v.setRotationAlignment(V),v.getPitchAlignment()!==$&&v.setPitchAlignment($),v.getPopup()!==L&&v.setPopup(L),Hb.createPortal(i.children,v.getElement())}));function f1(i){return new Set(i?i.trim().split(/\s+/):[])}const eT=he.memo(he.forwardRef((i,n)=>{const{map:a,mapLib:h}=he.useContext(jg),p=he.useMemo(()=>document.createElement("div"),[]),v=he.useRef({props:i});v.current.props=i;const g=he.useMemo(()=>{const c={...i},A=new h.Popup(c);return A.setLngLat([i.longitude,i.latitude]),A.once("open",D=>{var N,L;(L=(N=v.current.props).onOpen)==null||L.call(N,D)}),A},[]);if(he.useEffect(()=>{const c=A=>{var D,N;(N=(D=v.current.props).onClose)==null||N.call(D,A)};return g.on("close",c),g.setDOMContent(p).addTo(a.getMap()),()=>{g.off("close",c),g.isOpen()&&g.remove()}},[]),he.useEffect(()=>{md(g.getElement(),i.style)},[i.style]),he.useImperativeHandle(n,()=>g,[]),g.isOpen()&&((g.getLngLat().lng!==i.longitude||g.getLngLat().lat!==i.latitude)&&g.setLngLat([i.longitude,i.latitude]),i.offset&&!Bs(g.options.offset,i.offset)&&g.setOffset(i.offset),(g.options.anchor!==i.anchor||g.options.maxWidth!==i.maxWidth)&&(g.options.anchor=i.anchor,g.setMaxWidth(i.maxWidth)),g.options.className!==i.className)){const c=f1(g.options.className),A=f1(i.className);for(const D of c)A.has(D)||g.removeClassName(D);for(const D of A)c.has(D)||g.addClassName(D);g.options.className=i.className}return Hb.createPortal(i.children,p)}));function pm(i,n,a,h){const p=he.useContext(jg),v=he.useMemo(()=>i(p),[]);return he.useEffect(()=>{const g=n,c=null,A=typeof n=="function"?n:null,{map:D}=p;return D.hasControl(v)||(D.addControl(v,g==null?void 0:g.position),c&&c(p)),()=>{A&&A(p),D.hasControl(v)&&D.removeControl(v)}},[]),v}function NS(i){const n=pm(({mapLib:a})=>new a.AttributionControl(i),{position:i.position});return he.useEffect(()=>{md(n._container,i.style)},[i.style]),null}he.memo(NS);function PS(i){const n=pm(({mapLib:a})=>new a.FullscreenControl({container:i.containerId&&document.getElementById(i.containerId)}),{position:i.position});return he.useEffect(()=>{md(n._controlContainer,i.style)},[i.style]),null}he.memo(PS);function zS(i,n){const a=he.useRef({props:i}),h=pm(({mapLib:p})=>{const v=new p.GeolocateControl(i),g=v._setupUI;return v._setupUI=()=>{v._container.hasChildNodes()||g()},v.on("geolocate",c=>{var A,D;(D=(A=a.current.props).onGeolocate)==null||D.call(A,c)}),v.on("error",c=>{var A,D;(D=(A=a.current.props).onError)==null||D.call(A,c)}),v.on("outofmaxbounds",c=>{var A,D;(D=(A=a.current.props).onOutOfMaxBounds)==null||D.call(A,c)}),v.on("trackuserlocationstart",c=>{var A,D;(D=(A=a.current.props).onTrackUserLocationStart)==null||D.call(A,c)}),v.on("trackuserlocationend",c=>{var A,D;(D=(A=a.current.props).onTrackUserLocationEnd)==null||D.call(A,c)}),v},{position:i.position});return a.current.props=i,he.useImperativeHandle(n,()=>h,[]),he.useEffect(()=>{md(h._container,i.style)},[i.style]),null}he.memo(he.forwardRef(zS));function OS(i){const n=pm(({mapLib:a})=>new a.NavigationControl(i),{position:i.position});return he.useEffect(()=>{md(n._container,i.style)},[i.style]),null}const LS=he.memo(OS);function BS(i){const n=pm(({mapLib:v})=>new v.ScaleControl(i),{position:i.position}),a=he.useRef(i),h=a.current;a.current=i;const{style:p}=i;return i.maxWidth!==void 0&&i.maxWidth!==h.maxWidth&&(n.options.maxWidth=i.maxWidth),i.unit!==void 0&&i.unit!==h.unit&&n.setUnit(i.unit),he.useEffect(()=>{md(n._container,p)},[p]),null}he.memo(BS);function jS(i){const n=pm(({mapLib:a})=>new a.TerrainControl(i),{position:i.position});return he.useEffect(()=>{md(n._container,i.style)},[i.style]),null}he.memo(jS);function FS(i){const n=pm(({mapLib:a})=>new a.LogoControl(i),{position:i.position});return he.useEffect(()=>{md(n._container,i.style)},[i.style]),null}he.memo(FS);function P0(i,n){if(!i)throw new Error(n)}let US=0;function VS(i,n,a){if(i.style&&i.style._loaded){const h={...a};return delete h.id,delete h.children,i.addSource(n,h),i.getSource(n)}return null}function GS(i,n,a){var g,c,A;P0(n.id===a.id,"source id changed"),P0(n.type===a.type,"source type changed");let h="",p=0;for(const D in n)D!=="children"&&D!=="id"&&!Bs(a[D],n[D])&&(h=D,p++);if(!p)return;const v=n.type;if(v==="geojson")i.setData(n.data);else if(v==="image")i.updateImage({url:n.url,coordinates:n.coordinates});else switch(h){case"coordinates":(g=i.setCoordinates)==null||g.call(i,n.coordinates);break;case"url":(c=i.setUrl)==null||c.call(i,n.url);break;case"tiles":(A=i.setTiles)==null||A.call(i,n.tiles);break;default:console.warn(`Unable to update <Source> prop: ${h}`)}}function ZS(i){const n=he.useContext(jg).map.getMap(),a=he.useRef(i),[,h]=he.useState(0),p=he.useMemo(()=>i.id||`jsx-source-${US++}`,[]);he.useEffect(()=>{if(n){const g=()=>setTimeout(()=>h(c=>c+1),0);return n.on("styledata",g),g(),()=>{var c;if(n.off("styledata",g),n.style&&n.style._loaded&&n.getSource(p)){const A=(c=n.getStyle())==null?void 0:c.layers;if(A)for(const D of A)D.source===p&&n.removeLayer(D.id);n.removeSource(p)}}}},[n]);let v=n&&n.style&&n.getSource(p);return v?GS(v,i,a.current):v=VS(n,p,i),a.current=i,v&&he.Children.map(i.children,g=>g&&he.cloneElement(g,{source:p}))||null}function $S(i,n,a,h){if(P0(a.id===h.id,"layer id changed"),P0(a.type===h.type,"layer type changed"),a.type==="custom"||h.type==="custom")return;const{layout:p={},paint:v={},filter:g,minzoom:c,maxzoom:A,beforeId:D}=a;if(D!==h.beforeId&&i.moveLayer(n,D),p!==h.layout){const N=h.layout||{};for(const L in p)Bs(p[L],N[L])||i.setLayoutProperty(n,L,p[L]);for(const L in N)p.hasOwnProperty(L)||i.setLayoutProperty(n,L,void 0)}if(v!==h.paint){const N=h.paint||{};for(const L in v)Bs(v[L],N[L])||i.setPaintProperty(n,L,v[L]);for(const L in N)v.hasOwnProperty(L)||i.setPaintProperty(n,L,void 0)}Bs(g,h.filter)||i.setFilter(n,g),(c!==h.minzoom||A!==h.maxzoom)&&i.setLayerZoomRange(n,c,A)}function YS(i,n,a){if(i.style&&i.style._loaded&&(!("source"in a)||i.getSource(a.source))){const h={...a,id:n};delete h.beforeId,i.addLayer(h,a.beforeId)}}let qS=0;function p1(i){const n=he.useContext(jg).map.getMap(),a=he.useRef(i),[,h]=he.useState(0),p=he.useMemo(()=>i.id||`jsx-layer-${qS++}`,[]);if(he.useEffect(()=>{if(n){const g=()=>h(c=>c+1);return n.on("styledata",g),g(),()=>{n.off("styledata",g),n.style&&n.style._loaded&&n.getLayer(p)&&n.removeLayer(p)}}},[n]),n&&n.style&&n.getLayer(p))try{$S(n,p,i,a.current)}catch(g){console.warn(g)}else YS(n,p,i);return a.current=i,null}var E0={exports:{}};/**
 * MapLibre GL JS
 * @license 3-Clause BSD. Full text of license: https://github.com/maplibre/maplibre-gl-js/blob/v5.1.0/LICENSE.txt
 */var HS=E0.exports,m1;function XS(){return m1||(m1=1,function(i,n){(function(a,h){i.exports=h()})(HS,function(){var a={},h={};function p(g,c,A){if(h[g]=A,g==="index"){var D="var sharedModule = {}; ("+h.shared+")(sharedModule); ("+h.worker+")(sharedModule);",N={};return h.shared(N),h.index(a,N),typeof window<"u"&&a.setWorkerUrl(window.URL.createObjectURL(new Blob([D],{type:"text/javascript"}))),a}}p("shared",["exports"],function(g){function c(l,t,s,d){return new(s||(s=Promise))(function(_,T){function E(B){try{R(d.next(B))}catch(U){T(U)}}function C(B){try{R(d.throw(B))}catch(U){T(U)}}function R(B){var U;B.done?_(B.value):(U=B.value,U instanceof s?U:new s(function(G){G(U)})).then(E,C)}R((d=d.apply(l,t||[])).next())})}function A(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var D,N;function L(){if(N)return D;function l(t,s){this.x=t,this.y=s}return N=1,D=l,l.prototype={clone:function(){return new l(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,s){return this.clone()._rotateAround(t,s)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var s=t.x-this.x,d=t.y-this.y;return s*s+d*d},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,s){return Math.atan2(this.x*s-this.y*t,this.x*t+this.y*s)},_matMult:function(t){var s=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=s,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var s=Math.cos(t),d=Math.sin(t),_=d*this.x+s*this.y;return this.x=s*this.x-d*this.y,this.y=_,this},_rotateAround:function(t,s){var d=Math.cos(t),_=Math.sin(t),T=s.y+_*(this.x-s.x)+d*(this.y-s.y);return this.x=s.x+d*(this.x-s.x)-_*(this.y-s.y),this.y=T,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},l.convert=function(t){return t instanceof l?t:Array.isArray(t)?new l(t[0],t[1]):t},D}typeof SuppressedError=="function"&&SuppressedError;var F,V,$=A(L()),J=function(){if(V)return F;function l(t,s,d,_){this.cx=3*t,this.bx=3*(d-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(_-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=s,this.p2x=d,this.p2y=_}return V=1,F=l,l.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,s){if(s===void 0&&(s=1e-6),t<0)return 0;if(t>1)return 1;for(var d=t,_=0;_<8;_++){var T=this.sampleCurveX(d)-t;if(Math.abs(T)<s)return d;var E=this.sampleCurveDerivativeX(d);if(Math.abs(E)<1e-6)break;d-=T/E}var C=0,R=1;for(d=t,_=0;_<20&&(T=this.sampleCurveX(d),!(Math.abs(T-t)<s));_++)t>T?C=d:R=d,d=.5*(R-C)+C;return d},solve:function(t,s){return this.sampleCurveY(this.solveCurveX(t,s))}},F}(),ae=A(J);let fe,ve;function Ce(){return fe==null&&(fe=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),fe}function Me(){if(ve==null&&(ve=!1,Ce())){const t=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(t){for(let d=0;d<5*5;d++){const _=4*d;t.fillStyle=`rgb(${_},${_+1},${_+2})`,t.fillRect(d%5,Math.floor(d/5),1,1)}const s=t.getImageData(0,0,5,5).data;for(let d=0;d<5*5*4;d++)if(d%4!=3&&s[d]!==d){ve=!0;break}}}return ve||!1}var Te,De=1e-6,Ne=typeof Float32Array<"u"?Float32Array:Array;function je(){var l=new Ne(9);return Ne!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[5]=0,l[6]=0,l[7]=0),l[0]=1,l[4]=1,l[8]=1,l}function ye(l){return l[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l}function Qe(){var l=new Ne(3);return Ne!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l}function bt(l,t,s){var d=new Ne(3);return d[0]=l,d[1]=t,d[2]=s,d}function Ot(l,t,s){var d=t[0],_=t[1],T=t[2],E=t[3];return l[0]=s[0]*d+s[4]*_+s[8]*T+s[12]*E,l[1]=s[1]*d+s[5]*_+s[9]*T+s[13]*E,l[2]=s[2]*d+s[6]*_+s[10]*T+s[14]*E,l[3]=s[3]*d+s[7]*_+s[11]*T+s[15]*E,l}function mt(){var l=new Ne(4);return Ne!=Float32Array&&(l[0]=0,l[1]=0,l[2]=0),l[3]=1,l}function Dt(){var l=new Ne(2);return Ne!=Float32Array&&(l[0]=0,l[1]=0),l}function vt(l,t){var s=new Ne(2);return s[0]=l,s[1]=t,s}Math.hypot||(Math.hypot=function(){for(var l=0,t=arguments.length;t--;)l+=arguments[t]*arguments[t];return Math.sqrt(l)}),Qe(),Te=new Ne(4),Ne!=Float32Array&&(Te[0]=0,Te[1]=0,Te[2]=0,Te[3]=0),Qe(),bt(1,0,0),bt(0,1,0),mt(),mt(),je(),Dt();const Ge=8192;function dt(l,t,s){return t*(Ge/(l.tileSize*Math.pow(2,s-l.tileID.overscaledZ)))}function ot(l,t){return(l%t+t)%t}function Ut(l,t,s){return l*(1-s)+t*s}function Ie(l){if(l<=0)return 0;if(l>=1)return 1;const t=l*l,s=t*l;return 4*(l<.5?s:3*(l-t)+s-.75)}function ut(l,t,s,d){const _=new ae(l,t,s,d);return T=>_.solve(T)}const Bt=ut(.25,.1,.25,1);function Lt(l,t,s){return Math.min(s,Math.max(t,l))}function Tt(l,t,s){const d=s-t,_=((l-t)%d+d)%d+t;return _===t?s:_}function jt(l,...t){for(const s of t)for(const d in s)l[d]=s[d];return l}let qt=1;function Sn(l,t,s){const d={};for(const _ in l)d[_]=t.call(this,l[_],_,l);return d}function dn(l,t,s){const d={};for(const _ in l)t.call(this,l[_],_,l)&&(d[_]=l[_]);return d}function An(l){return Array.isArray(l)?l.map(An):typeof l=="object"&&l?Sn(l,An):l}const Un={};function Wn(l){Un[l]||(typeof console<"u"&&console.warn(l),Un[l]=!0)}function ai(l,t,s){return(s.y-l.y)*(t.x-l.x)>(t.y-l.y)*(s.x-l.x)}function Ni(l){return typeof WorkerGlobalScope<"u"&&l!==void 0&&l instanceof WorkerGlobalScope}let ci=null;function Jn(l){return typeof ImageBitmap<"u"&&l instanceof ImageBitmap}const Xr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function kr(l,t,s,d,_){return c(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const T=new VideoFrame(l,{timestamp:0});try{const E=T==null?void 0:T.format;if(!E||!E.startsWith("BGR")&&!E.startsWith("RGB"))throw new Error(`Unrecognized format ${E}`);const C=E.startsWith("BGR"),R=new Uint8ClampedArray(d*_*4);if(yield T.copyTo(R,function(B,U,G,q,W){const K=4*Math.max(1,0),ne=(Math.max(0,G)-G)*q*4+K,ue=4*q,_e=Math.max(0,U),Le=Math.max(0,G);return{rect:{x:_e,y:Le,width:Math.min(B.width,U+q)-_e,height:Math.min(B.height,G+W)-Le},layout:[{offset:ne,stride:ue}]}}(l,t,s,d,_)),C)for(let B=0;B<R.length;B+=4){const U=R[B];R[B]=R[B+2],R[B+2]=U}return R}finally{T.close()}})}let eo,Co;function ar(l){return l/Math.PI*180}const ja="AbortError";function xs(){return new Error(ja)}const Wo={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};function Wr(l){return Wo.REGISTERED_PROTOCOLS[l.substring(0,l.indexOf("://"))]}const ws="global-dispatcher";class to extends Error{constructor(t,s,d,_){super(`AJAXError: ${s} (${t}): ${d}`),this.status=t,this.statusText=s,this.url=d,this.body=_}}const Qo=()=>Ni(self)?self.worker&&self.worker.referrer:(window.location.protocol==="blob:"?window.parent:window).location.href,Ea=function(l,t){if(/:\/\//.test(l.url)&&!/^https?:|^file:/.test(l.url)){const d=Wr(l.url);if(d)return d(l,t);if(Ni(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:l,targetMapId:ws},t)}if(!(/^file:/.test(s=l.url)||/^file:/.test(Qo())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return function(d,_){return c(this,void 0,void 0,function*(){const T=new Request(d.url,{method:d.method||"GET",body:d.body,credentials:d.credentials,headers:d.headers,cache:d.cache,referrer:Qo(),signal:_.signal});let E,C;d.type!=="json"||T.headers.has("Accept")||T.headers.set("Accept","application/json");try{E=yield fetch(T)}catch(B){throw new to(0,B.message,d.url,new Blob)}if(!E.ok){const B=yield E.blob();throw new to(E.status,E.statusText,d.url,B)}C=d.type==="arrayBuffer"||d.type==="image"?E.arrayBuffer():d.type==="json"?E.json():E.text();const R=yield C;if(_.signal.aborted)throw xs();return{data:R,cacheControl:E.headers.get("Cache-Control"),expires:E.headers.get("Expires")}})}(l,t);if(Ni(self)&&self.worker&&self.worker.actor)return self.worker.actor.sendAsync({type:"GR",data:l,mustQueue:!0,targetMapId:ws},t)}var s;return function(d,_){return new Promise((T,E)=>{var C;const R=new XMLHttpRequest;R.open(d.method||"GET",d.url,!0),d.type!=="arrayBuffer"&&d.type!=="image"||(R.responseType="arraybuffer");for(const B in d.headers)R.setRequestHeader(B,d.headers[B]);d.type==="json"&&(R.responseType="text",!((C=d.headers)===null||C===void 0)&&C.Accept||R.setRequestHeader("Accept","application/json")),R.withCredentials=d.credentials==="include",R.onerror=()=>{E(new Error(R.statusText))},R.onload=()=>{if(!_.signal.aborted)if((R.status>=200&&R.status<300||R.status===0)&&R.response!==null){let B=R.response;if(d.type==="json")try{B=JSON.parse(R.response)}catch(U){return void E(U)}T({data:B,cacheControl:R.getResponseHeader("Cache-Control"),expires:R.getResponseHeader("Expires")})}else{const B=new Blob([R.response],{type:R.getResponseHeader("Content-Type")});E(new to(R.status,R.statusText,d.url,B))}},_.signal.addEventListener("abort",()=>{R.abort(),E(xs())}),R.send(d.body)})}(l,t)};function ac(l){if(!l||l.indexOf("://")<=0||l.indexOf("data:image/")===0||l.indexOf("blob:")===0)return!0;const t=new URL(l),s=window.location;return t.protocol===s.protocol&&t.host===s.host}function Gs(l,t,s){s[l]&&s[l].indexOf(t)!==-1||(s[l]=s[l]||[],s[l].push(t))}function tu(l,t,s){if(s&&s[l]){const d=s[l].indexOf(t);d!==-1&&s[l].splice(d,1)}}class nu{constructor(t,s={}){jt(this,s),this.type=t}}class Zs extends nu{constructor(t,s={}){super("error",jt({error:t},s))}}class Rr{on(t,s){return this._listeners=this._listeners||{},Gs(t,s,this._listeners),{unsubscribe:()=>{this.off(t,s)}}}off(t,s){return tu(t,s,this._listeners),tu(t,s,this._oneTimeListeners),this}once(t,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Gs(t,s,this._oneTimeListeners),this):new Promise(d=>this.once(t,d))}fire(t,s){typeof t=="string"&&(t=new nu(t,s||{}));const d=t.type;if(this.listens(d)){t.target=this;const _=this._listeners&&this._listeners[d]?this._listeners[d].slice():[];for(const C of _)C.call(this,t);const T=this._oneTimeListeners&&this._oneTimeListeners[d]?this._oneTimeListeners[d].slice():[];for(const C of T)tu(d,C,this._oneTimeListeners),C.call(this,t);const E=this._eventedParent;E&&(jt(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),E.fire(t))}else t instanceof Zs&&console.error(t.error);return this}listens(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)}setEventedParent(t,s){return this._eventedParent=t,this._eventedParentData=s,this}}var de={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},centerAltitude:{type:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},roll:{type:"number",default:0,units:"degrees"},light:{type:"light"},sky:{type:"sky"},projection:{type:"projection"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},sky:{"sky-color":{type:"color","property-type":"data-constant",default:"#88C6FC",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-color":{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"fog-ground-blend":{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-fog-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"sky-horizon-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"atmosphere-blend":{type:"number","property-type":"data-constant",default:.8,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},projection:{type:{type:"projectionDefinition",default:"mercator","property-type":"data-constant",transition:!1,expression:{interpolated:!0,parameters:["zoom"]}}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const te=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function re(l,t){const s={};for(const d in l)d!=="ref"&&(s[d]=l[d]);return te.forEach(d=>{d in t&&(s[d]=t[d])}),s}function oe(l,t){if(Array.isArray(l)){if(!Array.isArray(t)||l.length!==t.length)return!1;for(let s=0;s<l.length;s++)if(!oe(l[s],t[s]))return!1;return!0}if(typeof l=="object"&&l!==null&&t!==null){if(typeof t!="object"||Object.keys(l).length!==Object.keys(t).length)return!1;for(const s in l)if(!oe(l[s],t[s]))return!1;return!0}return l===t}function xe(l,t){l.push(t)}function ze(l,t,s){xe(s,{command:"addSource",args:[l,t[l]]})}function Ve(l,t,s){xe(t,{command:"removeSource",args:[l]}),s[l]=!0}function We(l,t,s,d){Ve(l,s,d),ze(l,t,s)}function Fe(l,t,s){let d;for(d in l[s])if(Object.prototype.hasOwnProperty.call(l[s],d)&&d!=="data"&&!oe(l[s][d],t[s][d]))return!1;for(d in t[s])if(Object.prototype.hasOwnProperty.call(t[s],d)&&d!=="data"&&!oe(l[s][d],t[s][d]))return!1;return!0}function at(l,t,s,d,_,T){l=l||{},t=t||{};for(const E in l)Object.prototype.hasOwnProperty.call(l,E)&&(oe(l[E],t[E])||s.push({command:T,args:[d,E,t[E],_]}));for(const E in t)Object.prototype.hasOwnProperty.call(t,E)&&!Object.prototype.hasOwnProperty.call(l,E)&&(oe(l[E],t[E])||s.push({command:T,args:[d,E,t[E],_]}))}function tt(l){return l.id}function $e(l,t){return l[t.id]=t,l}class Be{constructor(t,s,d,_){this.message=(t?`${t}: `:"")+d,_&&(this.identifier=_),s!=null&&s.__line__&&(this.line=s.__line__)}}function Rt(l,...t){for(const s of t)for(const d in s)l[d]=s[d];return l}class It extends Error{constructor(t,s){super(s),this.message=s,this.key=t}}class tn{constructor(t,s=[]){this.parent=t,this.bindings={};for(const[d,_]of s)this.bindings[d]=_}concat(t){return new tn(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const fn={kind:"null"},ct={kind:"number"},Pt={kind:"string"},Yt={kind:"boolean"},Cn={kind:"color"},Zn={kind:"projectionDefinition"},en={kind:"object"},Nt={kind:"value"},$n={kind:"collator"},no={kind:"formatted"},Ar={kind:"padding"},Nr={kind:"resolvedImage"},Fi={kind:"variableAnchorOffsetCollection"};function Fa(l,t){return{kind:"array",itemType:l,N:t}}function wi(l){if(l.kind==="array"){const t=wi(l.itemType);return typeof l.N=="number"?`array<${t}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${t}>`}return l.kind}const oc=[fn,ct,Pt,Yt,Cn,Zn,no,en,Fa(Nt),Ar,Nr,Fi];function Mo(l,t){if(t.kind==="error")return null;if(l.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Mo(l.itemType,t.itemType))&&(typeof l.N!="number"||l.N===t.N))return null}else{if(l.kind===t.kind)return null;if(l.kind==="value"){for(const s of oc)if(!Mo(s,t))return null}}return`Expected ${wi(l)} but found ${wi(t)} instead.`}function vl(l,t){return t.some(s=>s.kind===l.kind)}function Ko(l,t){return t.some(s=>s==="null"?l===null:s==="array"?Array.isArray(l):s==="object"?l&&!Array.isArray(l)&&typeof l=="object":s===typeof l)}function Do(l,t){return l.kind==="array"&&t.kind==="array"?l.itemType.kind===t.itemType.kind&&typeof l.N=="number":l.kind===t.kind}const Zr=.96422,yd=.82521,Uf=4/29,Io=6/29,sc=3*Io*Io,$s=Io*Io*Io,Kg=Math.PI/180,vm=180/Math.PI;function Vf(l){return(l%=360)<0&&(l+=360),l}function Gf([l,t,s,d]){let _,T;const E=iu((.2225045*(l=Ts(l))+.7168786*(t=Ts(t))+.0606169*(s=Ts(s)))/1);l===t&&t===s?_=T=E:(_=iu((.4360747*l+.3850649*t+.1430804*s)/Zr),T=iu((.0139322*l+.0971045*t+.7141733*s)/yd));const C=116*E-16;return[C<0?0:C,500*(_-E),200*(E-T),d]}function Ts(l){return l<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function iu(l){return l>$s?Math.pow(l,1/3):l/sc+Uf}function Es([l,t,s,d]){let _=(l+16)/116,T=isNaN(t)?_:_+t/500,E=isNaN(s)?_:_-s/200;return _=1*_d(_),T=Zr*_d(T),E=yd*_d(E),[Qr(3.1338561*T-1.6168667*_-.4906146*E),Qr(-.9787684*T+1.9161415*_+.033454*E),Qr(.0719453*T-.2289914*_+1.4052427*E),d]}function Qr(l){return(l=l<=.00304?12.92*l:1.055*Math.pow(l,1/2.4)-.055)<0?0:l>1?1:l}function _d(l){return l>Io?l*l*l:sc*(l-Uf)}function vd(l){return parseInt(l.padEnd(2,l),16)/255}function ah(l,t){return bl(t?l/100:l,0,1)}function bl(l,t,s){return Math.min(Math.max(t,l),s)}function ru(l){return!l.some(Number.isNaN)}const Ss={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function hn(l,t,s){return l+s*(t-l)}function ko(l,t,s){return l.map((d,_)=>hn(d,t[_],s))}class Dn{constructor(t,s,d,_=1,T=!0){this.r=t,this.g=s,this.b=d,this.a=_,T||(this.r*=_,this.g*=_,this.b*=_,_||this.overwriteGetter("rgb",[t,s,d,_]))}static parse(t){if(t instanceof Dn)return t;if(typeof t!="string")return;const s=function(d){if((d=d.toLowerCase().trim())==="transparent")return[0,0,0,0];const _=Ss[d];if(_){const[E,C,R]=_;return[E/255,C/255,R/255,1]}if(d.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(d)){const E=d.length<6?1:2;let C=1;return[vd(d.slice(C,C+=E)),vd(d.slice(C,C+=E)),vd(d.slice(C,C+=E)),vd(d.slice(C,C+E)||"ff")]}if(d.startsWith("rgb")){const E=d.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(E){const[C,R,B,U,G,q,W,K,ne,ue,_e,Le]=E,we=[U||" ",W||" ",ue].join("");if(we==="  "||we==="  /"||we===",,"||we===",,,"){const X=[B,q,ne].join(""),ce=X==="%%%"?100:X===""?255:0;if(ce){const Ee=[bl(+R/ce,0,1),bl(+G/ce,0,1),bl(+K/ce,0,1),_e?ah(+_e,Le):1];if(ru(Ee))return Ee}}return}}const T=d.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(T){const[E,C,R,B,U,G,q,W,K]=T,ne=[R||" ",U||" ",q].join("");if(ne==="  "||ne==="  /"||ne===",,"||ne===",,,"){const ue=[+C,bl(+B,0,100),bl(+G,0,100),W?ah(+W,K):1];if(ru(ue))return function([_e,Le,we,X]){function ce(Ee){const qe=(Ee+_e/30)%12,yt=Le*Math.min(we,1-we);return we-yt*Math.max(-1,Math.min(qe-3,9-qe,1))}return _e=Vf(_e),Le/=100,we/=100,[ce(0),ce(8),ce(4),X]}(ue)}}}(t);return s?new Dn(...s,!1):void 0}get rgb(){const{r:t,g:s,b:d,a:_}=this,T=_||1/0;return this.overwriteGetter("rgb",[t/T,s/T,d/T,_])}get hcl(){return this.overwriteGetter("hcl",function(t){const[s,d,_,T]=Gf(t),E=Math.sqrt(d*d+_*_);return[Math.round(1e4*E)?Vf(Math.atan2(_,d)*vm):NaN,E,s,T]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Gf(this.rgb))}overwriteGetter(t,s){return Object.defineProperty(this,t,{value:s}),s}toString(){const[t,s,d,_]=this.rgb;return`rgba(${[t,s,d].map(T=>Math.round(255*T)).join(",")},${_})`}static interpolate(t,s,d,_="rgb"){switch(_){case"rgb":{const[T,E,C,R]=ko(t.rgb,s.rgb,d);return new Dn(T,E,C,R,!1)}case"hcl":{const[T,E,C,R]=t.hcl,[B,U,G,q]=s.hcl;let W,K;if(isNaN(T)||isNaN(B))isNaN(T)?isNaN(B)?W=NaN:(W=B,C!==1&&C!==0||(K=U)):(W=T,G!==1&&G!==0||(K=E));else{let we=B-T;B>T&&we>180?we-=360:B<T&&T-B>180&&(we+=360),W=T+d*we}const[ne,ue,_e,Le]=function([we,X,ce,Ee]){return we=isNaN(we)?0:we*Kg,Es([ce,Math.cos(we)*X,Math.sin(we)*X,Ee])}([W,K??hn(E,U,d),hn(C,G,d),hn(R,q,d)]);return new Dn(ne,ue,_e,Le,!1)}case"lab":{const[T,E,C,R]=Es(ko(t.lab,s.lab,d));return new Dn(T,E,C,R,!1)}}}}Dn.black=new Dn(0,0,0,1),Dn.white=new Dn(1,1,1,1),Dn.transparent=new Dn(0,0,0,0),Dn.red=new Dn(1,0,0,1);class au{constructor(t,s,d){this.sensitivity=t?s?"variant":"case":s?"accent":"base",this.locale=d,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,s){return this.collator.compare(t,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}const lc=["bottom","center","top"];class ou{constructor(t,s,d,_,T,E){this.text=t,this.image=s,this.scale=d,this.fontStack=_,this.textColor=T,this.verticalAlign=E}}class or{constructor(t){this.sections=t}static fromString(t){return new or([new ou(t,null,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof or?t:or.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}}class qi{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof qi)return t;if(typeof t=="number")return new qi([t,t,t,t]);if(Array.isArray(t)&&!(t.length<1||t.length>4)){for(const s of t)if(typeof s!="number")return;switch(t.length){case 1:t=[t[0],t[0],t[0],t[0]];break;case 2:t=[t[0],t[1],t[0],t[1]];break;case 3:t=[t[0],t[1],t[2],t[1]]}return new qi(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,s,d){return new qi(ko(t.values,s.values,d))}}class Hi{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const bd=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class oa{constructor(t){this.values=t.slice()}static parse(t){if(t instanceof oa)return t;if(Array.isArray(t)&&!(t.length<1)&&t.length%2==0){for(let s=0;s<t.length;s+=2){const d=t[s],_=t[s+1];if(typeof d!="string"||!bd.has(d)||!Array.isArray(_)||_.length!==2||typeof _[0]!="number"||typeof _[1]!="number")return}return new oa(t)}}toString(){return JSON.stringify(this.values)}static interpolate(t,s,d){const _=t.values,T=s.values;if(_.length!==T.length)throw new Hi(`Cannot interpolate values of different length. from: ${t.toString()}, to: ${s.toString()}`);const E=[];for(let C=0;C<_.length;C+=2){if(_[C]!==T[C])throw new Hi(`Cannot interpolate values containing mismatched anchors. from[${C}]: ${_[C]}, to[${C}]: ${T[C]}`);E.push(_[C]);const[R,B]=_[C+1],[U,G]=T[C+1];E.push([hn(R,U,d),hn(B,G,d)])}return new oa(E)}}class Kr{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new Kr({name:t,available:!1}):null}}class da{constructor(t,s,d){this.from=t,this.to=s,this.transition=d}static interpolate(t,s,d){return new da(t,s,d)}static parse(t){return t instanceof da?t:Array.isArray(t)&&t.length===3&&typeof t[0]=="string"&&typeof t[1]=="string"&&typeof t[2]=="number"?new da(t[0],t[1],t[2]):typeof t=="object"&&typeof t.from=="string"&&typeof t.to=="string"&&typeof t.transition=="number"?new da(t.from,t.to,t.transition):typeof t=="string"?new da(t,t,1):void 0}}function Zf(l,t,s,d){return typeof l=="number"&&l>=0&&l<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof s=="number"&&s>=0&&s<=255?d===void 0||typeof d=="number"&&d>=0&&d<=1?null:`Invalid rgba value [${[l,t,s,d].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof d=="number"?[l,t,s,d]:[l,t,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function As(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof da||l instanceof Dn||l instanceof au||l instanceof or||l instanceof qi||l instanceof oa||l instanceof Kr)return!0;if(Array.isArray(l)){for(const t of l)if(!As(t))return!1;return!0}if(typeof l=="object"){for(const t in l)if(!As(l[t]))return!1;return!0}return!1}function Ai(l){if(l===null)return fn;if(typeof l=="string")return Pt;if(typeof l=="boolean")return Yt;if(typeof l=="number")return ct;if(l instanceof Dn)return Cn;if(l instanceof da)return Zn;if(l instanceof au)return $n;if(l instanceof or)return no;if(l instanceof qi)return Ar;if(l instanceof oa)return Fi;if(l instanceof Kr)return Nr;if(Array.isArray(l)){const t=l.length;let s;for(const d of l){const _=Ai(d);if(s){if(s===_)continue;s=Nt;break}s=_}return Fa(s||Nt,t)}return en}function cc(l){const t=typeof l;return l===null?"":t==="string"||t==="number"||t==="boolean"?String(l):l instanceof Dn||l instanceof da||l instanceof or||l instanceof qi||l instanceof oa||l instanceof Kr?l.toString():JSON.stringify(l)}class Sa{constructor(t,s){this.type=t,this.value=s}static parse(t,s){if(t.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!As(t[1]))return s.error("invalid value");const d=t[1];let _=Ai(d);const T=s.expectedType;return _.kind!=="array"||_.N!==0||!T||T.kind!=="array"||typeof T.N=="number"&&T.N!==0||(_=T),new Sa(_,d)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}const Ua={string:Pt,number:ct,boolean:Yt,object:en};class io{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");let d,_=1;const T=t[0];if(T==="array"){let C,R;if(t.length>2){const B=t[1];if(typeof B!="string"||!(B in Ua)||B==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);C=Ua[B],_++}else C=Nt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return s.error('The length argument to "array" must be a positive integer literal',2);R=t[2],_++}d=Fa(C,R)}else{if(!Ua[T])throw new Error(`Types doesn't contain name = ${T}`);d=Ua[T]}const E=[];for(;_<t.length;_++){const C=s.parse(t[_],_,Nt);if(!C)return null;E.push(C)}return new io(d,E)}evaluate(t){for(let s=0;s<this.args.length;s++){const d=this.args[s].evaluate(t);if(!Mo(this.type,Ai(d)))return d;if(s===this.args.length-1)throw new Hi(`Expected value to be of type ${wi(this.type)}, but found ${wi(Ai(d))} instead.`)}throw new Error}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const oh={"to-boolean":Yt,"to-color":Cn,"to-number":ct,"to-string":Pt};class Cs{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");const d=t[0];if(!oh[d])throw new Error(`Can't parse ${d} as it is not part of the known types`);if((d==="to-boolean"||d==="to-string")&&t.length!==2)return s.error("Expected one argument.");const _=oh[d],T=[];for(let E=1;E<t.length;E++){const C=s.parse(t[E],E,Nt);if(!C)return null;T.push(C)}return new Cs(_,T)}evaluate(t){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(t);case"color":{let s,d;for(const _ of this.args){if(s=_.evaluate(t),d=null,s instanceof Dn)return s;if(typeof s=="string"){const T=t.parseColor(s);if(T)return T}else if(Array.isArray(s)&&(d=s.length<3||s.length>4?`Invalid rgba value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Zf(s[0],s[1],s[2],s[3]),!d))return new Dn(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Hi(d||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const d of this.args){s=d.evaluate(t);const _=qi.parse(s);if(_)return _}throw new Hi(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const d of this.args){s=d.evaluate(t);const _=oa.parse(s);if(_)return _}throw new Hi(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const d of this.args){if(s=d.evaluate(t),s===null)return 0;const _=Number(s);if(!isNaN(_))return _}throw new Hi(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return or.fromString(cc(this.args[0].evaluate(t)));case"resolvedImage":return Kr.fromString(cc(this.args[0].evaluate(t)));case"projectionDefinition":return this.args[0].evaluate(t);default:return cc(this.args[0].evaluate(t))}}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}const xl=["Unknown","Point","LineString","Polygon"];class Ci{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?xl[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(t){let s=this._parseColorCache[t];return s||(s=this._parseColorCache[t]=Dn.parse(t)),s}}class Ms{constructor(t,s,d=[],_,T=new tn,E=[]){this.registry=t,this.path=d,this.key=d.map(C=>`[${C}]`).join(""),this.scope=T,this.errors=E,this.expectedType=_,this._isConstant=s}parse(t,s,d,_,T={}){return s?this.concat(s,d,_)._parse(t,T):this._parse(t,T)}_parse(t,s){function d(_,T,E){return E==="assert"?new io(T,[_]):E==="coerce"?new Cs(T,[_]):_}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const _=t[0];if(typeof _!="string")return this.error(`Expression name must be a string, but found ${typeof _} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const T=this.registry[_];if(T){let E=T.parse(t,this);if(!E)return null;if(this.expectedType){const C=this.expectedType,R=E.type;if(C.kind!=="string"&&C.kind!=="number"&&C.kind!=="boolean"&&C.kind!=="object"&&C.kind!=="array"||R.kind!=="value")if(C.kind!=="projectionDefinition"||R.kind!=="string"&&R.kind!=="array")if(C.kind!=="color"&&C.kind!=="formatted"&&C.kind!=="resolvedImage"||R.kind!=="value"&&R.kind!=="string")if(C.kind!=="padding"||R.kind!=="value"&&R.kind!=="number"&&R.kind!=="array")if(C.kind!=="variableAnchorOffsetCollection"||R.kind!=="value"&&R.kind!=="array"){if(this.checkSubtype(C,R))return null}else E=d(E,C,s.typeAnnotation||"coerce");else E=d(E,C,s.typeAnnotation||"coerce");else E=d(E,C,s.typeAnnotation||"coerce");else E=d(E,C,s.typeAnnotation||"coerce");else E=d(E,C,s.typeAnnotation||"assert")}if(!(E instanceof Sa)&&E.type.kind!=="resolvedImage"&&this._isConstant(E)){const C=new Ci;try{E=new Sa(E.type,E.evaluate(C))}catch(R){return this.error(R.message),null}}return E}return this.error(`Unknown expression "${_}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,s,d){const _=typeof t=="number"?this.path.concat(t):this.path,T=d?this.scope.concat(d):this.scope;return new Ms(this.registry,this._isConstant,_,s||null,T,this.errors)}error(t,...s){const d=`${this.key}${s.map(_=>`[${_}]`).join("")}`;this.errors.push(new It(d,t))}checkSubtype(t,s){const d=Mo(t,s);return d&&this.error(d),d}}class Tn{constructor(t,s){this.type=s.type,this.bindings=[].concat(t),this.result=s}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const s of this.bindings)t(s[1]);t(this.result)}static parse(t,s){if(t.length<4)return s.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const d=[];for(let T=1;T<t.length-1;T+=2){const E=t[T];if(typeof E!="string")return s.error(`Expected string, but found ${typeof E} instead.`,T);if(/[^a-zA-Z0-9_]/.test(E))return s.error("Variable names must contain only alphanumeric characters or '_'.",T);const C=s.parse(t[T+1],T+1);if(!C)return null;d.push([E,C])}const _=s.parse(t[t.length-1],t.length-1,s.expectedType,d);return _?new Tn(d,_):null}outputDefined(){return this.result.outputDefined()}}class pn{constructor(t,s){this.type=s.type,this.name=t,this.boundExpression=s}static parse(t,s){if(t.length!==2||typeof t[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const d=t[1];return s.scope.has(d)?new pn(d,s.scope.get(d)):s.error(`Unknown variable "${d}". Make sure "${d}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}}class wl{constructor(t,s,d){this.type=t,this.index=s,this.input=d}static parse(t,s){if(t.length!==3)return s.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const d=s.parse(t[1],1,ct),_=s.parse(t[2],2,Fa(s.expectedType||Nt));return d&&_?new wl(_.type.itemType,d,_):null}evaluate(t){const s=this.index.evaluate(t),d=this.input.evaluate(t);if(s<0)throw new Hi(`Array index out of bounds: ${s} < 0.`);if(s>=d.length)throw new Hi(`Array index out of bounds: ${s} > ${d.length-1}.`);if(s!==Math.floor(s))throw new Hi(`Array index must be an integer, but found ${s} instead.`);return d[s]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}}class Vn{constructor(t,s){this.type=Yt,this.needle=t,this.haystack=s}static parse(t,s){if(t.length!==3)return s.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const d=s.parse(t[1],1,Nt),_=s.parse(t[2],2,Nt);return d&&_?vl(d.type,[Yt,Pt,ct,fn,Nt])?new Vn(d,_):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${wi(d.type)} instead`):null}evaluate(t){const s=this.needle.evaluate(t),d=this.haystack.evaluate(t);if(!d)return!1;if(!Ko(s,["boolean","string","number","null"]))throw new Hi(`Expected first argument to be of type boolean, string, number or null, but found ${wi(Ai(s))} instead.`);if(!Ko(d,["string","array"]))throw new Hi(`Expected second argument to be of type array or string, but found ${wi(Ai(d))} instead.`);return d.indexOf(s)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}}class Ys{constructor(t,s,d){this.type=ct,this.needle=t,this.haystack=s,this.fromIndex=d}static parse(t,s){if(t.length<=2||t.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const d=s.parse(t[1],1,Nt),_=s.parse(t[2],2,Nt);if(!d||!_)return null;if(!vl(d.type,[Yt,Pt,ct,fn,Nt]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${wi(d.type)} instead`);if(t.length===4){const T=s.parse(t[3],3,ct);return T?new Ys(d,_,T):null}return new Ys(d,_)}evaluate(t){const s=this.needle.evaluate(t),d=this.haystack.evaluate(t);if(!Ko(s,["boolean","string","number","null"]))throw new Hi(`Expected first argument to be of type boolean, string, number or null, but found ${wi(Ai(s))} instead.`);let _;if(this.fromIndex&&(_=this.fromIndex.evaluate(t)),Ko(d,["string"])){const T=d.indexOf(s,_);return T===-1?-1:[...d.slice(0,T)].length}if(Ko(d,["array"]))return d.indexOf(s,_);throw new Hi(`Expected second argument to be of type array or string, but found ${wi(Ai(d))} instead.`)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}}class Va{constructor(t,s,d,_,T,E){this.inputType=t,this.type=s,this.input=d,this.cases=_,this.outputs=T,this.otherwise=E}static parse(t,s){if(t.length<5)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return s.error("Expected an even number of arguments.");let d,_;s.expectedType&&s.expectedType.kind!=="value"&&(_=s.expectedType);const T={},E=[];for(let B=2;B<t.length-1;B+=2){let U=t[B];const G=t[B+1];Array.isArray(U)||(U=[U]);const q=s.concat(B);if(U.length===0)return q.error("Expected at least one branch label.");for(const K of U){if(typeof K!="number"&&typeof K!="string")return q.error("Branch labels must be numbers or strings.");if(typeof K=="number"&&Math.abs(K)>Number.MAX_SAFE_INTEGER)return q.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof K=="number"&&Math.floor(K)!==K)return q.error("Numeric branch labels must be integer values.");if(d){if(q.checkSubtype(d,Ai(K)))return null}else d=Ai(K);if(T[String(K)]!==void 0)return q.error("Branch labels must be unique.");T[String(K)]=E.length}const W=s.parse(G,B,_);if(!W)return null;_=_||W.type,E.push(W)}const C=s.parse(t[1],1,Nt);if(!C)return null;const R=s.parse(t[t.length-1],t.length-1,_);return R?C.type.kind!=="value"&&s.concat(1).checkSubtype(d,C.type)?null:new Va(d,_,C,T,E,R):null}evaluate(t){const s=this.input.evaluate(t);return(Ai(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}}class su{constructor(t,s,d){this.type=t,this.branches=s,this.otherwise=d}static parse(t,s){if(t.length<4)return s.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return s.error("Expected an odd number of arguments.");let d;s.expectedType&&s.expectedType.kind!=="value"&&(d=s.expectedType);const _=[];for(let E=1;E<t.length-1;E+=2){const C=s.parse(t[E],E,Yt);if(!C)return null;const R=s.parse(t[E+1],E+1,d);if(!R)return null;_.push([C,R]),d=d||R.type}const T=s.parse(t[t.length-1],t.length-1,d);if(!T)return null;if(!d)throw new Error("Can't infer output type");return new su(d,_,T)}evaluate(t){for(const[s,d]of this.branches)if(s.evaluate(t))return d.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[s,d]of this.branches)t(s),t(d);t(this.otherwise)}outputDefined(){return this.branches.every(([t,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class Jr{constructor(t,s,d,_){this.type=t,this.input=s,this.beginIndex=d,this.endIndex=_}static parse(t,s){if(t.length<=2||t.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const d=s.parse(t[1],1,Nt),_=s.parse(t[2],2,ct);if(!d||!_)return null;if(!vl(d.type,[Fa(Nt),Pt,Nt]))return s.error(`Expected first argument to be of type array or string, but found ${wi(d.type)} instead`);if(t.length===4){const T=s.parse(t[3],3,ct);return T?new Jr(d.type,d,_,T):null}return new Jr(d.type,d,_)}evaluate(t){const s=this.input.evaluate(t),d=this.beginIndex.evaluate(t);let _;if(this.endIndex&&(_=this.endIndex.evaluate(t)),Ko(s,["string"]))return[...s].slice(d,_).join("");if(Ko(s,["array"]))return s.slice(d,_);throw new Hi(`Expected first argument to be of type array or string, but found ${wi(Ai(s))} instead.`)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}}function Jo(l,t){const s=l.length-1;let d,_,T=0,E=s,C=0;for(;T<=E;)if(C=Math.floor((T+E)/2),d=l[C],_=l[C+1],d<=t){if(C===s||t<_)return C;T=C+1}else{if(!(d>t))throw new Hi("Input is not a number.");E=C-1}return 0}class Ds{constructor(t,s,d){this.type=t,this.input=s,this.labels=[],this.outputs=[];for(const[_,T]of d)this.labels.push(_),this.outputs.push(T)}static parse(t,s){if(t.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return s.error("Expected an even number of arguments.");const d=s.parse(t[1],1,ct);if(!d)return null;const _=[];let T=null;s.expectedType&&s.expectedType.kind!=="value"&&(T=s.expectedType);for(let E=1;E<t.length;E+=2){const C=E===1?-1/0:t[E],R=t[E+1],B=E,U=E+1;if(typeof C!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',B);if(_.length&&_[_.length-1][0]>=C)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',B);const G=s.parse(R,U,T);if(!G)return null;T=T||G.type,_.push([C,G])}return new Ds(T,d,_)}evaluate(t){const s=this.labels,d=this.outputs;if(s.length===1)return d[0].evaluate(t);const _=this.input.evaluate(t);if(_<=s[0])return d[0].evaluate(t);const T=s.length;return _>=s[T-1]?d[T-1].evaluate(t):d[Jo(s,_)].evaluate(t)}eachChild(t){t(this.input);for(const s of this.outputs)t(s)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function lu(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var $f,sh,xd=function(){if(sh)return $f;function l(t,s,d,_){this.cx=3*t,this.bx=3*(d-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(_-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=s,this.p2x=d,this.p2y=_}return sh=1,$f=l,l.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,s){if(s===void 0&&(s=1e-6),t<0)return 0;if(t>1)return 1;for(var d=t,_=0;_<8;_++){var T=this.sampleCurveX(d)-t;if(Math.abs(T)<s)return d;var E=this.sampleCurveDerivativeX(d);if(Math.abs(E)<1e-6)break;d-=T/E}var C=0,R=1;for(d=t,_=0;_<20&&(T=this.sampleCurveX(d),!(Math.abs(T-t)<s));_++)t>T?C=d:R=d,d=.5*(R-C)+C;return d},solve:function(t,s){return this.sampleCurveY(this.solveCurveX(t,s))}},$f}(),qs=lu(xd);class ui{constructor(t,s,d,_,T){this.type=t,this.operator=s,this.interpolation=d,this.input=_,this.labels=[],this.outputs=[];for(const[E,C]of T)this.labels.push(E),this.outputs.push(C)}static interpolationFactor(t,s,d,_){let T=0;if(t.name==="exponential")T=uc(s,t.base,d,_);else if(t.name==="linear")T=uc(s,1,d,_);else if(t.name==="cubic-bezier"){const E=t.controlPoints;T=new qs(E[0],E[1],E[2],E[3]).solve(uc(s,1,d,_))}return T}static parse(t,s){let[d,_,T,...E]=t;if(!Array.isArray(_)||_.length===0)return s.error("Expected an interpolation type expression.",1);if(_[0]==="linear")_={name:"linear"};else if(_[0]==="exponential"){const B=_[1];if(typeof B!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);_={name:"exponential",base:B}}else{if(_[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(_[0])}`,1,0);{const B=_.slice(1);if(B.length!==4||B.some(U=>typeof U!="number"||U<0||U>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);_={name:"cubic-bezier",controlPoints:B}}}if(t.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(T=s.parse(T,2,ct),!T)return null;const C=[];let R=null;d==="interpolate-hcl"||d==="interpolate-lab"?R=Cn:s.expectedType&&s.expectedType.kind!=="value"&&(R=s.expectedType);for(let B=0;B<E.length;B+=2){const U=E[B],G=E[B+1],q=B+3,W=B+4;if(typeof U!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',q);if(C.length&&C[C.length-1][0]>=U)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',q);const K=s.parse(G,W,R);if(!K)return null;R=R||K.type,C.push([U,K])}return Do(R,ct)||Do(R,Zn)||Do(R,Cn)||Do(R,Ar)||Do(R,Fi)||Do(R,Fa(ct))?new ui(R,d,_,T,C):s.error(`Type ${wi(R)} is not interpolatable.`)}evaluate(t){const s=this.labels,d=this.outputs;if(s.length===1)return d[0].evaluate(t);const _=this.input.evaluate(t);if(_<=s[0])return d[0].evaluate(t);const T=s.length;if(_>=s[T-1])return d[T-1].evaluate(t);const E=Jo(s,_),C=ui.interpolationFactor(this.interpolation,_,s[E],s[E+1]),R=d[E].evaluate(t),B=d[E+1].evaluate(t);switch(this.operator){case"interpolate":switch(this.type.kind){case"number":return hn(R,B,C);case"color":return Dn.interpolate(R,B,C);case"padding":return qi.interpolate(R,B,C);case"variableAnchorOffsetCollection":return oa.interpolate(R,B,C);case"array":return ko(R,B,C);case"projectionDefinition":return da.interpolate(R,B,C)}case"interpolate-hcl":return Dn.interpolate(R,B,C,"hcl");case"interpolate-lab":return Dn.interpolate(R,B,C,"lab")}}eachChild(t){t(this.input);for(const s of this.outputs)t(s)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}}function uc(l,t,s,d){const _=d-s,T=l-s;return _===0?0:t===1?T/_:(Math.pow(t,T)-1)/(Math.pow(t,_)-1)}const es={color:Dn.interpolate,number:hn,padding:qi.interpolate,variableAnchorOffsetCollection:oa.interpolate,array:ko};class hc{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");let d=null;const _=s.expectedType;_&&_.kind!=="value"&&(d=_);const T=[];for(const C of t.slice(1)){const R=s.parse(C,1+T.length,d,void 0,{typeAnnotation:"omit"});if(!R)return null;d=d||R.type,T.push(R)}if(!d)throw new Error("No output type");const E=_&&T.some(C=>Mo(_,C.type));return new hc(E?Nt:d,T)}evaluate(t){let s,d=null,_=0;for(const T of this.args)if(_++,d=T.evaluate(t),d&&d instanceof Kr&&!d.available&&(s||(s=d.name),d=null,_===this.args.length&&(d=s)),d!==null)break;return d}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}}function $r(l,t){return l==="=="||l==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function lh(l,t,s,d){return d.compare(t,s)===0}function Tl(l,t,s){const d=l!=="=="&&l!=="!=";return class tT{constructor(T,E,C){this.type=Yt,this.lhs=T,this.rhs=E,this.collator=C,this.hasUntypedArgument=T.type.kind==="value"||E.type.kind==="value"}static parse(T,E){if(T.length!==3&&T.length!==4)return E.error("Expected two or three arguments.");const C=T[0];let R=E.parse(T[1],1,Nt);if(!R)return null;if(!$r(C,R.type))return E.concat(1).error(`"${C}" comparisons are not supported for type '${wi(R.type)}'.`);let B=E.parse(T[2],2,Nt);if(!B)return null;if(!$r(C,B.type))return E.concat(2).error(`"${C}" comparisons are not supported for type '${wi(B.type)}'.`);if(R.type.kind!==B.type.kind&&R.type.kind!=="value"&&B.type.kind!=="value")return E.error(`Cannot compare types '${wi(R.type)}' and '${wi(B.type)}'.`);d&&(R.type.kind==="value"&&B.type.kind!=="value"?R=new io(B.type,[R]):R.type.kind!=="value"&&B.type.kind==="value"&&(B=new io(R.type,[B])));let U=null;if(T.length===4){if(R.type.kind!=="string"&&B.type.kind!=="string"&&R.type.kind!=="value"&&B.type.kind!=="value")return E.error("Cannot use collator to compare non-string types.");if(U=E.parse(T[3],3,$n),!U)return null}return new tT(R,B,U)}evaluate(T){const E=this.lhs.evaluate(T),C=this.rhs.evaluate(T);if(d&&this.hasUntypedArgument){const R=Ai(E),B=Ai(C);if(R.kind!==B.kind||R.kind!=="string"&&R.kind!=="number")throw new Hi(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${R.kind}, ${B.kind}) instead.`)}if(this.collator&&!d&&this.hasUntypedArgument){const R=Ai(E),B=Ai(C);if(R.kind!=="string"||B.kind!=="string")return t(T,E,C)}return this.collator?s(T,E,C,this.collator.evaluate(T)):t(T,E,C)}eachChild(T){T(this.lhs),T(this.rhs),this.collator&&T(this.collator)}outputDefined(){return!0}}}const bm=Tl("==",function(l,t,s){return t===s},lh),Jg=Tl("!=",function(l,t,s){return t!==s},function(l,t,s,d){return!lh(0,t,s,d)}),wd=Tl("<",function(l,t,s){return t<s},function(l,t,s,d){return d.compare(t,s)<0}),Yf=Tl(">",function(l,t,s){return t>s},function(l,t,s,d){return d.compare(t,s)>0}),xm=Tl("<=",function(l,t,s){return t<=s},function(l,t,s,d){return d.compare(t,s)<=0}),Td=Tl(">=",function(l,t,s){return t>=s},function(l,t,s,d){return d.compare(t,s)>=0});class dc{constructor(t,s,d){this.type=$n,this.locale=d,this.caseSensitive=t,this.diacriticSensitive=s}static parse(t,s){if(t.length!==2)return s.error("Expected one argument.");const d=t[1];if(typeof d!="object"||Array.isArray(d))return s.error("Collator options argument must be an object.");const _=s.parse(d["case-sensitive"]!==void 0&&d["case-sensitive"],1,Yt);if(!_)return null;const T=s.parse(d["diacritic-sensitive"]!==void 0&&d["diacritic-sensitive"],1,Yt);if(!T)return null;let E=null;return d.locale&&(E=s.parse(d.locale,1,Pt),!E)?null:new dc(_,T,E)}evaluate(t){return new au(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}}class ro{constructor(t,s,d,_,T){this.type=Pt,this.number=t,this.locale=s,this.currency=d,this.minFractionDigits=_,this.maxFractionDigits=T}static parse(t,s){if(t.length!==3)return s.error("Expected two arguments.");const d=s.parse(t[1],1,ct);if(!d)return null;const _=t[2];if(typeof _!="object"||Array.isArray(_))return s.error("NumberFormat options argument must be an object.");let T=null;if(_.locale&&(T=s.parse(_.locale,1,Pt),!T))return null;let E=null;if(_.currency&&(E=s.parse(_.currency,1,Pt),!E))return null;let C=null;if(_["min-fraction-digits"]&&(C=s.parse(_["min-fraction-digits"],1,ct),!C))return null;let R=null;return _["max-fraction-digits"]&&(R=s.parse(_["max-fraction-digits"],1,ct),!R)?null:new ro(d,T,E,C,R)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}}class ch{constructor(t){this.type=no,this.sections=t}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");const d=t[1];if(!Array.isArray(d)&&typeof d=="object")return s.error("First argument must be an image or text section.");const _=[];let T=!1;for(let E=1;E<=t.length-1;++E){const C=t[E];if(T&&typeof C=="object"&&!Array.isArray(C)){T=!1;let R=null;if(C["font-scale"]&&(R=s.parse(C["font-scale"],1,ct),!R))return null;let B=null;if(C["text-font"]&&(B=s.parse(C["text-font"],1,Fa(Pt)),!B))return null;let U=null;if(C["text-color"]&&(U=s.parse(C["text-color"],1,Cn),!U))return null;let G=null;if(C["vertical-align"]){if(typeof C["vertical-align"]=="string"&&!lc.includes(C["vertical-align"]))return s.error(`'vertical-align' must be one of: 'bottom', 'center', 'top' but found '${C["vertical-align"]}' instead.`);if(G=s.parse(C["vertical-align"],1,Pt),!G)return null}const q=_[_.length-1];q.scale=R,q.font=B,q.textColor=U,q.verticalAlign=G}else{const R=s.parse(t[E],1,Nt);if(!R)return null;const B=R.type.kind;if(B!=="string"&&B!=="value"&&B!=="null"&&B!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");T=!0,_.push({content:R,scale:null,font:null,textColor:null,verticalAlign:null})}}return new ch(_)}evaluate(t){return new or(this.sections.map(s=>{const d=s.content.evaluate(t);return Ai(d)===Nr?new ou("",d,null,null,null,s.verticalAlign?s.verticalAlign.evaluate(t):null):new ou(cc(d),null,s.scale?s.scale.evaluate(t):null,s.font?s.font.evaluate(t).join(","):null,s.textColor?s.textColor.evaluate(t):null,s.verticalAlign?s.verticalAlign.evaluate(t):null)}))}eachChild(t){for(const s of this.sections)t(s.content),s.scale&&t(s.scale),s.font&&t(s.font),s.textColor&&t(s.textColor),s.verticalAlign&&t(s.verticalAlign)}outputDefined(){return!1}}class El{constructor(t){this.type=Nr,this.input=t}static parse(t,s){if(t.length!==2)return s.error("Expected two arguments.");const d=s.parse(t[1],1,Pt);return d?new El(d):s.error("No image name provided.")}evaluate(t){const s=this.input.evaluate(t),d=Kr.fromString(s);return d&&t.availableImages&&(d.available=t.availableImages.indexOf(s)>-1),d}eachChild(t){t(this.input)}outputDefined(){return!1}}class qf{constructor(t){this.type=ct,this.input=t}static parse(t,s){if(t.length!==2)return s.error(`Expected 1 argument, but found ${t.length-1} instead.`);const d=s.parse(t[1],1);return d?d.type.kind!=="array"&&d.type.kind!=="string"&&d.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${wi(d.type)} instead.`):new qf(d):null}evaluate(t){const s=this.input.evaluate(t);if(typeof s=="string")return[...s].length;if(Array.isArray(s))return s.length;throw new Hi(`Expected value to be of type string or array, but found ${wi(Ai(s))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}}const Ro=8192;function ey(l,t){const s=(180+l[0])/360,d=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,_=Math.pow(2,t.z);return[Math.round(s*_*Ro),Math.round(d*_*Ro)]}function Ed(l,t){const s=Math.pow(2,t.z);return[(_=(l[0]/Ro+t.x)/s,360*_-180),(d=(l[1]/Ro+t.y)/s,360/Math.PI*Math.atan(Math.exp((180-360*d)*Math.PI/180))-90)];var d,_}function uh(l,t){l[0]=Math.min(l[0],t[0]),l[1]=Math.min(l[1],t[1]),l[2]=Math.max(l[2],t[0]),l[3]=Math.max(l[3],t[1])}function hh(l,t){return!(l[0]<=t[0]||l[2]>=t[2]||l[1]<=t[1]||l[3]>=t[3])}function Sd(l,t,s){const d=l[0]-t[0],_=l[1]-t[1],T=l[0]-s[0],E=l[1]-s[1];return d*E-T*_==0&&d*T<=0&&_*E<=0}function Ad(l,t,s,d){return(_=[d[0]-s[0],d[1]-s[1]])[0]*(T=[t[0]-l[0],t[1]-l[1]])[1]-_[1]*T[0]!=0&&!(!Cd(l,t,s,d)||!Cd(s,d,l,t));var _,T}function wm(l,t,s){for(const d of s)for(let _=0;_<d.length-1;++_)if(Ad(l,t,d[_],d[_+1]))return!0;return!1}function fc(l,t,s=!1){let d=!1;for(const C of t)for(let R=0;R<C.length-1;R++){if(Sd(l,C[R],C[R+1]))return s;(T=C[R])[1]>(_=l)[1]!=(E=C[R+1])[1]>_[1]&&_[0]<(E[0]-T[0])*(_[1]-T[1])/(E[1]-T[1])+T[0]&&(d=!d)}var _,T,E;return d}function ty(l,t){for(const s of t)if(fc(l,s))return!0;return!1}function Hf(l,t){for(const s of l)if(!fc(s,t))return!1;for(let s=0;s<l.length-1;++s)if(wm(l[s],l[s+1],t))return!1;return!0}function ny(l,t){for(const s of t)if(Hf(l,s))return!0;return!1}function Cd(l,t,s,d){const _=d[0]-s[0],T=d[1]-s[1],E=(l[0]-s[0])*T-_*(l[1]-s[1]),C=(t[0]-s[0])*T-_*(t[1]-s[1]);return E>0&&C<0||E<0&&C>0}function pc(l,t,s){const d=[];for(let _=0;_<l.length;_++){const T=[];for(let E=0;E<l[_].length;E++){const C=ey(l[_][E],s);uh(t,C),T.push(C)}d.push(T)}return d}function Tm(l,t,s){const d=[];for(let _=0;_<l.length;_++){const T=pc(l[_],t,s);d.push(T)}return d}function Xf(l,t,s,d){if(l[0]<s[0]||l[0]>s[2]){const _=.5*d;let T=l[0]-s[0]>_?-d:s[0]-l[0]>_?d:0;T===0&&(T=l[0]-s[2]>_?-d:s[2]-l[0]>_?d:0),l[0]+=T}uh(t,l)}function Md(l,t,s,d){const _=Math.pow(2,d.z)*Ro,T=[d.x*Ro,d.y*Ro],E=[];for(const C of l)for(const R of C){const B=[R.x+T[0],R.y+T[1]];Xf(B,t,s,_),E.push(B)}return E}function Dd(l,t,s,d){const _=Math.pow(2,d.z)*Ro,T=[d.x*Ro,d.y*Ro],E=[];for(const R of l){const B=[];for(const U of R){const G=[U.x+T[0],U.y+T[1]];uh(t,G),B.push(G)}E.push(B)}if(t[2]-t[0]<=_/2){(C=t)[0]=C[1]=1/0,C[2]=C[3]=-1/0;for(const R of E)for(const B of R)Xf(B,t,s,_)}var C;return E}class Hs{constructor(t,s){this.type=Yt,this.geojson=t,this.geometries=s}static parse(t,s){if(t.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(As(t[1])){const d=t[1];if(d.type==="FeatureCollection"){const _=[];for(const T of d.features){const{type:E,coordinates:C}=T.geometry;E==="Polygon"&&_.push(C),E==="MultiPolygon"&&_.push(...C)}if(_.length)return new Hs(d,{type:"MultiPolygon",coordinates:_})}else if(d.type==="Feature"){const _=d.geometry.type;if(_==="Polygon"||_==="MultiPolygon")return new Hs(d,d.geometry)}else if(d.type==="Polygon"||d.type==="MultiPolygon")return new Hs(d,d)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(s,d){const _=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],E=s.canonicalID();if(d.type==="Polygon"){const C=pc(d.coordinates,T,E),R=Md(s.geometry(),_,T,E);if(!hh(_,T))return!1;for(const B of R)if(!fc(B,C))return!1}if(d.type==="MultiPolygon"){const C=Tm(d.coordinates,T,E),R=Md(s.geometry(),_,T,E);if(!hh(_,T))return!1;for(const B of R)if(!ty(B,C))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(s,d){const _=[1/0,1/0,-1/0,-1/0],T=[1/0,1/0,-1/0,-1/0],E=s.canonicalID();if(d.type==="Polygon"){const C=pc(d.coordinates,T,E),R=Dd(s.geometry(),_,T,E);if(!hh(_,T))return!1;for(const B of R)if(!Hf(B,C))return!1}if(d.type==="MultiPolygon"){const C=Tm(d.coordinates,T,E),R=Dd(s.geometry(),_,T,E);if(!hh(_,T))return!1;for(const B of R)if(!ny(B,C))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}let Wf=class{constructor(l=[],t=(s,d)=>s<d?-1:s>d?1:0){if(this.data=l,this.length=this.data.length,this.compare=t,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(l){this.data.push(l),this._up(this.length++)}pop(){if(this.length===0)return;const l=this.data[0],t=this.data.pop();return--this.length>0&&(this.data[0]=t,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:t,compare:s}=this,d=t[l];for(;l>0;){const _=l-1>>1,T=t[_];if(s(d,T)>=0)break;t[l]=T,l=_}t[l]=d}_down(l){const{data:t,compare:s}=this,d=this.length>>1,_=t[l];for(;l<d;){let T=1+(l<<1);const E=T+1;if(E<this.length&&s(t[E],t[T])<0&&(T=E),s(t[T],_)>=0)break;t[l]=t[T],l=T}t[l]=_}};function mc(l,t,s=0,d=l.length-1,_=Qf){for(;d>s;){if(d-s>600){const R=d-s+1,B=t-s+1,U=Math.log(R),G=.5*Math.exp(2*U/3),q=.5*Math.sqrt(U*G*(R-G)/R)*(B-R/2<0?-1:1);mc(l,t,Math.max(s,Math.floor(t-B*G/R+q)),Math.min(d,Math.floor(t+(R-B)*G/R+q)),_)}const T=l[t];let E=s,C=d;for(dh(l,s,t),_(l[d],T)>0&&dh(l,s,d);E<C;){for(dh(l,E,C),E++,C--;_(l[E],T)<0;)E++;for(;_(l[C],T)>0;)C--}_(l[s],T)===0?dh(l,s,C):(C++,dh(l,C,d)),C<=t&&(s=C+1),t<=C&&(d=C-1)}}function dh(l,t,s){const d=l[t];l[t]=l[s],l[s]=d}function Qf(l,t){return l<t?-1:l>t?1:0}function Id(l,t){if(l.length<=1)return[l];const s=[];let d,_;for(const T of l){const E=Sm(T);E!==0&&(T.area=Math.abs(E),_===void 0&&(_=E<0),_===E<0?(d&&s.push(d),d=[T]):d.push(T))}if(d&&s.push(d),t>1)for(let T=0;T<s.length;T++)s[T].length<=t||(mc(s[T],t,1,s[T].length-1,Em),s[T]=s[T].slice(0,t));return s}function Em(l,t){return t.area-l.area}function Sm(l){let t=0;for(let s,d,_=0,T=l.length,E=T-1;_<T;E=_++)s=l[_],d=l[E],t+=(d.x-s.x)*(s.y+d.y);return t}const gc=1/298.257223563,yc=gc*(2-gc),Am=Math.PI/180;class cu{constructor(t){const s=6378.137*Am*1e3,d=Math.cos(t*Am),_=1/(1-yc*(1-d*d)),T=Math.sqrt(_);this.kx=s*T*d,this.ky=s*T*_*(1-yc)}distance(t,s){const d=this.wrap(t[0]-s[0])*this.kx,_=(t[1]-s[1])*this.ky;return Math.sqrt(d*d+_*_)}pointOnLine(t,s){let d,_,T,E,C=1/0;for(let R=0;R<t.length-1;R++){let B=t[R][0],U=t[R][1],G=this.wrap(t[R+1][0]-B)*this.kx,q=(t[R+1][1]-U)*this.ky,W=0;G===0&&q===0||(W=(this.wrap(s[0]-B)*this.kx*G+(s[1]-U)*this.ky*q)/(G*G+q*q),W>1?(B=t[R+1][0],U=t[R+1][1]):W>0&&(B+=G/this.kx*W,U+=q/this.ky*W)),G=this.wrap(s[0]-B)*this.kx,q=(s[1]-U)*this.ky;const K=G*G+q*q;K<C&&(C=K,d=B,_=U,T=R,E=W)}return{point:[d,_],index:T,t:Math.max(0,Math.min(1,E))}}wrap(t){for(;t<-180;)t+=360;for(;t>180;)t-=360;return t}}function kd(l,t){return t[0]-l[0]}function uu(l){return l[1]-l[0]+1}function ts(l,t){return l[1]>=l[0]&&l[1]<t}function fh(l,t){if(l[0]>l[1])return[null,null];const s=uu(l);if(t){if(s===2)return[l,null];const _=Math.floor(s/2);return[[l[0],l[0]+_],[l[0]+_,l[1]]]}if(s===1)return[l,null];const d=Math.floor(s/2)-1;return[[l[0],l[0]+d],[l[0]+d+1,l[1]]]}function Rd(l,t){if(!ts(t,l.length))return[1/0,1/0,-1/0,-1/0];const s=[1/0,1/0,-1/0,-1/0];for(let d=t[0];d<=t[1];++d)uh(s,l[d]);return s}function ph(l){const t=[1/0,1/0,-1/0,-1/0];for(const s of l)for(const d of s)uh(t,d);return t}function Kf(l){return l[0]!==-1/0&&l[1]!==-1/0&&l[2]!==1/0&&l[3]!==1/0}function Jf(l,t,s){if(!Kf(l)||!Kf(t))return NaN;let d=0,_=0;return l[2]<t[0]&&(d=t[0]-l[2]),l[0]>t[2]&&(d=l[0]-t[2]),l[1]>t[3]&&(_=l[1]-t[3]),l[3]<t[1]&&(_=t[1]-l[3]),s.distance([0,0],[d,_])}function _c(l,t,s){const d=s.pointOnLine(t,l);return s.distance(l,d.point)}function ep(l,t,s,d,_){const T=Math.min(_c(l,[s,d],_),_c(t,[s,d],_)),E=Math.min(_c(s,[l,t],_),_c(d,[l,t],_));return Math.min(T,E)}function oi(l,t,s,d,_){if(!ts(t,l.length)||!ts(d,s.length))return 1/0;let T=1/0;for(let E=t[0];E<t[1];++E){const C=l[E],R=l[E+1];for(let B=d[0];B<d[1];++B){const U=s[B],G=s[B+1];if(Ad(C,R,U,G))return 0;T=Math.min(T,ep(C,R,U,G,_))}}return T}function iy(l,t,s,d,_){if(!ts(t,l.length)||!ts(d,s.length))return NaN;let T=1/0;for(let E=t[0];E<=t[1];++E)for(let C=d[0];C<=d[1];++C)if(T=Math.min(T,_.distance(l[E],s[C])),T===0)return T;return T}function ao(l,t,s){if(fc(l,t,!0))return 0;let d=1/0;for(const _ of t){const T=_[0],E=_[_.length-1];if(T!==E&&(d=Math.min(d,_c(l,[E,T],s)),d===0))return d;const C=s.pointOnLine(_,l);if(d=Math.min(d,s.distance(l,C.point)),d===0)return d}return d}function mh(l,t,s,d){if(!ts(t,l.length))return NaN;for(let T=t[0];T<=t[1];++T)if(fc(l[T],s,!0))return 0;let _=1/0;for(let T=t[0];T<t[1];++T){const E=l[T],C=l[T+1];for(const R of s)for(let B=0,U=R.length,G=U-1;B<U;G=B++){const q=R[G],W=R[B];if(Ad(E,C,q,W))return 0;_=Math.min(_,ep(E,C,q,W,d))}}return _}function tp(l,t){for(const s of l)for(const d of s)if(fc(d,t,!0))return!0;return!1}function Cm(l,t,s,d=1/0){const _=ph(l),T=ph(t);if(d!==1/0&&Jf(_,T,s)>=d)return d;if(hh(_,T)){if(tp(l,t))return 0}else if(tp(t,l))return 0;let E=1/0;for(const C of l)for(let R=0,B=C.length,U=B-1;R<B;U=R++){const G=C[U],q=C[R];for(const W of t)for(let K=0,ne=W.length,ue=ne-1;K<ne;ue=K++){const _e=W[ue],Le=W[K];if(Ad(G,q,_e,Le))return 0;E=Math.min(E,ep(G,q,_e,Le,s))}}return E}function np(l,t,s,d,_,T){if(!T)return;const E=Jf(Rd(d,T),_,s);E<t&&l.push([E,T,[0,0]])}function gh(l,t,s,d,_,T,E){if(!T||!E)return;const C=Jf(Rd(d,T),Rd(_,E),s);C<t&&l.push([C,T,E])}function hu(l,t,s,d,_=1/0){let T=Math.min(d.distance(l[0],s[0][0]),_);if(T===0)return T;const E=new Wf([[0,[0,l.length-1],[0,0]]],kd),C=ph(s);for(;E.length>0;){const R=E.pop();if(R[0]>=T)continue;const B=R[1],U=t?50:100;if(uu(B)<=U){if(!ts(B,l.length))return NaN;if(t){const G=mh(l,B,s,d);if(isNaN(G)||G===0)return G;T=Math.min(T,G)}else for(let G=B[0];G<=B[1];++G){const q=ao(l[G],s,d);if(T=Math.min(T,q),T===0)return 0}}else{const G=fh(B,t);np(E,T,d,l,C,G[0]),np(E,T,d,l,C,G[1])}}return T}function Nd(l,t,s,d,_,T=1/0){let E=Math.min(T,_.distance(l[0],s[0]));if(E===0)return E;const C=new Wf([[0,[0,l.length-1],[0,s.length-1]]],kd);for(;C.length>0;){const R=C.pop();if(R[0]>=E)continue;const B=R[1],U=R[2],G=t?50:100,q=d?50:100;if(uu(B)<=G&&uu(U)<=q){if(!ts(B,l.length)&&ts(U,s.length))return NaN;let W;if(t&&d)W=oi(l,B,s,U,_),E=Math.min(E,W);else if(t&&!d){const K=l.slice(B[0],B[1]+1);for(let ne=U[0];ne<=U[1];++ne)if(W=_c(s[ne],K,_),E=Math.min(E,W),E===0)return E}else if(!t&&d){const K=s.slice(U[0],U[1]+1);for(let ne=B[0];ne<=B[1];++ne)if(W=_c(l[ne],K,_),E=Math.min(E,W),E===0)return E}else W=iy(l,B,s,U,_),E=Math.min(E,W)}else{const W=fh(B,t),K=fh(U,d);gh(C,E,_,l,s,W[0],K[0]),gh(C,E,_,l,s,W[0],K[1]),gh(C,E,_,l,s,W[1],K[0]),gh(C,E,_,l,s,W[1],K[1])}}return E}function ip(l){return l.type==="MultiPolygon"?l.coordinates.map(t=>({type:"Polygon",coordinates:t})):l.type==="MultiLineString"?l.coordinates.map(t=>({type:"LineString",coordinates:t})):l.type==="MultiPoint"?l.coordinates.map(t=>({type:"Point",coordinates:t})):[l]}class No{constructor(t,s){this.type=ct,this.geojson=t,this.geometries=s}static parse(t,s){if(t.length!==2)return s.error(`'distance' expression requires exactly one argument, but found ${t.length-1} instead.`);if(As(t[1])){const d=t[1];if(d.type==="FeatureCollection")return new No(d,d.features.map(_=>ip(_.geometry)).flat());if(d.type==="Feature")return new No(d,ip(d.geometry));if("type"in d&&"coordinates"in d)return new No(d,ip(d))}return s.error("'distance' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(s,d){const _=s.geometry(),T=_.flat().map(R=>Ed([R.x,R.y],s.canonical));if(_.length===0)return NaN;const E=new cu(T[0][1]);let C=1/0;for(const R of d){switch(R.type){case"Point":C=Math.min(C,Nd(T,!1,[R.coordinates],!1,E,C));break;case"LineString":C=Math.min(C,Nd(T,!1,R.coordinates,!0,E,C));break;case"Polygon":C=Math.min(C,hu(T,!1,R.coordinates,E,C))}if(C===0)return C}return C}(t,this.geometries);if(t.geometryType()==="LineString")return function(s,d){const _=s.geometry(),T=_.flat().map(R=>Ed([R.x,R.y],s.canonical));if(_.length===0)return NaN;const E=new cu(T[0][1]);let C=1/0;for(const R of d){switch(R.type){case"Point":C=Math.min(C,Nd(T,!0,[R.coordinates],!1,E,C));break;case"LineString":C=Math.min(C,Nd(T,!0,R.coordinates,!0,E,C));break;case"Polygon":C=Math.min(C,hu(T,!0,R.coordinates,E,C))}if(C===0)return C}return C}(t,this.geometries);if(t.geometryType()==="Polygon")return function(s,d){const _=s.geometry();if(_.length===0||_[0].length===0)return NaN;const T=Id(_,0).map(R=>R.map(B=>B.map(U=>Ed([U.x,U.y],s.canonical)))),E=new cu(T[0][0][0][1]);let C=1/0;for(const R of d)for(const B of T){switch(R.type){case"Point":C=Math.min(C,hu([R.coordinates],!1,B,E,C));break;case"LineString":C=Math.min(C,hu(R.coordinates,!0,B,E,C));break;case"Polygon":C=Math.min(C,Cm(B,R.coordinates,E,C))}if(C===0)return C}return C}(t,this.geometries)}return NaN}eachChild(){}outputDefined(){return!0}}const Sl={"==":bm,"!=":Jg,">":Yf,"<":wd,">=":Td,"<=":xm,array:io,at:wl,boolean:io,case:su,coalesce:hc,collator:dc,format:ch,image:El,in:Vn,"index-of":Ys,interpolate:ui,"interpolate-hcl":ui,"interpolate-lab":ui,length:qf,let:Tn,literal:Sa,match:Va,number:io,"number-format":ro,object:io,slice:Jr,step:Ds,string:io,"to-boolean":Cs,"to-color":Cs,"to-number":Cs,"to-string":Cs,var:pn,within:Hs,distance:No};class fa{constructor(t,s,d,_){this.name=t,this.type=s,this._evaluate=d,this.args=_}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}static parse(t,s){const d=t[0],_=fa.definitions[d];if(!_)return s.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0);const T=Array.isArray(_)?_[0]:_.type,E=Array.isArray(_)?[[_[1],_[2]]]:_.overloads,C=E.filter(([B])=>!Array.isArray(B)||B.length===t.length-1);let R=null;for(const[B,U]of C){R=new Ms(s.registry,du,s.path,null,s.scope);const G=[];let q=!1;for(let W=1;W<t.length;W++){const K=t[W],ne=Array.isArray(B)?B[W-1]:B.type,ue=R.parse(K,1+G.length,ne);if(!ue){q=!0;break}G.push(ue)}if(!q)if(Array.isArray(B)&&B.length!==G.length)R.error(`Expected ${B.length} arguments, but found ${G.length} instead.`);else{for(let W=0;W<G.length;W++){const K=Array.isArray(B)?B[W]:B.type,ne=G[W];R.concat(W+1).checkSubtype(K,ne.type)}if(R.errors.length===0)return new fa(d,T,U,G)}}if(C.length===1)s.errors.push(...R.errors);else{const B=(C.length?C:E).map(([G])=>{return q=G,Array.isArray(q)?`(${q.map(wi).join(", ")})`:`(${wi(q.type)}...)`;var q}).join(" | "),U=[];for(let G=1;G<t.length;G++){const q=s.parse(t[G],1+U.length);if(!q)return null;U.push(wi(q.type))}s.error(`Expected arguments of type ${B}, but found (${U.join(", ")}) instead.`)}return null}static register(t,s){fa.definitions=s;for(const d in s)t[d]=fa}}function Pd(l,[t,s,d,_]){t=t.evaluate(l),s=s.evaluate(l),d=d.evaluate(l);const T=_?_.evaluate(l):1,E=Zf(t,s,d,T);if(E)throw new Hi(E);return new Dn(t/255,s/255,d/255,T,!1)}function rp(l,t){return l in t}function Xs(l,t){const s=t[l];return s===void 0?null:s}function Po(l){return{type:l}}function du(l){if(l instanceof pn)return du(l.boundExpression);if(l instanceof fa&&l.name==="error"||l instanceof dc||l instanceof Hs||l instanceof No)return!1;const t=l instanceof Cs||l instanceof io;let s=!0;return l.eachChild(d=>{s=t?s&&du(d):s&&d instanceof Sa}),!!s&&yh(l)&&_h(l,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function yh(l){if(l instanceof fa&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof Hs||l instanceof No)return!1;let t=!0;return l.eachChild(s=>{t&&!yh(s)&&(t=!1)}),t}function ns(l){if(l instanceof fa&&l.name==="feature-state")return!1;let t=!0;return l.eachChild(s=>{t&&!ns(s)&&(t=!1)}),t}function _h(l,t){if(l instanceof fa&&t.indexOf(l.name)>=0)return!1;let s=!0;return l.eachChild(d=>{s&&!_h(d,t)&&(s=!1)}),s}function ap(l){return{result:"success",value:l}}function vc(l){return{result:"error",value:l}}function fu(l){return l["property-type"]==="data-driven"||l["property-type"]==="cross-faded-data-driven"}function Mm(l){return!!l.expression&&l.expression.parameters.indexOf("zoom")>-1}function op(l){return!!l.expression&&l.expression.interpolated}function Yn(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}function vh(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function Dm(l){return l}function zo(l,t){const s=t.type==="color",d=l.stops&&typeof l.stops[0][0]=="object",_=d||!(d||l.property!==void 0),T=l.type||(op(t)?"exponential":"interval");if(s||t.type==="padding"){const U=s?Dn.parse:qi.parse;(l=Rt({},l)).stops&&(l.stops=l.stops.map(G=>[G[0],U(G[1])])),l.default=U(l.default?l.default:t.default)}if(l.colorSpace&&(E=l.colorSpace)!=="rgb"&&E!=="hcl"&&E!=="lab")throw new Error(`Unknown color space: "${l.colorSpace}"`);var E;let C,R,B;if(T==="exponential")C=bh;else if(T==="interval")C=sp;else if(T==="categorical"){C=Al,R=Object.create(null);for(const U of l.stops)R[U[0]]=U[1];B=typeof l.stops[0][0]}else{if(T!=="identity")throw new Error(`Unknown function type "${T}"`);C=zd}if(d){const U={},G=[];for(let K=0;K<l.stops.length;K++){const ne=l.stops[K],ue=ne[0].zoom;U[ue]===void 0&&(U[ue]={zoom:ue,type:l.type,property:l.property,default:l.default,stops:[]},G.push(ue)),U[ue].stops.push([ne[0].value,ne[1]])}const q=[];for(const K of G)q.push([U[K].zoom,zo(U[K],t)]);const W={name:"linear"};return{kind:"composite",interpolationType:W,interpolationFactor:ui.interpolationFactor.bind(void 0,W),zoomStops:q.map(K=>K[0]),evaluate:({zoom:K},ne)=>bh({stops:q,base:l.base},t,K).evaluate(K,ne)}}if(_){const U=T==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:U,interpolationFactor:ui.interpolationFactor.bind(void 0,U),zoomStops:l.stops.map(G=>G[0]),evaluate:({zoom:G})=>C(l,t,G,R,B)}}return{kind:"source",evaluate(U,G){const q=G&&G.properties?G.properties[l.property]:void 0;return q===void 0?pa(l.default,t.default):C(l,t,q,R,B)}}}function pa(l,t,s){return l!==void 0?l:t!==void 0?t:s!==void 0?s:void 0}function Al(l,t,s,d,_){return pa(typeof s===_?d[s]:void 0,l.default,t.default)}function sp(l,t,s){if(Yn(s)!=="number")return pa(l.default,t.default);const d=l.stops.length;if(d===1||s<=l.stops[0][0])return l.stops[0][1];if(s>=l.stops[d-1][0])return l.stops[d-1][1];const _=Jo(l.stops.map(T=>T[0]),s);return l.stops[_][1]}function bh(l,t,s){const d=l.base!==void 0?l.base:1;if(Yn(s)!=="number")return pa(l.default,t.default);const _=l.stops.length;if(_===1||s<=l.stops[0][0])return l.stops[0][1];if(s>=l.stops[_-1][0])return l.stops[_-1][1];const T=Jo(l.stops.map(U=>U[0]),s),E=function(U,G,q,W){const K=W-q,ne=U-q;return K===0?0:G===1?ne/K:(Math.pow(G,ne)-1)/(Math.pow(G,K)-1)}(s,d,l.stops[T][0],l.stops[T+1][0]),C=l.stops[T][1],R=l.stops[T+1][1],B=es[t.type]||Dm;return typeof C.evaluate=="function"?{evaluate(...U){const G=C.evaluate.apply(void 0,U),q=R.evaluate.apply(void 0,U);if(G!==void 0&&q!==void 0)return B(G,q,E,l.colorSpace)}}:B(C,R,E,l.colorSpace)}function zd(l,t,s){switch(t.type){case"color":s=Dn.parse(s);break;case"formatted":s=or.fromString(s.toString());break;case"resolvedImage":s=Kr.fromString(s.toString());break;case"padding":s=qi.parse(s);break;default:Yn(s)===t.type||t.type==="enum"&&t.values[s]||(s=void 0)}return pa(s,l.default,t.default)}fa.register(Sl,{error:[{kind:"error"},[Pt],(l,[t])=>{throw new Hi(t.evaluate(l))}],typeof:[Pt,[Nt],(l,[t])=>wi(Ai(t.evaluate(l)))],"to-rgba":[Fa(ct,4),[Cn],(l,[t])=>{const[s,d,_,T]=t.evaluate(l).rgb;return[255*s,255*d,255*_,T]}],rgb:[Cn,[ct,ct,ct],Pd],rgba:[Cn,[ct,ct,ct,ct],Pd],has:{type:Yt,overloads:[[[Pt],(l,[t])=>rp(t.evaluate(l),l.properties())],[[Pt,en],(l,[t,s])=>rp(t.evaluate(l),s.evaluate(l))]]},get:{type:Nt,overloads:[[[Pt],(l,[t])=>Xs(t.evaluate(l),l.properties())],[[Pt,en],(l,[t,s])=>Xs(t.evaluate(l),s.evaluate(l))]]},"feature-state":[Nt,[Pt],(l,[t])=>Xs(t.evaluate(l),l.featureState||{})],properties:[en,[],l=>l.properties()],"geometry-type":[Pt,[],l=>l.geometryType()],id:[Nt,[],l=>l.id()],zoom:[ct,[],l=>l.globals.zoom],"heatmap-density":[ct,[],l=>l.globals.heatmapDensity||0],"line-progress":[ct,[],l=>l.globals.lineProgress||0],accumulated:[Nt,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[ct,Po(ct),(l,t)=>{let s=0;for(const d of t)s+=d.evaluate(l);return s}],"*":[ct,Po(ct),(l,t)=>{let s=1;for(const d of t)s*=d.evaluate(l);return s}],"-":{type:ct,overloads:[[[ct,ct],(l,[t,s])=>t.evaluate(l)-s.evaluate(l)],[[ct],(l,[t])=>-t.evaluate(l)]]},"/":[ct,[ct,ct],(l,[t,s])=>t.evaluate(l)/s.evaluate(l)],"%":[ct,[ct,ct],(l,[t,s])=>t.evaluate(l)%s.evaluate(l)],ln2:[ct,[],()=>Math.LN2],pi:[ct,[],()=>Math.PI],e:[ct,[],()=>Math.E],"^":[ct,[ct,ct],(l,[t,s])=>Math.pow(t.evaluate(l),s.evaluate(l))],sqrt:[ct,[ct],(l,[t])=>Math.sqrt(t.evaluate(l))],log10:[ct,[ct],(l,[t])=>Math.log(t.evaluate(l))/Math.LN10],ln:[ct,[ct],(l,[t])=>Math.log(t.evaluate(l))],log2:[ct,[ct],(l,[t])=>Math.log(t.evaluate(l))/Math.LN2],sin:[ct,[ct],(l,[t])=>Math.sin(t.evaluate(l))],cos:[ct,[ct],(l,[t])=>Math.cos(t.evaluate(l))],tan:[ct,[ct],(l,[t])=>Math.tan(t.evaluate(l))],asin:[ct,[ct],(l,[t])=>Math.asin(t.evaluate(l))],acos:[ct,[ct],(l,[t])=>Math.acos(t.evaluate(l))],atan:[ct,[ct],(l,[t])=>Math.atan(t.evaluate(l))],min:[ct,Po(ct),(l,t)=>Math.min(...t.map(s=>s.evaluate(l)))],max:[ct,Po(ct),(l,t)=>Math.max(...t.map(s=>s.evaluate(l)))],abs:[ct,[ct],(l,[t])=>Math.abs(t.evaluate(l))],round:[ct,[ct],(l,[t])=>{const s=t.evaluate(l);return s<0?-Math.round(-s):Math.round(s)}],floor:[ct,[ct],(l,[t])=>Math.floor(t.evaluate(l))],ceil:[ct,[ct],(l,[t])=>Math.ceil(t.evaluate(l))],"filter-==":[Yt,[Pt,Nt],(l,[t,s])=>l.properties()[t.value]===s.value],"filter-id-==":[Yt,[Nt],(l,[t])=>l.id()===t.value],"filter-type-==":[Yt,[Pt],(l,[t])=>l.geometryType()===t.value],"filter-<":[Yt,[Pt,Nt],(l,[t,s])=>{const d=l.properties()[t.value],_=s.value;return typeof d==typeof _&&d<_}],"filter-id-<":[Yt,[Nt],(l,[t])=>{const s=l.id(),d=t.value;return typeof s==typeof d&&s<d}],"filter->":[Yt,[Pt,Nt],(l,[t,s])=>{const d=l.properties()[t.value],_=s.value;return typeof d==typeof _&&d>_}],"filter-id->":[Yt,[Nt],(l,[t])=>{const s=l.id(),d=t.value;return typeof s==typeof d&&s>d}],"filter-<=":[Yt,[Pt,Nt],(l,[t,s])=>{const d=l.properties()[t.value],_=s.value;return typeof d==typeof _&&d<=_}],"filter-id-<=":[Yt,[Nt],(l,[t])=>{const s=l.id(),d=t.value;return typeof s==typeof d&&s<=d}],"filter->=":[Yt,[Pt,Nt],(l,[t,s])=>{const d=l.properties()[t.value],_=s.value;return typeof d==typeof _&&d>=_}],"filter-id->=":[Yt,[Nt],(l,[t])=>{const s=l.id(),d=t.value;return typeof s==typeof d&&s>=d}],"filter-has":[Yt,[Nt],(l,[t])=>t.value in l.properties()],"filter-has-id":[Yt,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[Yt,[Fa(Pt)],(l,[t])=>t.value.indexOf(l.geometryType())>=0],"filter-id-in":[Yt,[Fa(Nt)],(l,[t])=>t.value.indexOf(l.id())>=0],"filter-in-small":[Yt,[Pt,Fa(Nt)],(l,[t,s])=>s.value.indexOf(l.properties()[t.value])>=0],"filter-in-large":[Yt,[Pt,Fa(Nt)],(l,[t,s])=>function(d,_,T,E){for(;T<=E;){const C=T+E>>1;if(_[C]===d)return!0;_[C]>d?E=C-1:T=C+1}return!1}(l.properties()[t.value],s.value,0,s.value.length-1)],all:{type:Yt,overloads:[[[Yt,Yt],(l,[t,s])=>t.evaluate(l)&&s.evaluate(l)],[Po(Yt),(l,t)=>{for(const s of t)if(!s.evaluate(l))return!1;return!0}]]},any:{type:Yt,overloads:[[[Yt,Yt],(l,[t,s])=>t.evaluate(l)||s.evaluate(l)],[Po(Yt),(l,t)=>{for(const s of t)if(s.evaluate(l))return!0;return!1}]]},"!":[Yt,[Yt],(l,[t])=>!t.evaluate(l)],"is-supported-script":[Yt,[Pt],(l,[t])=>{const s=l.globals&&l.globals.isSupportedScript;return!s||s(t.evaluate(l))}],upcase:[Pt,[Pt],(l,[t])=>t.evaluate(l).toUpperCase()],downcase:[Pt,[Pt],(l,[t])=>t.evaluate(l).toLowerCase()],concat:[Pt,Po(Nt),(l,t)=>t.map(s=>cc(s.evaluate(l))).join("")],"resolved-locale":[Pt,[$n],(l,[t])=>t.evaluate(l).resolvedLocale()]});class pu{constructor(t,s){var d;this.expression=t,this._warningHistory={},this._evaluator=new Ci,this._defaultValue=s?(d=s).type==="color"&&vh(d.default)?new Dn(0,0,0,0):d.type==="color"?Dn.parse(d.default)||null:d.type==="padding"?qi.parse(d.default)||null:d.type==="variableAnchorOffsetCollection"?oa.parse(d.default)||null:d.type==="projectionDefinition"?da.parse(d.default)||null:d.default===void 0?null:d.default:null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(t,s,d,_,T,E){return this._evaluator.globals=t,this._evaluator.feature=s,this._evaluator.featureState=d,this._evaluator.canonical=_,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=E,this.expression.evaluate(this._evaluator)}evaluate(t,s,d,_,T,E){this._evaluator.globals=t,this._evaluator.feature=s||null,this._evaluator.featureState=d||null,this._evaluator.canonical=_,this._evaluator.availableImages=T||null,this._evaluator.formattedSection=E||null;try{const C=this.expression.evaluate(this._evaluator);if(C==null||typeof C=="number"&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new Hi(`Expected value to be one of ${Object.keys(this._enumValues).map(R=>JSON.stringify(R)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function is(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in Sl}function xh(l,t){const s=new Ms(Sl,du,[],t?function(_){const T={color:Cn,string:Pt,number:ct,enum:Pt,boolean:Yt,formatted:no,padding:Ar,projectionDefinition:Zn,resolvedImage:Nr,variableAnchorOffsetCollection:Fi};return _.type==="array"?Fa(T[_.value]||Nt,_.length):T[_.type]}(t):void 0),d=s.parse(l,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return d?ap(new pu(d,t)):vc(s.errors)}class Ws{constructor(t,s){this.kind=t,this._styleExpression=s,this.isStateDependent=t!=="constant"&&!ns(s.expression)}evaluateWithoutErrorHandling(t,s,d,_,T,E){return this._styleExpression.evaluateWithoutErrorHandling(t,s,d,_,T,E)}evaluate(t,s,d,_,T,E){return this._styleExpression.evaluate(t,s,d,_,T,E)}}class Qs{constructor(t,s,d,_){this.kind=t,this.zoomStops=d,this._styleExpression=s,this.isStateDependent=t!=="camera"&&!ns(s.expression),this.interpolationType=_}evaluateWithoutErrorHandling(t,s,d,_,T,E){return this._styleExpression.evaluateWithoutErrorHandling(t,s,d,_,T,E)}evaluate(t,s,d,_,T,E){return this._styleExpression.evaluate(t,s,d,_,T,E)}interpolationFactor(t,s,d){return this.interpolationType?ui.interpolationFactor(this.interpolationType,t,s,d):0}}function lp(l,t){const s=xh(l,t);if(s.result==="error")return s;const d=s.value.expression,_=yh(d);if(!_&&!fu(t))return vc([new It("","data expressions not supported")]);const T=_h(d,["zoom"]);if(!T&&!Mm(t))return vc([new It("","zoom expressions not supported")]);const E=Ks(d);return E||T?E instanceof It?vc([E]):E instanceof ui&&!op(t)?vc([new It("",'"interpolate" expressions cannot be used with this property')]):ap(E?new Qs(_?"camera":"composite",s.value,E.labels,E instanceof ui?E.interpolation:void 0):new Ws(_?"constant":"source",s.value)):vc([new It("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Aa{constructor(t,s){this._parameters=t,this._specification=s,Rt(this,zo(this._parameters,this._specification))}static deserialize(t){return new Aa(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function Ks(l){let t=null;if(l instanceof Tn)t=Ks(l.result);else if(l instanceof hc){for(const s of l.args)if(t=Ks(s),t)break}else(l instanceof Ds||l instanceof ui)&&l.input instanceof fa&&l.input.name==="zoom"&&(t=l);return t instanceof It||l.eachChild(s=>{const d=Ks(s);d instanceof It?t=d:!t&&d?t=new It("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&d&&t!==d&&(t=new It("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}function Cl(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const t of l.slice(1))if(!Cl(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}const Od={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function bc(l){if(l==null)return{filter:()=>!0,needGeometry:!1};Cl(l)||(l=Is(l));const t=xh(l,Od);if(t.result==="error")throw new Error(t.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,d,_)=>t.value.evaluate(s,d,{},_),needGeometry:so(l)}}function oo(l,t){return l<t?-1:l>t?1:0}function so(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let t=1;t<l.length;t++)if(so(l[t]))return!0;return!1}function Is(l){if(!l)return!0;const t=l[0];return l.length<=1?t!=="any":t==="=="?Oo(l[1],l[2],"=="):t==="!="?mu(Oo(l[1],l[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Oo(l[1],l[2],t):t==="any"?(s=l.slice(1),["any"].concat(s.map(Is))):t==="all"?["all"].concat(l.slice(1).map(Is)):t==="none"?["all"].concat(l.slice(1).map(Is).map(mu)):t==="in"?rs(l[1],l.slice(2)):t==="!in"?mu(rs(l[1],l.slice(2))):t==="has"?Js(l[1]):t!=="!has"||mu(Js(l[1]));var s}function Oo(l,t,s){switch(l){case"$type":return[`filter-type-${s}`,t];case"$id":return[`filter-id-${s}`,t];default:return[`filter-${s}`,l,t]}}function rs(l,t){if(t.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(s=>typeof s!=typeof t[0])?["filter-in-large",l,["literal",t.sort(oo)]]:["filter-in-small",l,["literal",t]]}}function Js(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function mu(l){return["!",l]}function xc(l){const t=typeof l;if(t==="number"||t==="boolean"||t==="string"||l==null)return JSON.stringify(l);if(Array.isArray(l)){let _="[";for(const T of l)_+=`${xc(T)},`;return`${_}]`}const s=Object.keys(l).sort();let d="{";for(let _=0;_<s.length;_++)d+=`${JSON.stringify(s[_])}:${xc(l[s[_]])},`;return`${d}}`}function wh(l){let t="";for(const s of te)t+=`/${xc(l[s])}`;return t}function ea(l){const t=l.value;return t?[new Be(l.key,t,"constants have been deprecated as of v8")]:[]}function Rn(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function Bn(l){if(Array.isArray(l))return l.map(Bn);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const t={};for(const s in l)t[s]=Bn(l[s]);return t}return Rn(l)}function fr(l){const t=l.key,s=l.value,d=l.valueSpec||{},_=l.objectElementValidators||{},T=l.style,E=l.styleSpec,C=l.validateSpec;let R=[];const B=Yn(s);if(B!=="object")return[new Be(t,s,`object expected, ${B} found`)];for(const U in s){const G=U.split(".")[0],q=d[G]||d["*"];let W;if(_[G])W=_[G];else if(d[G])W=C;else if(_["*"])W=_["*"];else{if(!d["*"]){R.push(new Be(t,s[U],`unknown property "${U}"`));continue}W=C}R=R.concat(W({key:(t&&`${t}.`)+U,value:s[U],valueSpec:q,style:T,styleSpec:E,object:s,objectKey:U,validateSpec:C},s))}for(const U in d)_[U]||d[U].required&&d[U].default===void 0&&s[U]===void 0&&R.push(new Be(t,s,`missing required property "${U}"`));return R}function Lo(l){const t=l.value,s=l.valueSpec,d=l.style,_=l.styleSpec,T=l.key,E=l.arrayElementValidator||l.validateSpec;if(Yn(t)!=="array")return[new Be(T,t,`array expected, ${Yn(t)} found`)];if(s.length&&t.length!==s.length)return[new Be(T,t,`array length ${s.length} expected, length ${t.length} found`)];if(s["min-length"]&&t.length<s["min-length"])return[new Be(T,t,`array length at least ${s["min-length"]} expected, length ${t.length} found`)];let C={type:s.value,values:s.values};_.$version<7&&(C.function=s.function),Yn(s.value)==="object"&&(C=s.value);let R=[];for(let B=0;B<t.length;B++)R=R.concat(E({array:t,arrayIndex:B,value:t[B],valueSpec:C,validateSpec:l.validateSpec,style:d,styleSpec:_,key:`${T}[${B}]`}));return R}function Th(l){const t=l.key,s=l.value,d=l.valueSpec;let _=Yn(s);return _==="number"&&s!=s&&(_="NaN"),_!=="number"?[new Be(t,s,`number expected, ${_} found`)]:"minimum"in d&&s<d.minimum?[new Be(t,s,`${s} is less than the minimum value ${d.minimum}`)]:"maximum"in d&&s>d.maximum?[new Be(t,s,`${s} is greater than the maximum value ${d.maximum}`)]:[]}function Ml(l){const t=l.valueSpec,s=Rn(l.value.type);let d,_,T,E={};const C=s!=="categorical"&&l.value.property===void 0,R=!C,B=Yn(l.value.stops)==="array"&&Yn(l.value.stops[0])==="array"&&Yn(l.value.stops[0][0])==="object",U=fr({key:l.key,value:l.value,valueSpec:l.styleSpec.function,validateSpec:l.validateSpec,style:l.style,styleSpec:l.styleSpec,objectElementValidators:{stops:function(W){if(s==="identity")return[new Be(W.key,W.value,'identity function may not have a "stops" property')];let K=[];const ne=W.value;return K=K.concat(Lo({key:W.key,value:ne,valueSpec:W.valueSpec,validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:G})),Yn(ne)==="array"&&ne.length===0&&K.push(new Be(W.key,ne,"array must have at least one stop")),K},default:function(W){return W.validateSpec({key:W.key,value:W.value,valueSpec:t,validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec})}}});return s==="identity"&&C&&U.push(new Be(l.key,l.value,'missing required property "property"')),s==="identity"||l.value.stops||U.push(new Be(l.key,l.value,'missing required property "stops"')),s==="exponential"&&l.valueSpec.expression&&!op(l.valueSpec)&&U.push(new Be(l.key,l.value,"exponential functions not supported")),l.styleSpec.$version>=8&&(R&&!fu(l.valueSpec)?U.push(new Be(l.key,l.value,"property functions not supported")):C&&!Mm(l.valueSpec)&&U.push(new Be(l.key,l.value,"zoom functions not supported"))),s!=="categorical"&&!B||l.value.property!==void 0||U.push(new Be(l.key,l.value,'"property" property is required')),U;function G(W){let K=[];const ne=W.value,ue=W.key;if(Yn(ne)!=="array")return[new Be(ue,ne,`array expected, ${Yn(ne)} found`)];if(ne.length!==2)return[new Be(ue,ne,`array length 2 expected, length ${ne.length} found`)];if(B){if(Yn(ne[0])!=="object")return[new Be(ue,ne,`object expected, ${Yn(ne[0])} found`)];if(ne[0].zoom===void 0)return[new Be(ue,ne,"object stop key must have zoom")];if(ne[0].value===void 0)return[new Be(ue,ne,"object stop key must have value")];if(T&&T>Rn(ne[0].zoom))return[new Be(ue,ne[0].zoom,"stop zoom values must appear in ascending order")];Rn(ne[0].zoom)!==T&&(T=Rn(ne[0].zoom),_=void 0,E={}),K=K.concat(fr({key:`${ue}[0]`,value:ne[0],valueSpec:{zoom:{}},validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:Th,value:q}}))}else K=K.concat(q({key:`${ue}[0]`,value:ne[0],validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec},ne));return is(Bn(ne[1]))?K.concat([new Be(`${ue}[1]`,ne[1],"expressions are not allowed in function stops.")]):K.concat(W.validateSpec({key:`${ue}[1]`,value:ne[1],valueSpec:t,validateSpec:W.validateSpec,style:W.style,styleSpec:W.styleSpec}))}function q(W,K){const ne=Yn(W.value),ue=Rn(W.value),_e=W.value!==null?W.value:K;if(d){if(ne!==d)return[new Be(W.key,_e,`${ne} stop domain type must match previous stop domain type ${d}`)]}else d=ne;if(ne!=="number"&&ne!=="string"&&ne!=="boolean")return[new Be(W.key,_e,"stop domain value must be a number, string, or boolean")];if(ne!=="number"&&s!=="categorical"){let Le=`number expected, ${ne} found`;return fu(t)&&s===void 0&&(Le+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Be(W.key,_e,Le)]}return s!=="categorical"||ne!=="number"||isFinite(ue)&&Math.floor(ue)===ue?s!=="categorical"&&ne==="number"&&_!==void 0&&ue<_?[new Be(W.key,_e,"stop domain values must appear in ascending order")]:(_=ue,s==="categorical"&&ue in E?[new Be(W.key,_e,"stop domain values must be unique")]:(E[ue]=!0,[])):[new Be(W.key,_e,`integer expected, found ${ue}`)]}}function wc(l){const t=(l.expressionContext==="property"?lp:xh)(Bn(l.value),l.valueSpec);if(t.result==="error")return t.value.map(d=>new Be(`${l.key}${d.key}`,l.value,d.message));const s=t.value.expression||t.value._styleExpression.expression;if(l.expressionContext==="property"&&l.propertyKey==="text-font"&&!s.outputDefined())return[new Be(l.key,l.value,`Invalid data expression for "${l.propertyKey}". Output values must be contained as literals within the expression.`)];if(l.expressionContext==="property"&&l.propertyType==="layout"&&!ns(s))return[new Be(l.key,l.value,'"feature-state" data expressions are not supported with layout properties.')];if(l.expressionContext==="filter"&&!ns(s))return[new Be(l.key,l.value,'"feature-state" data expressions are not supported with filters.')];if(l.expressionContext&&l.expressionContext.indexOf("cluster")===0){if(!_h(s,["zoom","feature-state"]))return[new Be(l.key,l.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(l.expressionContext==="cluster-initial"&&!yh(s))return[new Be(l.key,l.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Tc(l){const t=l.key,s=l.value,d=l.valueSpec,_=[];return Array.isArray(d.values)?d.values.indexOf(Rn(s))===-1&&_.push(new Be(t,s,`expected one of [${d.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(d.values).indexOf(Rn(s))===-1&&_.push(new Be(t,s,`expected one of [${Object.keys(d.values).join(", ")}], ${JSON.stringify(s)} found`)),_}function Dl(l){return Cl(Bn(l.value))?wc(Rt({},l,{expressionContext:"filter",valueSpec:{value:"boolean"}})):el(l)}function el(l){const t=l.value,s=l.key;if(Yn(t)!=="array")return[new Be(s,t,`array expected, ${Yn(t)} found`)];const d=l.styleSpec;let _,T=[];if(t.length<1)return[new Be(s,t,"filter array must have at least 1 element")];switch(T=T.concat(Tc({key:`${s}[0]`,value:t[0],valueSpec:d.filter_operator,style:l.style,styleSpec:l.styleSpec})),Rn(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&Rn(t[1])==="$type"&&T.push(new Be(s,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&T.push(new Be(s,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(_=Yn(t[1]),_!=="string"&&T.push(new Be(`${s}[1]`,t[1],`string expected, ${_} found`)));for(let E=2;E<t.length;E++)_=Yn(t[E]),Rn(t[1])==="$type"?T=T.concat(Tc({key:`${s}[${E}]`,value:t[E],valueSpec:d.geometry_type,style:l.style,styleSpec:l.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&T.push(new Be(`${s}[${E}]`,t[E],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let E=1;E<t.length;E++)T=T.concat(el({key:`${s}[${E}]`,value:t[E],style:l.style,styleSpec:l.styleSpec}));break;case"has":case"!has":_=Yn(t[1]),t.length!==2?T.push(new Be(s,t,`filter array for "${t[0]}" operator must have 2 elements`)):_!=="string"&&T.push(new Be(`${s}[1]`,t[1],`string expected, ${_} found`))}return T}function gu(l,t){const s=l.key,d=l.validateSpec,_=l.style,T=l.styleSpec,E=l.value,C=l.objectKey,R=T[`${t}_${l.layerType}`];if(!R)return[];const B=C.match(/^(.*)-transition$/);if(t==="paint"&&B&&R[B[1]]&&R[B[1]].transition)return d({key:s,value:E,valueSpec:T.transition,style:_,styleSpec:T});const U=l.valueSpec||R[C];if(!U)return[new Be(s,E,`unknown property "${C}"`)];let G;if(Yn(E)==="string"&&fu(U)&&!U.tokens&&(G=/^{([^}]+)}$/.exec(E)))return[new Be(s,E,`"${C}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(G[1])} }\`.`)];const q=[];return l.layerType==="symbol"&&(C==="text-field"&&_&&!_.glyphs&&q.push(new Be(s,E,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&vh(Bn(E))&&Rn(E.type)==="identity"&&q.push(new Be(s,E,'"text-font" does not support identity functions'))),q.concat(d({key:l.key,value:E,valueSpec:U,style:_,styleSpec:T,expressionContext:"property",propertyType:t,propertyKey:C}))}function Ec(l){return gu(l,"paint")}function Ld(l){return gu(l,"layout")}function Bd(l){let t=[];const s=l.value,d=l.key,_=l.style,T=l.styleSpec;s.type||s.ref||t.push(new Be(d,s,'either "type" or "ref" is required'));let E=Rn(s.type);const C=Rn(s.ref);if(s.id){const R=Rn(s.id);for(let B=0;B<l.arrayIndex;B++){const U=_.layers[B];Rn(U.id)===R&&t.push(new Be(d,s.id,`duplicate layer id "${s.id}", previously used at line ${U.id.__line__}`))}}if("ref"in s){let R;["type","source","source-layer","filter","layout"].forEach(B=>{B in s&&t.push(new Be(d,s[B],`"${B}" is prohibited for ref layers`))}),_.layers.forEach(B=>{Rn(B.id)===C&&(R=B)}),R?R.ref?t.push(new Be(d,s.ref,"ref cannot reference another ref layer")):E=Rn(R.type):t.push(new Be(d,s.ref,`ref layer "${C}" not found`))}else if(E!=="background")if(s.source){const R=_.sources&&_.sources[s.source],B=R&&Rn(R.type);R?B==="vector"&&E==="raster"?t.push(new Be(d,s.source,`layer "${s.id}" requires a raster source`)):B!=="raster-dem"&&E==="hillshade"?t.push(new Be(d,s.source,`layer "${s.id}" requires a raster-dem source`)):B==="raster"&&E!=="raster"?t.push(new Be(d,s.source,`layer "${s.id}" requires a vector source`)):B!=="vector"||s["source-layer"]?B==="raster-dem"&&E!=="hillshade"?t.push(new Be(d,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!s.paint||!s.paint["line-gradient"]||B==="geojson"&&R.lineMetrics||t.push(new Be(d,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Be(d,s,`layer "${s.id}" must specify a "source-layer"`)):t.push(new Be(d,s.source,`source "${s.source}" not found`))}else t.push(new Be(d,s,'missing required property "source"'));return t=t.concat(fr({key:d,value:s,valueSpec:T.layer,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,objectElementValidators:{"*":()=>[],type:()=>l.validateSpec({key:`${d}.type`,value:s.type,valueSpec:T.layer.type,style:l.style,styleSpec:l.styleSpec,validateSpec:l.validateSpec,object:s,objectKey:"type"}),filter:Dl,layout:R=>fr({layer:s,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,validateSpec:R.validateSpec,objectElementValidators:{"*":B=>Ld(Rt({layerType:E},B))}}),paint:R=>fr({layer:s,key:R.key,value:R.value,style:R.style,styleSpec:R.styleSpec,validateSpec:R.validateSpec,objectElementValidators:{"*":B=>Ec(Rt({layerType:E},B))}})}})),t}function tl(l){const t=l.value,s=l.key,d=Yn(t);return d!=="string"?[new Be(s,t,`string expected, ${d} found`)]:[]}const yu={promoteId:function({key:l,value:t}){if(Yn(t)==="string")return tl({key:l,value:t});{const s=[];for(const d in t)s.push(...tl({key:`${l}.${d}`,value:t[d]}));return s}}};function Sc(l){const t=l.value,s=l.key,d=l.styleSpec,_=l.style,T=l.validateSpec;if(!t.type)return[new Be(s,t,'"type" is required')];const E=Rn(t.type);let C;switch(E){case"vector":case"raster":return C=fr({key:s,value:t,valueSpec:d[`source_${E.replace("-","_")}`],style:l.style,styleSpec:d,objectElementValidators:yu,validateSpec:T}),C;case"raster-dem":return C=function(R){var B;const U=(B=R.sourceName)!==null&&B!==void 0?B:"",G=R.value,q=R.styleSpec,W=q.source_raster_dem,K=R.style;let ne=[];const ue=Yn(G);if(G===void 0)return ne;if(ue!=="object")return ne.push(new Be("source_raster_dem",G,`object expected, ${ue} found`)),ne;const _e=Rn(G.encoding)==="custom",Le=["redFactor","greenFactor","blueFactor","baseShift"],we=R.value.encoding?`"${R.value.encoding}"`:"Default";for(const X in G)!_e&&Le.includes(X)?ne.push(new Be(X,G[X],`In "${U}": "${X}" is only valid when "encoding" is set to "custom". ${we} encoding found`)):W[X]?ne=ne.concat(R.validateSpec({key:X,value:G[X],valueSpec:W[X],validateSpec:R.validateSpec,style:K,styleSpec:q})):ne.push(new Be(X,G[X],`unknown property "${X}"`));return ne}({sourceName:s,value:t,style:l.style,styleSpec:d,validateSpec:T}),C;case"geojson":if(C=fr({key:s,value:t,valueSpec:d.source_geojson,style:_,styleSpec:d,validateSpec:T,objectElementValidators:yu}),t.cluster)for(const R in t.clusterProperties){const[B,U]=t.clusterProperties[R],G=typeof B=="string"?[B,["accumulated"],["get",R]]:B;C.push(...wc({key:`${s}.${R}.map`,value:U,expressionContext:"cluster-map"})),C.push(...wc({key:`${s}.${R}.reduce`,value:G,expressionContext:"cluster-reduce"}))}return C;case"video":return fr({key:s,value:t,valueSpec:d.source_video,style:_,validateSpec:T,styleSpec:d});case"image":return fr({key:s,value:t,valueSpec:d.source_image,style:_,validateSpec:T,styleSpec:d});case"canvas":return[new Be(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Tc({key:`${s}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]}})}}function _u(l){const t=l.value,s=l.styleSpec,d=s.light,_=l.style;let T=[];const E=Yn(t);if(t===void 0)return T;if(E!=="object")return T=T.concat([new Be("light",t,`object expected, ${E} found`)]),T;for(const C in t){const R=C.match(/^(.*)-transition$/);T=T.concat(R&&d[R[1]]&&d[R[1]].transition?l.validateSpec({key:C,value:t[C],valueSpec:s.transition,validateSpec:l.validateSpec,style:_,styleSpec:s}):d[C]?l.validateSpec({key:C,value:t[C],valueSpec:d[C],validateSpec:l.validateSpec,style:_,styleSpec:s}):[new Be(C,t[C],`unknown property "${C}"`)])}return T}function cp(l){const t=l.value,s=l.styleSpec,d=s.sky,_=l.style,T=Yn(t);if(t===void 0)return[];if(T!=="object")return[new Be("sky",t,`object expected, ${T} found`)];let E=[];for(const C in t)E=E.concat(d[C]?l.validateSpec({key:C,value:t[C],valueSpec:d[C],style:_,styleSpec:s}):[new Be(C,t[C],`unknown property "${C}"`)]);return E}function Ac(l){const t=l.value,s=l.styleSpec,d=s.terrain,_=l.style;let T=[];const E=Yn(t);if(t===void 0)return T;if(E!=="object")return T=T.concat([new Be("terrain",t,`object expected, ${E} found`)]),T;for(const C in t)T=T.concat(d[C]?l.validateSpec({key:C,value:t[C],valueSpec:d[C],validateSpec:l.validateSpec,style:_,styleSpec:s}):[new Be(C,t[C],`unknown property "${C}"`)]);return T}function vu(l){let t=[];const s=l.value,d=l.key;if(Array.isArray(s)){const _=[],T=[];for(const E in s)s[E].id&&_.includes(s[E].id)&&t.push(new Be(d,s,`all the sprites' ids must be unique, but ${s[E].id} is duplicated`)),_.push(s[E].id),s[E].url&&T.includes(s[E].url)&&t.push(new Be(d,s,`all the sprites' URLs must be unique, but ${s[E].url} is duplicated`)),T.push(s[E].url),t=t.concat(fr({key:`${d}[${E}]`,value:s[E],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:l.validateSpec}));return t}return tl({key:d,value:s})}const Eh={"*":()=>[],array:Lo,boolean:function(l){const t=l.value,s=l.key,d=Yn(t);return d!=="boolean"?[new Be(s,t,`boolean expected, ${d} found`)]:[]},number:Th,color:function(l){const t=l.key,s=l.value,d=Yn(s);return d!=="string"?[new Be(t,s,`color expected, ${d} found`)]:Dn.parse(String(s))?[]:[new Be(t,s,`color expected, "${s}" found`)]},constants:ea,enum:Tc,filter:Dl,function:Ml,layer:Bd,object:fr,source:Sc,light:_u,sky:cp,terrain:Ac,projection:function(l){const t=l.value,s=l.styleSpec,d=s.projection,_=l.style,T=Yn(t);if(t===void 0)return[];if(T!=="object")return[new Be("projection",t,`object expected, ${T} found`)];let E=[];for(const C in t)E=E.concat(d[C]?l.validateSpec({key:C,value:t[C],valueSpec:d[C],style:_,styleSpec:s}):[new Be(C,t[C],`unknown property "${C}"`)]);return E},projectionDefinition:function(l){const t=l.key;let s=l.value;s=s instanceof String?s.valueOf():s;const d=Yn(s);return d!=="array"||function(_){return Array.isArray(_)&&_.length===3&&typeof _[0]=="string"&&typeof _[1]=="string"&&typeof _[2]=="number"}(s)||function(_){return!!["interpolate","step","literal"].includes(_[0])}(s)?["array","string"].includes(d)?[]:[new Be(t,s,`projection expected, invalid type "${d}" found`)]:[new Be(t,s,`projection expected, invalid array ${JSON.stringify(s)} found`)]},string:tl,formatted:function(l){return tl(l).length===0?[]:wc(l)},resolvedImage:function(l){return tl(l).length===0?[]:wc(l)},padding:function(l){const t=l.key,s=l.value;if(Yn(s)==="array"){if(s.length<1||s.length>4)return[new Be(t,s,`padding requires 1 to 4 values; ${s.length} values found`)];const d={type:"number"};let _=[];for(let T=0;T<s.length;T++)_=_.concat(l.validateSpec({key:`${t}[${T}]`,value:s[T],validateSpec:l.validateSpec,valueSpec:d}));return _}return Th({key:t,value:s,valueSpec:{}})},variableAnchorOffsetCollection:function(l){const t=l.key,s=l.value,d=Yn(s),_=l.styleSpec;if(d!=="array"||s.length<1||s.length%2!=0)return[new Be(t,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let T=[];for(let E=0;E<s.length;E+=2)T=T.concat(Tc({key:`${t}[${E}]`,value:s[E],valueSpec:_.layout_symbol["text-anchor"]})),T=T.concat(Lo({key:`${t}[${E+1}]`,value:s[E+1],valueSpec:{length:2,value:"number"},validateSpec:l.validateSpec,style:l.style,styleSpec:_}));return T},sprite:vu};function Il(l){const t=l.value,s=l.valueSpec,d=l.styleSpec;return l.validateSpec=Il,s.expression&&vh(Rn(t))?Ml(l):s.expression&&is(Bn(t))?wc(l):s.type&&Eh[s.type]?Eh[s.type](l):fr(Rt({},l,{valueSpec:s.type?d[s.type]:s}))}function nl(l){const t=l.value,s=l.key,d=tl(l);return d.length||(t.indexOf("{fontstack}")===-1&&d.push(new Be(s,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&d.push(new Be(s,t,'"glyphs" url must include a "{range}" token'))),d}function ma(l,t=de){let s=[];return s=s.concat(Il({key:"",value:l,valueSpec:t.$root,styleSpec:t,style:l,validateSpec:Il,objectElementValidators:{glyphs:nl,"*":()=>[]}})),l.constants&&(s=s.concat(ea({key:"constants",value:l.constants}))),Bo(s)}function sr(l){return function(t){return l({...t,validateSpec:Il})}}function Bo(l){return[].concat(l).sort((t,s)=>t.line-s.line)}function jo(l){return function(...t){return Bo(l.apply(this,t))}}ma.source=jo(sr(Sc)),ma.sprite=jo(sr(vu)),ma.glyphs=jo(sr(nl)),ma.light=jo(sr(_u)),ma.sky=jo(sr(cp)),ma.terrain=jo(sr(Ac)),ma.layer=jo(sr(Bd)),ma.filter=jo(sr(Dl)),ma.paintProperty=jo(sr(Ec)),ma.layoutProperty=jo(sr(Ld));const as=ma,jd=as.light,bu=as.sky,Fd=as.paintProperty,Sh=as.layoutProperty;function lo(l,t){let s=!1;if(t&&t.length)for(const d of t)l.fire(new Zs(new Error(d.message))),s=!0;return s}class ga{constructor(t,s,d){const _=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;const E=new Int32Array(this.arrayBuffer);t=E[0],this.d=(s=E[1])+2*(d=E[2]);for(let R=0;R<this.d*this.d;R++){const B=E[3+R],U=E[3+R+1];_.push(B===U?null:E.subarray(B,U))}const C=E[3+_.length+1];this.keys=E.subarray(E[3+_.length],C),this.bboxes=E.subarray(C),this.insert=this._insertReadonly}else{this.d=s+2*d;for(let E=0;E<this.d*this.d;E++)_.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=t,this.padding=d,this.scale=s/t,this.uid=0;const T=d/s*t;this.min=-T,this.max=t+T}insert(t,s,d,_,T){this._forEachCell(s,d,_,T,this._insertCell,this.uid++,void 0,void 0),this.keys.push(t),this.bboxes.push(s),this.bboxes.push(d),this.bboxes.push(_),this.bboxes.push(T)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(t,s,d,_,T,E){this.cells[T].push(E)}query(t,s,d,_,T){const E=this.min,C=this.max;if(t<=E&&s<=E&&C<=d&&C<=_&&!T)return Array.prototype.slice.call(this.keys);{const R=[];return this._forEachCell(t,s,d,_,this._queryCell,R,{},T),R}}_queryCell(t,s,d,_,T,E,C,R){const B=this.cells[T];if(B!==null){const U=this.keys,G=this.bboxes;for(let q=0;q<B.length;q++){const W=B[q];if(C[W]===void 0){const K=4*W;(R?R(G[K+0],G[K+1],G[K+2],G[K+3]):t<=G[K+2]&&s<=G[K+3]&&d>=G[K+0]&&_>=G[K+1])?(C[W]=!0,E.push(U[W])):C[W]=!1}}}}_forEachCell(t,s,d,_,T,E,C,R){const B=this._convertToCellCoord(t),U=this._convertToCellCoord(s),G=this._convertToCellCoord(d),q=this._convertToCellCoord(_);for(let W=B;W<=G;W++)for(let K=U;K<=q;K++){const ne=this.d*K+W;if((!R||R(this._convertFromCellCoord(W),this._convertFromCellCoord(K),this._convertFromCellCoord(W+1),this._convertFromCellCoord(K+1)))&&T.call(this,t,s,d,_,ne,E,C,R))return}}_convertFromCellCoord(t){return(t-this.padding)/this.scale}_convertToCellCoord(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const t=this.cells,s=3+this.cells.length+1+1;let d=0;for(let E=0;E<this.cells.length;E++)d+=this.cells[E].length;const _=new Int32Array(s+d+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;let T=s;for(let E=0;E<t.length;E++){const C=t[E];_[3+E]=T,_.set(C,T),T+=C.length}return _[3+t.length]=T,_.set(this.keys,T),T+=this.keys.length,_[3+t.length+1]=T,_.set(this.bboxes,T),T+=this.bboxes.length,_.buffer}static serialize(t,s){const d=t.toArrayBuffer();return s&&s.push(d),{buffer:d}}static deserialize(t){return new ga(t.buffer)}}const ya={};function Ft(l,t,s={}){if(ya[l])throw new Error(`${l} is already registered.`);Object.defineProperty(t,"_classRegistryKey",{value:l,writeable:!1}),ya[l]={klass:t,omit:s.omit||[],shallow:s.shallow||[]}}Ft("Object",Object),Ft("TransferableGridIndex",ga),Ft("Color",Dn),Ft("Error",Error),Ft("AJAXError",to),Ft("ResolvedImage",Kr),Ft("StylePropertyFunction",Aa),Ft("StyleExpression",pu,{omit:["_evaluator"]}),Ft("ZoomDependentExpression",Qs),Ft("ZoomConstantExpression",Ws),Ft("CompoundExpression",fa,{omit:["_evaluate"]});for(const l in Sl)Sl[l]._classRegistryKey||Ft(`Expression_${l}`,Sl[l]);function il(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function Ca(l){return l.$name||l.constructor._classRegistryKey}function Pr(l){return!function(t){if(t===null||typeof t!="object")return!1;const s=Ca(t);return!(!s||s==="Object")}(l)&&(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||l instanceof Blob||l instanceof Error||il(l)||Jn(l)||ArrayBuffer.isView(l)||l instanceof ImageData)}function kl(l,t){if(Pr(l))return(il(l)||Jn(l))&&t&&t.push(l),ArrayBuffer.isView(l)&&t&&t.push(l.buffer),l instanceof ImageData&&t&&t.push(l.data.buffer),l;if(Array.isArray(l)){const T=[];for(const E of l)T.push(kl(E,t));return T}if(typeof l!="object")throw new Error("can't serialize object of type "+typeof l);const s=Ca(l);if(!s)throw new Error(`can't serialize object of unregistered class ${l.constructor.name}`);if(!ya[s])throw new Error(`${s} is not registered.`);const{klass:d}=ya[s],_=d.serialize?d.serialize(l,t):{};if(d.serialize){if(t&&_===t[t.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const T in l){if(!l.hasOwnProperty(T)||ya[s].omit.indexOf(T)>=0)continue;const E=l[T];_[T]=ya[s].shallow.indexOf(T)>=0?E:kl(E,t)}l instanceof Error&&(_.message=l.message)}if(_.$name)throw new Error("$name property is reserved for worker serialization logic.");return s!=="Object"&&(_.$name=s),_}function Rl(l){if(Pr(l))return l;if(Array.isArray(l))return l.map(Rl);if(typeof l!="object")throw new Error("can't deserialize object of type "+typeof l);const t=Ca(l)||"Object";if(!ya[t])throw new Error(`can't deserialize unregistered class ${t}`);const{klass:s}=ya[t];if(!s)throw new Error(`can't deserialize unregistered class ${t}`);if(s.deserialize)return s.deserialize(l);const d=Object.create(s.prototype);for(const _ of Object.keys(l)){if(_==="$name")continue;const T=l[_];d[_]=ya[t].shallow.indexOf(_)>=0?T:Rl(T)}return d}class Im{constructor(){this.first=!0}update(t,s){const d=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=d,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=d,!0):(this.lastFloorZoom>d?(this.lastIntegerZoom=d+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<d&&(this.lastIntegerZoom=d,this.lastIntegerZoomTime=s),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=d,!0))}}const zn={"Latin-1 Supplement":l=>l>=128&&l<=255,"Hangul Jamo":l=>l>=4352&&l<=4607,Khmer:l=>l>=6016&&l<=6143,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Katakana:l=>l>=12448&&l<=12543,Kanbun:l=>l>=12688&&l<=12703,"CJK Strokes":l=>l>=12736&&l<=12783,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"Private Use Area":l=>l>=57344&&l<=63743,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519};function Xi(l){for(const t of l)if(al(t.charCodeAt(0)))return!0;return!1}function Ud(l){for(const t of l)if(!Vd(t.charCodeAt(0)))return!1;return!0}function Nl(l){const t=l.map(s=>{try{return new RegExp(`\\p{sc=${s}}`,"u").source}catch{return null}}).filter(s=>s);return new RegExp(t.join("|"),"u")}const xu=Nl(["Arab","Dupl","Mong","Ougr","Syrc"]);function Vd(l){return!xu.test(String.fromCodePoint(l))}const rl=Nl(["Bopo","Hani","Hira","Kana","Kits","Nshu","Tang","Yiii"]);function al(l){return!(l!==746&&l!==747&&(l<4352||!(zn["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||zn["CJK Compatibility"](l)||zn["CJK Strokes"](l)||!(!zn["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||zn["Enclosed CJK Letters and Months"](l)||zn["Ideographic Description Characters"](l)||zn.Kanbun(l)||zn.Katakana(l)&&l!==12540||!(!zn["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!zn["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||zn["Vertical Forms"](l)||zn["Yijing Hexagram Symbols"](l)||new RegExp("\\p{sc=Cans}","u").test(String.fromCodePoint(l))||new RegExp("\\p{sc=Hang}","u").test(String.fromCodePoint(l))||rl.test(String.fromCodePoint(l)))))}function km(l){return!(al(l)||function(t){return!!(zn["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||zn["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||zn["Letterlike Symbols"](t)||zn["Number Forms"](t)||zn["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||zn["Control Pictures"](t)&&t!==9251||zn["Optical Character Recognition"](t)||zn["Enclosed Alphanumerics"](t)||zn["Geometric Shapes"](t)||zn["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||zn["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||zn["CJK Symbols and Punctuation"](t)||zn.Katakana(t)||zn["Private Use Area"](t)||zn["CJK Compatibility Forms"](t)||zn["Small Form Variants"](t)||zn["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(l))}const up=Nl(["Adlm","Arab","Armi","Avst","Chrs","Cprt","Egyp","Elym","Gara","Hatr","Hebr","Hung","Khar","Lydi","Mand","Mani","Mend","Merc","Mero","Narb","Nbat","Nkoo","Orkh","Palm","Phli","Phlp","Phnx","Prti","Rohg","Samr","Sarb","Sogo","Syrc","Thaa","Todr","Yezi"]);function Rm(l){return up.test(String.fromCodePoint(l))}function hp(l,t){return!(!t&&Rm(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||zn.Khmer(l))}function Pl(l){for(const t of l)if(Rm(t.charCodeAt(0)))return!0;return!1}const os=new class{constructor(){this.TIMEOUT=5e3,this.applyArabicShaping=null,this.processBidirectionalText=null,this.processStyledBidirectionalText=null,this.pluginStatus="unavailable",this.pluginURL=null,this.loadScriptResolve=()=>{}}setState(l){this.pluginStatus=l.pluginStatus,this.pluginURL=l.pluginURL}getState(){return{pluginStatus:this.pluginStatus,pluginURL:this.pluginURL}}setMethods(l){if(os.isParsed())throw new Error("RTL text plugin already registered.");this.applyArabicShaping=l.applyArabicShaping,this.processBidirectionalText=l.processBidirectionalText,this.processStyledBidirectionalText=l.processStyledBidirectionalText,this.loadScriptResolve()}isParsed(){return this.applyArabicShaping!=null&&this.processBidirectionalText!=null&&this.processStyledBidirectionalText!=null}getRTLTextPluginStatus(){return this.pluginStatus}syncState(l,t){return c(this,void 0,void 0,function*(){if(this.isParsed())return this.getState();if(l.pluginStatus!=="loading")return this.setState(l),l;const s=l.pluginURL,d=new Promise(T=>{this.loadScriptResolve=T});t(s);const _=new Promise(T=>setTimeout(()=>T(),this.TIMEOUT));if(yield Promise.race([d,_]),this.isParsed()){const T={pluginStatus:"loaded",pluginURL:s};return this.setState(T),T}throw this.setState({pluginStatus:"error",pluginURL:""}),new Error(`RTL Text Plugin failed to import scripts from ${s}`)})}};class Mi{constructor(t,s){this.zoom=t,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Im,this.transition={})}isSupportedScript(t){return function(s,d){for(const _ of s)if(!hp(_.charCodeAt(0),d))return!1;return!0}(t,os.getRTLTextPluginStatus()==="loaded")}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,s=t-Math.floor(t),d=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*d}:{fromScale:.5,toScale:1,t:1-(1-d)*s}}}class Ah{constructor(t,s){this.property=t,this.value=s,this.expression=function(d,_){if(vh(d))return new Aa(d,_);if(is(d)){const T=lp(d,_);if(T.result==="error")throw new Error(T.value.map(E=>`${E.key}: ${E.message}`).join(", "));return T.value}{let T=d;return _.type==="color"&&typeof d=="string"?T=Dn.parse(d):_.type!=="padding"||typeof d!="number"&&!Array.isArray(d)?_.type==="variableAnchorOffsetCollection"&&Array.isArray(d)?T=oa.parse(d):_.type==="projectionDefinition"&&typeof d=="string"&&(T=da.parse(d)):T=qi.parse(d),{kind:"constant",evaluate:()=>T}}}(s===void 0?t.specification.default:s,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,s,d){return this.property.possiblyEvaluate(this,t,s,d)}}class ss{constructor(t){this.property=t,this.value=new Ah(t,void 0)}transitioned(t,s){return new mi(this.property,this.value,s,jt({},t.transition,this.transition),t.now)}untransitioned(){return new mi(this.property,this.value,null,{},0)}}class Nn{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return An(this._values[t].value.value)}setValue(t,s){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ss(this._values[t].property)),this._values[t].value=new Ah(this._values[t].property,s===null?void 0:An(s))}getTransition(t){return An(this._values[t].transition)}setTransition(t,s){Object.prototype.hasOwnProperty.call(this._values,t)||(this._values[t]=new ss(this._values[t].property)),this._values[t].transition=An(s)||void 0}serialize(){const t={};for(const s of Object.keys(this._values)){const d=this.getValue(s);d!==void 0&&(t[s]=d);const _=this.getTransition(s);_!==void 0&&(t[`${s}-transition`]=_)}return t}transitioned(t,s){const d=new pr(this._properties);for(const _ of Object.keys(this._values))d._values[_]=this._values[_].transitioned(t,s._values[_]);return d}untransitioned(){const t=new pr(this._properties);for(const s of Object.keys(this._values))t._values[s]=this._values[s].untransitioned();return t}}class mi{constructor(t,s,d,_,T){this.property=t,this.value=s,this.begin=T+_.delay||0,this.end=this.begin+_.duration||0,t.specification.transition&&(_.delay||_.duration)&&(this.prior=d)}possiblyEvaluate(t,s,d){const _=t.now||0,T=this.value.possiblyEvaluate(t,s,d),E=this.prior;if(E){if(_>this.end)return this.prior=null,T;if(this.value.isDataDriven())return this.prior=null,T;if(_<this.begin)return E.possiblyEvaluate(t,s,d);{const C=(_-this.begin)/(this.end-this.begin);return this.property.interpolate(E.possiblyEvaluate(t,s,d),T,Ie(C))}}return T}}class pr{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,s,d){const _=new Fo(this._properties);for(const T of Object.keys(this._values))_._values[T]=this._values[T].possiblyEvaluate(t,s,d);return _}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class Cc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}hasValue(t){return this._values[t].value!==void 0}getValue(t){return An(this._values[t].value)}setValue(t,s){this._values[t]=new Ah(this._values[t].property,s===null?void 0:An(s))}serialize(){const t={};for(const s of Object.keys(this._values)){const d=this.getValue(s);d!==void 0&&(t[s]=d)}return t}possiblyEvaluate(t,s,d){const _=new Fo(this._properties);for(const T of Object.keys(this._values))_._values[T]=this._values[T].possiblyEvaluate(t,s,d);return _}}class Ma{constructor(t,s,d){this.property=t,this.value=s,this.parameters=d}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,s,d,_){return this.property.evaluate(this.value,this.parameters,t,s,d,_)}}class Fo{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class Wt{constructor(t){this.specification=t}possiblyEvaluate(t,s){if(t.isDataDriven())throw new Error("Value should not be data driven");return t.expression.evaluate(s)}interpolate(t,s,d){const _=es[this.specification.type];return _?_(t,s,d):t}}class rn{constructor(t,s){this.specification=t,this.overrides=s}possiblyEvaluate(t,s,d,_){return new Ma(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(s,null,{},d,_)}:t.expression,s)}interpolate(t,s,d){if(t.value.kind!=="constant"||s.value.kind!=="constant")return t;if(t.value.value===void 0||s.value.value===void 0)return new Ma(this,{kind:"constant",value:void 0},t.parameters);const _=es[this.specification.type];if(_){const T=_(t.value.value,s.value.value,d);return new Ma(this,{kind:"constant",value:T},t.parameters)}return t}evaluate(t,s,d,_,T,E){return t.kind==="constant"?t.value:t.evaluate(s,d,_,T,E)}}class ks extends rn{possiblyEvaluate(t,s,d,_){if(t.value===void 0)return new Ma(this,{kind:"constant",value:void 0},s);if(t.expression.kind==="constant"){const T=t.expression.evaluate(s,null,{},d,_),E=t.property.specification.type==="resolvedImage"&&typeof T!="string"?T.name:T,C=this._calculate(E,E,E,s);return new Ma(this,{kind:"constant",value:C},s)}if(t.expression.kind==="camera"){const T=this._calculate(t.expression.evaluate({zoom:s.zoom-1}),t.expression.evaluate({zoom:s.zoom}),t.expression.evaluate({zoom:s.zoom+1}),s);return new Ma(this,{kind:"constant",value:T},s)}return new Ma(this,t.expression,s)}evaluate(t,s,d,_,T,E){if(t.kind==="source"){const C=t.evaluate(s,d,_,T,E);return this._calculate(C,C,C,s)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(s.zoom)-1},d,_),t.evaluate({zoom:Math.floor(s.zoom)},d,_),t.evaluate({zoom:Math.floor(s.zoom)+1},d,_),s):t.value}_calculate(t,s,d,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:t,to:s}:{from:d,to:s}}interpolate(t){return t}}class Gd{constructor(t){this.specification=t}possiblyEvaluate(t,s,d,_){if(t.value!==void 0){if(t.expression.kind==="constant"){const T=t.expression.evaluate(s,null,{},d,_);return this._calculate(T,T,T,s)}return this._calculate(t.expression.evaluate(new Mi(Math.floor(s.zoom-1),s)),t.expression.evaluate(new Mi(Math.floor(s.zoom),s)),t.expression.evaluate(new Mi(Math.floor(s.zoom+1),s)),s)}}_calculate(t,s,d,_){return _.zoom>_.zoomHistory.lastIntegerZoom?{from:t,to:s}:{from:d,to:s}}interpolate(t){return t}}class Wi{constructor(t){this.specification=t}possiblyEvaluate(t,s,d,_){return!!t.expression.evaluate(s,null,{},d,_)}interpolate(){return!1}}class _a{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in t){const d=t[s];d.specification.overridable&&this.overridableProperties.push(s);const _=this.defaultPropertyValues[s]=new Ah(d,void 0),T=this.defaultTransitionablePropertyValues[s]=new ss(d);this.defaultTransitioningPropertyValues[s]=T.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=_.possiblyEvaluate({})}}}Ft("DataDrivenProperty",rn),Ft("DataConstantProperty",Wt),Ft("CrossFadedDataDrivenProperty",ks),Ft("CrossFadedProperty",Gd),Ft("ColorRampProperty",Wi);const Zd="-transition";class ls extends Rr{constructor(t,s){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1},t.type!=="custom"&&(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),s.layout&&(this._unevaluatedLayout=new Cc(s.layout)),s.paint)){this._transitionablePaint=new Nn(s.paint);for(const d in t.paint)this.setPaintProperty(d,t.paint[d],{validate:!1});for(const d in t.layout)this.setLayoutProperty(d,t.layout[d],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Fo(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,s,d={}){s!=null&&this._validate(Sh,`layers.${this.id}.layout.${t}`,t,s,d)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,s):this.visibility=s)}getPaintProperty(t){return t.endsWith(Zd)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,s,d={}){if(s!=null&&this._validate(Fd,`layers.${this.id}.paint.${t}`,t,s,d))return!1;if(t.endsWith(Zd))return this._transitionablePaint.setTransition(t.slice(0,-11),s||void 0),!1;{const _=this._transitionablePaint._values[t],T=_.property.specification["property-type"]==="cross-faded-data-driven",E=_.value.isDataDriven(),C=_.value;this._transitionablePaint.setValue(t,s),this._handleSpecialPaintPropertyUpdate(t);const R=this._transitionablePaint._values[t].value;return R.isDataDriven()||E||T||this._handleOverridablePaintPropertyUpdate(t,C,R)}}_handleSpecialPaintPropertyUpdate(t){}_handleOverridablePaintPropertyUpdate(t,s,d){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,s){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,s)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),dn(t,(s,d)=>!(s===void 0||d==="layout"&&!Object.keys(s).length||d==="paint"&&!Object.keys(s).length))}_validate(t,s,d,_,T={}){return(!T||T.validate!==!1)&&lo(this,t.call(as,{key:s,layerType:this.type,objectKey:d,value:_,styleSpec:de,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const s=this.paint.get(t);if(s instanceof Ma&&fu(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const Nm={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ch{constructor(t,s){this._structArray=t,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class gi{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,s){return t._trim(),s&&(t.isTransferred=!0,s.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const s=Object.create(this.prototype);return s.arrayBuffer=t.arrayBuffer,s.length=t.length,s.capacity=t.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function lr(l,t=1){let s=0,d=0;return{members:l.map(_=>{const T=Nm[_.type].BYTES_PER_ELEMENT,E=s=$d(s,Math.max(t,T)),C=_.components||1;return d=Math.max(d,T),s+=T*C,{name:_.name,type:_.type,components:C,offset:E}}),size:$d(s,Math.max(d,t)),alignment:t}}function $d(l,t){return Math.ceil(l/t)*t}class ta extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,s)}emplace(t,s,d){const _=2*t;return this.int16[_+0]=s,this.int16[_+1]=d,t}}ta.prototype.bytesPerElement=4,Ft("StructArrayLayout2i4",ta);class Qi extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,d){const _=this.length;return this.resize(_+1),this.emplace(_,t,s,d)}emplace(t,s,d,_){const T=3*t;return this.int16[T+0]=s,this.int16[T+1]=d,this.int16[T+2]=_,t}}Qi.prototype.bytesPerElement=6,Ft("StructArrayLayout3i6",Qi);class wu extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,d,_){const T=this.length;return this.resize(T+1),this.emplace(T,t,s,d,_)}emplace(t,s,d,_,T){const E=4*t;return this.int16[E+0]=s,this.int16[E+1]=d,this.int16[E+2]=_,this.int16[E+3]=T,t}}wu.prototype.bytesPerElement=8,Ft("StructArrayLayout4i8",wu);class Mc extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,d,_,T,E){const C=this.length;return this.resize(C+1),this.emplace(C,t,s,d,_,T,E)}emplace(t,s,d,_,T,E,C){const R=6*t;return this.int16[R+0]=s,this.int16[R+1]=d,this.int16[R+2]=_,this.int16[R+3]=T,this.int16[R+4]=E,this.int16[R+5]=C,t}}Mc.prototype.bytesPerElement=12,Ft("StructArrayLayout2i4i12",Mc);class Uo extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,d,_,T,E){const C=this.length;return this.resize(C+1),this.emplace(C,t,s,d,_,T,E)}emplace(t,s,d,_,T,E,C){const R=4*t,B=8*t;return this.int16[R+0]=s,this.int16[R+1]=d,this.uint8[B+4]=_,this.uint8[B+5]=T,this.uint8[B+6]=E,this.uint8[B+7]=C,t}}Uo.prototype.bytesPerElement=8,Ft("StructArrayLayout2i4ub8",Uo);class zl extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,s)}emplace(t,s,d){const _=2*t;return this.float32[_+0]=s,this.float32[_+1]=d,t}}zl.prototype.bytesPerElement=8,Ft("StructArrayLayout2f8",zl);class co extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,d,_,T,E,C,R,B,U){const G=this.length;return this.resize(G+1),this.emplace(G,t,s,d,_,T,E,C,R,B,U)}emplace(t,s,d,_,T,E,C,R,B,U,G){const q=10*t;return this.uint16[q+0]=s,this.uint16[q+1]=d,this.uint16[q+2]=_,this.uint16[q+3]=T,this.uint16[q+4]=E,this.uint16[q+5]=C,this.uint16[q+6]=R,this.uint16[q+7]=B,this.uint16[q+8]=U,this.uint16[q+9]=G,t}}co.prototype.bytesPerElement=20,Ft("StructArrayLayout10ui20",co);class Dc extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,d,_,T,E,C,R,B,U,G,q){const W=this.length;return this.resize(W+1),this.emplace(W,t,s,d,_,T,E,C,R,B,U,G,q)}emplace(t,s,d,_,T,E,C,R,B,U,G,q,W){const K=12*t;return this.int16[K+0]=s,this.int16[K+1]=d,this.int16[K+2]=_,this.int16[K+3]=T,this.uint16[K+4]=E,this.uint16[K+5]=C,this.uint16[K+6]=R,this.uint16[K+7]=B,this.int16[K+8]=U,this.int16[K+9]=G,this.int16[K+10]=q,this.int16[K+11]=W,t}}Dc.prototype.bytesPerElement=24,Ft("StructArrayLayout4i4ui4i24",Dc);class Ic extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,d){const _=this.length;return this.resize(_+1),this.emplace(_,t,s,d)}emplace(t,s,d,_){const T=3*t;return this.float32[T+0]=s,this.float32[T+1]=d,this.float32[T+2]=_,t}}Ic.prototype.bytesPerElement=12,Ft("StructArrayLayout3f12",Ic);class Mh extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.uint32[1*t+0]=s,t}}Mh.prototype.bytesPerElement=4,Ft("StructArrayLayout1ul4",Mh);class kc extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,d,_,T,E,C,R,B){const U=this.length;return this.resize(U+1),this.emplace(U,t,s,d,_,T,E,C,R,B)}emplace(t,s,d,_,T,E,C,R,B,U){const G=10*t,q=5*t;return this.int16[G+0]=s,this.int16[G+1]=d,this.int16[G+2]=_,this.int16[G+3]=T,this.int16[G+4]=E,this.int16[G+5]=C,this.uint32[q+3]=R,this.uint16[G+8]=B,this.uint16[G+9]=U,t}}kc.prototype.bytesPerElement=20,Ft("StructArrayLayout6i1ul2ui20",kc);class Ol extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,d,_,T,E){const C=this.length;return this.resize(C+1),this.emplace(C,t,s,d,_,T,E)}emplace(t,s,d,_,T,E,C){const R=6*t;return this.int16[R+0]=s,this.int16[R+1]=d,this.int16[R+2]=_,this.int16[R+3]=T,this.int16[R+4]=E,this.int16[R+5]=C,t}}Ol.prototype.bytesPerElement=12,Ft("StructArrayLayout2i2i2i12",Ol);class Yd extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,d,_,T){const E=this.length;return this.resize(E+1),this.emplace(E,t,s,d,_,T)}emplace(t,s,d,_,T,E){const C=4*t,R=8*t;return this.float32[C+0]=s,this.float32[C+1]=d,this.float32[C+2]=_,this.int16[R+6]=T,this.int16[R+7]=E,t}}Yd.prototype.bytesPerElement=16,Ft("StructArrayLayout2f1f2i16",Yd);class Dh extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,d,_,T,E){const C=this.length;return this.resize(C+1),this.emplace(C,t,s,d,_,T,E)}emplace(t,s,d,_,T,E,C){const R=16*t,B=4*t,U=8*t;return this.uint8[R+0]=s,this.uint8[R+1]=d,this.float32[B+1]=_,this.float32[B+2]=T,this.int16[U+6]=E,this.int16[U+7]=C,t}}Dh.prototype.bytesPerElement=16,Ft("StructArrayLayout2ub2f2i16",Dh);class ol extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,d){const _=this.length;return this.resize(_+1),this.emplace(_,t,s,d)}emplace(t,s,d,_){const T=3*t;return this.uint16[T+0]=s,this.uint16[T+1]=d,this.uint16[T+2]=_,t}}ol.prototype.bytesPerElement=6,Ft("StructArrayLayout3ui6",ol);class qd extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,d,_,T,E,C,R,B,U,G,q,W,K,ne,ue,_e){const Le=this.length;return this.resize(Le+1),this.emplace(Le,t,s,d,_,T,E,C,R,B,U,G,q,W,K,ne,ue,_e)}emplace(t,s,d,_,T,E,C,R,B,U,G,q,W,K,ne,ue,_e,Le){const we=24*t,X=12*t,ce=48*t;return this.int16[we+0]=s,this.int16[we+1]=d,this.uint16[we+2]=_,this.uint16[we+3]=T,this.uint32[X+2]=E,this.uint32[X+3]=C,this.uint32[X+4]=R,this.uint16[we+10]=B,this.uint16[we+11]=U,this.uint16[we+12]=G,this.float32[X+7]=q,this.float32[X+8]=W,this.uint8[ce+36]=K,this.uint8[ce+37]=ne,this.uint8[ce+38]=ue,this.uint32[X+10]=_e,this.int16[we+22]=Le,t}}qd.prototype.bytesPerElement=48,Ft("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",qd);class Ih extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,d,_,T,E,C,R,B,U,G,q,W,K,ne,ue,_e,Le,we,X,ce,Ee,qe,yt,et,rt,Et,_t){const St=this.length;return this.resize(St+1),this.emplace(St,t,s,d,_,T,E,C,R,B,U,G,q,W,K,ne,ue,_e,Le,we,X,ce,Ee,qe,yt,et,rt,Et,_t)}emplace(t,s,d,_,T,E,C,R,B,U,G,q,W,K,ne,ue,_e,Le,we,X,ce,Ee,qe,yt,et,rt,Et,_t,St){const lt=32*t,Zt=16*t;return this.int16[lt+0]=s,this.int16[lt+1]=d,this.int16[lt+2]=_,this.int16[lt+3]=T,this.int16[lt+4]=E,this.int16[lt+5]=C,this.int16[lt+6]=R,this.int16[lt+7]=B,this.uint16[lt+8]=U,this.uint16[lt+9]=G,this.uint16[lt+10]=q,this.uint16[lt+11]=W,this.uint16[lt+12]=K,this.uint16[lt+13]=ne,this.uint16[lt+14]=ue,this.uint16[lt+15]=_e,this.uint16[lt+16]=Le,this.uint16[lt+17]=we,this.uint16[lt+18]=X,this.uint16[lt+19]=ce,this.uint16[lt+20]=Ee,this.uint16[lt+21]=qe,this.uint16[lt+22]=yt,this.uint32[Zt+12]=et,this.float32[Zt+13]=rt,this.float32[Zt+14]=Et,this.uint16[lt+30]=_t,this.uint16[lt+31]=St,t}}Ih.prototype.bytesPerElement=64,Ft("StructArrayLayout8i15ui1ul2f2ui64",Ih);class Tu extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.float32[1*t+0]=s,t}}Tu.prototype.bytesPerElement=4,Ft("StructArrayLayout1f4",Tu);class dp extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,d){const _=this.length;return this.resize(_+1),this.emplace(_,t,s,d)}emplace(t,s,d,_){const T=3*t;return this.uint16[6*t+0]=s,this.float32[T+1]=d,this.float32[T+2]=_,t}}dp.prototype.bytesPerElement=12,Ft("StructArrayLayout1ui2f12",dp);class b extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,d){const _=this.length;return this.resize(_+1),this.emplace(_,t,s,d)}emplace(t,s,d,_){const T=4*t;return this.uint32[2*t+0]=s,this.uint16[T+2]=d,this.uint16[T+3]=_,t}}b.prototype.bytesPerElement=8,Ft("StructArrayLayout1ul2ui8",b);class e extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s){const d=this.length;return this.resize(d+1),this.emplace(d,t,s)}emplace(t,s,d){const _=2*t;return this.uint16[_+0]=s,this.uint16[_+1]=d,t}}e.prototype.bytesPerElement=4,Ft("StructArrayLayout2ui4",e);class o extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.uint16[1*t+0]=s,t}}o.prototype.bytesPerElement=2,Ft("StructArrayLayout1ui2",o);class f extends gi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,d,_){const T=this.length;return this.resize(T+1),this.emplace(T,t,s,d,_)}emplace(t,s,d,_,T){const E=4*t;return this.float32[E+0]=s,this.float32[E+1]=d,this.float32[E+2]=_,this.float32[E+3]=T,t}}f.prototype.bytesPerElement=16,Ft("StructArrayLayout4f16",f);class y extends Ch{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new $(this.anchorPointX,this.anchorPointY)}}y.prototype.size=20;class w extends kc{get(t){return new y(this,t)}}Ft("CollisionBoxArray",w);class S extends Ch{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(t){this._structArray.uint8[this._pos1+37]=t}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(t){this._structArray.uint8[this._pos1+38]=t}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(t){this._structArray.uint32[this._pos4+10]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}S.prototype.size=48;class I extends qd{get(t){return new S(this,t)}}Ft("PlacedSymbolArray",I);class P extends Ch{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(t){this._structArray.uint32[this._pos4+12]=t}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}P.prototype.size=64;class j extends Ih{get(t){return new P(this,t)}}Ft("SymbolInstanceArray",j);class Z extends Tu{getoffsetX(t){return this.float32[1*t+0]}}Ft("GlyphOffsetArray",Z);class Y extends Qi{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}Ft("SymbolLineVertexArray",Y);class H extends Ch{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}H.prototype.size=12;class ee extends dp{get(t){return new H(this,t)}}Ft("TextAnchorOffsetArray",ee);class ie extends Ch{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ie.prototype.size=8;class me extends b{get(t){return new ie(this,t)}}Ft("FeatureIndexArray",me);class pe extends ta{}class ge extends ta{}class be extends ta{}class Se extends Mc{}class ke extends Uo{}class Re extends zl{}class Oe extends co{}class Pe extends Dc{}class He extends Ic{}class Ke extends Mh{}class st extends Ol{}class ht extends Dh{}class nt extends ol{}class kt extends e{}const Mt=lr([{name:"a_pos",components:2,type:"Int16"}],4),{members:gt}=Mt;class zt{constructor(t=[]){this._forceNewSegmentOnNextPrepare=!1,this.segments=t}prepareSegment(t,s,d,_){const T=this.segments[this.segments.length-1];return t>zt.MAX_VERTEX_ARRAY_LENGTH&&Wn(`Max vertices per segment is ${zt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}. Consider using the \`fillLargeMeshArrays\` function if you require meshes with more than ${zt.MAX_VERTEX_ARRAY_LENGTH} vertices.`),this._forceNewSegmentOnNextPrepare||!T||T.vertexLength+t>zt.MAX_VERTEX_ARRAY_LENGTH||T.sortKey!==_?this.createNewSegment(s,d,_):T}createNewSegment(t,s,d){const _={vertexOffset:t.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0,vaos:{}};return d!==void 0&&(_.sortKey=d),this._forceNewSegmentOnNextPrepare=!1,this.segments.push(_),_}getOrCreateLatestSegment(t,s,d){return this.prepareSegment(0,t,s,d)}forceNewSegmentOnNextPrepare(){this._forceNewSegmentOnNextPrepare=!0}get(){return this.segments}destroy(){for(const t of this.segments)for(const s in t.vaos)t.vaos[s].destroy()}static simpleSegment(t,s,d,_){return new zt([{vertexOffset:t,primitiveOffset:s,vertexLength:d,primitiveLength:_,vaos:{},sortKey:0}])}}function gn(l,t){return 256*(l=Lt(Math.floor(l),0,255))+Lt(Math.floor(t),0,255)}zt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ft("SegmentVector",zt);const qn=lr([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var Ui,yi,Ti,hi={exports:{}},ii={exports:{}},_i={exports:{}},na=function(){if(Ti)return hi.exports;Ti=1;var l=(Ui||(Ui=1,ii.exports=function(s,d){var _,T,E,C,R,B,U,G;for(T=s.length-(_=3&s.length),E=d,R=3432918353,B=461845907,G=0;G<T;)U=255&s.charCodeAt(G)|(255&s.charCodeAt(++G))<<8|(255&s.charCodeAt(++G))<<16|(255&s.charCodeAt(++G))<<24,++G,E=27492+(65535&(C=5*(65535&(E=(E^=U=(65535&(U=(U=(65535&U)*R+(((U>>>16)*R&65535)<<16)&4294967295)<<15|U>>>17))*B+(((U>>>16)*B&65535)<<16)&4294967295)<<13|E>>>19))+((5*(E>>>16)&65535)<<16)&4294967295))+((58964+(C>>>16)&65535)<<16);switch(U=0,_){case 3:U^=(255&s.charCodeAt(G+2))<<16;case 2:U^=(255&s.charCodeAt(G+1))<<8;case 1:E^=U=(65535&(U=(U=(65535&(U^=255&s.charCodeAt(G)))*R+(((U>>>16)*R&65535)<<16)&4294967295)<<15|U>>>17))*B+(((U>>>16)*B&65535)<<16)&4294967295}return E^=s.length,E=2246822507*(65535&(E^=E>>>16))+((2246822507*(E>>>16)&65535)<<16)&4294967295,E=3266489909*(65535&(E^=E>>>13))+((3266489909*(E>>>16)&65535)<<16)&4294967295,(E^=E>>>16)>>>0}),ii.exports),t=(yi||(yi=1,_i.exports=function(s,d){for(var _,T=s.length,E=d^T,C=0;T>=4;)_=1540483477*(65535&(_=255&s.charCodeAt(C)|(255&s.charCodeAt(++C))<<8|(255&s.charCodeAt(++C))<<16|(255&s.charCodeAt(++C))<<24))+((1540483477*(_>>>16)&65535)<<16),E=1540483477*(65535&E)+((1540483477*(E>>>16)&65535)<<16)^(_=1540483477*(65535&(_^=_>>>24))+((1540483477*(_>>>16)&65535)<<16)),T-=4,++C;switch(T){case 3:E^=(255&s.charCodeAt(C+2))<<16;case 2:E^=(255&s.charCodeAt(C+1))<<8;case 1:E=1540483477*(65535&(E^=255&s.charCodeAt(C)))+((1540483477*(E>>>16)&65535)<<16)}return E=1540483477*(65535&(E^=E>>>13))+((1540483477*(E>>>16)&65535)<<16),(E^=E>>>15)>>>0}),_i.exports);return hi.exports=l,hi.exports.murmur3=l,hi.exports.murmur2=t,hi.exports}(),Ei=A(na);class Pi{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,s,d,_){this.ids.push(mr(t)),this.positions.push(s,d,_)}getPositions(t){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=mr(t);let d=0,_=this.ids.length-1;for(;d<_;){const E=d+_>>1;this.ids[E]>=s?_=E:d=E+1}const T=[];for(;this.ids[d]===s;)T.push({index:this.positions[3*d],start:this.positions[3*d+1],end:this.positions[3*d+2]}),d++;return T}static serialize(t,s){const d=new Float64Array(t.ids),_=new Uint32Array(t.positions);return Da(d,_,0,d.length-1),s&&s.push(d.buffer,_.buffer),{ids:d,positions:_}}static deserialize(t){const s=new Pi;return s.ids=t.ids,s.positions=t.positions,s.indexed=!0,s}}function mr(l){const t=+l;return!isNaN(t)&&t<=Number.MAX_SAFE_INTEGER?t:Ei(String(l))}function Da(l,t,s,d){for(;s<d;){const _=l[s+d>>1];let T=s-1,E=d+1;for(;;){do T++;while(l[T]<_);do E--;while(l[E]>_);if(T>=E)break;Vo(l,T,E),Vo(t,3*T,3*E),Vo(t,3*T+1,3*E+1),Vo(t,3*T+2,3*E+2)}E-s<d-E?(Da(l,t,s,E),s=E+1):(Da(l,t,E+1,d),d=E)}}function Vo(l,t,s){const d=l[t];l[t]=l[s],l[s]=d}Ft("FeaturePositionMap",Pi);class Ia{constructor(t,s){this.gl=t.gl,this.location=s}}class Rs extends Ia{constructor(t,s){super(t,s),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class Eu extends Ia{constructor(t,s){super(t,s),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class cs extends Ia{constructor(t,s){super(t,s),this.current=Dn.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const sl=new Float32Array(16);function ka(l){return[gn(255*l.r,255*l.g),gn(255*l.b,255*l.a)]}class uo{constructor(t,s,d){this.value=t,this.uniformNames=s.map(_=>`u_${_}`),this.type=d}setUniform(t,s,d){t.set(d.constantOr(this.value))}getBinding(t,s,d){return this.type==="color"?new cs(t,s):new Rs(t,s)}}class ho{constructor(t,s){this.uniformNames=s.map(d=>`u_${d}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=t.tlbr}setUniform(t,s,d,_){const T=_==="u_pattern_to"?this.patternTo:_==="u_pattern_from"?this.patternFrom:_==="u_pixel_ratio_to"?this.pixelRatioTo:_==="u_pixel_ratio_from"?this.pixelRatioFrom:null;T&&t.set(T)}getBinding(t,s,d){return d.substr(0,9)==="u_pattern"?new Eu(t,s):new Rs(t,s)}}class va{constructor(t,s,d,_){this.expression=t,this.type=d,this.maxValue=0,this.paintVertexAttributes=s.map(T=>({name:`a_${T}`,type:"Float32",components:d==="color"?2:1,offset:0})),this.paintVertexArray=new _}populatePaintArray(t,s,d,_,T){const E=this.paintVertexArray.length,C=this.expression.evaluate(new Mi(0),s,{},_,[],T);this.paintVertexArray.resize(t),this._setPaintValue(E,t,C)}updatePaintArray(t,s,d,_){const T=this.expression.evaluate({zoom:0},d,_);this._setPaintValue(t,s,T)}_setPaintValue(t,s,d){if(this.type==="color"){const _=ka(d);for(let T=t;T<s;T++)this.paintVertexArray.emplace(T,_[0],_[1])}else{for(let _=t;_<s;_++)this.paintVertexArray.emplace(_,d);this.maxValue=Math.max(this.maxValue,Math.abs(d))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class vi{constructor(t,s,d,_,T,E){this.expression=t,this.uniformNames=s.map(C=>`u_${C}_t`),this.type=d,this.useIntegerZoom=_,this.zoom=T,this.maxValue=0,this.paintVertexAttributes=s.map(C=>({name:`a_${C}`,type:"Float32",components:d==="color"?4:2,offset:0})),this.paintVertexArray=new E}populatePaintArray(t,s,d,_,T){const E=this.expression.evaluate(new Mi(this.zoom),s,{},_,[],T),C=this.expression.evaluate(new Mi(this.zoom+1),s,{},_,[],T),R=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(R,t,E,C)}updatePaintArray(t,s,d,_){const T=this.expression.evaluate({zoom:this.zoom},d,_),E=this.expression.evaluate({zoom:this.zoom+1},d,_);this._setPaintValue(t,s,T,E)}_setPaintValue(t,s,d,_){if(this.type==="color"){const T=ka(d),E=ka(_);for(let C=t;C<s;C++)this.paintVertexArray.emplace(C,T[0],T[1],E[0],E[1])}else{for(let T=t;T<s;T++)this.paintVertexArray.emplace(T,d,_);this.maxValue=Math.max(this.maxValue,Math.abs(d),Math.abs(_))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,s){const d=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,_=Lt(this.expression.interpolationFactor(d,this.zoom,this.zoom+1),0,1);t.set(_)}getBinding(t,s,d){return new Rs(t,s)}}class Ii{constructor(t,s,d,_,T,E){this.expression=t,this.type=s,this.useIntegerZoom=d,this.zoom=_,this.layerId=E,this.zoomInPaintVertexArray=new T,this.zoomOutPaintVertexArray=new T}populatePaintArray(t,s,d){const _=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(_,t,s.patterns&&s.patterns[this.layerId],d)}updatePaintArray(t,s,d,_,T){this._setPaintValues(t,s,d.patterns&&d.patterns[this.layerId],T)}_setPaintValues(t,s,d,_){if(!_||!d)return;const{min:T,mid:E,max:C}=d,R=_[T],B=_[E],U=_[C];if(R&&B&&U)for(let G=t;G<s;G++)this.zoomInPaintVertexArray.emplace(G,B.tl[0],B.tl[1],B.br[0],B.br[1],R.tl[0],R.tl[1],R.br[0],R.br[1],B.pixelRatio,R.pixelRatio),this.zoomOutPaintVertexArray.emplace(G,B.tl[0],B.tl[1],B.br[0],B.br[1],U.tl[0],U.tl[1],U.br[0],U.br[1],B.pixelRatio,U.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,qn.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,qn.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ga{constructor(t,s,d){this.binders={},this._buffers=[];const _=[];for(const T in t.paint._values){if(!d(T))continue;const E=t.paint.get(T);if(!(E instanceof Ma&&fu(E.property.specification)))continue;const C=ry(T,t.type),R=E.value,B=E.property.specification.type,U=E.property.useIntegerZoom,G=E.property.specification["property-type"],q=G==="cross-faded"||G==="cross-faded-data-driven";if(R.kind==="constant")this.binders[T]=q?new ho(R.value,C):new uo(R.value,C,B),_.push(`/u_${T}`);else if(R.kind==="source"||q){const W=fp(T,B,"source");this.binders[T]=q?new Ii(R,B,U,s,W,t.id):new va(R,C,B,W),_.push(`/a_${T}`)}else{const W=fp(T,B,"composite");this.binders[T]=new vi(R,C,B,U,s,W),_.push(`/z_${T}`)}}this.cacheKey=_.sort().join("")}getMaxValue(t){const s=this.binders[t];return s instanceof va||s instanceof vi?s.maxValue:0}populatePaintArrays(t,s,d,_,T){for(const E in this.binders){const C=this.binders[E];(C instanceof va||C instanceof vi||C instanceof Ii)&&C.populatePaintArray(t,s,d,_,T)}}setConstantPatternPositions(t,s){for(const d in this.binders){const _=this.binders[d];_ instanceof ho&&_.setConstantPatternPositions(t,s)}}updatePaintArrays(t,s,d,_,T){let E=!1;for(const C in t){const R=s.getPositions(C);for(const B of R){const U=d.feature(B.index);for(const G in this.binders){const q=this.binders[G];if((q instanceof va||q instanceof vi||q instanceof Ii)&&q.expression.isStateDependent===!0){const W=_.paint.get(G);q.expression=W.value,q.updatePaintArray(B.start,B.end,U,t[C],T),E=!0}}}}return E}defines(){const t=[];for(const s in this.binders){const d=this.binders[s];(d instanceof uo||d instanceof ho)&&t.push(...d.uniformNames.map(_=>`#define HAS_UNIFORM_${_}`))}return t}getBinderAttributes(){const t=[];for(const s in this.binders){const d=this.binders[s];if(d instanceof va||d instanceof vi)for(let _=0;_<d.paintVertexAttributes.length;_++)t.push(d.paintVertexAttributes[_].name);else if(d instanceof Ii)for(let _=0;_<qn.members.length;_++)t.push(qn.members[_].name)}return t}getBinderUniforms(){const t=[];for(const s in this.binders){const d=this.binders[s];if(d instanceof uo||d instanceof ho||d instanceof vi)for(const _ of d.uniformNames)t.push(_)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,s){const d=[];for(const _ in this.binders){const T=this.binders[_];if(T instanceof uo||T instanceof ho||T instanceof vi){for(const E of T.uniformNames)if(s[E]){const C=T.getBinding(t,s[E],E);d.push({name:E,property:_,binding:C})}}}return d}setUniforms(t,s,d,_){for(const{name:T,property:E,binding:C}of s)this.binders[E].setUniform(C,_,d.get(E),T)}updatePaintBuffers(t){this._buffers=[];for(const s in this.binders){const d=this.binders[s];if(t&&d instanceof Ii){const _=t.fromScale===2?d.zoomInPaintVertexBuffer:d.zoomOutPaintVertexBuffer;_&&this._buffers.push(_)}else(d instanceof va||d instanceof vi)&&d.paintVertexBuffer&&this._buffers.push(d.paintVertexBuffer)}}upload(t){for(const s in this.binders){const d=this.binders[s];(d instanceof va||d instanceof vi||d instanceof Ii)&&d.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const s=this.binders[t];(s instanceof va||s instanceof vi||s instanceof Ii)&&s.destroy()}}}class Vi{constructor(t,s,d=()=>!0){this.programConfigurations={};for(const _ of t)this.programConfigurations[_.id]=new Ga(_,s,d);this.needsUpload=!1,this._featureMap=new Pi,this._bufferOffset=0}populatePaintArrays(t,s,d,_,T,E){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(t,s,_,T,E);s.id!==void 0&&this._featureMap.add(s.id,d,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,s,d,_){for(const T of d)this.needsUpload=this.programConfigurations[T.id].updatePaintArrays(t,this._featureMap,s,T,_)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}function ry(l,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[l]||[l.replace(`${t}-`,"").replace(/-/g,"_")]}function fp(l,t,s){const d={color:{source:zl,composite:f},number:{source:Tu,composite:zl}},_=function(T){return{"line-pattern":{source:Oe,composite:Oe},"fill-pattern":{source:Oe,composite:Oe},"fill-extrusion-pattern":{source:Oe,composite:Oe}}[T]}(l);return _&&_[s]||d[t][s]}Ft("ConstantBinder",uo),Ft("CrossFadedConstantBinder",ho),Ft("SourceExpressionBinder",va),Ft("CrossFadedCompositeBinder",Ii),Ft("CompositeExpressionBinder",vi),Ft("ProgramConfiguration",Ga,{omit:["_buffers"]}),Ft("ProgramConfigurationSet",Vi);const zr=Math.pow(2,14)-1,ia=-zr-1;function Ll(l){const t=Ge/l.extent,s=l.loadGeometry();for(let d=0;d<s.length;d++){const _=s[d];for(let T=0;T<_.length;T++){const E=_[T],C=Math.round(E.x*t),R=Math.round(E.y*t);E.x=Lt(C,ia,zr),E.y=Lt(R,ia,zr),(C<E.x||C>E.x+1||R<E.y||R>E.y+1)&&Wn("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function Bl(l,t){return{type:l.type,id:l.id,properties:l.properties,geometry:t?Ll(l):[]}}const ll=-32768;function pp(l,t,s,d,_){l.emplaceBack(ll+8*t+d,ll+8*s+_)}class kh{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new ge,this.indexArray=new nt,this.segments=new zt,this.programConfigurations=new Vi(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,d){const _=this.layers[0],T=[];let E=null,C=!1,R=_.type==="heatmap";if(_.type==="circle"){const U=_;E=U.layout.get("circle-sort-key"),C=!E.isConstant(),R=R||U.paint.get("circle-pitch-alignment")==="map"}const B=R?s.subdivisionGranularity.circle:1;for(const{feature:U,id:G,index:q,sourceLayerIndex:W}of t){const K=this.layers[0]._featureFilter.needGeometry,ne=Bl(U,K);if(!this.layers[0]._featureFilter.filter(new Mi(this.zoom),ne,d))continue;const ue=C?E.evaluate(ne,{},d):void 0,_e={id:G,properties:U.properties,type:U.type,sourceLayerIndex:W,index:q,geometry:K?ne.geometry:Ll(U),patterns:{},sortKey:ue};T.push(_e)}C&&T.sort((U,G)=>U.sortKey-G.sortKey);for(const U of T){const{geometry:G,index:q,sourceLayerIndex:W}=U,K=t[q].feature;this.addFeature(U,G,q,d,B),s.featureIndex.insert(K,G,q,W,this.index)}}update(t,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,gt),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,s,d,_,T=1){let E;switch(T){case 1:E=[0,7];break;case 3:E=[0,2,5,7];break;case 5:E=[0,1,3,4,6,7];break;case 7:E=[0,1,2,3,4,5,6,7];break;default:throw new Error(`Invalid circle bucket granularity: ${T}; valid values are 1, 3, 5, 7.`)}const C=E.length;for(const R of s)for(const B of R){const U=B.x,G=B.y;if(U<0||U>=Ge||G<0||G>=Ge)continue;const q=this.segments.prepareSegment(C*C,this.layoutVertexArray,this.indexArray,t.sortKey),W=q.vertexLength;for(let K=0;K<C;K++)for(let ne=0;ne<C;ne++)pp(this.layoutVertexArray,U,G,E[ne],E[K]);for(let K=0;K<C-1;K++)for(let ne=0;ne<C-1;ne++){const ue=W+K*C+ne,_e=W+(K+1)*C+ne;this.indexArray.emplaceBack(ue,_e+1,ue+1),this.indexArray.emplaceBack(ue,_e,_e+1)}q.vertexLength+=C*C,q.primitiveLength+=(C-1)*(C-1)*2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,{},_)}}function Rc(l,t){for(let s=0;s<l.length;s++)if(Su(t,l[s]))return!0;for(let s=0;s<t.length;s++)if(Su(l,t[s]))return!0;return!!Pm(l,t)}function Rh(l,t,s){return!!Su(l,t)||!!mp(t,l,s)}function Hd(l,t){if(l.length===1)return oy(t,l[0]);for(let s=0;s<t.length;s++){const d=t[s];for(let _=0;_<d.length;_++)if(Su(l,d[_]))return!0}for(let s=0;s<l.length;s++)if(oy(t,l[s]))return!0;for(let s=0;s<t.length;s++)if(Pm(l,t[s]))return!0;return!1}function Xd(l,t,s){if(l.length>1){if(Pm(l,t))return!0;for(let d=0;d<t.length;d++)if(mp(t[d],l,s))return!0}for(let d=0;d<l.length;d++)if(mp(l[d],t,s))return!0;return!1}function Pm(l,t){if(l.length===0||t.length===0)return!1;for(let s=0;s<l.length-1;s++){const d=l[s],_=l[s+1];for(let T=0;T<t.length-1;T++)if(ay(d,_,t[T],t[T+1]))return!0}return!1}function ay(l,t,s,d){return ai(l,s,d)!==ai(t,s,d)&&ai(l,t,s)!==ai(l,t,d)}function mp(l,t,s){const d=s*s;if(t.length===1)return l.distSqr(t[0])<d;for(let _=1;_<t.length;_++)if(zm(l,t[_-1],t[_])<d)return!0;return!1}function zm(l,t,s){const d=t.distSqr(s);if(d===0)return l.distSqr(t);const _=((l.x-t.x)*(s.x-t.x)+(l.y-t.y)*(s.y-t.y))/d;return l.distSqr(_<0?t:_>1?s:s.sub(t)._mult(_)._add(t))}function oy(l,t){let s,d,_,T=!1;for(let E=0;E<l.length;E++){s=l[E];for(let C=0,R=s.length-1;C<s.length;R=C++)d=s[C],_=s[R],d.y>t.y!=_.y>t.y&&t.x<(_.x-d.x)*(t.y-d.y)/(_.y-d.y)+d.x&&(T=!T)}return T}function Su(l,t){let s=!1;for(let d=0,_=l.length-1;d<l.length;_=d++){const T=l[d],E=l[_];T.y>t.y!=E.y>t.y&&t.x<(E.x-T.x)*(t.y-T.y)/(E.y-T.y)+T.x&&(s=!s)}return s}function sy(l,t,s){const d=s[0],_=s[2];if(l.x<d.x&&t.x<d.x||l.x>_.x&&t.x>_.x||l.y<d.y&&t.y<d.y||l.y>_.y&&t.y>_.y)return!1;const T=ai(l,t,s[0]);return T!==ai(l,t,s[1])||T!==ai(l,t,s[2])||T!==ai(l,t,s[3])}function Nh(l,t,s){const d=t.paint.get(l).value;return d.kind==="constant"?d.value:s.programConfigurations.get(t.id).getMaxValue(l)}function gp(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Wd(l,t,s,d,_){if(!t[0]&&!t[1])return l;const T=$.convert(t)._mult(_);s==="viewport"&&T._rotate(-d);const E=[];for(let C=0;C<l.length;C++)E.push(l[C].sub(T));return E}let ly,jl;Ft("CircleBucket",kh,{omit:["layers"]});var cy={get paint(){return jl=jl||new _a({"circle-radius":new rn(de.paint_circle["circle-radius"]),"circle-color":new rn(de.paint_circle["circle-color"]),"circle-blur":new rn(de.paint_circle["circle-blur"]),"circle-opacity":new rn(de.paint_circle["circle-opacity"]),"circle-translate":new Wt(de.paint_circle["circle-translate"]),"circle-translate-anchor":new Wt(de.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Wt(de.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Wt(de.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new rn(de.paint_circle["circle-stroke-width"]),"circle-stroke-color":new rn(de.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new rn(de.paint_circle["circle-stroke-opacity"])})},get layout(){return ly=ly||new _a({"circle-sort-key":new rn(de.layout_circle["circle-sort-key"])})}};class Dv extends ls{constructor(t){super(t,cy)}createBucket(t){return new kh(t)}queryRadius(t){const s=t;return Nh("circle-radius",this,s)+Nh("circle-stroke-width",this,s)+gp(this.paint.get("circle-translate"))}queryIntersectsFeature({queryGeometry:t,feature:s,featureState:d,geometry:_,transform:T,pixelsToTileUnits:E,pixelPosMatrix:C}){const R=Wd(t,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),-T.bearingInRadians,E),B=this.paint.get("circle-radius").evaluate(s,d)+this.paint.get("circle-stroke-width").evaluate(s,d),U=this.paint.get("circle-pitch-alignment")==="map",G=U?R:function(W,K){return W.map(ne=>uy(ne,K))}(R,C),q=U?B*E:B;for(const W of _)for(const K of W){const ne=U?K:uy(K,C);let ue=q;const _e=Ot([],[K.x,K.y,0,1],C);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?ue*=_e[3]/T.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(ue*=T.cameraToCenterDistance/_e[3]),Rh(G,ne,ue))return!0}return!1}}function uy(l,t){const s=Ot([],[l.x,l.y,0,1],t);return new $(s[0]/s[3],s[1]/s[3])}class Om extends kh{}let Au;Ft("HeatmapBucket",Om,{omit:["layers"]});var Nc={get paint(){return Au=Au||new _a({"heatmap-radius":new rn(de.paint_heatmap["heatmap-radius"]),"heatmap-weight":new rn(de.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Wt(de.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Wi(de.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Wt(de.paint_heatmap["heatmap-opacity"])})}};function Fl(l,{width:t,height:s},d,_){if(_){if(_ instanceof Uint8ClampedArray)_=new Uint8Array(_.buffer);else if(_.length!==t*s*d)throw new RangeError(`mismatched image size. expected: ${_.length} but got: ${t*s*d}`)}else _=new Uint8Array(t*s*d);return l.width=t,l.height=s,l.data=_,l}function Ul(l,{width:t,height:s},d){if(t===l.width&&s===l.height)return;const _=Fl({},{width:t,height:s},d);yp(l,_,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,t),height:Math.min(l.height,s)},d),l.width=t,l.height=s,l.data=_.data}function yp(l,t,s,d,_,T){if(_.width===0||_.height===0)return t;if(_.width>l.width||_.height>l.height||s.x>l.width-_.width||s.y>l.height-_.height)throw new RangeError("out of range source coordinates for image copy");if(_.width>t.width||_.height>t.height||d.x>t.width-_.width||d.y>t.height-_.height)throw new RangeError("out of range destination coordinates for image copy");const E=l.data,C=t.data;if(E===C)throw new Error("srcData equals dstData, so image is already copied");for(let R=0;R<_.height;R++){const B=((s.y+R)*l.width+s.x)*T,U=((d.y+R)*t.width+d.x)*T;for(let G=0;G<_.width*T;G++)C[U+G]=E[B+G]}return t}class Ph{constructor(t,s){Fl(this,t,1,s)}resize(t){Ul(this,t,1)}clone(){return new Ph({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,s,d,_,T){yp(t,s,d,_,T,1)}}class Ra{constructor(t,s){Fl(this,t,4,s)}resize(t){Ul(this,t,4)}replace(t,s){s?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Ra({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,s,d,_,T){yp(t,s,d,_,T,4)}}function _p(l){const t={},s=l.resolution||256,d=l.clips?l.clips.length:1,_=l.image||new Ra({width:s,height:d});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const T=(E,C,R)=>{t[l.evaluationKey]=R;const B=l.expression.evaluate(t);_.data[E+C+0]=Math.floor(255*B.r/B.a),_.data[E+C+1]=Math.floor(255*B.g/B.a),_.data[E+C+2]=Math.floor(255*B.b/B.a),_.data[E+C+3]=Math.floor(255*B.a)};if(l.clips)for(let E=0,C=0;E<d;++E,C+=4*s)for(let R=0,B=0;R<s;R++,B+=4){const U=R/(s-1),{start:G,end:q}=l.clips[E];T(C,B,G*(1-U)+q*U)}else for(let E=0,C=0;E<s;E++,C+=4)T(0,C,E/(s-1));return _}Ft("AlphaImage",Ph),Ft("RGBAImage",Ra);const Pc="big-fb";class Za extends ls{createBucket(t){return new Om(t)}constructor(t){super(t,Nc),this.heatmapFbos=new Map,this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=_p({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbos.has(Pc)&&this.heatmapFbos.delete(Pc)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let vp;var L_={get paint(){return vp=vp||new _a({"hillshade-illumination-direction":new Wt(de.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Wt(de.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Wt(de.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Wt(de.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Wt(de.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Wt(de.paint_hillshade["hillshade-accent-color"])})}};class Cu extends ls{constructor(t){super(t,L_)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const hy=lr([{name:"a_pos",components:2,type:"Int16"}],4),{members:dy}=hy;function Vl(l,t,s){const d=s.patternDependencies;let _=!1;for(const T of t){const E=T.paint.get(`${l}-pattern`);E.isConstant()||(_=!0);const C=E.constantOr(null);C&&(_=!0,d[C.to]=!0,d[C.from]=!0)}return _}function Gl(l,t,s,d,_){const T=_.patternDependencies;for(const E of t){const C=E.paint.get(`${l}-pattern`).value;if(C.kind!=="constant"){let R=C.evaluate({zoom:d-1},s,{},_.availableImages),B=C.evaluate({zoom:d},s,{},_.availableImages),U=C.evaluate({zoom:d+1},s,{},_.availableImages);R=R&&R.name?R.name:R,B=B&&B.name?B.name:B,U=U&&U.name?U.name:U,T[R]=!0,T[B]=!0,T[U]=!0,s.patterns[E.id]={min:R,mid:B,max:U}}}return s}function Qd(l,t,s,d,_){let T;if(_===function(E,C,R,B){let U=0;for(let G=C,q=R-B;G<R;G+=B)U+=(E[q]-E[G])*(E[G+1]+E[q+1]),q=G;return U}(l,t,s,d)>0)for(let E=t;E<s;E+=d)T=fy(E/d|0,l[E],l[E+1],T);else for(let E=s-d;E>=t;E-=d)T=fy(E/d|0,l[E],l[E+1],T);return T&&Du(T,T.next)&&(Or(T),T=T.next),T}function zc(l,t){if(!l)return l;t||(t=l);let s,d=l;do if(s=!1,d.steiner||!Du(d,d.next)&&gr(d.prev,d,d.next)!==0)d=d.next;else{if(Or(d),d=t=d.prev,d===d.next)break;s=!0}while(s||d!==t);return t}function zh(l,t,s,d,_,T,E){if(!l)return;!E&&T&&function(R,B,U,G){let q=R;do q.z===0&&(q.z=Lm(q.x,q.y,B,U,G)),q.prevZ=q.prev,q.nextZ=q.next,q=q.next;while(q!==R);q.prevZ.nextZ=null,q.prevZ=null,function(W){let K,ne=1;do{let ue,_e=W;W=null;let Le=null;for(K=0;_e;){K++;let we=_e,X=0;for(let Ee=0;Ee<ne&&(X++,we=we.nextZ,we);Ee++);let ce=ne;for(;X>0||ce>0&&we;)X!==0&&(ce===0||!we||_e.z<=we.z)?(ue=_e,_e=_e.nextZ,X--):(ue=we,we=we.nextZ,ce--),Le?Le.nextZ=ue:W=ue,ue.prevZ=Le,Le=ue;_e=we}Le.nextZ=null,ne*=2}while(K>1)}(q)}(l,d,_,T);let C=l;for(;l.prev!==l.next;){const R=l.prev,B=l.next;if(T?xp(l,d,_,T):bp(l))t.push(R.i,l.i,B.i),Or(l),l=B.next,C=B.next;else if((l=B)===C){E?E===1?zh(l=B_(zc(l),t),t,s,d,_,T,2):E===2&&j_(l,t,s,d,_,T):zh(zc(l),t,s,d,_,T,1);break}}}function bp(l){const t=l.prev,s=l,d=l.next;if(gr(t,s,d)>=0)return!1;const _=t.x,T=s.x,E=d.x,C=t.y,R=s.y,B=d.y,U=Math.min(_,T,E),G=Math.min(C,R,B),q=Math.max(_,T,E),W=Math.max(C,R,B);let K=d.next;for(;K!==t;){if(K.x>=U&&K.x<=q&&K.y>=G&&K.y<=W&&Kd(_,C,T,R,E,B,K.x,K.y)&&gr(K.prev,K,K.next)>=0)return!1;K=K.next}return!0}function xp(l,t,s,d){const _=l.prev,T=l,E=l.next;if(gr(_,T,E)>=0)return!1;const C=_.x,R=T.x,B=E.x,U=_.y,G=T.y,q=E.y,W=Math.min(C,R,B),K=Math.min(U,G,q),ne=Math.max(C,R,B),ue=Math.max(U,G,q),_e=Lm(W,K,t,s,d),Le=Lm(ne,ue,t,s,d);let we=l.prevZ,X=l.nextZ;for(;we&&we.z>=_e&&X&&X.z<=Le;){if(we.x>=W&&we.x<=ne&&we.y>=K&&we.y<=ue&&we!==_&&we!==E&&Kd(C,U,R,G,B,q,we.x,we.y)&&gr(we.prev,we,we.next)>=0||(we=we.prevZ,X.x>=W&&X.x<=ne&&X.y>=K&&X.y<=ue&&X!==_&&X!==E&&Kd(C,U,R,G,B,q,X.x,X.y)&&gr(X.prev,X,X.next)>=0))return!1;X=X.nextZ}for(;we&&we.z>=_e;){if(we.x>=W&&we.x<=ne&&we.y>=K&&we.y<=ue&&we!==_&&we!==E&&Kd(C,U,R,G,B,q,we.x,we.y)&&gr(we.prev,we,we.next)>=0)return!1;we=we.prevZ}for(;X&&X.z<=Le;){if(X.x>=W&&X.x<=ne&&X.y>=K&&X.y<=ue&&X!==_&&X!==E&&Kd(C,U,R,G,B,q,X.x,X.y)&&gr(X.prev,X,X.next)>=0)return!1;X=X.nextZ}return!0}function B_(l,t){let s=l;do{const d=s.prev,_=s.next.next;!Du(d,_)&&Bm(d,s,s.next,_)&&Ki(d,_)&&Ki(_,d)&&(t.push(d.i,s.i,_.i),Or(s),Or(s.next),s=l=_),s=s.next}while(s!==l);return zc(s)}function j_(l,t,s,d,_,T){let E=l;do{let C=E.next.next;for(;C!==E.prev;){if(E.i!==C.i&&U_(E,C)){let R=jm(E,C);return E=zc(E,E.next),R=zc(R,R.next),zh(E,t,s,d,_,T,0),void zh(R,t,s,d,_,T,0)}C=C.next}E=E.next}while(E!==l)}function wp(l,t){let s=l.x-t.x;return s===0&&(s=l.y-t.y,s===0)&&(s=(l.next.y-l.y)/(l.next.x-l.x)-(t.next.y-t.y)/(t.next.x-t.x)),s}function Mu(l,t){const s=function(_,T){let E=T;const C=_.x,R=_.y;let B,U=-1/0;if(Du(_,E))return E;do{if(Du(_,E.next))return E.next;if(R<=E.y&&R>=E.next.y&&E.next.y!==E.y){const ne=E.x+(R-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(ne<=C&&ne>U&&(U=ne,B=E.x<E.next.x?E:E.next,ne===C))return B}E=E.next}while(E!==T);if(!B)return null;const G=B,q=B.x,W=B.y;let K=1/0;E=B;do{if(C>=E.x&&E.x>=q&&C!==E.x&&Go(R<W?C:U,R,q,W,R<W?U:C,R,E.x,E.y)){const ne=Math.abs(R-E.y)/(C-E.x);Ki(E,_)&&(ne<K||ne===K&&(E.x>B.x||E.x===B.x&&F_(B,E)))&&(B=E,K=ne)}E=E.next}while(E!==G);return B}(l,t);if(!s)return t;const d=jm(s,l);return zc(d,d.next),zc(s,s.next)}function F_(l,t){return gr(l.prev,l,t.prev)<0&&gr(t.next,l,l.next)<0}function Lm(l,t,s,d,_){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-s)*_|0)|l<<8))|l<<4))|l<<2))|l<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-d)*_|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Oh(l){let t=l,s=l;do(t.x<s.x||t.x===s.x&&t.y<s.y)&&(s=t),t=t.next;while(t!==l);return s}function Go(l,t,s,d,_,T,E,C){return(_-E)*(t-C)>=(l-E)*(T-C)&&(l-E)*(d-C)>=(s-E)*(t-C)&&(s-E)*(T-C)>=(_-E)*(d-C)}function Kd(l,t,s,d,_,T,E,C){return!(l===E&&t===C)&&Go(l,t,s,d,_,T,E,C)}function U_(l,t){return l.next.i!==t.i&&l.prev.i!==t.i&&!function(s,d){let _=s;do{if(_.i!==s.i&&_.next.i!==s.i&&_.i!==d.i&&_.next.i!==d.i&&Bm(_,_.next,s,d))return!0;_=_.next}while(_!==s);return!1}(l,t)&&(Ki(l,t)&&Ki(t,l)&&function(s,d){let _=s,T=!1;const E=(s.x+d.x)/2,C=(s.y+d.y)/2;do _.y>C!=_.next.y>C&&_.next.y!==_.y&&E<(_.next.x-_.x)*(C-_.y)/(_.next.y-_.y)+_.x&&(T=!T),_=_.next;while(_!==s);return T}(l,t)&&(gr(l.prev,l,t.prev)||gr(l,t.prev,t))||Du(l,t)&&gr(l.prev,l,l.next)>0&&gr(t.prev,t,t.next)>0)}function gr(l,t,s){return(t.y-l.y)*(s.x-t.x)-(t.x-l.x)*(s.y-t.y)}function Du(l,t){return l.x===t.x&&l.y===t.y}function Bm(l,t,s,d){const _=Ns(gr(l,t,s)),T=Ns(gr(l,t,d)),E=Ns(gr(s,d,l)),C=Ns(gr(s,d,t));return _!==T&&E!==C||!(_!==0||!Lh(l,s,t))||!(T!==0||!Lh(l,d,t))||!(E!==0||!Lh(s,l,d))||!(C!==0||!Lh(s,t,d))}function Lh(l,t,s){return t.x<=Math.max(l.x,s.x)&&t.x>=Math.min(l.x,s.x)&&t.y<=Math.max(l.y,s.y)&&t.y>=Math.min(l.y,s.y)}function Ns(l){return l>0?1:l<0?-1:0}function Ki(l,t){return gr(l.prev,l,l.next)<0?gr(l,t,l.next)>=0&&gr(l,l.prev,t)>=0:gr(l,t,l.prev)<0||gr(l,l.next,t)<0}function jm(l,t){const s=Fm(l.i,l.x,l.y),d=Fm(t.i,t.x,t.y),_=l.next,T=t.prev;return l.next=t,t.prev=l,s.next=_,_.prev=s,d.next=s,s.prev=d,T.next=d,d.prev=T,d}function fy(l,t,s,d){const _=Fm(l,t,s);return d?(_.next=d.next,_.prev=d,d.next.prev=_,d.next=_):(_.prev=_,_.next=_),_}function Or(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function Fm(l,t,s){return{i:l,x:t,y:s,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}class Jd{constructor(t,s){if(s>t)throw new Error("Min granularity must not be greater than base granularity.");this._baseZoomGranularity=t,this._minGranularity=s}getGranularityForZoomLevel(t){return Math.max(Math.floor(this._baseZoomGranularity/(1<<t)),this._minGranularity,1)}}class Tp{constructor(t){this.fill=t.fill,this.line=t.line,this.tile=t.tile,this.stencil=t.stencil,this.circle=t.circle}}Tp.noSubdivision=new Tp({fill:new Jd(0,0),line:new Jd(0,0),tile:new Jd(0,0),stencil:new Jd(0,0),circle:1}),Ft("SubdivisionGranularityExpression",Jd),Ft("SubdivisionGranularitySetting",Tp);const Bh=-32768,yr=32767;class us{constructor(t,s){this._vertexBuffer=[],this._vertexDictionary=new Map,this._used=!1,this._granularity=t,this._granularityCellSize=Ge/t,this._canonical=s}_getKey(t,s){return(t+=32768)<<16|(s+=32768)<<0}_vertexToIndex(t,s){if(t<-32768||s<-32768||t>32767||s>32767)throw new Error("Vertex coordinates are out of signed 16 bit integer range.");const d=0|Math.round(t),_=0|Math.round(s),T=this._getKey(d,_);if(this._vertexDictionary.has(T))return this._vertexDictionary.get(T);const E=this._vertexBuffer.length/2;return this._vertexDictionary.set(T,E),this._vertexBuffer.push(d,_),E}_subdivideTrianglesScanline(t){if(this._granularity<2)return function(_,T){const E=[];for(let C=0;C<T.length;C+=3){const R=T[C],B=T[C+1],U=T[C+2],G=_[2*R],q=_[2*R+1];(_[2*B]-G)*(_[2*U+1]-q)-(_[2*B+1]-q)*(_[2*U]-G)>0?(E.push(R),E.push(U),E.push(B)):(E.push(R),E.push(B),E.push(U))}return E}(this._vertexBuffer,t);const s=[],d=t.length;for(let _=0;_<d;_+=3){const T=[t[_+0],t[_+1],t[_+2]],E=[this._vertexBuffer[2*t[_+0]+0],this._vertexBuffer[2*t[_+0]+1],this._vertexBuffer[2*t[_+1]+0],this._vertexBuffer[2*t[_+1]+1],this._vertexBuffer[2*t[_+2]+0],this._vertexBuffer[2*t[_+2]+1]];let C=1/0,R=1/0,B=-1/0,U=-1/0;for(let ne=0;ne<3;ne++){const ue=E[2*ne],_e=E[2*ne+1];C=Math.min(C,ue),B=Math.max(B,ue),R=Math.min(R,_e),U=Math.max(U,_e)}if(C===B||R===U)continue;const G=Math.floor(C/this._granularityCellSize),q=Math.ceil(B/this._granularityCellSize),W=Math.floor(R/this._granularityCellSize),K=Math.ceil(U/this._granularityCellSize);if(G!==q||W!==K)for(let ne=W;ne<K;ne++){const ue=this._scanlineGenerateVertexRingForCellRow(ne,E,T);V_(this._vertexBuffer,ue,s)}else s.push(...T)}return s}_scanlineGenerateVertexRingForCellRow(t,s,d){const _=t*this._granularityCellSize,T=_+this._granularityCellSize,E=[];for(let C=0;C<3;C++){const R=s[2*C],B=s[2*C+1],U=s[2*(C+1)%6],G=s[(2*(C+1)+1)%6],q=s[2*(C+2)%6],W=s[(2*(C+2)+1)%6],K=U-R,ne=G-B,ue=K===0,_e=ne===0,Le=(_-B)/ne,we=(T-B)/ne,X=Math.min(Le,we),ce=Math.max(Le,we);if(!_e&&(X>=1||ce<=0)||_e&&(B<_||B>T)){G>=_&&G<=T&&E.push(d[(C+1)%3]);continue}!_e&&X>0&&E.push(this._vertexToIndex(R+K*X,B+ne*X));const Ee=R+K*Math.max(X,0),qe=R+K*Math.min(ce,1);ue||this._generateIntraEdgeVertices(E,R,B,U,G,Ee,qe),!_e&&ce<1&&E.push(this._vertexToIndex(R+K*ce,B+ne*ce)),(_e||G>=_&&G<=T)&&E.push(d[(C+1)%3]),!_e&&(G<=_||G>=T)&&this._generateInterEdgeVertices(E,R,B,U,G,q,W,qe,_,T)}return E}_generateIntraEdgeVertices(t,s,d,_,T,E,C){const R=_-s,B=T-d,U=B===0,G=U?Math.min(s,_):Math.min(E,C),q=U?Math.max(s,_):Math.max(E,C),W=Math.floor(G/this._granularityCellSize)+1,K=Math.ceil(q/this._granularityCellSize)-1;if(U?s<_:E<C)for(let ne=W;ne<=K;ne++){const ue=ne*this._granularityCellSize;t.push(this._vertexToIndex(ue,d+B*(ue-s)/R))}else for(let ne=K;ne>=W;ne--){const ue=ne*this._granularityCellSize;t.push(this._vertexToIndex(ue,d+B*(ue-s)/R))}}_generateInterEdgeVertices(t,s,d,_,T,E,C,R,B,U){const G=T-d,q=E-_,W=C-T,K=(B-T)/W,ne=(U-T)/W,ue=Math.min(K,ne),_e=Math.max(K,ne),Le=_+q*ue;let we=Math.floor(Math.min(Le,R)/this._granularityCellSize)+1,X=Math.ceil(Math.max(Le,R)/this._granularityCellSize)-1,ce=R<Le;const Ee=W===0;if(Ee&&(C===B||C===U))return;if(Ee||ue>=1||_e<=0){const yt=d-C,et=E+(s-E)*Math.min((B-C)/yt,(U-C)/yt);we=Math.floor(Math.min(et,R)/this._granularityCellSize)+1,X=Math.ceil(Math.max(et,R)/this._granularityCellSize)-1,ce=R<et}const qe=G>0?U:B;if(ce)for(let yt=we;yt<=X;yt++)t.push(this._vertexToIndex(yt*this._granularityCellSize,qe));else for(let yt=X;yt>=we;yt--)t.push(this._vertexToIndex(yt*this._granularityCellSize,qe))}_generateOutline(t){const s=[];for(const d of t){const _=Iu(d,this._granularity,!0),T=this._pointArrayToIndices(_),E=[];for(let C=1;C<T.length;C++)E.push(T[C-1]),E.push(T[C]);s.push(E)}return s}_handlePoles(t){let s=!1,d=!1;this._canonical&&(this._canonical.y===0&&(s=!0),this._canonical.y===(1<<this._canonical.z)-1&&(d=!0)),(s||d)&&this._fillPoles(t,s,d)}_ensureNoPoleVertices(){const t=this._vertexBuffer;for(let s=0;s<t.length;s+=2){const d=t[s+1];d===Bh&&(t[s+1]=-32767),d===yr&&(t[s+1]=32766)}}_generatePoleQuad(t,s,d,_,T,E){_>T!=(E===Bh)?(t.push(s),t.push(d),t.push(this._vertexToIndex(_,E)),t.push(d),t.push(this._vertexToIndex(T,E)),t.push(this._vertexToIndex(_,E))):(t.push(d),t.push(s),t.push(this._vertexToIndex(_,E)),t.push(this._vertexToIndex(T,E)),t.push(d),t.push(this._vertexToIndex(_,E)))}_fillPoles(t,s,d){const _=this._vertexBuffer,T=Ge,E=t.length;for(let C=2;C<E;C+=3){const R=t[C-2],B=t[C-1],U=t[C],G=_[2*R],q=_[2*R+1],W=_[2*B],K=_[2*B+1],ne=_[2*U],ue=_[2*U+1];s&&(q===0&&K===0&&this._generatePoleQuad(t,R,B,G,W,Bh),K===0&&ue===0&&this._generatePoleQuad(t,B,U,W,ne,Bh),ue===0&&q===0&&this._generatePoleQuad(t,U,R,ne,G,Bh)),d&&(q===T&&K===T&&this._generatePoleQuad(t,R,B,G,W,yr),K===T&&ue===T&&this._generatePoleQuad(t,B,U,W,ne,yr),ue===T&&q===T&&this._generatePoleQuad(t,U,R,ne,G,yr))}}_initializeVertices(t){for(let s=0;s<t.length;s+=2)this._vertexToIndex(t[s],t[s+1])}subdividePolygonInternal(t,s){if(this._used)throw new Error("Subdivision: multiple use not allowed.");this._used=!0;const{flattened:d,holeIndices:_}=function(C){const R=[],B=[];for(const U of C)if(U.length!==0){U!==C[0]&&R.push(B.length/2);for(let G=0;G<U.length;G++)B.push(U[G].x),B.push(U[G].y)}return{flattened:B,holeIndices:R}}(t);let T;this._initializeVertices(d);try{const C=function(B,U,G=2){const q=U&&U.length,W=q?U[0]*G:B.length;let K=Qd(B,0,W,G,!0);const ne=[];if(!K||K.next===K.prev)return ne;let ue,_e,Le;if(q&&(K=function(we,X,ce,Ee){const qe=[];for(let yt=0,et=X.length;yt<et;yt++){const rt=Qd(we,X[yt]*Ee,yt<et-1?X[yt+1]*Ee:we.length,Ee,!1);rt===rt.next&&(rt.steiner=!0),qe.push(Oh(rt))}qe.sort(wp);for(let yt=0;yt<qe.length;yt++)ce=Mu(qe[yt],ce);return ce}(B,U,K,G)),B.length>80*G){ue=1/0,_e=1/0;let we=-1/0,X=-1/0;for(let ce=G;ce<W;ce+=G){const Ee=B[ce],qe=B[ce+1];Ee<ue&&(ue=Ee),qe<_e&&(_e=qe),Ee>we&&(we=Ee),qe>X&&(X=qe)}Le=Math.max(we-ue,X-_e),Le=Le!==0?32767/Le:0}return zh(K,ne,G,ue,_e,Le,0),ne}(d,_),R=this._convertIndices(d,C);T=this._subdivideTrianglesScanline(R)}catch(C){console.error(C)}let E=[];return s&&(E=this._generateOutline(t)),this._ensureNoPoleVertices(),this._handlePoles(T),{verticesFlattened:this._vertexBuffer,indicesTriangles:T,indicesLineList:E}}_convertIndices(t,s){const d=[];for(let _=0;_<s.length;_++)d.push(this._vertexToIndex(t[2*s[_]],t[2*s[_]+1]));return d}_pointArrayToIndices(t){const s=[];for(let d=0;d<t.length;d++){const _=t[d];s.push(this._vertexToIndex(_.x,_.y))}return s}}function Zl(l,t,s,d=!0){return new us(s,t).subdividePolygonInternal(l,d)}function Iu(l,t,s=!1){if(!l||l.length<1)return[];if(l.length<2)return[];const d=l[0],_=l[l.length-1],T=s&&(d.x!==_.x||d.y!==_.y);if(t<2)return T?[...l,l[0]]:[...l];const E=Math.floor(Ge/t),C=[];C.push(new $(l[0].x,l[0].y));const R=l.length,B=T?R:R-1;for(let U=0;U<B;U++){const G=l[U],q=U<R-1?l[U+1]:l[0],W=G.x,K=G.y,ne=q.x,ue=q.y,_e=W!==ne,Le=K!==ue;if(!_e&&!Le)continue;const we=ne-W,X=ue-K,ce=Math.abs(we),Ee=Math.abs(X);let qe=W,yt=K;for(;;){const rt=we>0?(Math.floor(qe/E)+1)*E:(Math.ceil(qe/E)-1)*E,Et=X>0?(Math.floor(yt/E)+1)*E:(Math.ceil(yt/E)-1)*E,_t=Math.abs(qe-rt),St=Math.abs(yt-Et),lt=Math.abs(qe-ne),Zt=Math.abs(yt-ue),on=_e?_t/ce:Number.POSITIVE_INFINITY,an=Le?St/Ee:Number.POSITIVE_INFINITY;if((lt<=_t||!_e)&&(Zt<=St||!Le))break;if(on<an&&_e||!Le){qe=rt,yt+=X*on;const Xt=new $(qe,Math.round(yt));C[C.length-1].x===Xt.x&&C[C.length-1].y===Xt.y||C.push(Xt)}else{qe+=we*an,yt=Et;const Xt=new $(Math.round(qe),yt);C[C.length-1].x===Xt.x&&C[C.length-1].y===Xt.y||C.push(Xt)}}const et=new $(ne,ue);C[C.length-1].x===et.x&&C[C.length-1].y===et.y||C.push(et)}return C}function V_(l,t,s){if(t.length===0)throw new Error("Subdivision vertex ring is empty.");let d=0,_=l[2*t[0]];for(let R=1;R<t.length;R++){const B=l[2*t[R]];B<_&&(_=B,d=R)}const T=t.length;let E=d,C=(E+1)%T;for(;;){const R=E-1>=0?E-1:T-1,B=(C+1)%T,U=l[2*t[R]],G=l[2*t[B]],q=l[2*t[E]],W=l[2*t[E]+1],K=l[2*t[C]+1];let ne=!1;if(U<G)ne=!0;else if(U>G)ne=!1;else{const ue=K-W,_e=-(l[2*t[C]]-q),Le=W<K?1:-1;((U-q)*ue+(l[2*t[R]+1]-W)*_e)*Le>((G-q)*ue+(l[2*t[B]+1]-W)*_e)*Le&&(ne=!0)}if(ne){const ue=t[R],_e=t[E],Le=t[C];ue!==_e&&ue!==Le&&_e!==Le&&s.push(Le,_e,ue),E--,E<0&&(E=T-1)}else{const ue=t[B],_e=t[E],Le=t[C];ue!==_e&&ue!==Le&&_e!==Le&&s.push(Le,_e,ue),C++,C>=T&&(C=0)}if(R===B)break}}function G_(l,t,s,d,_,T,E,C,R){const B=_.length/2,U=E&&C&&R;if(B<zt.MAX_VERTEX_ARRAY_LENGTH){const G=t.prepareSegment(B,s,d),q=G.vertexLength;for(let ne=0;ne<T.length;ne+=3)d.emplaceBack(q+T[ne],q+T[ne+1],q+T[ne+2]);let W,K;G.vertexLength+=B,G.primitiveLength+=T.length/3,U&&(K=E.prepareSegment(B,s,C),W=K.vertexLength,K.vertexLength+=B);for(let ne=0;ne<_.length;ne+=2)l(_[ne],_[ne+1]);if(U)for(let ne=0;ne<R.length;ne++){const ue=R[ne];for(let _e=1;_e<ue.length;_e+=2)C.emplaceBack(W+ue[_e-1],W+ue[_e]);K.primitiveLength+=ue.length/2}}else(function(G,q,W,K,ne,ue){const _e=[];for(let Ee=0;Ee<K.length/2;Ee++)_e.push(-1);const Le={count:0};let we=0,X=G.getOrCreateLatestSegment(q,W),ce=X.vertexLength;for(let Ee=2;Ee<ne.length;Ee+=3){const qe=ne[Ee-2],yt=ne[Ee-1],et=ne[Ee];let rt=_e[qe]<we,Et=_e[yt]<we,_t=_e[et]<we;X.vertexLength+((rt?1:0)+(Et?1:0)+(_t?1:0))>zt.MAX_VERTEX_ARRAY_LENGTH&&(X=G.createNewSegment(q,W),we=Le.count,rt=!0,Et=!0,_t=!0,ce=0);const St=jh(_e,K,ue,Le,qe,rt,X),lt=jh(_e,K,ue,Le,yt,Et,X),Zt=jh(_e,K,ue,Le,et,_t,X);W.emplaceBack(ce+St-we,ce+lt-we,ce+Zt-we),X.primitiveLength++}})(t,s,d,_,T,l),U&&function(G,q,W,K,ne,ue){const _e=[];for(let Ee=0;Ee<K.length/2;Ee++)_e.push(-1);const Le={count:0};let we=0,X=G.getOrCreateLatestSegment(q,W),ce=X.vertexLength;for(let Ee=0;Ee<ne.length;Ee++){const qe=ne[Ee];for(let yt=1;yt<ne[Ee].length;yt+=2){const et=qe[yt-1],rt=qe[yt];let Et=_e[et]<we,_t=_e[rt]<we;X.vertexLength+((Et?1:0)+(_t?1:0))>zt.MAX_VERTEX_ARRAY_LENGTH&&(X=G.createNewSegment(q,W),we=Le.count,Et=!0,_t=!0,ce=0);const St=jh(_e,K,ue,Le,et,Et,X),lt=jh(_e,K,ue,Le,rt,_t,X);W.emplaceBack(ce+St-we,ce+lt-we),X.primitiveLength++}}}(E,s,C,_,R,l),t.forceNewSegmentOnNextPrepare(),E==null||E.forceNewSegmentOnNextPrepare()}function jh(l,t,s,d,_,T,E){if(T){const C=d.count;return s(t[2*_],t[2*_+1]),l[_]=d.count,d.count++,E.vertexLength++,C}return l[_]}class Zo{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new be,this.indexArray=new nt,this.indexArray2=new kt,this.programConfigurations=new Vi(t.layers,t.zoom),this.segments=new zt,this.segments2=new zt,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,d){this.hasPattern=Vl("fill",this.layers,s);const _=this.layers[0].layout.get("fill-sort-key"),T=!_.isConstant(),E=[];for(const{feature:C,id:R,index:B,sourceLayerIndex:U}of t){const G=this.layers[0]._featureFilter.needGeometry,q=Bl(C,G);if(!this.layers[0]._featureFilter.filter(new Mi(this.zoom),q,d))continue;const W=T?_.evaluate(q,{},d,s.availableImages):void 0,K={id:R,properties:C.properties,type:C.type,sourceLayerIndex:U,index:B,geometry:G?q.geometry:Ll(C),patterns:{},sortKey:W};E.push(K)}T&&E.sort((C,R)=>C.sortKey-R.sortKey);for(const C of E){const{geometry:R,index:B,sourceLayerIndex:U}=C;if(this.hasPattern){const G=Gl("fill",this.layers,C,this.zoom,s);this.patternFeatures.push(G)}else this.addFeature(C,R,B,d,{},s.subdivisionGranularity);s.featureIndex.insert(t[B].feature,R,B,U,this.index)}}update(t,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,d)}addFeatures(t,s,d){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,s,d,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,dy),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,s,d,_,T,E){for(const C of Id(s,500)){const R=Zl(C,_,E.fill.getGranularityForZoomLevel(_.z)),B=this.layoutVertexArray;G_((U,G)=>{B.emplaceBack(U,G)},this.segments,this.layoutVertexArray,this.indexArray,R.verticesFlattened,R.indicesTriangles,this.segments2,this.indexArray2,R.indicesLineList)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,T,_)}}let Ps,py;Ft("FillBucket",Zo,{omit:["layers","patternFeatures"]});var zs={get paint(){return py=py||new _a({"fill-antialias":new Wt(de.paint_fill["fill-antialias"]),"fill-opacity":new rn(de.paint_fill["fill-opacity"]),"fill-color":new rn(de.paint_fill["fill-color"]),"fill-outline-color":new rn(de.paint_fill["fill-outline-color"]),"fill-translate":new Wt(de.paint_fill["fill-translate"]),"fill-translate-anchor":new Wt(de.paint_fill["fill-translate-anchor"]),"fill-pattern":new ks(de.paint_fill["fill-pattern"])})},get layout(){return Ps=Ps||new _a({"fill-sort-key":new rn(de.layout_fill["fill-sort-key"])})}};class Z_ extends ls{constructor(t){super(t,zs)}recalculate(t,s){super.recalculate(t,s);const d=this.paint._values["fill-outline-color"];d.value.kind==="constant"&&d.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Zo(t)}queryRadius(){return gp(this.paint.get("fill-translate"))}queryIntersectsFeature({queryGeometry:t,geometry:s,transform:d,pixelsToTileUnits:_}){return Hd(Wd(t,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),-d.bearingInRadians,_),s)}isTileClipped(){return!0}}const Oc=lr([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),ef=lr([{name:"a_centroid",components:2,type:"Int16"}],4),{members:ku}=Oc;var Ep,Um,$l,my,Ru,tf,nf,Lc={};function gy(){if(Um)return Ep;Um=1;var l=L();function t(_,T,E,C,R){this.properties={},this.extent=E,this.type=0,this._pbf=_,this._geometry=-1,this._keys=C,this._values=R,_.readFields(s,this,T)}function s(_,T,E){_==1?T.id=E.readVarint():_==2?function(C,R){for(var B=C.readVarint()+C.pos;C.pos<B;){var U=R._keys[C.readVarint()],G=R._values[C.readVarint()];R.properties[U]=G}}(E,T):_==3?T.type=E.readVarint():_==4&&(T._geometry=E.pos)}function d(_){for(var T,E,C=0,R=0,B=_.length,U=B-1;R<B;U=R++)C+=((E=_[U]).x-(T=_[R]).x)*(T.y+E.y);return C}return Ep=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var _=this._pbf;_.pos=this._geometry;for(var T,E=_.readVarint()+_.pos,C=1,R=0,B=0,U=0,G=[];_.pos<E;){if(R<=0){var q=_.readVarint();C=7&q,R=q>>3}if(R--,C===1||C===2)B+=_.readSVarint(),U+=_.readSVarint(),C===1&&(T&&G.push(T),T=[]),T.push(new l(B,U));else{if(C!==7)throw new Error("unknown command "+C);T&&T.push(T[0].clone())}}return T&&G.push(T),G},t.prototype.bbox=function(){var _=this._pbf;_.pos=this._geometry;for(var T=_.readVarint()+_.pos,E=1,C=0,R=0,B=0,U=1/0,G=-1/0,q=1/0,W=-1/0;_.pos<T;){if(C<=0){var K=_.readVarint();E=7&K,C=K>>3}if(C--,E===1||E===2)(R+=_.readSVarint())<U&&(U=R),R>G&&(G=R),(B+=_.readSVarint())<q&&(q=B),B>W&&(W=B);else if(E!==7)throw new Error("unknown command "+E)}return[U,q,G,W]},t.prototype.toGeoJSON=function(_,T,E){var C,R,B=this.extent*Math.pow(2,E),U=this.extent*_,G=this.extent*T,q=this.loadGeometry(),W=t.types[this.type];function K(_e){for(var Le=0;Le<_e.length;Le++){var we=_e[Le];_e[Le]=[360*(we.x+U)/B-180,360/Math.PI*Math.atan(Math.exp((180-360*(we.y+G)/B)*Math.PI/180))-90]}}switch(this.type){case 1:var ne=[];for(C=0;C<q.length;C++)ne[C]=q[C][0];K(q=ne);break;case 2:for(C=0;C<q.length;C++)K(q[C]);break;case 3:for(q=function(_e){var Le=_e.length;if(Le<=1)return[_e];for(var we,X,ce=[],Ee=0;Ee<Le;Ee++){var qe=d(_e[Ee]);qe!==0&&(X===void 0&&(X=qe<0),X===qe<0?(we&&ce.push(we),we=[_e[Ee]]):we.push(_e[Ee]))}return we&&ce.push(we),ce}(q),C=0;C<q.length;C++)for(R=0;R<q[C].length;R++)K(q[C][R])}q.length===1?q=q[0]:W="Multi"+W;var ue={type:"Feature",geometry:{type:W,coordinates:q},properties:this.properties};return"id"in this&&(ue.id=this.id),ue},Ep}function yy(){if(my)return $l;my=1;var l=gy();function t(d,_){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=d,this._keys=[],this._values=[],this._features=[],d.readFields(s,this,_),this.length=this._features.length}function s(d,_,T){d===15?_.version=T.readVarint():d===1?_.name=T.readString():d===5?_.extent=T.readVarint():d===2?_._features.push(T.pos):d===3?_._keys.push(T.readString()):d===4&&_._values.push(function(E){for(var C=null,R=E.readVarint()+E.pos;E.pos<R;){var B=E.readVarint()>>3;C=B===1?E.readString():B===2?E.readFloat():B===3?E.readDouble():B===4?E.readVarint64():B===5?E.readVarint():B===6?E.readSVarint():B===7?E.readBoolean():null}return C}(T))}return $l=t,t.prototype.feature=function(d){if(d<0||d>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[d];var _=this._pbf.readVarint()+this._pbf.pos;return new l(this._pbf,_,this.extent,this._keys,this._values)},$l}function rf(){return nf||(nf=1,Lc.VectorTile=function(){if(tf)return Ru;tf=1;var l=yy();function t(s,d,_){if(s===3){var T=new l(_,_.readVarint()+_.pos);T.length&&(d[T.name]=T)}}return Ru=function(s,d){this.layers=s.readFields(t,{},d)},Ru}(),Lc.VectorTileFeature=gy(),Lc.VectorTileLayer=yy()),Lc}var af=A(rf());const Vm=af.VectorTileFeature.types,Gm=Math.pow(2,13);function Sp(l,t,s,d,_,T,E,C){l.emplaceBack(t,s,2*Math.floor(d*Gm)+E,_*Gm*2,T*Gm*2,Math.round(C))}class $o{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Se,this.centroidVertexArray=new pe,this.indexArray=new nt,this.programConfigurations=new Vi(t.layers,t.zoom),this.segments=new zt,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,d){this.features=[],this.hasPattern=Vl("fill-extrusion",this.layers,s);for(const{feature:_,id:T,index:E,sourceLayerIndex:C}of t){const R=this.layers[0]._featureFilter.needGeometry,B=Bl(_,R);if(!this.layers[0]._featureFilter.filter(new Mi(this.zoom),B,d))continue;const U={id:T,sourceLayerIndex:C,index:E,geometry:R?B.geometry:Ll(_),properties:_.properties,type:_.type,patterns:{}};this.hasPattern?this.features.push(Gl("fill-extrusion",this.layers,U,this.zoom,s)):this.addFeature(U,U.geometry,E,d,{},s.subdivisionGranularity),s.featureIndex.insert(_,U.geometry,E,C,this.index,!0)}}addFeatures(t,s,d){for(const _ of this.features){const{geometry:T}=_;this.addFeature(_,T,_.index,s,d,t.subdivisionGranularity)}}update(t,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,d)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,ku),this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,ef.members,!0),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(t,s,d,_,T,E){for(const C of Id(s,500)){const R={x:0,y:0,sampleCount:0},B=this.layoutVertexArray.length;this.processPolygon(R,_,t,C,E);const U=this.layoutVertexArray.length-B,G=Math.floor(R.x/R.sampleCount),q=Math.floor(R.y/R.sampleCount);for(let W=0;W<U;W++)this.centroidVertexArray.emplaceBack(G,q)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,T,_)}processPolygon(t,s,d,_,T){if(_.length<1||vy(_[0]))return;for(const G of _)G.length!==0&&_y(t,G);const E={segment:this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray)},C=T.fill.getGranularityForZoomLevel(s.z),R=Vm[d.type]==="Polygon";for(const G of _){if(G.length===0||vy(G))continue;const q=Iu(G,C,R);this._generateSideFaces(q,E)}if(!R)return;const B=Zl(_,s,C,!1),U=this.layoutVertexArray;G_((G,q)=>{Sp(U,G,q,0,0,1,1,0)},this.segments,this.layoutVertexArray,this.indexArray,B.verticesFlattened,B.indicesTriangles)}_generateSideFaces(t,s){let d=0;for(let _=1;_<t.length;_++){const T=t[_],E=t[_-1];if(Nu(T,E))continue;s.segment.vertexLength+4>zt.MAX_VERTEX_ARRAY_LENGTH&&(s.segment=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const C=T.sub(E)._perp()._unit(),R=E.dist(T);d+R>32768&&(d=0),Sp(this.layoutVertexArray,T.x,T.y,C.x,C.y,0,0,d),Sp(this.layoutVertexArray,T.x,T.y,C.x,C.y,0,1,d),d+=R,Sp(this.layoutVertexArray,E.x,E.y,C.x,C.y,0,0,d),Sp(this.layoutVertexArray,E.x,E.y,C.x,C.y,0,1,d);const B=s.segment.vertexLength;this.indexArray.emplaceBack(B,B+2,B+1),this.indexArray.emplaceBack(B+1,B+2,B+3),s.segment.vertexLength+=4,s.segment.primitiveLength+=2}}}function _y(l,t){for(let s=0;s<t.length;s++){const d=t[s];s===t.length-1&&t[0].x===d.x&&t[0].y===d.y||(l.x+=d.x,l.y+=d.y,l.sampleCount++)}}function Nu(l,t){return l.x===t.x&&(l.x<0||l.x>Ge)||l.y===t.y&&(l.y<0||l.y>Ge)}function vy(l){return l.every(t=>t.x<0)||l.every(t=>t.x>Ge)||l.every(t=>t.y<0)||l.every(t=>t.y>Ge)}let Ap;Ft("FillExtrusionBucket",$o,{omit:["layers","features"]});var Fh={get paint(){return Ap=Ap||new _a({"fill-extrusion-opacity":new Wt(de["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new rn(de["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Wt(de["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Wt(de["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ks(de["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new rn(de["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new rn(de["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Wt(de["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class $_ extends ls{constructor(t){super(t,Fh)}createBucket(t){return new $o(t)}queryRadius(){return gp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature({queryGeometry:t,feature:s,featureState:d,geometry:_,transform:T,pixelsToTileUnits:E,pixelPosMatrix:C}){const R=Wd(t,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),-T.bearingInRadians,E),B=this.paint.get("fill-extrusion-height").evaluate(s,d),U=this.paint.get("fill-extrusion-base").evaluate(s,d),G=function(W,K,ne){const ue=[];for(const _e of W){const Le=[_e.x,_e.y,0,1];Ot(Le,Le,K),ue.push(new $(Le[0]/Le[3],Le[1]/Le[3]))}return ue}(R,C),q=function(W,K,ne,ue){const _e=[],Le=[],we=ue[8]*K,X=ue[9]*K,ce=ue[10]*K,Ee=ue[11]*K,qe=ue[8]*ne,yt=ue[9]*ne,et=ue[10]*ne,rt=ue[11]*ne;for(const Et of W){const _t=[],St=[];for(const lt of Et){const Zt=lt.x,on=lt.y,an=ue[0]*Zt+ue[4]*on+ue[12],Xt=ue[1]*Zt+ue[5]*on+ue[13],Pn=ue[2]*Zt+ue[6]*on+ue[14],zi=ue[3]*Zt+ue[7]*on+ue[15],Mr=Pn+ce,sa=zi+Ee,fo=an+qe,Br=Xt+yt,tr=Pn+et,di=zi+rt,vr=new $((an+we)/sa,(Xt+X)/sa);vr.z=Mr/sa,_t.push(vr);const Dr=new $(fo/di,Br/di);Dr.z=tr/di,St.push(Dr)}_e.push(_t),Le.push(St)}return[_e,Le]}(_,U,B,C);return function(W,K,ne){let ue=1/0;Hd(ne,K)&&(ue=Zm(ne,K[0]));for(let _e=0;_e<K.length;_e++){const Le=K[_e],we=W[_e];for(let X=0;X<Le.length-1;X++){const ce=Le[X],Ee=[ce,Le[X+1],we[X+1],we[X],ce];Rc(ne,Ee)&&(ue=Math.min(ue,Zm(ne,Ee)))}}return ue!==1/0&&ue}(q[0],q[1],G)}}function Uh(l,t){return l.x*t.x+l.y*t.y}function Zm(l,t){if(l.length===1){let s=0;const d=t[s++];let _;for(;!_||d.equals(_);)if(_=t[s++],!_)return 1/0;for(;s<t.length;s++){const T=t[s],E=l[0],C=_.sub(d),R=T.sub(d),B=E.sub(d),U=Uh(C,C),G=Uh(C,R),q=Uh(R,R),W=Uh(B,C),K=Uh(B,R),ne=U*q-G*G,ue=(q*W-G*K)/ne,_e=(U*K-G*W)/ne,Le=d.z*(1-ue-_e)+_.z*ue+T.z*_e;if(isFinite(Le))return Le}return 1/0}{let s=1/0;for(const d of t)s=Math.min(s,d.z);return s}}const Bc=lr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Y_}=Bc,$m=lr([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Cp}=$m,Cr=af.VectorTileFeature.types,Iv=Math.cos(Math.PI/180*37.5),q_=Math.pow(2,14)/.5;class Ym{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new ke,this.layoutVertexArray2=new Re,this.indexArray=new nt,this.programConfigurations=new Vi(t.layers,t.zoom),this.segments=new zt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,d){this.hasPattern=Vl("line",this.layers,s);const _=this.layers[0].layout.get("line-sort-key"),T=!_.isConstant(),E=[];for(const{feature:C,id:R,index:B,sourceLayerIndex:U}of t){const G=this.layers[0]._featureFilter.needGeometry,q=Bl(C,G);if(!this.layers[0]._featureFilter.filter(new Mi(this.zoom),q,d))continue;const W=T?_.evaluate(q,{},d):void 0,K={id:R,properties:C.properties,type:C.type,sourceLayerIndex:U,index:B,geometry:G?q.geometry:Ll(C),patterns:{},sortKey:W};E.push(K)}T&&E.sort((C,R)=>C.sortKey-R.sortKey);for(const C of E){const{geometry:R,index:B,sourceLayerIndex:U}=C;if(this.hasPattern){const G=Gl("line",this.layers,C,this.zoom,s);this.patternFeatures.push(G)}else this.addFeature(C,R,B,d,{},s.subdivisionGranularity);s.featureIndex.insert(t[B].feature,R,B,U,this.index)}}update(t,s,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,d)}addFeatures(t,s,d){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,s,d,t.subdivisionGranularity)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,Cp)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Y_),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(t.properties,"mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,s,d,_,T,E){const C=this.layers[0].layout,R=C.get("line-join").evaluate(t,{}),B=C.get("line-cap"),U=C.get("line-miter-limit"),G=C.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const q of s)this.addLine(q,t,R,B,U,G,_,E);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,d,T,_)}addLine(t,s,d,_,T,E,C,R){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,t=Iu(t,C?R.line.getGranularityForZoomLevel(C.z):1),this.lineClips){this.lineClipsArray.push(this.lineClips);for(let we=0;we<t.length-1;we++)this.totalDistance+=t[we].dist(t[we+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const B=Cr[s.type]==="Polygon";let U=t.length;for(;U>=2&&t[U-1].equals(t[U-2]);)U--;let G=0;for(;G<U-1&&t[G].equals(t[G+1]);)G++;if(U<(B?3:2))return;d==="bevel"&&(T=1.05);const q=this.overscaling<=16?15*Ge/(512*this.overscaling):0,W=this.segments.prepareSegment(10*U,this.layoutVertexArray,this.indexArray);let K,ne,ue,_e,Le;this.e1=this.e2=-1,B&&(K=t[U-2],Le=t[G].sub(K)._unit()._perp());for(let we=G;we<U;we++){if(ue=we===U-1?B?t[G+1]:void 0:t[we+1],ue&&t[we].equals(ue))continue;Le&&(_e=Le),K&&(ne=K),K=t[we],Le=ue?ue.sub(K)._unit()._perp():_e,_e=_e||Le;let X=_e.add(Le);X.x===0&&X.y===0||X._unit();const ce=_e.x*Le.x+_e.y*Le.y,Ee=X.x*Le.x+X.y*Le.y,qe=Ee!==0?1/Ee:1/0,yt=2*Math.sqrt(2-2*Ee),et=Ee<Iv&&ne&&ue,rt=_e.x*Le.y-_e.y*Le.x>0;if(et&&we>G){const St=K.dist(ne);if(St>2*q){const lt=K.sub(K.sub(ne)._mult(q/St)._round());this.updateDistance(ne,lt),this.addCurrentVertex(lt,_e,0,0,W),ne=lt}}const Et=ne&&ue;let _t=Et?d:B?"butt":_;if(Et&&_t==="round"&&(qe<E?_t="miter":qe<=2&&(_t="fakeround")),_t==="miter"&&qe>T&&(_t="bevel"),_t==="bevel"&&(qe>2&&(_t="flipbevel"),qe<T&&(_t="miter")),ne&&this.updateDistance(ne,K),_t==="miter")X._mult(qe),this.addCurrentVertex(K,X,0,0,W);else if(_t==="flipbevel"){if(qe>100)X=Le.mult(-1);else{const St=qe*_e.add(Le).mag()/_e.sub(Le).mag();X._perp()._mult(St*(rt?-1:1))}this.addCurrentVertex(K,X,0,0,W),this.addCurrentVertex(K,X.mult(-1),0,0,W)}else if(_t==="bevel"||_t==="fakeround"){const St=-Math.sqrt(qe*qe-1),lt=rt?St:0,Zt=rt?0:St;if(ne&&this.addCurrentVertex(K,_e,lt,Zt,W),_t==="fakeround"){const on=Math.round(180*yt/Math.PI/20);for(let an=1;an<on;an++){let Xt=an/on;if(Xt!==.5){const zi=Xt-.5;Xt+=Xt*zi*(Xt-1)*((1.0904+ce*(ce*(3.55645-1.43519*ce)-3.2452))*zi*zi+(.848013+ce*(.215638*ce-1.06021)))}const Pn=Le.sub(_e)._mult(Xt)._add(_e)._unit()._mult(rt?-1:1);this.addHalfVertex(K,Pn.x,Pn.y,!1,rt,0,W)}}ue&&this.addCurrentVertex(K,Le,-lt,-Zt,W)}else if(_t==="butt")this.addCurrentVertex(K,X,0,0,W);else if(_t==="square"){const St=ne?1:-1;this.addCurrentVertex(K,X,St,St,W)}else _t==="round"&&(ne&&(this.addCurrentVertex(K,_e,0,0,W),this.addCurrentVertex(K,_e,1,1,W,!0)),ue&&(this.addCurrentVertex(K,Le,-1,-1,W,!0),this.addCurrentVertex(K,Le,0,0,W)));if(et&&we<U-1){const St=K.dist(ue);if(St>2*q){const lt=K.add(ue.sub(K)._mult(q/St)._round());this.updateDistance(K,lt),this.addCurrentVertex(lt,Le,0,0,W),K=lt}}}}addCurrentVertex(t,s,d,_,T,E=!1){const C=s.y*_-s.x,R=-s.y-s.x*_;this.addHalfVertex(t,s.x+s.y*d,s.y-s.x*d,E,!1,d,T),this.addHalfVertex(t,C,R,E,!0,-_,T),this.distance>q_/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(t,s,d,_,T,E))}addHalfVertex({x:t,y:s},d,_,T,E,C,R){const B=.5*(this.lineClips?this.scaledDistance*(q_-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t<<1)+(T?1:0),(s<<1)+(E?1:0),Math.round(63*d)+128,Math.round(63*_)+128,1+(C===0?0:C<0?-1:1)|(63&B)<<2,B>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const U=R.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,U,this.e2),R.primitiveLength++),E?this.e2=U:this.e1=U}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(t,s){this.distance+=t.dist(s),this.updateScaledDistance()}}let H_,X_;Ft("LineBucket",Ym,{omit:["layers","patternFeatures"]});var _r={get paint(){return X_=X_||new _a({"line-opacity":new rn(de.paint_line["line-opacity"]),"line-color":new rn(de.paint_line["line-color"]),"line-translate":new Wt(de.paint_line["line-translate"]),"line-translate-anchor":new Wt(de.paint_line["line-translate-anchor"]),"line-width":new rn(de.paint_line["line-width"]),"line-gap-width":new rn(de.paint_line["line-gap-width"]),"line-offset":new rn(de.paint_line["line-offset"]),"line-blur":new rn(de.paint_line["line-blur"]),"line-dasharray":new Gd(de.paint_line["line-dasharray"]),"line-pattern":new ks(de.paint_line["line-pattern"]),"line-gradient":new Wi(de.paint_line["line-gradient"])})},get layout(){return H_=H_||new _a({"line-cap":new Wt(de.layout_line["line-cap"]),"line-join":new rn(de.layout_line["line-join"]),"line-miter-limit":new Wt(de.layout_line["line-miter-limit"]),"line-round-limit":new Wt(de.layout_line["line-round-limit"]),"line-sort-key":new rn(de.layout_line["line-sort-key"])})}};class Ji extends rn{possiblyEvaluate(t,s){return s=new Mi(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(t,s)}evaluate(t,s,d,_){return s=jt({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(t,s,d,_)}}let jn;class si extends ls{constructor(t){super(t,_r),this.gradientVersion=0,jn||(jn=new Ji(_r.paint.properties["line-width"].specification),jn.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(d){return d._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof Ds,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,s){super.recalculate(t,s),this.paint._values["line-floorwidth"]=jn.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new Ym(t)}queryRadius(t){const s=t,d=Gi(Nh("line-width",this,s),Nh("line-gap-width",this,s)),_=Nh("line-offset",this,s);return d/2+Math.abs(_)+gp(this.paint.get("line-translate"))}queryIntersectsFeature({queryGeometry:t,feature:s,featureState:d,geometry:_,transform:T,pixelsToTileUnits:E}){const C=Wd(t,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),-T.bearingInRadians,E),R=E/2*Gi(this.paint.get("line-width").evaluate(s,d),this.paint.get("line-gap-width").evaluate(s,d)),B=this.paint.get("line-offset").evaluate(s,d);return B&&(_=function(U,G){const q=[];for(let W=0;W<U.length;W++){const K=U[W],ne=[];for(let ue=0;ue<K.length;ue++){const _e=K[ue-1],Le=K[ue],we=K[ue+1],X=ue===0?new $(0,0):Le.sub(_e)._unit()._perp(),ce=ue===K.length-1?new $(0,0):we.sub(Le)._unit()._perp(),Ee=X._add(ce)._unit(),qe=Ee.x*ce.x+Ee.y*ce.y;qe!==0&&Ee._mult(1/qe),ne.push(Ee._mult(G)._add(Le))}q.push(ne)}return q}(_,B*E)),function(U,G,q){for(let W=0;W<G.length;W++){const K=G[W];if(U.length>=3){for(let ne=0;ne<K.length;ne++)if(Su(U,K[ne]))return!0}if(Xd(U,K,q))return!0}return!1}(C,_,R)}isTileClipped(){return!0}}function Gi(l,t){return t>0?t+2*l:l}const hs=lr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),jc=lr([{name:"a_projected_pos",components:3,type:"Float32"}],4);lr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const of=lr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_box_real",components:2,type:"Int16"}]);lr([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const qm=lr([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Fc=lr([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Lr(l,t,s){return l.sections.forEach(d=>{d.text=function(_,T,E){const C=T.layout.get("text-transform").evaluate(E,{});return C==="uppercase"?_=_.toLocaleUpperCase():C==="lowercase"&&(_=_.toLocaleLowerCase()),os.applyArabicShaping&&(_=os.applyArabicShaping(_)),_}(d.text,t,s)}),l}lr([{name:"triangle",components:3,type:"Uint16"}]),lr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),lr([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),lr([{type:"Float32",name:"offsetX"}]),lr([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),lr([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Os={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Pu,Mp,ds,er=24,Vh={};function Yl(){return Pu||(Pu=1,Vh.read=function(l,t,s,d,_){var T,E,C=8*_-d-1,R=(1<<C)-1,B=R>>1,U=-7,G=s?_-1:0,q=s?-1:1,W=l[t+G];for(G+=q,T=W&(1<<-U)-1,W>>=-U,U+=C;U>0;T=256*T+l[t+G],G+=q,U-=8);for(E=T&(1<<-U)-1,T>>=-U,U+=d;U>0;E=256*E+l[t+G],G+=q,U-=8);if(T===0)T=1-B;else{if(T===R)return E?NaN:1/0*(W?-1:1);E+=Math.pow(2,d),T-=B}return(W?-1:1)*E*Math.pow(2,T-d)},Vh.write=function(l,t,s,d,_,T){var E,C,R,B=8*T-_-1,U=(1<<B)-1,G=U>>1,q=_===23?Math.pow(2,-24)-Math.pow(2,-77):0,W=d?0:T-1,K=d?1:-1,ne=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(C=isNaN(t)?1:0,E=U):(E=Math.floor(Math.log(t)/Math.LN2),t*(R=Math.pow(2,-E))<1&&(E--,R*=2),(t+=E+G>=1?q/R:q*Math.pow(2,1-G))*R>=2&&(E++,R/=2),E+G>=U?(C=0,E=U):E+G>=1?(C=(t*R-1)*Math.pow(2,_),E+=G):(C=t*Math.pow(2,G-1)*Math.pow(2,_),E=0));_>=8;l[s+W]=255&C,W+=K,C/=256,_-=8);for(E=E<<_|C,B+=_;B>0;l[s+W]=255&E,W+=K,E/=256,B-=8);l[s+W-K]|=128*ne}),Vh}function Hm(){if(ds)return Mp;ds=1,Mp=t;var l=Yl();function t(X){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(X)?X:new Uint8Array(X||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var s=4294967296,d=1/s,_=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");function T(X){return X.type===t.Bytes?X.readVarint()+X.pos:X.pos+1}function E(X,ce,Ee){return Ee?4294967296*ce+(X>>>0):4294967296*(ce>>>0)+(X>>>0)}function C(X,ce,Ee){var qe=ce<=16383?1:ce<=2097151?2:ce<=268435455?3:Math.floor(Math.log(ce)/(7*Math.LN2));Ee.realloc(qe);for(var yt=Ee.pos-1;yt>=X;yt--)Ee.buf[yt+qe]=Ee.buf[yt]}function R(X,ce){for(var Ee=0;Ee<X.length;Ee++)ce.writeVarint(X[Ee])}function B(X,ce){for(var Ee=0;Ee<X.length;Ee++)ce.writeSVarint(X[Ee])}function U(X,ce){for(var Ee=0;Ee<X.length;Ee++)ce.writeFloat(X[Ee])}function G(X,ce){for(var Ee=0;Ee<X.length;Ee++)ce.writeDouble(X[Ee])}function q(X,ce){for(var Ee=0;Ee<X.length;Ee++)ce.writeBoolean(X[Ee])}function W(X,ce){for(var Ee=0;Ee<X.length;Ee++)ce.writeFixed32(X[Ee])}function K(X,ce){for(var Ee=0;Ee<X.length;Ee++)ce.writeSFixed32(X[Ee])}function ne(X,ce){for(var Ee=0;Ee<X.length;Ee++)ce.writeFixed64(X[Ee])}function ue(X,ce){for(var Ee=0;Ee<X.length;Ee++)ce.writeSFixed64(X[Ee])}function _e(X,ce){return(X[ce]|X[ce+1]<<8|X[ce+2]<<16)+16777216*X[ce+3]}function Le(X,ce,Ee){X[Ee]=ce,X[Ee+1]=ce>>>8,X[Ee+2]=ce>>>16,X[Ee+3]=ce>>>24}function we(X,ce){return(X[ce]|X[ce+1]<<8|X[ce+2]<<16)+(X[ce+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(X,ce,Ee){for(Ee=Ee||this.length;this.pos<Ee;){var qe=this.readVarint(),yt=qe>>3,et=this.pos;this.type=7&qe,X(yt,ce,this),this.pos===et&&this.skip(qe)}return ce},readMessage:function(X,ce){return this.readFields(X,ce,this.readVarint()+this.pos)},readFixed32:function(){var X=_e(this.buf,this.pos);return this.pos+=4,X},readSFixed32:function(){var X=we(this.buf,this.pos);return this.pos+=4,X},readFixed64:function(){var X=_e(this.buf,this.pos)+_e(this.buf,this.pos+4)*s;return this.pos+=8,X},readSFixed64:function(){var X=_e(this.buf,this.pos)+we(this.buf,this.pos+4)*s;return this.pos+=8,X},readFloat:function(){var X=l.read(this.buf,this.pos,!0,23,4);return this.pos+=4,X},readDouble:function(){var X=l.read(this.buf,this.pos,!0,52,8);return this.pos+=8,X},readVarint:function(X){var ce,Ee,qe=this.buf;return ce=127&(Ee=qe[this.pos++]),Ee<128?ce:(ce|=(127&(Ee=qe[this.pos++]))<<7,Ee<128?ce:(ce|=(127&(Ee=qe[this.pos++]))<<14,Ee<128?ce:(ce|=(127&(Ee=qe[this.pos++]))<<21,Ee<128?ce:function(yt,et,rt){var Et,_t,St=rt.buf;if(Et=(112&(_t=St[rt.pos++]))>>4,_t<128||(Et|=(127&(_t=St[rt.pos++]))<<3,_t<128)||(Et|=(127&(_t=St[rt.pos++]))<<10,_t<128)||(Et|=(127&(_t=St[rt.pos++]))<<17,_t<128)||(Et|=(127&(_t=St[rt.pos++]))<<24,_t<128)||(Et|=(1&(_t=St[rt.pos++]))<<31,_t<128))return E(yt,Et,et);throw new Error("Expected varint not more than 10 bytes")}(ce|=(15&(Ee=qe[this.pos]))<<28,X,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var X=this.readVarint();return X%2==1?(X+1)/-2:X/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var X=this.readVarint()+this.pos,ce=this.pos;return this.pos=X,X-ce>=12&&_?function(Ee,qe,yt){return _.decode(Ee.subarray(qe,yt))}(this.buf,ce,X):function(Ee,qe,yt){for(var et="",rt=qe;rt<yt;){var Et,_t,St,lt=Ee[rt],Zt=null,on=lt>239?4:lt>223?3:lt>191?2:1;if(rt+on>yt)break;on===1?lt<128&&(Zt=lt):on===2?(192&(Et=Ee[rt+1]))==128&&(Zt=(31&lt)<<6|63&Et)<=127&&(Zt=null):on===3?(_t=Ee[rt+2],(192&(Et=Ee[rt+1]))==128&&(192&_t)==128&&((Zt=(15&lt)<<12|(63&Et)<<6|63&_t)<=2047||Zt>=55296&&Zt<=57343)&&(Zt=null)):on===4&&(_t=Ee[rt+2],St=Ee[rt+3],(192&(Et=Ee[rt+1]))==128&&(192&_t)==128&&(192&St)==128&&((Zt=(15&lt)<<18|(63&Et)<<12|(63&_t)<<6|63&St)<=65535||Zt>=1114112)&&(Zt=null)),Zt===null?(Zt=65533,on=1):Zt>65535&&(Zt-=65536,et+=String.fromCharCode(Zt>>>10&1023|55296),Zt=56320|1023&Zt),et+=String.fromCharCode(Zt),rt+=on}return et}(this.buf,ce,X)},readBytes:function(){var X=this.readVarint()+this.pos,ce=this.buf.subarray(this.pos,X);return this.pos=X,ce},readPackedVarint:function(X,ce){if(this.type!==t.Bytes)return X.push(this.readVarint(ce));var Ee=T(this);for(X=X||[];this.pos<Ee;)X.push(this.readVarint(ce));return X},readPackedSVarint:function(X){if(this.type!==t.Bytes)return X.push(this.readSVarint());var ce=T(this);for(X=X||[];this.pos<ce;)X.push(this.readSVarint());return X},readPackedBoolean:function(X){if(this.type!==t.Bytes)return X.push(this.readBoolean());var ce=T(this);for(X=X||[];this.pos<ce;)X.push(this.readBoolean());return X},readPackedFloat:function(X){if(this.type!==t.Bytes)return X.push(this.readFloat());var ce=T(this);for(X=X||[];this.pos<ce;)X.push(this.readFloat());return X},readPackedDouble:function(X){if(this.type!==t.Bytes)return X.push(this.readDouble());var ce=T(this);for(X=X||[];this.pos<ce;)X.push(this.readDouble());return X},readPackedFixed32:function(X){if(this.type!==t.Bytes)return X.push(this.readFixed32());var ce=T(this);for(X=X||[];this.pos<ce;)X.push(this.readFixed32());return X},readPackedSFixed32:function(X){if(this.type!==t.Bytes)return X.push(this.readSFixed32());var ce=T(this);for(X=X||[];this.pos<ce;)X.push(this.readSFixed32());return X},readPackedFixed64:function(X){if(this.type!==t.Bytes)return X.push(this.readFixed64());var ce=T(this);for(X=X||[];this.pos<ce;)X.push(this.readFixed64());return X},readPackedSFixed64:function(X){if(this.type!==t.Bytes)return X.push(this.readSFixed64());var ce=T(this);for(X=X||[];this.pos<ce;)X.push(this.readSFixed64());return X},skip:function(X){var ce=7&X;if(ce===t.Varint)for(;this.buf[this.pos++]>127;);else if(ce===t.Bytes)this.pos=this.readVarint()+this.pos;else if(ce===t.Fixed32)this.pos+=4;else{if(ce!==t.Fixed64)throw new Error("Unimplemented type: "+ce);this.pos+=8}},writeTag:function(X,ce){this.writeVarint(X<<3|ce)},realloc:function(X){for(var ce=this.length||16;ce<this.pos+X;)ce*=2;if(ce!==this.length){var Ee=new Uint8Array(ce);Ee.set(this.buf),this.buf=Ee,this.length=ce}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(X){this.realloc(4),Le(this.buf,X,this.pos),this.pos+=4},writeSFixed32:function(X){this.realloc(4),Le(this.buf,X,this.pos),this.pos+=4},writeFixed64:function(X){this.realloc(8),Le(this.buf,-1&X,this.pos),Le(this.buf,Math.floor(X*d),this.pos+4),this.pos+=8},writeSFixed64:function(X){this.realloc(8),Le(this.buf,-1&X,this.pos),Le(this.buf,Math.floor(X*d),this.pos+4),this.pos+=8},writeVarint:function(X){(X=+X||0)>268435455||X<0?function(ce,Ee){var qe,yt;if(ce>=0?(qe=ce%4294967296|0,yt=ce/4294967296|0):(yt=~(-ce/4294967296),4294967295^(qe=~(-ce%4294967296))?qe=qe+1|0:(qe=0,yt=yt+1|0)),ce>=18446744073709552e3||ce<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Ee.realloc(10),function(et,rt,Et){Et.buf[Et.pos++]=127&et|128,et>>>=7,Et.buf[Et.pos++]=127&et|128,et>>>=7,Et.buf[Et.pos++]=127&et|128,et>>>=7,Et.buf[Et.pos++]=127&et|128,Et.buf[Et.pos]=127&(et>>>=7)}(qe,0,Ee),function(et,rt){var Et=(7&et)<<4;rt.buf[rt.pos++]|=Et|((et>>>=3)?128:0),et&&(rt.buf[rt.pos++]=127&et|((et>>>=7)?128:0),et&&(rt.buf[rt.pos++]=127&et|((et>>>=7)?128:0),et&&(rt.buf[rt.pos++]=127&et|((et>>>=7)?128:0),et&&(rt.buf[rt.pos++]=127&et|((et>>>=7)?128:0),et&&(rt.buf[rt.pos++]=127&et)))))}(yt,Ee)}(X,this):(this.realloc(4),this.buf[this.pos++]=127&X|(X>127?128:0),X<=127||(this.buf[this.pos++]=127&(X>>>=7)|(X>127?128:0),X<=127||(this.buf[this.pos++]=127&(X>>>=7)|(X>127?128:0),X<=127||(this.buf[this.pos++]=X>>>7&127))))},writeSVarint:function(X){this.writeVarint(X<0?2*-X-1:2*X)},writeBoolean:function(X){this.writeVarint(!!X)},writeString:function(X){X=String(X),this.realloc(4*X.length),this.pos++;var ce=this.pos;this.pos=function(qe,yt,et){for(var rt,Et,_t=0;_t<yt.length;_t++){if((rt=yt.charCodeAt(_t))>55295&&rt<57344){if(!Et){rt>56319||_t+1===yt.length?(qe[et++]=239,qe[et++]=191,qe[et++]=189):Et=rt;continue}if(rt<56320){qe[et++]=239,qe[et++]=191,qe[et++]=189,Et=rt;continue}rt=Et-55296<<10|rt-56320|65536,Et=null}else Et&&(qe[et++]=239,qe[et++]=191,qe[et++]=189,Et=null);rt<128?qe[et++]=rt:(rt<2048?qe[et++]=rt>>6|192:(rt<65536?qe[et++]=rt>>12|224:(qe[et++]=rt>>18|240,qe[et++]=rt>>12&63|128),qe[et++]=rt>>6&63|128),qe[et++]=63&rt|128)}return et}(this.buf,X,this.pos);var Ee=this.pos-ce;Ee>=128&&C(ce,Ee,this),this.pos=ce-1,this.writeVarint(Ee),this.pos+=Ee},writeFloat:function(X){this.realloc(4),l.write(this.buf,X,this.pos,!0,23,4),this.pos+=4},writeDouble:function(X){this.realloc(8),l.write(this.buf,X,this.pos,!0,52,8),this.pos+=8},writeBytes:function(X){var ce=X.length;this.writeVarint(ce),this.realloc(ce);for(var Ee=0;Ee<ce;Ee++)this.buf[this.pos++]=X[Ee]},writeRawMessage:function(X,ce){this.pos++;var Ee=this.pos;X(ce,this);var qe=this.pos-Ee;qe>=128&&C(Ee,qe,this),this.pos=Ee-1,this.writeVarint(qe),this.pos+=qe},writeMessage:function(X,ce,Ee){this.writeTag(X,t.Bytes),this.writeRawMessage(ce,Ee)},writePackedVarint:function(X,ce){ce.length&&this.writeMessage(X,R,ce)},writePackedSVarint:function(X,ce){ce.length&&this.writeMessage(X,B,ce)},writePackedBoolean:function(X,ce){ce.length&&this.writeMessage(X,q,ce)},writePackedFloat:function(X,ce){ce.length&&this.writeMessage(X,U,ce)},writePackedDouble:function(X,ce){ce.length&&this.writeMessage(X,G,ce)},writePackedFixed32:function(X,ce){ce.length&&this.writeMessage(X,W,ce)},writePackedSFixed32:function(X,ce){ce.length&&this.writeMessage(X,K,ce)},writePackedFixed64:function(X,ce){ce.length&&this.writeMessage(X,ne,ce)},writePackedSFixed64:function(X,ce){ce.length&&this.writeMessage(X,ue,ce)},writeBytesField:function(X,ce){this.writeTag(X,t.Bytes),this.writeBytes(ce)},writeFixed32Field:function(X,ce){this.writeTag(X,t.Fixed32),this.writeFixed32(ce)},writeSFixed32Field:function(X,ce){this.writeTag(X,t.Fixed32),this.writeSFixed32(ce)},writeFixed64Field:function(X,ce){this.writeTag(X,t.Fixed64),this.writeFixed64(ce)},writeSFixed64Field:function(X,ce){this.writeTag(X,t.Fixed64),this.writeSFixed64(ce)},writeVarintField:function(X,ce){this.writeTag(X,t.Varint),this.writeVarint(ce)},writeSVarintField:function(X,ce){this.writeTag(X,t.Varint),this.writeSVarint(ce)},writeStringField:function(X,ce){this.writeTag(X,t.Bytes),this.writeString(ce)},writeFloatField:function(X,ce){this.writeTag(X,t.Fixed32),this.writeFloat(ce)},writeDoubleField:function(X,ce){this.writeTag(X,t.Fixed64),this.writeDouble(ce)},writeBooleanField:function(X,ce){this.writeVarintField(X,!!ce)}},Mp}var Dp=A(Hm());const sf=3;function Xm(l,t,s){l===1&&s.readMessage(zu,t)}function zu(l,t,s){if(l===3){const{id:d,bitmap:_,width:T,height:E,left:C,top:R,advance:B}=s.readMessage(Wm,{});t.push({id:d,bitmap:new Ph({width:T+2*sf,height:E+2*sf},_),metrics:{width:T,height:E,left:C,top:R,advance:B}})}}function Wm(l,t,s){l===1?t.id=s.readVarint():l===2?t.bitmap=s.readBytes():l===3?t.width=s.readVarint():l===4?t.height=s.readVarint():l===5?t.left=s.readSVarint():l===6?t.top=s.readSVarint():l===7&&(t.advance=s.readVarint())}const Gh=sf;function lf(l){let t=0,s=0;for(const E of l)t+=E.w*E.h,s=Math.max(s,E.w);l.sort((E,C)=>C.h-E.h);const d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),s),h:1/0}];let _=0,T=0;for(const E of l)for(let C=d.length-1;C>=0;C--){const R=d[C];if(!(E.w>R.w||E.h>R.h)){if(E.x=R.x,E.y=R.y,T=Math.max(T,E.y+E.h),_=Math.max(_,E.x+E.w),E.w===R.w&&E.h===R.h){const B=d.pop();C<d.length&&(d[C]=B)}else E.h===R.h?(R.x+=E.w,R.w-=E.w):E.w===R.w?(R.y+=E.h,R.h-=E.h):(d.push({x:R.x+E.w,y:R.y,w:R.w-E.w,h:E.h}),R.y+=E.h,R.h-=E.h);break}}return{w:_,h:T,fill:t/(_*T)||0}}const Na=1;class Ip{constructor(t,{pixelRatio:s,version:d,stretchX:_,stretchY:T,content:E,textFitWidth:C,textFitHeight:R}){this.paddedRect=t,this.pixelRatio=s,this.stretchX=_,this.stretchY=T,this.content=E,this.version=d,this.textFitWidth=C,this.textFitHeight=R}get tl(){return[this.paddedRect.x+Na,this.paddedRect.y+Na]}get br(){return[this.paddedRect.x+this.paddedRect.w-Na,this.paddedRect.y+this.paddedRect.h-Na]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Na)/this.pixelRatio,(this.paddedRect.h-2*Na)/this.pixelRatio]}}class cf{constructor(t,s){const d={},_={};this.haveRenderCallbacks=[];const T=[];this.addImages(t,d,T),this.addImages(s,_,T);const{w:E,h:C}=lf(T),R=new Ra({width:E||1,height:C||1});for(const B in t){const U=t[B],G=d[B].paddedRect;Ra.copy(U.data,R,{x:0,y:0},{x:G.x+Na,y:G.y+Na},U.data)}for(const B in s){const U=s[B],G=_[B].paddedRect,q=G.x+Na,W=G.y+Na,K=U.data.width,ne=U.data.height;Ra.copy(U.data,R,{x:0,y:0},{x:q,y:W},U.data),Ra.copy(U.data,R,{x:0,y:ne-1},{x:q,y:W-1},{width:K,height:1}),Ra.copy(U.data,R,{x:0,y:0},{x:q,y:W+ne},{width:K,height:1}),Ra.copy(U.data,R,{x:K-1,y:0},{x:q-1,y:W},{width:1,height:ne}),Ra.copy(U.data,R,{x:0,y:0},{x:q+K,y:W},{width:1,height:ne})}this.image=R,this.iconPositions=d,this.patternPositions=_}addImages(t,s,d){for(const _ in t){const T=t[_],E={x:0,y:0,w:T.data.width+2*Na,h:T.data.height+2*Na};d.push(E),s[_]=new Ip(E,T),T.hasRenderCallback&&this.haveRenderCallbacks.push(_)}}patchUpdatedImages(t,s){t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const d in t.updatedImages)this.patchUpdatedImage(this.iconPositions[d],t.getImage(d),s),this.patchUpdatedImage(this.patternPositions[d],t.getImage(d),s)}patchUpdatedImage(t,s,d){if(!t||!s||t.version===s.version)return;t.version=s.version;const[_,T]=t.tl;d.update(s.data,void 0,{x:_,y:T})}}var ql;Ft("ImagePosition",Ip),Ft("ImageAtlas",cf),g.ai=void 0,(ql=g.ai||(g.ai={}))[ql.none=0]="none",ql[ql.horizontal=1]="horizontal",ql[ql.vertical=2]="vertical",ql[ql.horizontalOnly=3]="horizontalOnly";const $a=-17;class uf{constructor(){this.scale=1,this.fontStack="",this.imageName=null,this.verticalAlign="bottom"}static forText(t,s,d){const _=new uf;return _.scale=t||1,_.fontStack=s,_.verticalAlign=d||"bottom",_}static forImage(t,s){const d=new uf;return d.imageName=t,d.verticalAlign=s||"bottom",d}}class ra{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,s){const d=new ra;for(let _=0;_<t.sections.length;_++){const T=t.sections[_];T.image?d.addImageSection(T):d.addTextSection(T,s)}return d}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(){this.text=function(t){let s="";for(let d=0;d<t.length;d++){const _=t.charCodeAt(d+1)||null,T=t.charCodeAt(d-1)||null;s+=_&&km(_)&&!Os[t[d+1]]||T&&km(T)&&!Os[t[d-1]]||!Os[t[d]]?t[d]:Os[t[d]]}return s}(this.text)}trim(){let t=0;for(let d=0;d<this.text.length&&hf[this.text.charCodeAt(d)];d++)t++;let s=this.text.length;for(let d=this.text.length-1;d>=0&&d>=t&&hf[this.text.charCodeAt(d)];d--)s--;this.text=this.text.substring(t,s),this.sectionIndex=this.sectionIndex.slice(t,s)}substring(t,s){const d=new ra;return d.text=this.text.substring(t,s),d.sectionIndex=this.sectionIndex.slice(t,s),d.sections=this.sections,d}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,s)=>Math.max(t,this.sections[s].scale),0)}getMaxImageSize(t){let s=0,d=0;for(let _=0;_<this.length();_++){const T=this.getSection(_);if(T.imageName){const E=t[T.imageName];if(!E)continue;const C=E.displaySize;s=Math.max(s,C[0]),d=Math.max(d,C[1])}}return{maxImageWidth:s,maxImageHeight:d}}addTextSection(t,s){this.text+=t.text,this.sections.push(uf.forText(t.scale,t.fontStack||s,t.verticalAlign));const d=this.sections.length-1;for(let _=0;_<t.text.length;++_)this.sectionIndex.push(d)}addImageSection(t){const s=t.image?t.image.name:"";if(s.length===0)return void Wn("Can't add FormattedSection with an empty image.");const d=this.getNextImageSectionCharCode();d?(this.text+=String.fromCharCode(d),this.sections.push(uf.forImage(s,t.verticalAlign)),this.sectionIndex.push(this.sections.length-1)):Wn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function kp(l,t,s,d,_,T,E,C,R,B,U,G,q,W,K){const ne=ra.fromFeature(l,_);let ue;G===g.ai.vertical&&ne.verticalizePunctuation();const{processBidirectionalText:_e,processStyledBidirectionalText:Le}=os;if(_e&&ne.sections.length===1){ue=[];const ce=_e(ne.toString(),Qm(ne,B,T,t,d,W));for(const Ee of ce){const qe=new ra;qe.text=Ee,qe.sections=ne.sections;for(let yt=0;yt<Ee.length;yt++)qe.sectionIndex.push(0);ue.push(qe)}}else if(Le){ue=[];const ce=Le(ne.text,ne.sectionIndex,Qm(ne,B,T,t,d,W));for(const Ee of ce){const qe=new ra;qe.text=Ee[0],qe.sectionIndex=Ee[1],qe.sections=ne.sections,ue.push(qe)}}else ue=function(ce,Ee){const qe=[],yt=ce.text;let et=0;for(const rt of Ee)qe.push(ce.substring(et,rt)),et=rt;return et<yt.length&&qe.push(ce.substring(et,yt.length)),qe}(ne,Qm(ne,B,T,t,d,W));const we=[],X={positionedLines:we,text:ne.toString(),top:U[1],bottom:U[1],left:U[0],right:U[0],writingMode:G,iconsInText:!1,verticalizable:!1};return function(ce,Ee,qe,yt,et,rt,Et,_t,St,lt,Zt,on){let an=0,Xt=0,Pn=0,zi=0;const Mr=_t==="right"?1:_t==="left"?0:.5,sa=er/on;let fo=0;for(const di of et){di.trim();const vr=di.getMaxScale(),Dr={positionedGlyphs:[],lineOffset:0};ce.positionedLines[fo]=Dr;const nr=Dr.positionedGlyphs;let qa=0;if(!di.length()){Xt+=rt,++fo;continue}const Yo=wy(yt,di,sa);for(let po=0;po<di.length();po++){const jr=di.getSection(po),Ir=di.getSectionIndex(po),Yr=di.getCharCode(po),Fr=Rv(St,Zt,Yr);let Si;if(jr.imageName){if(ce.iconsInText=!0,jr.scale=jr.scale*sa,Si=Pv(jr,Fr,vr,Yo,yt),!Si)continue;qa=Math.max(qa,Si.imageOffset)}else if(Si=Nv(jr,Yr,Fr,Yo,Ee,qe),!Si)continue;const{rect:qo,metrics:Xh,baselineOffset:mo}=Si;nr.push({glyph:Yr,imageName:jr.imageName,x:an,y:Xt+mo+$a,vertical:Fr,scale:jr.scale,fontStack:jr.fontStack,sectionIndex:Ir,metrics:Xh,rect:qo}),Fr?(ce.verticalizable=!0,an+=(jr.imageName?Xh.advance:er)*jr.scale+lt):an+=Xh.advance*jr.scale+lt}nr.length!==0&&(Pn=Math.max(an-lt,Pn),Q_(nr,0,nr.length-1,Mr)),an=0,Dr.lineOffset=Math.max(qa,(vr-1)*er);const br=rt*vr+qa;Xt+=br,zi=Math.max(br,zi),++fo}const{horizontalAlign:Br,verticalAlign:tr}=Km(Et);(function(di,vr,Dr,nr,qa,Yo,br,po,jr){const Ir=(vr-Dr)*qa;let Yr=0;Yr=Yo!==br?-po*nr-$a:-nr*jr*br+.5*br;for(const Fr of di)for(const Si of Fr.positionedGlyphs)Si.x+=Ir,Si.y+=Yr})(ce.positionedLines,Mr,Br,tr,Pn,zi,rt,Xt,et.length),ce.top+=-tr*Xt,ce.bottom=ce.top+Xt,ce.left+=-Br*Pn,ce.right=ce.left+Pn}(X,t,s,d,ue,E,C,R,G,B,q,K),!function(ce){for(const Ee of ce)if(Ee.positionedGlyphs.length!==0)return!1;return!0}(we)&&X}const hf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},W_={10:!0,32:!0,38:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0},kv={40:!0};function Hl(l,t,s,d,_,T){if(t.imageName){const E=d[t.imageName];return E?E.displaySize[0]*t.scale*er/T+_:0}{const E=s[t.fontStack],C=E&&E[l];return C?C.metrics.advance*t.scale+_:0}}function Rp(l,t,s,d){const _=Math.pow(l-t,2);return d?l<t?_/2:2*_:_+Math.abs(s)*s}function by(l,t,s){let d=0;return l===10&&(d-=1e4),s&&(d+=150),l!==40&&l!==65288||(d+=50),t!==41&&t!==65289||(d+=50),d}function Zh(l,t,s,d,_,T){let E=null,C=Rp(t,s,_,T);for(const R of d){const B=Rp(t-R.x,s,_,T)+R.badness;B<=C&&(E=R,C=B)}return{index:l,x:t,priorBreak:E,badness:C}}function xy(l){return l?xy(l.priorBreak).concat(l.index):[]}function Qm(l,t,s,d,_,T){if(!l)return[];const E=[],C=function(G,q,W,K,ne,ue){let _e=0;for(let Le=0;Le<G.length();Le++){const we=G.getSection(Le);_e+=Hl(G.getCharCode(Le),we,K,ne,q,ue)}return _e/Math.max(1,Math.ceil(_e/W))}(l,t,s,d,_,T),R=l.text.indexOf("")>=0;let B=0;for(let G=0;G<l.length();G++){const q=l.getSection(G),W=l.getCharCode(G);if(hf[W]||(B+=Hl(W,q,d,_,t,T)),G<l.length()-1){const K=!((U=W)<11904)&&(!!zn["CJK Compatibility Forms"](U)||!!zn["CJK Compatibility"](U)||!!zn["CJK Strokes"](U)||!!zn["CJK Symbols and Punctuation"](U)||!!zn["Enclosed CJK Letters and Months"](U)||!!zn["Halfwidth and Fullwidth Forms"](U)||!!zn["Ideographic Description Characters"](U)||!!zn["Vertical Forms"](U)||rl.test(String.fromCodePoint(U)));(W_[W]||K||q.imageName||G!==l.length()-2&&kv[l.getCharCode(G+1)])&&E.push(Zh(G+1,B,C,E,by(W,l.getCharCode(G+1),K&&R),!1))}}var U;return xy(Zh(l.length(),B,C,E,0,!0))}function Km(l){let t=.5,s=.5;switch(l){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:t,verticalAlign:s}}function wy(l,t,s){const d=t.getMaxScale()*er,{maxImageWidth:_,maxImageHeight:T}=t.getMaxImageSize(l),E=Math.max(d,T*s);return{verticalLineContentWidth:Math.max(d,_*s),horizontalLineContentHeight:E}}function Jm(l){switch(l){case"top":return 0;case"center":return .5;default:return 1}}function Rv(l,t,s){return!(l===g.ai.horizontal||!t&&!al(s)||t&&(hf[s]||(d=s,new RegExp("\\p{sc=Arab}","u").test(String.fromCodePoint(d)))));var d}function Nv(l,t,s,d,_,T){const E=T[l.fontStack],C=function(B,U,G,q){if(B&&B.rect)return B;const W=U[G.fontStack],K=W&&W[q];return K?{rect:null,metrics:K.metrics}:null}(E&&E[t],_,l,t);if(C===null)return null;let R;if(s)R=d.verticalLineContentWidth-l.scale*er;else{const B=Jm(l.verticalAlign);R=(d.horizontalLineContentHeight-l.scale*er)*B}return{rect:C.rect,metrics:C.metrics,baselineOffset:R}}function Pv(l,t,s,d,_){const T=_[l.imageName];if(!T)return null;const E=T.paddedRect,C=T.displaySize,R={width:C[0],height:C[1],left:Na,top:-3,advance:t?C[1]:C[0]};let B;if(t)B=d.verticalLineContentWidth-C[1]*l.scale;else{const U=Jm(l.verticalAlign);B=(d.horizontalLineContentHeight-C[1]*l.scale)*U}return{rect:E,metrics:R,baselineOffset:B,imageOffset:(t?C[0]:C[1])*l.scale-er*s}}function Q_(l,t,s,d){if(d===0)return;const _=l[s],T=(l[s].x+_.metrics.advance*_.scale)*d;for(let E=t;E<=s;E++)l[E].x-=T}function K_(l,t,s){const{horizontalAlign:d,verticalAlign:_}=Km(s),T=t[0]-l.displaySize[0]*d,E=t[1]-l.displaySize[1]*_;return{image:l,top:E,bottom:E+l.displaySize[1],left:T,right:T+l.displaySize[0]}}function $h(l){var t,s;let d=l.left,_=l.top,T=l.right-d,E=l.bottom-_;const C=(t=l.image.textFitWidth)!==null&&t!==void 0?t:"stretchOrShrink",R=(s=l.image.textFitHeight)!==null&&s!==void 0?s:"stretchOrShrink",B=(l.image.content[2]-l.image.content[0])/(l.image.content[3]-l.image.content[1]);if(R==="proportional"){if(C==="stretchOnly"&&T/E<B||C==="proportional"){const U=Math.ceil(E*B);d*=U/T,T=U}}else if(C==="proportional"&&R==="stretchOnly"&&B!==0&&T/E>B){const U=Math.ceil(T/B);_*=U/E,E=U}return{x1:d,y1:_,x2:d+T,y2:_+E}}function Np(l,t,s,d,_,T){const E=l.image;let C;if(E.content){const ue=E.content,_e=E.pixelRatio||1;C=[ue[0]/_e,ue[1]/_e,E.displaySize[0]-ue[2]/_e,E.displaySize[1]-ue[3]/_e]}const R=t.left*T,B=t.right*T;let U,G,q,W;s==="width"||s==="both"?(W=_[0]+R-d[3],G=_[0]+B+d[1]):(W=_[0]+(R+B-E.displaySize[0])/2,G=W+E.displaySize[0]);const K=t.top*T,ne=t.bottom*T;return s==="height"||s==="both"?(U=_[1]+K-d[0],q=_[1]+ne+d[2]):(U=_[1]+(K+ne-E.displaySize[1])/2,q=U+E.displaySize[1]),{image:E,top:U,right:G,bottom:q,left:W,collisionPadding:C}}const df=255,cl=128,Ou=df*cl;function Ty(l,t){const{expression:s}=t;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Mi(l+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:d,interpolationType:_}=s;let T=0;for(;T<d.length&&d[T]<=l;)T++;T=Math.max(0,T-1);let E=T;for(;E<d.length&&d[E]<l+1;)E++;E=Math.min(d.length-1,E);const C=d[T],R=d[E];return s.kind==="composite"?{kind:"composite",minZoom:C,maxZoom:R,interpolationType:_}:{kind:"camera",minZoom:C,maxZoom:R,minSize:s.evaluate(new Mi(C)),maxSize:s.evaluate(new Mi(R)),interpolationType:_}}}function Lu(l,t,s){let d="never";const _=l.get(t);return _?d=_:l.get(s)&&(d="always"),d}const J_=af.VectorTileFeature.types,Zi=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ff(l,t,s,d,_,T,E,C,R,B,U,G,q){const W=C?Math.min(Ou,Math.round(C[0])):0,K=C?Math.min(Ou,Math.round(C[1])):0;l.emplaceBack(t,s,Math.round(32*d),Math.round(32*_),T,E,(W<<1)+(R?1:0),K,16*B,16*U,256*G,256*q)}function Ey(l,t,s){l.emplaceBack(t.x,t.y,s),l.emplaceBack(t.x,t.y,s),l.emplaceBack(t.x,t.y,s),l.emplaceBack(t.x,t.y,s)}function e0(l){for(const t of l.sections)if(Pl(t.text))return!0;return!1}class Sy{constructor(t){this.layoutVertexArray=new Pe,this.indexArray=new nt,this.programConfigurations=t,this.segments=new zt,this.dynamicLayoutVertexArray=new He,this.opacityVertexArray=new Ke,this.hasVisibleVertices=!1,this.placedSymbolArray=new I}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,s,d,_){this.isEmpty()||(d&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,hs.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,jc.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,Zi,!0),this.opacityVertexBuffer.itemSize=1),(d||_)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ft("SymbolBuffers",Sy);class Ay{constructor(t,s,d){this.layoutVertexArray=new t,this.layoutAttributes=s,this.indexArray=new d,this.segments=new zt,this.collisionVertexArray=new ht}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,of.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ft("CollisionBuffers",Ay);class pf{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(E=>E.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[];const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ty(this.zoom,s["text-size"]),this.iconSizeData=Ty(this.zoom,s["icon-size"]);const d=this.layers[0].layout,_=d.get("symbol-sort-key"),T=d.get("symbol-z-order");this.canOverlap=Lu(d,"text-overlap","text-allow-overlap")!=="never"||Lu(d,"icon-overlap","icon-allow-overlap")!=="never"||d.get("text-ignore-placement")||d.get("icon-ignore-placement"),this.sortFeaturesByKey=T!=="viewport-y"&&!_.isConstant(),this.sortFeaturesByY=(T==="viewport-y"||T==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,d.get("symbol-placement")==="point"&&(this.writingModes=d.get("text-writing-mode").map(E=>g.ai[E])),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.sourceID=t.sourceID}createArrays(){this.text=new Sy(new Vi(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Sy(new Vi(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new Z,this.lineVertexArray=new Y,this.symbolInstances=new j,this.textAnchorOffsets=new ee}calculateGlyphDependencies(t,s,d,_,T){for(let E=0;E<t.length;E++)if(s[t.charCodeAt(E)]=!0,(d||_)&&T){const C=Os[t.charAt(E)];C&&(s[C.charCodeAt(0)]=!0)}}populate(t,s,d){const _=this.layers[0],T=_.layout,E=T.get("text-font"),C=T.get("text-field"),R=T.get("icon-image"),B=(C.value.kind!=="constant"||C.value.value instanceof or&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),U=R.value.kind!=="constant"||!!R.value.value||Object.keys(R.parameters).length>0,G=T.get("symbol-sort-key");if(this.features=[],!B&&!U)return;const q=s.iconDependencies,W=s.glyphDependencies,K=s.availableImages,ne=new Mi(this.zoom);for(const{feature:ue,id:_e,index:Le,sourceLayerIndex:we}of t){const X=_._featureFilter.needGeometry,ce=Bl(ue,X);if(!_._featureFilter.filter(ne,ce,d))continue;let Ee,qe;if(X||(ce.geometry=Ll(ue)),B){const et=_.getValueAndResolveTokens("text-field",ce,d,K),rt=or.factory(et),Et=this.hasRTLText=this.hasRTLText||e0(rt);(!Et||os.getRTLTextPluginStatus()==="unavailable"||Et&&os.isParsed())&&(Ee=Lr(rt,_,ce))}if(U){const et=_.getValueAndResolveTokens("icon-image",ce,d,K);qe=et instanceof Kr?et:Kr.fromString(et)}if(!Ee&&!qe)continue;const yt=this.sortFeaturesByKey?G.evaluate(ce,{},d):void 0;if(this.features.push({id:_e,text:Ee,icon:qe,index:Le,sourceLayerIndex:we,geometry:ce.geometry,properties:ue.properties,type:J_[ue.type],sortKey:yt}),qe&&(q[qe.name]=!0),Ee){const et=E.evaluate(ce,{},d).join(","),rt=T.get("text-rotation-alignment")!=="viewport"&&T.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(g.ai.vertical)>=0;for(const Et of Ee.sections)if(Et.image)q[Et.image.name]=!0;else{const _t=Xi(Ee.toString()),St=Et.fontStack||et,lt=W[St]=W[St]||{};this.calculateGlyphDependencies(Et.text,lt,rt,this.allowVerticalPlacement,_t)}}}T.get("symbol-placement")==="line"&&(this.features=function(ue){const _e={},Le={},we=[];let X=0;function ce(et){we.push(ue[et]),X++}function Ee(et,rt,Et){const _t=Le[et];return delete Le[et],Le[rt]=_t,we[_t].geometry[0].pop(),we[_t].geometry[0]=we[_t].geometry[0].concat(Et[0]),_t}function qe(et,rt,Et){const _t=_e[rt];return delete _e[rt],_e[et]=_t,we[_t].geometry[0].shift(),we[_t].geometry[0]=Et[0].concat(we[_t].geometry[0]),_t}function yt(et,rt,Et){const _t=Et?rt[0][rt[0].length-1]:rt[0][0];return`${et}:${_t.x}:${_t.y}`}for(let et=0;et<ue.length;et++){const rt=ue[et],Et=rt.geometry,_t=rt.text?rt.text.toString():null;if(!_t){ce(et);continue}const St=yt(_t,Et),lt=yt(_t,Et,!0);if(St in Le&&lt in _e&&Le[St]!==_e[lt]){const Zt=qe(St,lt,Et),on=Ee(St,lt,we[Zt].geometry);delete _e[St],delete Le[lt],Le[yt(_t,we[on].geometry,!0)]=on,we[Zt].geometry=null}else St in Le?Ee(St,lt,Et):lt in _e?qe(St,lt,Et):(ce(et),_e[St]=X-1,Le[lt]=X-1)}return we.filter(et=>et.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ue,_e)=>ue.sortKey-_e.sortKey)}update(t,s,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,s,this.layers,d),this.icon.programConfigurations.updatePaintArrays(t,s,this.layers,d))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,s){const d=this.lineVertexArray.length;if(t.segment!==void 0){let _=t.dist(s[t.segment+1]),T=t.dist(s[t.segment]);const E={};for(let C=t.segment+1;C<s.length;C++)E[C]={x:s[C].x,y:s[C].y,tileUnitDistanceFromAnchor:_},C<s.length-1&&(_+=s[C+1].dist(s[C]));for(let C=t.segment||0;C>=0;C--)E[C]={x:s[C].x,y:s[C].y,tileUnitDistanceFromAnchor:T},C>0&&(T+=s[C-1].dist(s[C]));for(let C=0;C<s.length;C++){const R=E[C];this.lineVertexArray.emplaceBack(R.x,R.y,R.tileUnitDistanceFromAnchor)}}return{lineStartIndex:d,lineLength:this.lineVertexArray.length-d}}addSymbols(t,s,d,_,T,E,C,R,B,U,G,q){const W=t.indexArray,K=t.layoutVertexArray,ne=t.segments.prepareSegment(4*s.length,K,W,this.canOverlap?E.sortKey:void 0),ue=this.glyphOffsetArray.length,_e=ne.vertexLength,Le=this.allowVerticalPlacement&&C===g.ai.vertical?Math.PI/2:0,we=E.text&&E.text.sections;for(let X=0;X<s.length;X++){const{tl:ce,tr:Ee,bl:qe,br:yt,tex:et,pixelOffsetTL:rt,pixelOffsetBR:Et,minFontScaleX:_t,minFontScaleY:St,glyphOffset:lt,isSDF:Zt,sectionIndex:on}=s[X],an=ne.vertexLength,Xt=lt[1];ff(K,R.x,R.y,ce.x,Xt+ce.y,et.x,et.y,d,Zt,rt.x,rt.y,_t,St),ff(K,R.x,R.y,Ee.x,Xt+Ee.y,et.x+et.w,et.y,d,Zt,Et.x,rt.y,_t,St),ff(K,R.x,R.y,qe.x,Xt+qe.y,et.x,et.y+et.h,d,Zt,rt.x,Et.y,_t,St),ff(K,R.x,R.y,yt.x,Xt+yt.y,et.x+et.w,et.y+et.h,d,Zt,Et.x,Et.y,_t,St),Ey(t.dynamicLayoutVertexArray,R,Le),W.emplaceBack(an,an+2,an+1),W.emplaceBack(an+1,an+2,an+3),ne.vertexLength+=4,ne.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(lt[0]),X!==s.length-1&&on===s[X+1].sectionIndex||t.programConfigurations.populatePaintArrays(K.length,E,E.index,{},q,we&&we[on])}t.placedSymbolArray.emplaceBack(R.x,R.y,ue,this.glyphOffsetArray.length-ue,_e,B,U,R.segment,d?d[0]:0,d?d[1]:0,_[0],_[1],C,0,!1,0,G)}_addCollisionDebugVertex(t,s,d,_,T,E){return s.emplaceBack(0,0),t.emplaceBack(d.x,d.y,_,T,Math.round(E.x),Math.round(E.y))}addCollisionDebugVertices(t,s,d,_,T,E,C){const R=T.segments.prepareSegment(4,T.layoutVertexArray,T.indexArray),B=R.vertexLength,U=T.layoutVertexArray,G=T.collisionVertexArray,q=C.anchorX,W=C.anchorY;this._addCollisionDebugVertex(U,G,E,q,W,new $(t,s)),this._addCollisionDebugVertex(U,G,E,q,W,new $(d,s)),this._addCollisionDebugVertex(U,G,E,q,W,new $(d,_)),this._addCollisionDebugVertex(U,G,E,q,W,new $(t,_)),R.vertexLength+=4;const K=T.indexArray;K.emplaceBack(B,B+1),K.emplaceBack(B+1,B+2),K.emplaceBack(B+2,B+3),K.emplaceBack(B+3,B),R.primitiveLength+=4}addDebugCollisionBoxes(t,s,d,_){for(let T=t;T<s;T++){const E=this.collisionBoxArray.get(T);this.addCollisionDebugVertices(E.x1,E.y1,E.x2,E.y2,_?this.textCollisionBox:this.iconCollisionBox,E.anchorPoint,d)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ay(st,qm.members,kt),this.iconCollisionBox=new Ay(st,qm.members,kt);for(let t=0;t<this.symbolInstances.length;t++){const s=this.symbolInstances.get(t);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(t,s,d,_,T,E,C,R,B){const U={};for(let G=s;G<d;G++){const q=t.get(G);U.textBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},U.textFeatureIndex=q.featureIndex;break}for(let G=_;G<T;G++){const q=t.get(G);U.verticalTextBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},U.verticalTextFeatureIndex=q.featureIndex;break}for(let G=E;G<C;G++){const q=t.get(G);U.iconBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},U.iconFeatureIndex=q.featureIndex;break}for(let G=R;G<B;G++){const q=t.get(G);U.verticalIconBox={x1:q.x1,y1:q.y1,x2:q.x2,y2:q.y2,anchorPointX:q.anchorPointX,anchorPointY:q.anchorPointY},U.verticalIconFeatureIndex=q.featureIndex;break}return U}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const d=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,d.textBoxStartIndex,d.textBoxEndIndex,d.verticalTextBoxStartIndex,d.verticalTextBoxEndIndex,d.iconBoxStartIndex,d.iconBoxEndIndex,d.verticalIconBoxStartIndex,d.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,s){const d=t.placedSymbolArray.get(s),_=d.vertexStartIndex+4*d.numGlyphs;for(let T=d.vertexStartIndex;T<_;T+=4)t.indexArray.emplaceBack(T,T+2,T+1),t.indexArray.emplaceBack(T+1,T+2,T+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(t),d=Math.cos(t),_=[],T=[],E=[];for(let C=0;C<this.symbolInstances.length;++C){E.push(C);const R=this.symbolInstances.get(C);_.push(0|Math.round(s*R.anchorX+d*R.anchorY)),T.push(R.featureIndex)}return E.sort((C,R)=>_[C]-_[R]||T[R]-T[C]),E}addToSortKeyRanges(t,s){const d=this.sortKeyRanges[this.sortKeyRanges.length-1];d&&d.sortKey===s?d.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const d=this.symbolInstances.get(s);this.featureSortOrder.push(d.featureIndex),[d.rightJustifiedTextSymbolIndex,d.centerJustifiedTextSymbolIndex,d.leftJustifiedTextSymbolIndex].forEach((_,T,E)=>{_>=0&&E.indexOf(_)===T&&this.addIndicesForPlacedSymbol(this.text,_)}),d.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,d.verticalPlacedTextSymbolIndex),d.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.placedIconSymbolIndex),d.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,d.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Pp,Yh;Ft("SymbolBucket",pf,{omit:["layers","collisionBoxArray","features","compareText"]}),pf.MAX_GLYPHS=65535,pf.addDynamicAttributes=Ey;var zp={get paint(){return Yh=Yh||new _a({"icon-opacity":new rn(de.paint_symbol["icon-opacity"]),"icon-color":new rn(de.paint_symbol["icon-color"]),"icon-halo-color":new rn(de.paint_symbol["icon-halo-color"]),"icon-halo-width":new rn(de.paint_symbol["icon-halo-width"]),"icon-halo-blur":new rn(de.paint_symbol["icon-halo-blur"]),"icon-translate":new Wt(de.paint_symbol["icon-translate"]),"icon-translate-anchor":new Wt(de.paint_symbol["icon-translate-anchor"]),"text-opacity":new rn(de.paint_symbol["text-opacity"]),"text-color":new rn(de.paint_symbol["text-color"],{runtimeType:Cn,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new rn(de.paint_symbol["text-halo-color"]),"text-halo-width":new rn(de.paint_symbol["text-halo-width"]),"text-halo-blur":new rn(de.paint_symbol["text-halo-blur"]),"text-translate":new Wt(de.paint_symbol["text-translate"]),"text-translate-anchor":new Wt(de.paint_symbol["text-translate-anchor"])})},get layout(){return Pp=Pp||new _a({"symbol-placement":new Wt(de.layout_symbol["symbol-placement"]),"symbol-spacing":new Wt(de.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Wt(de.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new rn(de.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Wt(de.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Wt(de.layout_symbol["icon-allow-overlap"]),"icon-overlap":new Wt(de.layout_symbol["icon-overlap"]),"icon-ignore-placement":new Wt(de.layout_symbol["icon-ignore-placement"]),"icon-optional":new Wt(de.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Wt(de.layout_symbol["icon-rotation-alignment"]),"icon-size":new rn(de.layout_symbol["icon-size"]),"icon-text-fit":new Wt(de.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Wt(de.layout_symbol["icon-text-fit-padding"]),"icon-image":new rn(de.layout_symbol["icon-image"]),"icon-rotate":new rn(de.layout_symbol["icon-rotate"]),"icon-padding":new rn(de.layout_symbol["icon-padding"]),"icon-keep-upright":new Wt(de.layout_symbol["icon-keep-upright"]),"icon-offset":new rn(de.layout_symbol["icon-offset"]),"icon-anchor":new rn(de.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Wt(de.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Wt(de.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Wt(de.layout_symbol["text-rotation-alignment"]),"text-field":new rn(de.layout_symbol["text-field"]),"text-font":new rn(de.layout_symbol["text-font"]),"text-size":new rn(de.layout_symbol["text-size"]),"text-max-width":new rn(de.layout_symbol["text-max-width"]),"text-line-height":new Wt(de.layout_symbol["text-line-height"]),"text-letter-spacing":new rn(de.layout_symbol["text-letter-spacing"]),"text-justify":new rn(de.layout_symbol["text-justify"]),"text-radial-offset":new rn(de.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Wt(de.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new rn(de.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new rn(de.layout_symbol["text-anchor"]),"text-max-angle":new Wt(de.layout_symbol["text-max-angle"]),"text-writing-mode":new Wt(de.layout_symbol["text-writing-mode"]),"text-rotate":new rn(de.layout_symbol["text-rotate"]),"text-padding":new Wt(de.layout_symbol["text-padding"]),"text-keep-upright":new Wt(de.layout_symbol["text-keep-upright"]),"text-transform":new rn(de.layout_symbol["text-transform"]),"text-offset":new rn(de.layout_symbol["text-offset"]),"text-allow-overlap":new Wt(de.layout_symbol["text-allow-overlap"]),"text-overlap":new Wt(de.layout_symbol["text-overlap"]),"text-ignore-placement":new Wt(de.layout_symbol["text-ignore-placement"]),"text-optional":new Wt(de.layout_symbol["text-optional"])})}};class Op{constructor(t){if(t.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=t.property.overrides?t.property.overrides.runtimeType:fn,this.defaultValue=t}evaluate(t){if(t.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(t.formattedSection))return s.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ft("FormatSectionOverride",Op,{omit:["defaultValue"]});class mf extends ls{constructor(t){super(t,zp)}recalculate(t,s){if(super.recalculate(t,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const d=this.layout.get("text-writing-mode");if(d){const _=[];for(const T of d)_.indexOf(T)<0&&_.push(T);this.layout._values["text-writing-mode"]=_}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(t,s,d,_){const T=this.layout.get(t).evaluate(s,{},d,_),E=this._unevaluatedLayout._values[t];return E.isDataDriven()||is(E.value)||!T?T:function(C,R){return R.replace(/{([^{}]+)}/g,(B,U)=>C&&U in C?String(C[U]):"")}(s.properties,T)}createBucket(t){return new pf(t)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const t of zp.paint.overridableProperties){if(!mf.hasPaintOverride(this.layout,t))continue;const s=this.paint.get(t),d=new Op(s),_=new pu(d,s.property.specification);let T=null;T=s.value.kind==="constant"||s.value.kind==="source"?new Ws("source",_):new Qs("composite",_,s.value.zoomStops),this.paint._values[t]=new Ma(s.property,T,s.parameters)}}_handleOverridablePaintPropertyUpdate(t,s,d){return!(!this.layout||s.isDataDriven()||d.isDataDriven())&&mf.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,s){const d=t.get("text-field"),_=zp.paint.properties[s];let T=!1;const E=C=>{for(const R of C)if(_.overrides&&_.overrides.hasOverride(R))return void(T=!0)};if(d.value.kind==="constant"&&d.value.value instanceof or)E(d.value.value.sections);else if(d.value.kind==="source"){const C=B=>{T||(B instanceof Sa&&Ai(B.value)===no?E(B.value.sections):B instanceof ch?E(B.sections):B.eachChild(C))},R=d.value;R._styleExpression&&C(R._styleExpression.expression)}return T}}let Bu;var Xl={get paint(){return Bu=Bu||new _a({"background-color":new Wt(de.paint_background["background-color"]),"background-pattern":new Gd(de.paint_background["background-pattern"]),"background-opacity":new Wt(de.paint_background["background-opacity"])})}};class Lp extends ls{constructor(t){super(t,Xl)}}let t0;var n0={get paint(){return t0=t0||new _a({"raster-opacity":new Wt(de.paint_raster["raster-opacity"]),"raster-hue-rotate":new Wt(de.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Wt(de.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Wt(de.paint_raster["raster-brightness-max"]),"raster-saturation":new Wt(de.paint_raster["raster-saturation"]),"raster-contrast":new Wt(de.paint_raster["raster-contrast"]),"raster-resampling":new Wt(de.paint_raster["raster-resampling"]),"raster-fade-duration":new Wt(de.paint_raster["raster-fade-duration"])})}};class i0 extends ls{constructor(t){super(t,n0)}}class r0 extends ls{constructor(t){super(t,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class zv{constructor(t){this._methodToThrottle=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._methodToThrottle()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._methodToThrottle()},0))}remove(){delete this._channel,this._methodToThrottle=()=>{}}}const Bp=63710088e-1;class Uc{constructor(t,s){if(isNaN(t)||isNaN(s))throw new Error(`Invalid LngLat object: (${t}, ${s})`);if(this.lng=+t,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Uc(Tt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const s=Math.PI/180,d=this.lat*s,_=t.lat*s,T=Math.sin(d)*Math.sin(_)+Math.cos(d)*Math.cos(_)*Math.cos((t.lng-this.lng)*s);return Bp*Math.acos(Math.min(T,1))}static convert(t){if(t instanceof Uc)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Uc(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Uc(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Cy=2*Math.PI*Bp;function a0(l){return Cy*Math.cos(l*Math.PI/180)}function eg(l){return(180+l)/360}function tg(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function o0(l,t){return l/a0(t)}function My(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function gf(l,t){return l*a0(My(t))}class jp{constructor(t,s,d=0){this.x=+t,this.y=+s,this.z=+d}static fromLngLat(t,s=0){const d=Uc.convert(t);return new jp(eg(d.lng),tg(d.lat),o0(s,d.lat))}toLngLat(){return new Uc(360*this.x-180,My(this.y))}toAltitude(){return gf(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Cy*(t=My(this.y),1/Math.cos(t*Math.PI/180));var t}}function Dy(l,t,s){var d=2*Math.PI*6378137/256/Math.pow(2,s);return[l*d-2*Math.PI*6378137/2,t*d-2*Math.PI*6378137/2]}class Qn{constructor(t,s,d){if(!function(_,T,E){return!(_<0||_>25||E<0||E>=Math.pow(2,_)||T<0||T>=Math.pow(2,_))}(t,s,d))throw new Error(`x=${s}, y=${d}, z=${t} outside of bounds. 0<=x<${Math.pow(2,t)}, 0<=y<${Math.pow(2,t)} 0<=z<=25 `);this.z=t,this.x=s,this.y=d,this.key=ju(0,t,t,s,d)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,s,d){const _=(E=this.y,C=this.z,R=Dy(256*(T=this.x),256*(E=Math.pow(2,C)-E-1),C),B=Dy(256*(T+1),256*(E+1),C),R[0]+","+R[1]+","+B[0]+","+B[1]);var T,E,C,R,B;const U=function(G,q,W){let K,ne="";for(let ue=G;ue>0;ue--)K=1<<ue-1,ne+=(q&K?1:0)+(W&K?2:0);return ne}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(d==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,U).replace(/{bbox-epsg-3857}/g,_)}isChildOf(t){const s=this.z-t.z;return s>0&&t.x===this.x>>s&&t.y===this.y>>s}getTilePoint(t){const s=Math.pow(2,this.z);return new $((t.x*s-this.x)*Ge,(t.y*s-this.y)*Ge)}toString(){return`${this.z}/${this.x}/${this.y}`}}class ng{constructor(t,s){this.wrap=t,this.canonical=s,this.key=ju(t,s.z,s.z,s.x,s.y)}}class Ya{constructor(t,s,d,_,T){if(this.terrainRttPosMatrix32f=null,t<d)throw new Error(`overscaledZ should be >= z; overscaledZ = ${t}; z = ${d}`);this.overscaledZ=t,this.wrap=s,this.canonical=new Qn(d,+_,+T),this.key=ju(s,t,d,_,T)}clone(){return new Ya(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-t;return t>this.canonical.z?new Ya(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ya(t,this.wrap,t,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(t,s){if(t>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${t}; overscaledZ = ${this.overscaledZ}`);const d=this.canonical.z-t;return t>this.canonical.z?ju(this.wrap*+s,t,this.canonical.z,this.canonical.x,this.canonical.y):ju(this.wrap*+s,t,t,this.canonical.x>>d,this.canonical.y>>d)}isChildOf(t){if(t.wrap!==this.wrap)return!1;const s=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>s&&t.canonical.y===this.canonical.y>>s}children(t){if(this.overscaledZ>=t)return[new Ya(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,d=2*this.canonical.x,_=2*this.canonical.y;return[new Ya(s,this.wrap,s,d,_),new Ya(s,this.wrap,s,d+1,_),new Ya(s,this.wrap,s,d,_+1),new Ya(s,this.wrap,s,d+1,_+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Ya(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Ya(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new ng(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(t){return this.canonical.getTilePoint(new jp(t.x-this.wrap,t.y))}}function ju(l,t,s,d,_){(l*=2)<0&&(l=-1*l-1);const T=1<<s;return(T*T*l+T*_+d).toString(36)+s.toString(36)+t.toString(36)}Ft("CanonicalTileID",Qn),Ft("OverscaledTileID",Ya,{omit:["terrainRttPosMatrix32f"]});class Iy{constructor(t,s,d,_=1,T=1,E=1,C=0){if(this.uid=t,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(d&&!["mapbox","terrarium","custom"].includes(d))return void Wn(`"${d}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const R=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),d){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=_,this.greenFactor=T,this.blueFactor=E,this.baseShift=C;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let B=0;B<R;B++)this.data[this._idx(-1,B)]=this.data[this._idx(0,B)],this.data[this._idx(R,B)]=this.data[this._idx(R-1,B)],this.data[this._idx(B,-1)]=this.data[this._idx(B,0)],this.data[this._idx(B,R)]=this.data[this._idx(B,R-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(R,-1)]=this.data[this._idx(R-1,0)],this.data[this._idx(-1,R)]=this.data[this._idx(0,R-1)],this.data[this._idx(R,R)]=this.data[this._idx(R-1,R-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let B=0;B<R;B++)for(let U=0;U<R;U++){const G=this.get(B,U);G>this.max&&(this.max=G),G<this.min&&(this.min=G)}}get(t,s){const d=new Uint8Array(this.data.buffer),_=4*this._idx(t,s);return this.unpack(d[_],d[_+1],d[_+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(t,s){if(t<-1||t>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(t+1)}unpack(t,s,d){return t*this.redFactor+s*this.greenFactor+d*this.blueFactor-this.baseShift}getPixels(){return new Ra({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(t,s,d){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let _=s*this.dim,T=s*this.dim+this.dim,E=d*this.dim,C=d*this.dim+this.dim;switch(s){case-1:_=T-1;break;case 1:T=_+1}switch(d){case-1:E=C-1;break;case 1:C=E+1}const R=-s*this.dim,B=-d*this.dim;for(let U=E;U<C;U++)for(let G=_;G<T;G++)this.data[this._idx(G,U)]=t.data[this._idx(G+R,U+B)]}}Ft("DEMData",Iy);class ig{constructor(t){this._stringToNumber={},this._numberToString=[];for(let s=0;s<t.length;s++){const d=t[s];this._stringToNumber[d]=s,this._numberToString[s]=d}}encode(t){return this._stringToNumber[t]}decode(t){if(t>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${t} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[t]}}class yf{constructor(t,s,d,_,T){this.type="Feature",this._vectorTileFeature=t,t._z=s,t._x=d,t._y=_,this.properties=t.properties,this.id=T}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(t[s]=this[s]);return t}}class Fp{constructor(t,s){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new ga(Ge,16,0),this.grid3D=new ga(Ge,16,0),this.featureIndexArray=new me,this.promoteId=s}insert(t,s,d,_,T,E){const C=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(d,_,T);const R=E?this.grid3D:this.grid;for(let B=0;B<s.length;B++){const U=s[B],G=[1/0,1/0,-1/0,-1/0];for(let q=0;q<U.length;q++){const W=U[q];G[0]=Math.min(G[0],W.x),G[1]=Math.min(G[1],W.y),G[2]=Math.max(G[2],W.x),G[3]=Math.max(G[3],W.y)}G[0]<Ge&&G[1]<Ge&&G[2]>=0&&G[3]>=0&&R.insert(C,G[0],G[1],G[2],G[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new af.VectorTile(new Dp(this.rawTileData)).layers,this.sourceLayerCoder=new ig(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(t,s,d,_){this.loadVTLayers();const T=t.params,E=Ge/t.tileSize/t.scale,C=bc(T.filter),R=t.queryGeometry,B=t.queryPadding*E,U=ky(R),G=this.grid.query(U.minX-B,U.minY-B,U.maxX+B,U.maxY+B),q=ky(t.cameraQueryGeometry),W=this.grid3D.query(q.minX-B,q.minY-B,q.maxX+B,q.maxY+B,(ue,_e,Le,we)=>function(X,ce,Ee,qe,yt){for(const rt of X)if(ce<=rt.x&&Ee<=rt.y&&qe>=rt.x&&yt>=rt.y)return!0;const et=[new $(ce,Ee),new $(ce,yt),new $(qe,yt),new $(qe,Ee)];if(X.length>2){for(const rt of et)if(Su(X,rt))return!0}for(let rt=0;rt<X.length-1;rt++)if(sy(X[rt],X[rt+1],et))return!0;return!1}(t.cameraQueryGeometry,ue-B,_e-B,Le+B,we+B));for(const ue of W)G.push(ue);G.sort(Ov);const K={};let ne;for(let ue=0;ue<G.length;ue++){const _e=G[ue];if(_e===ne)continue;ne=_e;const Le=this.featureIndexArray.get(_e);let we=null;this.loadMatchingFeature(K,Le.bucketIndex,Le.sourceLayerIndex,Le.featureIndex,C,T.layers,T.availableImages,s,d,_,(X,ce,Ee)=>(we||(we=Ll(X)),ce.queryIntersectsFeature({queryGeometry:R,feature:X,featureState:Ee,geometry:we,zoom:this.z,transform:t.transform,pixelsToTileUnits:E,pixelPosMatrix:t.pixelPosMatrix})))}return K}loadMatchingFeature(t,s,d,_,T,E,C,R,B,U,G){const q=this.bucketLayerIDs[s];if(E&&!q.some(ue=>E.has(ue)))return;const W=this.sourceLayerCoder.decode(d),K=this.vtLayers[W].feature(_);if(T.needGeometry){const ue=Bl(K,!0);if(!T.filter(new Mi(this.tileID.overscaledZ),ue,this.tileID.canonical))return}else if(!T.filter(new Mi(this.tileID.overscaledZ),K))return;const ne=this.getId(K,W);for(let ue=0;ue<q.length;ue++){const _e=q[ue];if(E&&!E.has(_e))continue;const Le=R[_e];if(!Le)continue;let we={};ne&&U&&(we=U.getState(Le.sourceLayer||"_geojsonTileLayer",ne));const X=jt({},B[_e]);X.paint=qh(X.paint,Le.paint,K,we,C),X.layout=qh(X.layout,Le.layout,K,we,C);const ce=!G||G(K,Le,we);if(!ce)continue;const Ee=new yf(K,this.z,this.x,this.y,ne);Ee.layer=X;let qe=t[_e];qe===void 0&&(qe=t[_e]=[]),qe.push({featureIndex:_,feature:Ee,intersectionZ:ce})}}lookupSymbolFeatures(t,s,d,_,T,E,C,R){const B={};this.loadVTLayers();const U=bc(T);for(const G of t)this.loadMatchingFeature(B,d,_,G,U,E,C,R,s);return B}hasLayer(t){for(const s of this.bucketLayerIDs)for(const d of s)if(t===d)return!0;return!1}getId(t,s){var d;let _=t.id;return this.promoteId&&(_=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof _=="boolean"&&(_=Number(_)),_===void 0&&(!((d=t.properties)===null||d===void 0)&&d.cluster)&&this.promoteId&&(_=Number(t.properties.cluster_id))),_}}function qh(l,t,s,d,_){return Sn(l,(T,E)=>{const C=t instanceof Fo?t.get(E):null;return C&&C.evaluate?C.evaluate(s,d,_):C})}function ky(l){let t=1/0,s=1/0,d=-1/0,_=-1/0;for(const T of l)t=Math.min(t,T.x),s=Math.min(s,T.y),d=Math.max(d,T.x),_=Math.max(_,T.y);return{minX:t,minY:s,maxX:d,maxY:_}}function Ov(l,t){return t-l}function s0(l,t,s,d,_){const T=[];for(let E=0;E<l.length;E++){const C=l[E];let R;for(let B=0;B<C.length-1;B++){let U=C[B],G=C[B+1];U.x<t&&G.x<t||(U.x<t?U=new $(t,U.y+(t-U.x)/(G.x-U.x)*(G.y-U.y))._round():G.x<t&&(G=new $(t,U.y+(t-U.x)/(G.x-U.x)*(G.y-U.y))._round()),U.y<s&&G.y<s||(U.y<s?U=new $(U.x+(s-U.y)/(G.y-U.y)*(G.x-U.x),s)._round():G.y<s&&(G=new $(U.x+(s-U.y)/(G.y-U.y)*(G.x-U.x),s)._round()),U.x>=d&&G.x>=d||(U.x>=d?U=new $(d,U.y+(d-U.x)/(G.x-U.x)*(G.y-U.y))._round():G.x>=d&&(G=new $(d,U.y+(d-U.x)/(G.x-U.x)*(G.y-U.y))._round()),U.y>=_&&G.y>=_||(U.y>=_?U=new $(U.x+(_-U.y)/(G.y-U.y)*(G.x-U.x),_)._round():G.y>=_&&(G=new $(U.x+(_-U.y)/(G.y-U.y)*(G.x-U.x),_)._round()),R&&U.equals(R[R.length-1])||(R=[U],T.push(R)),R.push(G)))))}}return T}Ft("FeatureIndex",Fp,{omit:["rawTileData","sourceLayerCoder"]});class Vc extends ${constructor(t,s,d,_){super(t,s),this.angle=d,_!==void 0&&(this.segment=_)}clone(){return new Vc(this.x,this.y,this.angle,this.segment)}}function Ry(l,t,s,d,_){if(t.segment===void 0||s===0)return!0;let T=t,E=t.segment+1,C=0;for(;C>-s/2;){if(E--,E<0)return!1;C-=l[E].dist(T),T=l[E]}C+=l[E].dist(l[E+1]),E++;const R=[];let B=0;for(;C<s/2;){const U=l[E],G=l[E+1];if(!G)return!1;let q=l[E-1].angleTo(U)-U.angleTo(G);for(q=Math.abs((q+3*Math.PI)%(2*Math.PI)-Math.PI),R.push({distance:C,angleDelta:q}),B+=q;C-R[0].distance>d;)B-=R.shift().angleDelta;if(B>_)return!1;E++,C+=U.dist(G)}return!0}function Up(l){let t=0;for(let s=0;s<l.length-1;s++)t+=l[s].dist(l[s+1]);return t}function ki(l,t,s){return l?.6*t*s:0}function rg(l,t){return Math.max(l?l.right-l.left:0,t?t.right-t.left:0)}function Pa(l,t,s,d,_,T){const E=ki(s,_,T),C=rg(s,d)*T;let R=0;const B=Up(l)/2;for(let U=0;U<l.length-1;U++){const G=l[U],q=l[U+1],W=G.dist(q);if(R+W>B){const K=(B-R)/W,ne=es.number(G.x,q.x,K),ue=es.number(G.y,q.y,K),_e=new Vc(ne,ue,q.angleTo(G),U);return _e._round(),!E||Ry(l,_e,C,E,t)?_e:void 0}R+=W}}function Lv(l,t,s,d,_,T,E,C,R){const B=ki(d,T,E),U=rg(d,_),G=U*E,q=l[0].x===0||l[0].x===R||l[0].y===0||l[0].y===R;return t-G<t/4&&(t=G+t/4),ag(l,q?t/2*C%t:(U/2+2*T)*E*C%t,t,B,s,G,q,!1,R)}function ag(l,t,s,d,_,T,E,C,R){const B=T/2,U=Up(l);let G=0,q=t-s,W=[];for(let K=0;K<l.length-1;K++){const ne=l[K],ue=l[K+1],_e=ne.dist(ue),Le=ue.angleTo(ne);for(;q+s<G+_e;){q+=s;const we=(q-G)/_e,X=es.number(ne.x,ue.x,we),ce=es.number(ne.y,ue.y,we);if(X>=0&&X<R&&ce>=0&&ce<R&&q-B>=0&&q+B<=U){const Ee=new Vc(X,ce,Le,K);Ee._round(),d&&!Ry(l,Ee,T,d,_)||W.push(Ee)}}G+=_e}return C||W.length||E||(W=ag(l,G/2,s,d,_,T,E,!0,R)),W}Ft("Anchor",Vc);const Hh=Na;function Vp(l,t,s,d){const _=[],T=l.image,E=T.pixelRatio,C=T.paddedRect.w-2*Hh,R=T.paddedRect.h-2*Hh;let B={x1:l.left,y1:l.top,x2:l.right,y2:l.bottom};const U=T.stretchX||[[0,C]],G=T.stretchY||[[0,R]],q=(lt,Zt)=>lt+Zt[1]-Zt[0],W=U.reduce(q,0),K=G.reduce(q,0),ne=C-W,ue=R-K;let _e=0,Le=W,we=0,X=K,ce=0,Ee=ne,qe=0,yt=ue;if(T.content&&d){const lt=T.content,Zt=lt[2]-lt[0],on=lt[3]-lt[1];(T.textFitWidth||T.textFitHeight)&&(B=$h(l)),_e=Gp(U,0,lt[0]),we=Gp(G,0,lt[1]),Le=Gp(U,lt[0],lt[2]),X=Gp(G,lt[1],lt[3]),ce=lt[0]-_e,qe=lt[1]-we,Ee=Zt-Le,yt=on-X}const et=B.x1,rt=B.y1,Et=B.x2-et,_t=B.y2-rt,St=(lt,Zt,on,an)=>{const Xt=_f(lt.stretch-_e,Le,Et,et),Pn=vf(lt.fixed-ce,Ee,lt.stretch,W),zi=_f(Zt.stretch-we,X,_t,rt),Mr=vf(Zt.fixed-qe,yt,Zt.stretch,K),sa=_f(on.stretch-_e,Le,Et,et),fo=vf(on.fixed-ce,Ee,on.stretch,W),Br=_f(an.stretch-we,X,_t,rt),tr=vf(an.fixed-qe,yt,an.stretch,K),di=new $(Xt,zi),vr=new $(sa,zi),Dr=new $(sa,Br),nr=new $(Xt,Br),qa=new $(Pn/E,Mr/E),Yo=new $(fo/E,tr/E),br=t*Math.PI/180;if(br){const Ir=Math.sin(br),Yr=Math.cos(br),Fr=[Yr,-Ir,Ir,Yr];di._matMult(Fr),vr._matMult(Fr),nr._matMult(Fr),Dr._matMult(Fr)}const po=lt.stretch+lt.fixed,jr=Zt.stretch+Zt.fixed;return{tl:di,tr:vr,bl:nr,br:Dr,tex:{x:T.paddedRect.x+Hh+po,y:T.paddedRect.y+Hh+jr,w:on.stretch+on.fixed-po,h:an.stretch+an.fixed-jr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:qa,pixelOffsetBR:Yo,minFontScaleX:Ee/E/Et,minFontScaleY:yt/E/_t,isSDF:s}};if(d&&(T.stretchX||T.stretchY)){const lt=Ny(U,ne,W),Zt=Ny(G,ue,K);for(let on=0;on<lt.length-1;on++){const an=lt[on],Xt=lt[on+1];for(let Pn=0;Pn<Zt.length-1;Pn++)_.push(St(an,Zt[Pn],Xt,Zt[Pn+1]))}}else _.push(St({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:C+1},{fixed:0,stretch:R+1}));return _}function Gp(l,t,s){let d=0;for(const _ of l)d+=Math.max(t,Math.min(s,_[1]))-Math.max(t,Math.min(s,_[0]));return d}function Ny(l,t,s){const d=[{fixed:-1,stretch:0}];for(const[_,T]of l){const E=d[d.length-1];d.push({fixed:_-E.stretch,stretch:E.stretch}),d.push({fixed:_-E.stretch,stretch:E.stretch+(T-_)})}return d.push({fixed:t+Hh,stretch:s}),d}function _f(l,t,s,d){return l/t*s+d}function vf(l,t,s,d){return l-t*s/d}class og{constructor(t,s,d,_,T,E,C,R,B,U){var G;if(this.boxStartIndex=t.length,B){let q=E.top,W=E.bottom;const K=E.collisionPadding;K&&(q-=K[1],W+=K[3]);let ne=W-q;ne>0&&(ne=Math.max(10,ne),this.circleDiameter=ne)}else{const q=!((G=E.image)===null||G===void 0)&&G.content&&(E.image.textFitWidth||E.image.textFitHeight)?$h(E):{x1:E.left,y1:E.top,x2:E.right,y2:E.bottom};q.y1=q.y1*C-R[0],q.y2=q.y2*C+R[2],q.x1=q.x1*C-R[3],q.x2=q.x2*C+R[1];const W=E.collisionPadding;if(W&&(q.x1-=W[0]*C,q.y1-=W[1]*C,q.x2+=W[2]*C,q.y2+=W[3]*C),U){const K=new $(q.x1,q.y1),ne=new $(q.x2,q.y1),ue=new $(q.x1,q.y2),_e=new $(q.x2,q.y2),Le=U*Math.PI/180;K._rotate(Le),ne._rotate(Le),ue._rotate(Le),_e._rotate(Le),q.x1=Math.min(K.x,ne.x,ue.x,_e.x),q.x2=Math.max(K.x,ne.x,ue.x,_e.x),q.y1=Math.min(K.y,ne.y,ue.y,_e.y),q.y2=Math.max(K.y,ne.y,ue.y,_e.y)}t.emplaceBack(s.x,s.y,q.x1,q.y1,q.x2,q.y2,d,_,T)}this.boxEndIndex=t.length}}class l0{constructor(t=[],s=(d,_)=>d<_?-1:d>_?1:0){if(this.data=t,this.length=this.data.length,this.compare=s,this.length>0)for(let d=(this.length>>1)-1;d>=0;d--)this._down(d)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],s=this.data.pop();return--this.length>0&&(this.data[0]=s,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:s,compare:d}=this,_=s[t];for(;t>0;){const T=t-1>>1,E=s[T];if(d(_,E)>=0)break;s[t]=E,t=T}s[t]=_}_down(t){const{data:s,compare:d}=this,_=this.length>>1,T=s[t];for(;t<_;){let E=1+(t<<1);const C=E+1;if(C<this.length&&d(s[C],s[E])<0&&(E=C),d(s[E],T)>=0)break;s[t]=s[E],t=E}s[t]=T}}function Bv(l,t=1,s=!1){let d=1/0,_=1/0,T=-1/0,E=-1/0;const C=l[0];for(let W=0;W<C.length;W++){const K=C[W];(!W||K.x<d)&&(d=K.x),(!W||K.y<_)&&(_=K.y),(!W||K.x>T)&&(T=K.x),(!W||K.y>E)&&(E=K.y)}const R=Math.min(T-d,E-_);let B=R/2;const U=new l0([],c0);if(R===0)return new $(d,_);for(let W=d;W<T;W+=R)for(let K=_;K<E;K+=R)U.push(new bf(W+B,K+B,B,l));let G=function(W){let K=0,ne=0,ue=0;const _e=W[0];for(let Le=0,we=_e.length,X=we-1;Le<we;X=Le++){const ce=_e[Le],Ee=_e[X],qe=ce.x*Ee.y-Ee.x*ce.y;ne+=(ce.x+Ee.x)*qe,ue+=(ce.y+Ee.y)*qe,K+=3*qe}return new bf(ne/K,ue/K,0,W)}(l),q=U.length;for(;U.length;){const W=U.pop();(W.d>G.d||!G.d)&&(G=W,s&&console.log("found best %d after %d probes",Math.round(1e4*W.d)/1e4,q)),W.max-G.d<=t||(B=W.h/2,U.push(new bf(W.p.x-B,W.p.y-B,B,l)),U.push(new bf(W.p.x+B,W.p.y-B,B,l)),U.push(new bf(W.p.x-B,W.p.y+B,B,l)),U.push(new bf(W.p.x+B,W.p.y+B,B,l)),q+=4)}return s&&(console.log(`num probes: ${q}`),console.log(`best distance: ${G.d}`)),G.p}function c0(l,t){return t.max-l.max}function bf(l,t,s,d){this.p=new $(l,t),this.h=s,this.d=function(_,T){let E=!1,C=1/0;for(let R=0;R<T.length;R++){const B=T[R];for(let U=0,G=B.length,q=G-1;U<G;q=U++){const W=B[U],K=B[q];W.y>_.y!=K.y>_.y&&_.x<(K.x-W.x)*(_.y-W.y)/(K.y-W.y)+W.x&&(E=!E),C=Math.min(C,zm(_,W,K))}}return(E?1:-1)*Math.sqrt(C)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}var ba;g.av=void 0,(ba=g.av||(g.av={}))[ba.center=1]="center",ba[ba.left=2]="left",ba[ba.right=3]="right",ba[ba.top=4]="top",ba[ba.bottom=5]="bottom",ba[ba["top-left"]=6]="top-left",ba[ba["top-right"]=7]="top-right",ba[ba["bottom-left"]=8]="bottom-left",ba[ba["bottom-right"]=9]="bottom-right";const Wl=7,Zp=Number.POSITIVE_INFINITY;function u0(l,t){return t[1]!==Zp?function(s,d,_){let T=0,E=0;switch(d=Math.abs(d),_=Math.abs(_),s){case"top-right":case"top-left":case"top":E=_-Wl;break;case"bottom-right":case"bottom-left":case"bottom":E=-_+Wl}switch(s){case"top-right":case"bottom-right":case"right":T=-d;break;case"top-left":case"bottom-left":case"left":T=d}return[T,E]}(l,t[0],t[1]):function(s,d){let _=0,T=0;d<0&&(d=0);const E=d/Math.SQRT2;switch(s){case"top-right":case"top-left":T=E-Wl;break;case"bottom-right":case"bottom-left":T=-E+Wl;break;case"bottom":T=-d+Wl;break;case"top":T=d-Wl}switch(s){case"top-right":case"bottom-right":_=-E;break;case"top-left":case"bottom-left":_=E;break;case"left":_=d;break;case"right":_=-d}return[_,T]}(l,t[0])}function h0(l,t,s){var d;const _=l.layout,T=(d=_.get("text-variable-anchor-offset"))===null||d===void 0?void 0:d.evaluate(t,{},s);if(T){const C=T.values,R=[];for(let B=0;B<C.length;B+=2){const U=R[B]=C[B],G=C[B+1].map(q=>q*er);U.startsWith("top")?G[1]-=Wl:U.startsWith("bottom")&&(G[1]+=Wl),R[B+1]=G}return new oa(R)}const E=_.get("text-variable-anchor");if(E){let C;C=l._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[_.get("text-radial-offset").evaluate(t,{},s)*er,Zp]:_.get("text-offset").evaluate(t,{},s).map(B=>B*er);const R=[];for(const B of E)R.push(B,u0(B,C));return new oa(R)}return null}function fs(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function d0(l,t,s,d,_,T,E,C,R,B,U,G){let q=T.textMaxSize.evaluate(t,{});q===void 0&&(q=E);const W=l.layers[0].layout,K=W.get("icon-offset").evaluate(t,{},U),ne=ps(s.horizontal),ue=E/24,_e=l.tilePixelRatio*ue,Le=l.tilePixelRatio*q/24,we=l.tilePixelRatio*C,X=l.tilePixelRatio*W.get("symbol-spacing"),ce=W.get("text-padding")*l.tilePixelRatio,Ee=function(on,an,Xt,Pn=1){const zi=on.get("icon-padding").evaluate(an,{},Xt),Mr=zi&&zi.values;return[Mr[0]*Pn,Mr[1]*Pn,Mr[2]*Pn,Mr[3]*Pn]}(W,t,U,l.tilePixelRatio),qe=W.get("text-max-angle")/180*Math.PI,yt=W.get("text-rotation-alignment")!=="viewport"&&W.get("symbol-placement")!=="point",et=W.get("icon-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",rt=W.get("symbol-placement"),Et=X/2,_t=W.get("icon-text-fit");let St;d&&_t!=="none"&&(l.allowVerticalPlacement&&s.vertical&&(St=Np(d,s.vertical,_t,W.get("icon-text-fit-padding"),K,ue)),ne&&(d=Np(d,ne,_t,W.get("icon-text-fit-padding"),K,ue)));const lt=U?G.line.getGranularityForZoomLevel(U.z):1,Zt=(on,an)=>{an.x<0||an.x>=Ge||an.y<0||an.y>=Ge||function(Xt,Pn,zi,Mr,sa,fo,Br,tr,di,vr,Dr,nr,qa,Yo,br,po,jr,Ir,Yr,Fr,Si,qo,Xh,mo,Fy){const Gc=Xt.addToLineVertexArray(Pn,zi);let Fu,xf,Zc,r,u=0,m=0,x=0,M=0,O=-1,Q=-1;const le={};let Ae=Ei("");if(Xt.allowVerticalPlacement&&Mr.vertical){const Kt=tr.layout.get("text-rotate").evaluate(Si,{},mo)+90;Zc=new og(di,Pn,vr,Dr,nr,Mr.vertical,qa,Yo,br,Kt),Br&&(r=new og(di,Pn,vr,Dr,nr,Br,jr,Ir,br,Kt))}if(sa){const Kt=tr.layout.get("icon-rotate").evaluate(Si,{}),Di=tr.layout.get("icon-text-fit")!=="none",Xn=Vp(sa,Kt,Xh,Di),xa=Br?Vp(Br,Kt,Xh,Di):void 0;xf=new og(di,Pn,vr,Dr,nr,sa,jr,Ir,!1,Kt),u=4*Xn.length;const Wh=Xt.iconSizeData;let Uu=null;Wh.kind==="source"?(Uu=[cl*tr.layout.get("icon-size").evaluate(Si,{})],Uu[0]>Ou&&Wn(`${Xt.layerIds[0]}: Value for "icon-size" is >= ${df}. Reduce your "icon-size".`)):Wh.kind==="composite"&&(Uu=[cl*qo.compositeIconSizes[0].evaluate(Si,{},mo),cl*qo.compositeIconSizes[1].evaluate(Si,{},mo)],(Uu[0]>Ou||Uu[1]>Ou)&&Wn(`${Xt.layerIds[0]}: Value for "icon-size" is >= ${df}. Reduce your "icon-size".`)),Xt.addSymbols(Xt.icon,Xn,Uu,Fr,Yr,Si,g.ai.none,Pn,Gc.lineStartIndex,Gc.lineLength,-1,mo),O=Xt.icon.placedSymbolArray.length-1,xa&&(m=4*xa.length,Xt.addSymbols(Xt.icon,xa,Uu,Fr,Yr,Si,g.ai.vertical,Pn,Gc.lineStartIndex,Gc.lineLength,-1,mo),Q=Xt.icon.placedSymbolArray.length-1)}const Ze=Object.keys(Mr.horizontal);for(const Kt of Ze){const Di=Mr.horizontal[Kt];if(!Fu){Ae=Ei(Di.text);const xa=tr.layout.get("text-rotate").evaluate(Si,{},mo);Fu=new og(di,Pn,vr,Dr,nr,Di,qa,Yo,br,xa)}const Xn=Di.positionedLines.length===1;if(x+=Py(Xt,Pn,Di,fo,tr,br,Si,po,Gc,Mr.vertical?g.ai.horizontal:g.ai.horizontalOnly,Xn?Ze:[Kt],le,O,qo,mo),Xn)break}Mr.vertical&&(M+=Py(Xt,Pn,Mr.vertical,fo,tr,br,Si,po,Gc,g.ai.vertical,["vertical"],le,Q,qo,mo));const pt=Fu?Fu.boxStartIndex:Xt.collisionBoxArray.length,At=Fu?Fu.boxEndIndex:Xt.collisionBoxArray.length,it=Zc?Zc.boxStartIndex:Xt.collisionBoxArray.length,ft=Zc?Zc.boxEndIndex:Xt.collisionBoxArray.length,ln=xf?xf.boxStartIndex:Xt.collisionBoxArray.length,In=xf?xf.boxEndIndex:Xt.collisionBoxArray.length,Ur=r?r.boxStartIndex:Xt.collisionBoxArray.length,Ye=r?r.boxEndIndex:Xt.collisionBoxArray.length;let Ue=-1;const Je=(Kt,Di)=>Kt&&Kt.circleDiameter?Math.max(Kt.circleDiameter,Di):Di;Ue=Je(Fu,Ue),Ue=Je(Zc,Ue),Ue=Je(xf,Ue),Ue=Je(r,Ue);const xt=Ue>-1?1:0;xt&&(Ue*=Fy/er),Xt.glyphOffsetArray.length>=pf.MAX_GLYPHS&&Wn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Si.sortKey!==void 0&&Xt.addToSortKeyRanges(Xt.symbolInstances.length,Si.sortKey);const nn=h0(tr,Si,mo),[Hn,un]=function(Kt,Di){const Xn=Kt.length,xa=Di==null?void 0:Di.values;if((xa==null?void 0:xa.length)>0)for(let Wh=0;Wh<xa.length;Wh+=2){const Uu=xa[Wh+1];Kt.emplaceBack(g.av[xa[Wh]],Uu[0],Uu[1])}return[Xn,Kt.length]}(Xt.textAnchorOffsets,nn);Xt.symbolInstances.emplaceBack(Pn.x,Pn.y,le.right>=0?le.right:-1,le.center>=0?le.center:-1,le.left>=0?le.left:-1,le.vertical||-1,O,Q,Ae,pt,At,it,ft,ln,In,Ur,Ye,vr,x,M,u,m,xt,0,qa,Ue,Hn,un)}(l,an,on,s,d,_,St,l.layers[0],l.collisionBoxArray,t.index,t.sourceLayerIndex,l.index,_e,[ce,ce,ce,ce],yt,R,we,Ee,et,K,t,T,B,U,E)};if(rt==="line")for(const on of s0(t.geometry,0,0,Ge,Ge)){const an=Iu(on,lt),Xt=Lv(an,X,qe,s.vertical||ne,d,24,Le,l.overscaling,Ge);for(const Pn of Xt)ne&&f0(l,ne.text,Et,Pn)||Zt(an,Pn)}else if(rt==="line-center"){for(const on of t.geometry)if(on.length>1){const an=Iu(on,lt),Xt=Pa(an,qe,s.vertical||ne,d,24,Le);Xt&&Zt(an,Xt)}}else if(t.type==="Polygon")for(const on of Id(t.geometry,0)){const an=Bv(on,16);Zt(Iu(on[0],lt,!0),new Vc(an.x,an.y,0))}else if(t.type==="LineString")for(const on of t.geometry){const an=Iu(on,lt);Zt(an,new Vc(an[0].x,an[0].y,0))}else if(t.type==="Point")for(const on of t.geometry)for(const an of on)Zt([an],new Vc(an.x,an.y,0))}function Py(l,t,s,d,_,T,E,C,R,B,U,G,q,W,K){const ne=function(Le,we,X,ce,Ee,qe,yt,et){const rt=ce.layout.get("text-rotate").evaluate(qe,{})*Math.PI/180,Et=[];for(const _t of we.positionedLines)for(const St of _t.positionedGlyphs){if(!St.rect)continue;const lt=St.rect||{};let Zt=Gh+1,on=!0,an=1,Xt=0;const Pn=(Ee||et)&&St.vertical,zi=St.metrics.advance*St.scale/2;if(et&&we.verticalizable&&(Xt=_t.lineOffset/2-(St.imageName?-(er-St.metrics.width*St.scale)/2:(St.scale-1)*er)),St.imageName){const Ir=yt[St.imageName];on=Ir.sdf,an=Ir.pixelRatio,Zt=Na/an}const Mr=Ee?[St.x+zi,St.y]:[0,0];let sa=Ee?[0,0]:[St.x+zi+X[0],St.y+X[1]-Xt],fo=[0,0];Pn&&(fo=sa,sa=[0,0]);const Br=St.metrics.isDoubleResolution?2:1,tr=(St.metrics.left-Zt)*St.scale-zi+sa[0],di=(-St.metrics.top-Zt)*St.scale+sa[1],vr=tr+lt.w/Br*St.scale/an,Dr=di+lt.h/Br*St.scale/an,nr=new $(tr,di),qa=new $(vr,di),Yo=new $(tr,Dr),br=new $(vr,Dr);if(Pn){const Ir=new $(-zi,zi-$a),Yr=-Math.PI/2,Fr=er/2-zi,Si=new $(5-$a-Fr,-(St.imageName?Fr:0)),qo=new $(...fo);nr._rotateAround(Yr,Ir)._add(Si)._add(qo),qa._rotateAround(Yr,Ir)._add(Si)._add(qo),Yo._rotateAround(Yr,Ir)._add(Si)._add(qo),br._rotateAround(Yr,Ir)._add(Si)._add(qo)}if(rt){const Ir=Math.sin(rt),Yr=Math.cos(rt),Fr=[Yr,-Ir,Ir,Yr];nr._matMult(Fr),qa._matMult(Fr),Yo._matMult(Fr),br._matMult(Fr)}const po=new $(0,0),jr=new $(0,0);Et.push({tl:nr,tr:qa,bl:Yo,br,tex:lt,writingMode:we.writingMode,glyphOffset:Mr,sectionIndex:St.sectionIndex,isSDF:on,pixelOffsetTL:po,pixelOffsetBR:jr,minFontScaleX:0,minFontScaleY:0})}return Et}(0,s,C,_,T,E,d,l.allowVerticalPlacement),ue=l.textSizeData;let _e=null;ue.kind==="source"?(_e=[cl*_.layout.get("text-size").evaluate(E,{})],_e[0]>Ou&&Wn(`${l.layerIds[0]}: Value for "text-size" is >= ${df}. Reduce your "text-size".`)):ue.kind==="composite"&&(_e=[cl*W.compositeTextSizes[0].evaluate(E,{},K),cl*W.compositeTextSizes[1].evaluate(E,{},K)],(_e[0]>Ou||_e[1]>Ou)&&Wn(`${l.layerIds[0]}: Value for "text-size" is >= ${df}. Reduce your "text-size".`)),l.addSymbols(l.text,ne,_e,C,T,E,B,t,R.lineStartIndex,R.lineLength,q,K);for(const Le of U)G[Le]=l.text.placedSymbolArray.length-1;return 4*ne.length}function ps(l){for(const t in l)return l[t];return null}function f0(l,t,s,d){const _=l.compareText;if(t in _){const T=_[t];for(let E=T.length-1;E>=0;E--)if(d.dist(T[E])<s)return!0}else _[t]=[];return _[t].push(d),!1}const $p=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class ul{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,d]=new Uint8Array(t,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const _=d>>4;if(_!==1)throw new Error(`Got v${_} data when expected v1.`);const T=$p[15&d];if(!T)throw new Error("Unrecognized array type.");const[E]=new Uint16Array(t,2,1),[C]=new Uint32Array(t,4,1);return new ul(C,E,T,t)}constructor(t,s=64,d=Float64Array,_){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=d,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const T=$p.indexOf(this.ArrayType),E=2*t*this.ArrayType.BYTES_PER_ELEMENT,C=t*this.IndexArrayType.BYTES_PER_ELEMENT,R=(8-C%8)%8;if(T<0)throw new Error(`Unexpected typed array class: ${d}.`);_&&_ instanceof ArrayBuffer?(this.data=_,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+C+R,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+E+C+R),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+C+R,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+T]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=t)}add(t,s){const d=this._pos>>1;return this.ids[d]=d,this.coords[this._pos++]=t,this.coords[this._pos++]=s,d}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return zy(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,s,d,_){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:T,coords:E,nodeSize:C}=this,R=[0,T.length-1,0],B=[];for(;R.length;){const U=R.pop()||0,G=R.pop()||0,q=R.pop()||0;if(G-q<=C){for(let ue=q;ue<=G;ue++){const _e=E[2*ue],Le=E[2*ue+1];_e>=t&&_e<=d&&Le>=s&&Le<=_&&B.push(T[ue])}continue}const W=q+G>>1,K=E[2*W],ne=E[2*W+1];K>=t&&K<=d&&ne>=s&&ne<=_&&B.push(T[W]),(U===0?t<=K:s<=ne)&&(R.push(q),R.push(W-1),R.push(1-U)),(U===0?d>=K:_>=ne)&&(R.push(W+1),R.push(G),R.push(1-U))}return B}within(t,s,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:T,nodeSize:E}=this,C=[0,_.length-1,0],R=[],B=d*d;for(;C.length;){const U=C.pop()||0,G=C.pop()||0,q=C.pop()||0;if(G-q<=E){for(let ue=q;ue<=G;ue++)m0(T[2*ue],T[2*ue+1],t,s)<=B&&R.push(_[ue]);continue}const W=q+G>>1,K=T[2*W],ne=T[2*W+1];m0(K,ne,t,s)<=B&&R.push(_[W]),(U===0?t-d<=K:s-d<=ne)&&(C.push(q),C.push(W-1),C.push(1-U)),(U===0?t+d>=K:s+d>=ne)&&(C.push(W+1),C.push(G),C.push(1-U))}return R}}function zy(l,t,s,d,_,T){if(_-d<=s)return;const E=d+_>>1;p0(l,t,E,d,_,T),zy(l,t,s,d,E-1,1-T),zy(l,t,s,E+1,_,1-T)}function p0(l,t,s,d,_,T){for(;_>d;){if(_-d>600){const B=_-d+1,U=s-d+1,G=Math.log(B),q=.5*Math.exp(2*G/3),W=.5*Math.sqrt(G*q*(B-q)/B)*(U-B/2<0?-1:1);p0(l,t,s,Math.max(d,Math.floor(s-U*q/B+W)),Math.min(_,Math.floor(s+(B-U)*q/B+W)),T)}const E=t[2*s+T];let C=d,R=_;for(Ql(l,t,d,s),t[2*_+T]>E&&Ql(l,t,d,_);C<R;){for(Ql(l,t,C,R),C++,R--;t[2*C+T]<E;)C++;for(;t[2*R+T]>E;)R--}t[2*d+T]===E?Ql(l,t,d,R):(R++,Ql(l,t,R,_)),R<=s&&(d=R+1),s<=R&&(_=R-1)}}function Ql(l,t,s,d){sg(l,s,d),sg(t,2*s,2*d),sg(t,2*s+1,2*d+1)}function sg(l,t,s){const d=l[t];l[t]=l[s],l[s]=d}function m0(l,t,s,d){const _=l-s,T=t-d;return _*_+T*T}var Oy;g.ce=void 0,(Oy=g.ce||(g.ce={})).create="create",Oy.load="load",Oy.fullLoad="fullLoad";let lg=null,Yp=[];const Ly=1e3/60,By="loadTime",jy="fullLoadTime",g0={mark(l){performance.mark(l)},frame(l){const t=l;lg!=null&&Yp.push(t-lg),lg=t},clearMetrics(){lg=null,Yp=[],performance.clearMeasures(By),performance.clearMeasures(jy);for(const l in g.ce)performance.clearMarks(g.ce[l])},getPerformanceMetrics(){performance.measure(By,g.ce.create,g.ce.load),performance.measure(jy,g.ce.create,g.ce.fullLoad);const l=performance.getEntriesByName(By)[0].duration,t=performance.getEntriesByName(jy)[0].duration,s=Yp.length,d=1/(Yp.reduce((T,E)=>T+E,0)/s/1e3),_=Yp.filter(T=>T>Ly).reduce((T,E)=>T+(E-Ly)/Ly,0);return{loadTime:l,fullLoadTime:t,fps:d,percentDroppedFrames:_/(s+_)*100,totalFrames:s}}};g.$=Be,g.A=Ne,g.B=bu,g.C=function(l){if(ci==null){const t=l.navigator?l.navigator.userAgent:null;ci=!!l.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ci},g.D=Wt,g.E=Rr,g.F=class{constructor(l,t){this.target=l,this.mapId=t,this.resolveRejects={},this.tasks={},this.taskQueue=[],this.abortControllers={},this.messageHandlers={},this.invoker=new zv(()=>this.process()),this.subscription=function(s,d,_,T){return s.addEventListener(d,_,!1),{unsubscribe:()=>{s.removeEventListener(d,_,!1)}}}(this.target,"message",s=>this.receive(s)),this.globalScope=Ni(self)?l:window}registerMessageHandler(l,t){this.messageHandlers[l]=t}sendAsync(l,t){return new Promise((s,d)=>{const _=Math.round(1e18*Math.random()).toString(36).substring(0,10);this.resolveRejects[_]={resolve:s,reject:d},t&&t.signal.addEventListener("abort",()=>{delete this.resolveRejects[_];const C={id:_,type:"<cancel>",origin:location.origin,targetMapId:l.targetMapId,sourceMapId:this.mapId};this.target.postMessage(C)},{once:!0});const T=[],E=Object.assign(Object.assign({},l),{id:_,sourceMapId:this.mapId,origin:location.origin,data:kl(l.data,T)});this.target.postMessage(E,{transfer:T})})}receive(l){const t=l.data,s=t.id;if(!(t.origin!=="file://"&&location.origin!=="file://"&&t.origin!=="resource://android"&&location.origin!=="resource://android"&&t.origin!==location.origin||t.targetMapId&&this.mapId!==t.targetMapId)){if(t.type==="<cancel>"){delete this.tasks[s];const d=this.abortControllers[s];return delete this.abortControllers[s],void(d&&d.abort())}if(Ni(self)||t.mustQueue)return this.tasks[s]=t,this.taskQueue.push(s),void this.invoker.trigger();this.processTask(s,t)}}process(){if(this.taskQueue.length===0)return;const l=this.taskQueue.shift(),t=this.tasks[l];delete this.tasks[l],this.taskQueue.length>0&&this.invoker.trigger(),t&&this.processTask(l,t)}processTask(l,t){return c(this,void 0,void 0,function*(){if(t.type==="<response>"){const _=this.resolveRejects[l];return delete this.resolveRejects[l],_?void(t.error?_.reject(Rl(t.error)):_.resolve(Rl(t.data))):void 0}if(!this.messageHandlers[t.type])return void this.completeTask(l,new Error(`Could not find a registered handler for ${t.type}, map ID: ${this.mapId}, available handlers: ${Object.keys(this.messageHandlers).join(", ")}`));const s=Rl(t.data),d=new AbortController;this.abortControllers[l]=d;try{const _=yield this.messageHandlers[t.type](t.sourceMapId,s,d);this.completeTask(l,null,_)}catch(_){this.completeTask(l,_)}})}completeTask(l,t,s){const d=[];delete this.abortControllers[l];const _={id:l,type:"<response>",sourceMapId:this.mapId,origin:location.origin,error:t?kl(t):null,data:kl(s,d)};this.target.postMessage(_,{transfer:d})}remove(){this.invoker.remove(),this.subscription.unsubscribe()}},g.G=ws,g.H=function(){var l=new Ne(16);return Ne!=Float32Array&&(l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0),l[0]=1,l[5]=1,l[10]=1,l[15]=1,l},g.I=Ip,g.J=function(l,t,s){var d,_,T,E,C,R,B,U,G,q,W,K,ne=s[0],ue=s[1],_e=s[2];return t===l?(l[12]=t[0]*ne+t[4]*ue+t[8]*_e+t[12],l[13]=t[1]*ne+t[5]*ue+t[9]*_e+t[13],l[14]=t[2]*ne+t[6]*ue+t[10]*_e+t[14],l[15]=t[3]*ne+t[7]*ue+t[11]*_e+t[15]):(_=t[1],T=t[2],E=t[3],C=t[4],R=t[5],B=t[6],U=t[7],G=t[8],q=t[9],W=t[10],K=t[11],l[0]=d=t[0],l[1]=_,l[2]=T,l[3]=E,l[4]=C,l[5]=R,l[6]=B,l[7]=U,l[8]=G,l[9]=q,l[10]=W,l[11]=K,l[12]=d*ne+C*ue+G*_e+t[12],l[13]=_*ne+R*ue+q*_e+t[13],l[14]=T*ne+B*ue+W*_e+t[14],l[15]=E*ne+U*ue+K*_e+t[15]),l},g.K=function(l,t,s){var d=s[0],_=s[1],T=s[2];return l[0]=t[0]*d,l[1]=t[1]*d,l[2]=t[2]*d,l[3]=t[3]*d,l[4]=t[4]*_,l[5]=t[5]*_,l[6]=t[6]*_,l[7]=t[7]*_,l[8]=t[8]*T,l[9]=t[9]*T,l[10]=t[10]*T,l[11]=t[11]*T,l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15],l},g.L=function(l,t,s){var d=t[0],_=t[1],T=t[2],E=t[3],C=t[4],R=t[5],B=t[6],U=t[7],G=t[8],q=t[9],W=t[10],K=t[11],ne=t[12],ue=t[13],_e=t[14],Le=t[15],we=s[0],X=s[1],ce=s[2],Ee=s[3];return l[0]=we*d+X*C+ce*G+Ee*ne,l[1]=we*_+X*R+ce*q+Ee*ue,l[2]=we*T+X*B+ce*W+Ee*_e,l[3]=we*E+X*U+ce*K+Ee*Le,l[4]=(we=s[4])*d+(X=s[5])*C+(ce=s[6])*G+(Ee=s[7])*ne,l[5]=we*_+X*R+ce*q+Ee*ue,l[6]=we*T+X*B+ce*W+Ee*_e,l[7]=we*E+X*U+ce*K+Ee*Le,l[8]=(we=s[8])*d+(X=s[9])*C+(ce=s[10])*G+(Ee=s[11])*ne,l[9]=we*_+X*R+ce*q+Ee*ue,l[10]=we*T+X*B+ce*W+Ee*_e,l[11]=we*E+X*U+ce*K+Ee*Le,l[12]=(we=s[12])*d+(X=s[13])*C+(ce=s[14])*G+(Ee=s[15])*ne,l[13]=we*_+X*R+ce*q+Ee*ue,l[14]=we*T+X*B+ce*W+Ee*_e,l[15]=we*E+X*U+ce*K+Ee*Le,l},g.M=function(l,t){const s={};for(let d=0;d<t.length;d++){const _=t[d];_ in l&&(s[_]=l[_])}return s},g.N=Uc,g.O=eg,g.P=$,g.Q=tg,g.R=Ra,g.S=Ya,g.T=Nn,g.U=Ce,g.V=Me,g.W=kr,g.X=Ge,g.Y=jp,g.Z=Qn,g._=c,g.a=Wo,g.a$=function(){return new Float64Array(16)},g.a0=l=>{const t=window.document.createElement("video");return t.muted=!0,new Promise(s=>{t.onloadstart=()=>{s(t)};for(const d of l){const _=window.document.createElement("source");ac(d)||(t.crossOrigin="Anonymous"),_.src=d,t.appendChild(_)}})},g.a1=function(){return qt++},g.a2=w,g.a3=pf,g.a4=bc,g.a5=Bl,g.a6=yf,g.a7=function(l){const t={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,d,_,T)=>{const E=_||T;return t[d]=!E||E.toLowerCase(),""}),t["max-age"]){const s=parseInt(t["max-age"],10);isNaN(s)?delete t["max-age"]:t["max-age"]=s}return t},g.a8=function(l){return Math.log(l)/Math.LN2},g.a9=function(l){var t=l[0],s=l[1];return t*t+s*s},g.aA=lr,g.aB=Tp,g.aC=pe,g.aD=zt,g.aE=nt,g.aF=85.051129,g.aG=function(l){return Math.pow(2,l)},g.aH=o0,g.aI=Tt,g.aJ=ar,g.aK=gf,g.aL=function(l,t,s){return l[0]=t[0]*s,l[1]=t[1]*s,l[2]=t[2]*s,l},g.aM=function(l,t,s){return l[0]=t[0]+s[0],l[1]=t[1]+s[1],l[2]=t[2]+s[2],l},g.aN=function(l){var t=new Ne(3);return t[0]=l[0],t[1]=l[1],t[2]=l[2],t},g.aO=function(l,t,s){return l[0]=t[0]*s[0],l[1]=t[1]*s[1],l[2]=t[2]*s[2],l[3]=t[3]*s[3],l},g.aP=function(l,t,s){return l[0]=t[0]-s[0],l[1]=t[1]-s[1],l[2]=t[2]-s[2],l},g.aQ=function(l,t){var s=t[0],d=t[1],_=t[2],T=s*s+d*d+_*_;return T>0&&(T=1/Math.sqrt(T)),l[0]=t[0]*T,l[1]=t[1]*T,l[2]=t[2]*T,l},g.aR=function(l,t,s){var d=t[0],_=t[1],T=t[2],E=s[0],C=s[1],R=s[2];return l[0]=_*R-T*C,l[1]=T*E-d*R,l[2]=d*C-_*E,l},g.aS=function(l,t){return l[0]*t[0]+l[1]*t[1]+l[2]*t[2]},g.aT=ng,g.aU=ju,g.aV=function(l,t,s,d,_){var T,E=1/Math.tan(t/2);return l[0]=E/s,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=E,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[11]=-1,l[12]=0,l[13]=0,l[15]=0,_!=null&&_!==1/0?(l[10]=(_+d)*(T=1/(d-_)),l[14]=2*_*d*T):(l[10]=-1,l[14]=-2*d),l},g.aW=function(l){var t=new Ne(16);return t[0]=l[0],t[1]=l[1],t[2]=l[2],t[3]=l[3],t[4]=l[4],t[5]=l[5],t[6]=l[6],t[7]=l[7],t[8]=l[8],t[9]=l[9],t[10]=l[10],t[11]=l[11],t[12]=l[12],t[13]=l[13],t[14]=l[14],t[15]=l[15],t},g.aX=function(l,t,s){var d=Math.sin(s),_=Math.cos(s),T=t[0],E=t[1],C=t[2],R=t[3],B=t[4],U=t[5],G=t[6],q=t[7];return t!==l&&(l[8]=t[8],l[9]=t[9],l[10]=t[10],l[11]=t[11],l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15]),l[0]=T*_+B*d,l[1]=E*_+U*d,l[2]=C*_+G*d,l[3]=R*_+q*d,l[4]=B*_-T*d,l[5]=U*_-E*d,l[6]=G*_-C*d,l[7]=q*_-R*d,l},g.aY=function(l,t,s){var d=Math.sin(s),_=Math.cos(s),T=t[4],E=t[5],C=t[6],R=t[7],B=t[8],U=t[9],G=t[10],q=t[11];return t!==l&&(l[0]=t[0],l[1]=t[1],l[2]=t[2],l[3]=t[3],l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15]),l[4]=T*_+B*d,l[5]=E*_+U*d,l[6]=C*_+G*d,l[7]=R*_+q*d,l[8]=B*_-T*d,l[9]=U*_-E*d,l[10]=G*_-C*d,l[11]=q*_-R*d,l},g.aZ=function(){const l=new Float32Array(16);return ye(l),l},g.a_=function(){const l=new Float64Array(16);return ye(l),l},g.aa=function(l){return l*Math.PI/180},g.ab=Lt,g.ac=function(l,t){const s=[];for(const d in l)d in t||s.push(d);return s},g.ad=Dt,g.ae=function(l){return Math.hypot(l[0],l[1])},g.af=function(l){return l[0]=0,l[1]=0,l},g.ag=function(l,t,s){return l[0]=t[0]*s,l[1]=t[1]*s,l},g.ah=function(l,t){let s=0,d=0;if(l.kind==="constant")d=l.layoutSize;else if(l.kind!=="source"){const{interpolationType:_,minZoom:T,maxZoom:E}=l,C=_?Lt(ui.interpolationFactor(_,t,T,E),0,1):0;l.kind==="camera"?d=es.number(l.minSize,l.maxSize,C):s=C}return{uSizeT:s,uSize:d}},g.aj=function(l,{uSize:t,uSizeT:s},{lowerSize:d,upperSize:_}){return l.kind==="source"?d/cl:l.kind==="composite"?es.number(d/cl,_/cl,s):t},g.ak=Ey,g.al=Ot,g.am=function(l,t,s,d){const _=t.y-l.y,T=t.x-l.x,E=d.y-s.y,C=d.x-s.x,R=E*T-C*_;if(R===0)return null;const B=(C*(l.y-s.y)-E*(l.x-s.x))/R;return new $(l.x+B*T,l.y+B*_)},g.an=function(l,t){var s=t[0],d=t[1],_=t[2],T=t[3],E=t[4],C=t[5],R=t[6],B=t[7],U=t[8],G=t[9],q=t[10],W=t[11],K=t[12],ne=t[13],ue=t[14],_e=t[15],Le=s*C-d*E,we=s*R-_*E,X=s*B-T*E,ce=d*R-_*C,Ee=d*B-T*C,qe=_*B-T*R,yt=U*ne-G*K,et=U*ue-q*K,rt=U*_e-W*K,Et=G*ue-q*ne,_t=G*_e-W*ne,St=q*_e-W*ue,lt=Le*St-we*_t+X*Et+ce*rt-Ee*et+qe*yt;return lt?(l[0]=(C*St-R*_t+B*Et)*(lt=1/lt),l[1]=(_*_t-d*St-T*Et)*lt,l[2]=(ne*qe-ue*Ee+_e*ce)*lt,l[3]=(q*Ee-G*qe-W*ce)*lt,l[4]=(R*rt-E*St-B*et)*lt,l[5]=(s*St-_*rt+T*et)*lt,l[6]=(ue*X-K*qe-_e*we)*lt,l[7]=(U*qe-q*X+W*we)*lt,l[8]=(E*_t-C*rt+B*yt)*lt,l[9]=(d*rt-s*_t-T*yt)*lt,l[10]=(K*Ee-ne*X+_e*Le)*lt,l[11]=(G*X-U*Ee-W*Le)*lt,l[12]=(C*et-E*Et-R*yt)*lt,l[13]=(s*Et-d*et+_*yt)*lt,l[14]=(ne*we-K*ce-ue*Le)*lt,l[15]=(U*ce-G*we+q*Le)*lt,l):null},g.ao=s0,g.ap=Rc,g.aq=ye,g.ar=function(l){let t=1/0,s=1/0,d=-1/0,_=-1/0;for(const T of l)t=Math.min(t,T.x),s=Math.min(s,T.y),d=Math.max(d,T.x),_=Math.max(_,T.y);return[t,s,d,_]},g.as=er,g.at=dt,g.au=function(l,t,s,d,_=!1){if(!s[0]&&!s[1])return[0,0];const T=_?d==="map"?-l.bearingInRadians:0:d==="viewport"?l.bearingInRadians:0;if(T){const E=Math.sin(T),C=Math.cos(T);s=[s[0]*C-s[1]*E,s[0]*E+s[1]*C]}return[_?s[0]:dt(t,s[0],l.zoom),_?s[1]:dt(t,s[1],l.zoom)]},g.aw=Lu,g.ax=fs,g.ay=Km,g.az=ul,g.b=Jn,g.b$=l=>l.type==="line",g.b0=function(l,t,s){const d=new Float64Array(4);return function(_,T,E,C){var R=.5*Math.PI/180;T*=R,E*=R,C*=R;var B=Math.sin(T),U=Math.cos(T),G=Math.sin(E),q=Math.cos(E),W=Math.sin(C),K=Math.cos(C);_[0]=B*q*K-U*G*W,_[1]=U*G*K+B*q*W,_[2]=U*q*W-B*G*K,_[3]=U*q*K+B*G*W}(d,l,t-90,s),d},g.b1=function(l,t,s,d){var _,T,E,C,R,B=t[0],U=t[1],G=t[2],q=t[3],W=s[0],K=s[1],ne=s[2],ue=s[3];return(T=B*W+U*K+G*ne+q*ue)<0&&(T=-T,W=-W,K=-K,ne=-ne,ue=-ue),1-T>De?(_=Math.acos(T),E=Math.sin(_),C=Math.sin((1-d)*_)/E,R=Math.sin(d*_)/E):(C=1-d,R=d),l[0]=C*B+R*W,l[1]=C*U+R*K,l[2]=C*G+R*ne,l[3]=C*q+R*ue,l},g.b2=function(l){const t=new Float64Array(9);var s,d,_,T,E,C,R,B,U,G,q,W,K,ne,ue,_e,Le,we;G=(_=(d=l)[0])*(R=_+_),q=(T=d[1])*R,K=(E=d[2])*R,ne=E*(B=T+T),_e=(C=d[3])*R,Le=C*B,we=C*(U=E+E),(s=t)[0]=1-(W=T*B)-(ue=E*U),s[3]=q-we,s[6]=K+Le,s[1]=q+we,s[4]=1-G-ue,s[7]=ne-_e,s[2]=K-Le,s[5]=ne+_e,s[8]=1-G-W;const X=ar(-Math.asin(Lt(t[2],-1,1)));let ce,Ee;return Math.hypot(t[5],t[8])<.001?(ce=0,Ee=-ar(Math.atan2(t[3],t[4]))):(ce=ar(t[5]===0&&t[8]===0?0:Math.atan2(t[5],t[8])),Ee=ar(t[1]===0&&t[0]===0?0:Math.atan2(t[1],t[0]))),{roll:ce,pitch:X+90,bearing:Ee}},g.b3=function(l,t){return l.roll==t.roll&&l.pitch==t.pitch&&l.bearing==t.bearing},g.b4=Dn,g.b5=Rs,g.b6=Bh,g.b7=yr,g.b8=Jd,g.b9=Ut,g.bA=Sn,g.bB=dn,g.bC=class extends Ia{constructor(l,t){super(l,t),this.current=0}set(l){this.current!==l&&(this.current=l,this.gl.uniform1i(this.location,l))}},g.bD=class extends Ia{constructor(l,t){super(l,t),this.current=sl}set(l){if(l[12]!==this.current[12]||l[0]!==this.current[0])return this.current=l,void this.gl.uniformMatrix4fv(this.location,!1,l);for(let t=1;t<16;t++)if(l[t]!==this.current[t]){this.current=l,this.gl.uniformMatrix4fv(this.location,!1,l);break}}},g.bE=Eu,g.bF=cs,g.bG=class extends Ia{constructor(l,t){super(l,t),this.current=[0,0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]&&l[2]===this.current[2]||(this.current=l,this.gl.uniform3f(this.location,l[0],l[1],l[2]))}},g.bH=class extends Ia{constructor(l,t){super(l,t),this.current=[0,0]}set(l){l[0]===this.current[0]&&l[1]===this.current[1]||(this.current=l,this.gl.uniform2f(this.location,l[0],l[1]))}},g.bI=je,g.bJ=function(l,t){var s=Math.sin(t),d=Math.cos(t);return l[0]=d,l[1]=s,l[2]=0,l[3]=-s,l[4]=d,l[5]=0,l[6]=0,l[7]=0,l[8]=1,l},g.bK=function(l,t,s){var d=t[0],_=t[1],T=t[2];return l[0]=d*s[0]+_*s[3]+T*s[6],l[1]=d*s[1]+_*s[4]+T*s[7],l[2]=d*s[2]+_*s[5]+T*s[8],l},g.bL=function(l,t,s,d,_,T,E){var C=1/(t-s),R=1/(d-_),B=1/(T-E);return l[0]=-2*C,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=-2*R,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=2*B,l[11]=0,l[12]=(t+s)*C,l[13]=(_+d)*R,l[14]=(E+T)*B,l[15]=1,l},g.bM=class extends Yd{},g.bN=Fc,g.bO=class extends ol{},g.bP=Pc,g.bQ=function(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))},g.bR=_p,g.bS=function(l,t,s){var d=t[0],_=t[1],T=t[2],E=s[3]*d+s[7]*_+s[11]*T+s[15];return l[0]=(s[0]*d+s[4]*_+s[8]*T+s[12])/(E=E||1),l[1]=(s[1]*d+s[5]*_+s[9]*T+s[13])/E,l[2]=(s[2]*d+s[6]*_+s[10]*T+s[14])/E,l},g.bT=class extends wu{},g.bU=class extends o{},g.bV=function(l,t){return l[0]===t[0]&&l[1]===t[1]&&l[2]===t[2]&&l[3]===t[3]&&l[4]===t[4]&&l[5]===t[5]&&l[6]===t[6]&&l[7]===t[7]&&l[8]===t[8]&&l[9]===t[9]&&l[10]===t[10]&&l[11]===t[11]&&l[12]===t[12]&&l[13]===t[13]&&l[14]===t[14]&&l[15]===t[15]},g.bW=function(l,t){var s=l[0],d=l[1],_=l[2],T=l[3],E=l[4],C=l[5],R=l[6],B=l[7],U=l[8],G=l[9],q=l[10],W=l[11],K=l[12],ne=l[13],ue=l[14],_e=l[15],Le=t[0],we=t[1],X=t[2],ce=t[3],Ee=t[4],qe=t[5],yt=t[6],et=t[7],rt=t[8],Et=t[9],_t=t[10],St=t[11],lt=t[12],Zt=t[13],on=t[14],an=t[15];return Math.abs(s-Le)<=De*Math.max(1,Math.abs(s),Math.abs(Le))&&Math.abs(d-we)<=De*Math.max(1,Math.abs(d),Math.abs(we))&&Math.abs(_-X)<=De*Math.max(1,Math.abs(_),Math.abs(X))&&Math.abs(T-ce)<=De*Math.max(1,Math.abs(T),Math.abs(ce))&&Math.abs(E-Ee)<=De*Math.max(1,Math.abs(E),Math.abs(Ee))&&Math.abs(C-qe)<=De*Math.max(1,Math.abs(C),Math.abs(qe))&&Math.abs(R-yt)<=De*Math.max(1,Math.abs(R),Math.abs(yt))&&Math.abs(B-et)<=De*Math.max(1,Math.abs(B),Math.abs(et))&&Math.abs(U-rt)<=De*Math.max(1,Math.abs(U),Math.abs(rt))&&Math.abs(G-Et)<=De*Math.max(1,Math.abs(G),Math.abs(Et))&&Math.abs(q-_t)<=De*Math.max(1,Math.abs(q),Math.abs(_t))&&Math.abs(W-St)<=De*Math.max(1,Math.abs(W),Math.abs(St))&&Math.abs(K-lt)<=De*Math.max(1,Math.abs(K),Math.abs(lt))&&Math.abs(ne-Zt)<=De*Math.max(1,Math.abs(ne),Math.abs(Zt))&&Math.abs(ue-on)<=De*Math.max(1,Math.abs(ue),Math.abs(on))&&Math.abs(_e-an)<=De*Math.max(1,Math.abs(_e),Math.abs(an))},g.bX=function(l,t){return l[0]=t[0],l[1]=t[1],l[2]=t[2],l[3]=t[3],l[4]=t[4],l[5]=t[5],l[6]=t[6],l[7]=t[7],l[8]=t[8],l[9]=t[9],l[10]=t[10],l[11]=t[11],l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15],l},g.bY=l=>l.type==="symbol",g.bZ=l=>l.type==="circle",g.b_=l=>l.type==="heatmap",g.ba=Ie,g.bb=da,g.bc=function(l,t,s,d,_){return Ut(d,_,Lt((l-t)/(s-t),0,1))},g.bd=ot,g.be=function(){return new Float64Array(4)},g.bf=function(){return new Float64Array(3)},g.bg=function(l,t,s,d){var _=[],T=[];return _[0]=t[0]-s[0],_[1]=t[1]-s[1],_[2]=t[2]-s[2],T[0]=_[0]*Math.cos(d)-_[1]*Math.sin(d),T[1]=_[0]*Math.sin(d)+_[1]*Math.cos(d),T[2]=_[2],l[0]=T[0]+s[0],l[1]=T[1]+s[1],l[2]=T[2]+s[2],l},g.bh=function(l,t,s,d){var _=[],T=[];return _[0]=t[0]-s[0],_[1]=t[1]-s[1],_[2]=t[2]-s[2],T[0]=_[0],T[1]=_[1]*Math.cos(d)-_[2]*Math.sin(d),T[2]=_[1]*Math.sin(d)+_[2]*Math.cos(d),l[0]=T[0]+s[0],l[1]=T[1]+s[1],l[2]=T[2]+s[2],l},g.bi=function(l,t,s,d){var _=[],T=[];return _[0]=t[0]-s[0],_[1]=t[1]-s[1],_[2]=t[2]-s[2],T[0]=_[2]*Math.sin(d)+_[0]*Math.cos(d),T[1]=_[1],T[2]=_[2]*Math.cos(d)-_[0]*Math.sin(d),l[0]=T[0]+s[0],l[1]=T[1]+s[1],l[2]=T[2]+s[2],l},g.bj=function(l,t,s){var d=Math.sin(s),_=Math.cos(s),T=t[0],E=t[1],C=t[2],R=t[3],B=t[8],U=t[9],G=t[10],q=t[11];return t!==l&&(l[4]=t[4],l[5]=t[5],l[6]=t[6],l[7]=t[7],l[12]=t[12],l[13]=t[13],l[14]=t[14],l[15]=t[15]),l[0]=T*_-B*d,l[1]=E*_-U*d,l[2]=C*_-G*d,l[3]=R*_-q*d,l[8]=T*d+B*_,l[9]=E*d+U*_,l[10]=C*d+G*_,l[11]=R*d+q*_,l},g.bk=function(l,t){const s=ot(l,360),d=ot(t,360),_=d-s,T=d>s?_-360:_+360;return Math.abs(_)<Math.abs(T)?_:T},g.bl=function(l){return l[0]=0,l[1]=0,l[2]=0,l},g.bm=function(l,t,s,d){const _=Math.sqrt(l*l+t*t),T=Math.sqrt(s*s+d*d);l/=_,t/=_,s/=T,d/=T;const E=Math.acos(l*s+t*d);return-t*s+l*d>0?E:-E},g.bn=function(l,t){return l[0]*t[0]+l[1]*t[1]+l[2]*t[2]+l[3]},g.bo=Bp,g.bp=function(l,t){const s=ot(l,2*Math.PI),d=ot(t,2*Math.PI);return Math.min(Math.abs(s-d),Math.abs(s-d+2*Math.PI),Math.abs(s-d-2*Math.PI))},g.bq=function(l){return Math.hypot(l[0],l[1],l[2])},g.br=function(){const l={},t=de.$version;for(const s in de.$root){const d=de.$root[s];if(d.required){let _=null;_=s==="version"?t:d.type==="array"?[]:{},_!=null&&(l[s]=_)}}return l},g.bs=Im,g.bt=Qo,g.bu=function(l){l=l.slice();const t=Object.create(null);for(let s=0;s<l.length;s++)t[l[s].id]=l[s];for(let s=0;s<l.length;s++)"ref"in l[s]&&(l[s]=re(l[s],t[l[s].ref]));return l},g.bv=function(l){if(l.type==="custom")return new r0(l);switch(l.type){case"background":return new Lp(l);case"circle":return new Dv(l);case"fill":return new Z_(l);case"fill-extrusion":return new $_(l);case"heatmap":return new Za(l);case"hillshade":return new Cu(l);case"line":return new si(l);case"raster":return new i0(l);case"symbol":return new mf(l)}},g.bw=An,g.bx=function(l,t){if(!l)return[{command:"setStyle",args:[t]}];let s=[];try{if(!oe(l.version,t.version))return[{command:"setStyle",args:[t]}];oe(l.center,t.center)||s.push({command:"setCenter",args:[t.center]}),oe(l.centerAltitude,t.centerAltitude)||s.push({command:"setCenterAltitude",args:[t.centerAltitude]}),oe(l.zoom,t.zoom)||s.push({command:"setZoom",args:[t.zoom]}),oe(l.bearing,t.bearing)||s.push({command:"setBearing",args:[t.bearing]}),oe(l.pitch,t.pitch)||s.push({command:"setPitch",args:[t.pitch]}),oe(l.roll,t.roll)||s.push({command:"setRoll",args:[t.roll]}),oe(l.sprite,t.sprite)||s.push({command:"setSprite",args:[t.sprite]}),oe(l.glyphs,t.glyphs)||s.push({command:"setGlyphs",args:[t.glyphs]}),oe(l.transition,t.transition)||s.push({command:"setTransition",args:[t.transition]}),oe(l.light,t.light)||s.push({command:"setLight",args:[t.light]}),oe(l.terrain,t.terrain)||s.push({command:"setTerrain",args:[t.terrain]}),oe(l.sky,t.sky)||s.push({command:"setSky",args:[t.sky]}),oe(l.projection,t.projection)||s.push({command:"setProjection",args:[t.projection]});const d={},_=[];(function(E,C,R,B){let U;for(U in C=C||{},E=E||{})Object.prototype.hasOwnProperty.call(E,U)&&(Object.prototype.hasOwnProperty.call(C,U)||Ve(U,R,B));for(U in C)Object.prototype.hasOwnProperty.call(C,U)&&(Object.prototype.hasOwnProperty.call(E,U)?oe(E[U],C[U])||(E[U].type==="geojson"&&C[U].type==="geojson"&&Fe(E,C,U)?xe(R,{command:"setGeoJSONSourceData",args:[U,C[U].data]}):We(U,C,R,B)):ze(U,C,R))})(l.sources,t.sources,_,d);const T=[];l.layers&&l.layers.forEach(E=>{"source"in E&&d[E.source]?s.push({command:"removeLayer",args:[E.id]}):T.push(E)}),s=s.concat(_),function(E,C,R){C=C||[];const B=(E=E||[]).map(tt),U=C.map(tt),G=E.reduce($e,{}),q=C.reduce($e,{}),W=B.slice(),K=Object.create(null);let ne,ue,_e,Le,we;for(let X=0,ce=0;X<B.length;X++)ne=B[X],Object.prototype.hasOwnProperty.call(q,ne)?ce++:(xe(R,{command:"removeLayer",args:[ne]}),W.splice(W.indexOf(ne,ce),1));for(let X=0,ce=0;X<U.length;X++)ne=U[U.length-1-X],W[W.length-1-X]!==ne&&(Object.prototype.hasOwnProperty.call(G,ne)?(xe(R,{command:"removeLayer",args:[ne]}),W.splice(W.lastIndexOf(ne,W.length-ce),1)):ce++,Le=W[W.length-X],xe(R,{command:"addLayer",args:[q[ne],Le]}),W.splice(W.length-X,0,ne),K[ne]=!0);for(let X=0;X<U.length;X++)if(ne=U[X],ue=G[ne],_e=q[ne],!K[ne]&&!oe(ue,_e))if(oe(ue.source,_e.source)&&oe(ue["source-layer"],_e["source-layer"])&&oe(ue.type,_e.type)){for(we in at(ue.layout,_e.layout,R,ne,null,"setLayoutProperty"),at(ue.paint,_e.paint,R,ne,null,"setPaintProperty"),oe(ue.filter,_e.filter)||xe(R,{command:"setFilter",args:[ne,_e.filter]}),oe(ue.minzoom,_e.minzoom)&&oe(ue.maxzoom,_e.maxzoom)||xe(R,{command:"setLayerZoomRange",args:[ne,_e.minzoom,_e.maxzoom]}),ue)Object.prototype.hasOwnProperty.call(ue,we)&&we!=="layout"&&we!=="paint"&&we!=="filter"&&we!=="metadata"&&we!=="minzoom"&&we!=="maxzoom"&&(we.indexOf("paint.")===0?at(ue[we],_e[we],R,ne,we.slice(6),"setPaintProperty"):oe(ue[we],_e[we])||xe(R,{command:"setLayerProperty",args:[ne,we,_e[we]]}));for(we in _e)Object.prototype.hasOwnProperty.call(_e,we)&&!Object.prototype.hasOwnProperty.call(ue,we)&&we!=="layout"&&we!=="paint"&&we!=="filter"&&we!=="metadata"&&we!=="minzoom"&&we!=="maxzoom"&&(we.indexOf("paint.")===0?at(ue[we],_e[we],R,ne,we.slice(6),"setPaintProperty"):oe(ue[we],_e[we])||xe(R,{command:"setLayerProperty",args:[ne,we,_e[we]]}))}else xe(R,{command:"removeLayer",args:[ne]}),Le=W[W.lastIndexOf(ne)+1],xe(R,{command:"addLayer",args:[_e,Le]})}(T,t.layers,s)}catch(d){console.warn("Unable to compute style diff:",d),s=[{command:"setStyle",args:[t]}]}return s},g.by=function(l){const t=[],s=l.id;return s===void 0&&t.push({message:`layers.${s}: missing required property "id"`}),l.render===void 0&&t.push({message:`layers.${s}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&t.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),t},g.bz=function l(t,s){if(Array.isArray(t)){if(!Array.isArray(s)||t.length!==s.length)return!1;for(let d=0;d<t.length;d++)if(!l(t[d],s[d]))return!1;return!0}if(typeof t=="object"&&t!==null&&s!==null){if(typeof s!="object"||Object.keys(t).length!==Object.keys(s).length)return!1;for(const d in t)if(!l(t[d],s[d]))return!1;return!0}return t===s},g.c=xs,g.c0=l=>l.type==="fill",g.c1=l=>l.type==="fill-extrusion",g.c2=l=>l.type==="hillshade",g.c3=l=>l.type==="raster",g.c4=l=>l.type==="background",g.c5=l=>l.type==="custom",g.c6=ut,g.c7=function(l,t,s){const d=vt(t.x-s.x,t.y-s.y),_=vt(l.x-s.x,l.y-s.y);var T,E;return ar(Math.atan2(d[0]*_[1]-d[1]*_[0],(T=d)[0]*(E=_)[0]+T[1]*E[1]))},g.c8=Bt,g.c9=function(l,t,s){var d=t[0],_=t[1];return l[0]=s[0]*d+s[4]*_+s[12],l[1]=s[1]*d+s[5]*_+s[13],l},g.cA=Hm,g.cB=xh,g.cC=os,g.ca=function(l,t){const{x:s,y:d}=jp.fromLngLat(t);return!(l<0||l>25||d<0||d>=1||s<0||s>=1)},g.cb=function(l,t){return l[0]=t[0],l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=t[1],l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=t[2],l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,l},g.cc=class extends Qi{},g.cd=g0,g.cf=function(l){return l.message===ja},g.cg=to,g.ch=function(l,t){Wo.REGISTERED_PROTOCOLS[l]=t},g.ci=function(l){delete Wo.REGISTERED_PROTOCOLS[l]},g.cj=function(l,t){const s={};for(let _=0;_<l.length;_++){const T=t&&t[l[_].id]||wh(l[_]);t&&(t[l[_].id]=T);let E=s[T];E||(E=s[T]=[]),E.push(l[_])}const d=[];for(const _ in s)d.push(s[_]);return d},g.ck=Ft,g.cl=ig,g.cm=Fp,g.cn=cf,g.co=function(l){l.bucket.createArrays(),l.bucket.tilePixelRatio=Ge/(512*l.bucket.overscaling),l.bucket.compareText={},l.bucket.iconsNeedLinear=!1;const t=l.bucket.layers[0],s=t.layout,d=t._unevaluatedLayout._values,_={layoutIconSize:d["icon-size"].possiblyEvaluate(new Mi(l.bucket.zoom+1),l.canonical),layoutTextSize:d["text-size"].possiblyEvaluate(new Mi(l.bucket.zoom+1),l.canonical),textMaxSize:d["text-size"].possiblyEvaluate(new Mi(18))};if(l.bucket.textSizeData.kind==="composite"){const{minZoom:B,maxZoom:U}=l.bucket.textSizeData;_.compositeTextSizes=[d["text-size"].possiblyEvaluate(new Mi(B),l.canonical),d["text-size"].possiblyEvaluate(new Mi(U),l.canonical)]}if(l.bucket.iconSizeData.kind==="composite"){const{minZoom:B,maxZoom:U}=l.bucket.iconSizeData;_.compositeIconSizes=[d["icon-size"].possiblyEvaluate(new Mi(B),l.canonical),d["icon-size"].possiblyEvaluate(new Mi(U),l.canonical)]}const T=s.get("text-line-height")*er,E=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",C=s.get("text-keep-upright"),R=s.get("text-size");for(const B of l.bucket.features){const U=s.get("text-font").evaluate(B,{},l.canonical).join(","),G=R.evaluate(B,{},l.canonical),q=_.layoutTextSize.evaluate(B,{},l.canonical),W=_.layoutIconSize.evaluate(B,{},l.canonical),K={horizontal:{},vertical:void 0},ne=B.text;let ue,_e=[0,0];if(ne){const X=ne.toString(),ce=s.get("text-letter-spacing").evaluate(B,{},l.canonical)*er,Ee=Ud(X)?ce:0,qe=s.get("text-anchor").evaluate(B,{},l.canonical),yt=h0(t,B,l.canonical);if(!yt){const _t=s.get("text-radial-offset").evaluate(B,{},l.canonical);_e=_t?u0(qe,[_t*er,Zp]):s.get("text-offset").evaluate(B,{},l.canonical).map(St=>St*er)}let et=E?"center":s.get("text-justify").evaluate(B,{},l.canonical);const rt=s.get("symbol-placement")==="point"?s.get("text-max-width").evaluate(B,{},l.canonical)*er:1/0,Et=()=>{l.bucket.allowVerticalPlacement&&Xi(X)&&(K.vertical=kp(ne,l.glyphMap,l.glyphPositions,l.imagePositions,U,rt,T,qe,"left",Ee,_e,g.ai.vertical,!0,q,G))};if(!E&&yt){const _t=new Set;if(et==="auto")for(let lt=0;lt<yt.values.length;lt+=2)_t.add(fs(yt.values[lt]));else _t.add(et);let St=!1;for(const lt of _t)if(!K.horizontal[lt])if(St)K.horizontal[lt]=K.horizontal[0];else{const Zt=kp(ne,l.glyphMap,l.glyphPositions,l.imagePositions,U,rt,T,"center",lt,Ee,_e,g.ai.horizontal,!1,q,G);Zt&&(K.horizontal[lt]=Zt,St=Zt.positionedLines.length===1)}Et()}else{et==="auto"&&(et=fs(qe));const _t=kp(ne,l.glyphMap,l.glyphPositions,l.imagePositions,U,rt,T,qe,et,Ee,_e,g.ai.horizontal,!1,q,G);_t&&(K.horizontal[et]=_t),Et(),Xi(X)&&E&&C&&(K.vertical=kp(ne,l.glyphMap,l.glyphPositions,l.imagePositions,U,rt,T,qe,et,Ee,_e,g.ai.vertical,!1,q,G))}}let Le=!1;if(B.icon&&B.icon.name){const X=l.imageMap[B.icon.name];X&&(ue=K_(l.imagePositions[B.icon.name],s.get("icon-offset").evaluate(B,{},l.canonical),s.get("icon-anchor").evaluate(B,{},l.canonical)),Le=!!X.sdf,l.bucket.sdfIcons===void 0?l.bucket.sdfIcons=Le:l.bucket.sdfIcons!==Le&&Wn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(X.pixelRatio!==l.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(l.bucket.iconsNeedLinear=!0))}const we=ps(K.horizontal)||K.vertical;l.bucket.iconsInText=!!we&&we.iconsInText,(we||ue)&&d0(l.bucket,B,K,ue,l.imageMap,_,q,W,_e,Le,l.canonical,l.subdivisionGranularity)}l.showCollisionBoxes&&l.bucket.generateCollisionDebugBuffers()},g.cp=Ym,g.cq=Zo,g.cr=$o,g.cs=af,g.ct=Dp,g.cu=class{constructor(l){this._marks={start:[l.url,"start"].join("#"),end:[l.url,"end"].join("#"),measure:l.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let l=performance.getEntriesByName(this._marks.measure);return l.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),l=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),l}},g.cv=function(l,t,s,d,_){return c(this,void 0,void 0,function*(){if(Me())try{return yield kr(l,t,s,d,_)}catch{}return function(T,E,C,R,B){const U=T.width,G=T.height;eo&&Co||(eo=new OffscreenCanvas(U,G),Co=eo.getContext("2d",{willReadFrequently:!0})),eo.width=U,eo.height=G,Co.drawImage(T,0,0,U,G);const q=Co.getImageData(E,C,R,B);return Co.clearRect(0,0,U,G),q.data}(l,t,s,d,_)})},g.cw=Iy,g.cx=A,g.cy=L,g.cz=rf,g.d=l=>c(void 0,void 0,void 0,function*(){if(l.byteLength===0)return createImageBitmap(new ImageData(1,1));const t=new Blob([new Uint8Array(l)],{type:"image/png"});try{return createImageBitmap(t)}catch(s){throw new Error(`Could not load image because of ${s.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`)}}),g.e=jt,g.f=l=>new Promise((t,s)=>{const d=new Image;d.onload=()=>{t(d),URL.revokeObjectURL(d.src),d.onload=null,window.requestAnimationFrame(()=>{d.src=Xr})},d.onerror=()=>s(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const _=new Blob([new Uint8Array(l)],{type:"image/png"});d.src=l.byteLength?URL.createObjectURL(_):Xr}),g.g=Wr,g.h=(l,t)=>Ea(jt(l,{type:"json"}),t),g.i=Ni,g.j=Zs,g.k=nu,g.l=(l,t)=>Ea(jt(l,{type:"arrayBuffer"}),t),g.m=Ea,g.n=function(l){return new Dp(l).readFields(Xm,[])},g.o=Ph,g.p=lf,g.q=_a,g.r=jd,g.s=ac,g.t=lo,g.u=as,g.v=de,g.w=Wn,g.x=function([l,t,s]){return t+=90,t*=Math.PI/180,s*=Math.PI/180,{x:l*Math.cos(t)*Math.sin(s),y:l*Math.sin(t)*Math.sin(s),z:l*Math.cos(s)}},g.y=es,g.z=Mi}),p("worker",["./shared"],function(g){class c{constructor(te){this.keyCache={},te&&this.replace(te)}replace(te){this._layerConfigs={},this._layers={},this.update(te,[])}update(te,re){for(const xe of te){this._layerConfigs[xe.id]=xe;const ze=this._layers[xe.id]=g.bv(xe);ze._featureFilter=g.a4(ze.filter),this.keyCache[xe.id]&&delete this.keyCache[xe.id]}for(const xe of re)delete this.keyCache[xe],delete this._layerConfigs[xe],delete this._layers[xe];this.familiesBySource={};const oe=g.cj(Object.values(this._layerConfigs),this.keyCache);for(const xe of oe){const ze=xe.map($e=>this._layers[$e.id]),Ve=ze[0];if(Ve.visibility==="none")continue;const We=Ve.source||"";let Fe=this.familiesBySource[We];Fe||(Fe=this.familiesBySource[We]={});const at=Ve.sourceLayer||"_geojsonTileLayer";let tt=Fe[at];tt||(tt=Fe[at]=[]),tt.push(ze)}}}class A{constructor(te){const re={},oe=[];for(const We in te){const Fe=te[We],at=re[We]={};for(const tt in Fe){const $e=Fe[+tt];if(!$e||$e.bitmap.width===0||$e.bitmap.height===0)continue;const Be={x:0,y:0,w:$e.bitmap.width+2,h:$e.bitmap.height+2};oe.push(Be),at[tt]={rect:Be,metrics:$e.metrics}}}const{w:xe,h:ze}=g.p(oe),Ve=new g.o({width:xe||1,height:ze||1});for(const We in te){const Fe=te[We];for(const at in Fe){const tt=Fe[+at];if(!tt||tt.bitmap.width===0||tt.bitmap.height===0)continue;const $e=re[We][at].rect;g.o.copy(tt.bitmap,Ve,{x:0,y:0},{x:$e.x+1,y:$e.y+1},tt.bitmap)}}this.image=Ve,this.positions=re}}g.ck("GlyphAtlas",A);class D{constructor(te){this.tileID=new g.S(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.uid=te.uid,this.zoom=te.zoom,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.collectResourceTiming,this.returnDependencies=!!te.returnDependencies,this.promoteId=te.promoteId,this.inFlightDependencies=[]}parse(te,re,oe,xe,ze){return g._(this,void 0,void 0,function*(){this.status="parsing",this.data=te,this.collisionBoxArray=new g.a2;const Ve=new g.cl(Object.keys(te.layers).sort()),We=new g.cm(this.tileID,this.promoteId);We.bucketLayerIDs=[];const Fe={},at={featureIndex:We,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:oe,subdivisionGranularity:ze},tt=re.familiesBySource[this.source];for(const en in tt){const Nt=te.layers[en];if(!Nt)continue;Nt.version===1&&g.w(`Vector tile source "${this.source}" layer "${en}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const $n=Ve.encode(en),no=[];for(let Ar=0;Ar<Nt.length;Ar++){const Nr=Nt.feature(Ar),Fi=We.getId(Nr,en);no.push({feature:Nr,id:Fi,index:Ar,sourceLayerIndex:$n})}for(const Ar of tt[en]){const Nr=Ar[0];Nr.source!==this.source&&g.w(`layer.source = ${Nr.source} does not equal this.source = ${this.source}`),Nr.minzoom&&this.zoom<Math.floor(Nr.minzoom)||Nr.maxzoom&&this.zoom>=Nr.maxzoom||Nr.visibility!=="none"&&(N(Ar,this.zoom,oe),(Fe[Nr.id]=Nr.createBucket({index:We.bucketLayerIDs.length,layers:Ar,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:$n,sourceID:this.source})).populate(no,at,this.tileID.canonical),We.bucketLayerIDs.push(Ar.map(Fi=>Fi.id)))}}const $e=g.bA(at.glyphDependencies,en=>Object.keys(en).map(Number));this.inFlightDependencies.forEach(en=>en==null?void 0:en.abort()),this.inFlightDependencies=[];let Be=Promise.resolve({});if(Object.keys($e).length){const en=new AbortController;this.inFlightDependencies.push(en),Be=xe.sendAsync({type:"GG",data:{stacks:$e,source:this.source,tileID:this.tileID,type:"glyphs"}},en)}const Rt=Object.keys(at.iconDependencies);let It=Promise.resolve({});if(Rt.length){const en=new AbortController;this.inFlightDependencies.push(en),It=xe.sendAsync({type:"GI",data:{icons:Rt,source:this.source,tileID:this.tileID,type:"icons"}},en)}const tn=Object.keys(at.patternDependencies);let fn=Promise.resolve({});if(tn.length){const en=new AbortController;this.inFlightDependencies.push(en),fn=xe.sendAsync({type:"GI",data:{icons:tn,source:this.source,tileID:this.tileID,type:"patterns"}},en)}const[ct,Pt,Yt]=yield Promise.all([Be,It,fn]),Cn=new A(ct),Zn=new g.cn(Pt,Yt);for(const en in Fe){const Nt=Fe[en];Nt instanceof g.a3?(N(Nt.layers,this.zoom,oe),g.co({bucket:Nt,glyphMap:ct,glyphPositions:Cn.positions,imageMap:Pt,imagePositions:Zn.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical,subdivisionGranularity:at.subdivisionGranularity})):Nt.hasPattern&&(Nt instanceof g.cp||Nt instanceof g.cq||Nt instanceof g.cr)&&(N(Nt.layers,this.zoom,oe),Nt.addFeatures(at,this.tileID.canonical,Zn.patternPositions))}return this.status="done",{buckets:Object.values(Fe).filter(en=>!en.isEmpty()),featureIndex:We,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Cn.image,imageAtlas:Zn,glyphMap:this.returnDependencies?ct:null,iconMap:this.returnDependencies?Pt:null,glyphPositions:this.returnDependencies?Cn.positions:null}})}}function N(de,te,re){const oe=new g.z(te);for(const xe of de)xe.recalculate(oe,re)}class L{constructor(te,re,oe){this.actor=te,this.layerIndex=re,this.availableImages=oe,this.fetching={},this.loading={},this.loaded={}}loadVectorTile(te,re){return g._(this,void 0,void 0,function*(){const oe=yield g.l(te.request,re);try{return{vectorTile:new g.cs.VectorTile(new g.ct(oe.data)),rawData:oe.data,cacheControl:oe.cacheControl,expires:oe.expires}}catch(xe){const ze=new Uint8Array(oe.data);let Ve=`Unable to parse the tile at ${te.request.url}, `;throw Ve+=ze[0]===31&&ze[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${xe.message}`,new Error(Ve)}})}loadTile(te){return g._(this,void 0,void 0,function*(){const re=te.uid,oe=!!(te&&te.request&&te.request.collectResourceTiming)&&new g.cu(te.request),xe=new D(te);this.loading[re]=xe;const ze=new AbortController;xe.abort=ze;try{const Ve=yield this.loadVectorTile(te,ze);if(delete this.loading[re],!Ve)return null;const We=Ve.rawData,Fe={};Ve.expires&&(Fe.expires=Ve.expires),Ve.cacheControl&&(Fe.cacheControl=Ve.cacheControl);const at={};if(oe){const $e=oe.finish();$e&&(at.resourceTiming=JSON.parse(JSON.stringify($e)))}xe.vectorTile=Ve.vectorTile;const tt=xe.parse(Ve.vectorTile,this.layerIndex,this.availableImages,this.actor,te.subdivisionGranularity);this.loaded[re]=xe,this.fetching[re]={rawTileData:We,cacheControl:Fe,resourceTiming:at};try{const $e=yield tt;return g.e({rawTileData:We.slice(0)},$e,Fe,at)}finally{delete this.fetching[re]}}catch(Ve){throw delete this.loading[re],xe.status="done",this.loaded[re]=xe,Ve}})}reloadTile(te){return g._(this,void 0,void 0,function*(){const re=te.uid;if(!this.loaded||!this.loaded[re])throw new Error("Should not be trying to reload a tile that was never loaded or has been removed");const oe=this.loaded[re];if(oe.showCollisionBoxes=te.showCollisionBoxes,oe.status==="parsing"){const xe=yield oe.parse(oe.vectorTile,this.layerIndex,this.availableImages,this.actor,te.subdivisionGranularity);let ze;if(this.fetching[re]){const{rawTileData:Ve,cacheControl:We,resourceTiming:Fe}=this.fetching[re];delete this.fetching[re],ze=g.e({rawTileData:Ve.slice(0)},xe,We,Fe)}else ze=xe;return ze}if(oe.status==="done"&&oe.vectorTile)return oe.parse(oe.vectorTile,this.layerIndex,this.availableImages,this.actor,te.subdivisionGranularity)})}abortTile(te){return g._(this,void 0,void 0,function*(){const re=this.loading,oe=te.uid;re&&re[oe]&&re[oe].abort&&(re[oe].abort.abort(),delete re[oe])})}removeTile(te){return g._(this,void 0,void 0,function*(){this.loaded&&this.loaded[te.uid]&&delete this.loaded[te.uid]})}}class F{constructor(){this.loaded={}}loadTile(te){return g._(this,void 0,void 0,function*(){const{uid:re,encoding:oe,rawImageData:xe,redFactor:ze,greenFactor:Ve,blueFactor:We,baseShift:Fe}=te,at=xe.width+2,tt=xe.height+2,$e=g.b(xe)?new g.R({width:at,height:tt},yield g.cv(xe,-1,-1,at,tt)):xe,Be=new g.cw(re,$e,oe,ze,Ve,We,Fe);return this.loaded=this.loaded||{},this.loaded[re]=Be,Be})}removeTile(te){const re=this.loaded,oe=te.uid;re&&re[oe]&&delete re[oe]}}var V,$,J=function(){if($)return V;function de(re,oe){if(re.length!==0){te(re[0],oe);for(var xe=1;xe<re.length;xe++)te(re[xe],!oe)}}function te(re,oe){for(var xe=0,ze=0,Ve=0,We=re.length,Fe=We-1;Ve<We;Fe=Ve++){var at=(re[Ve][0]-re[Fe][0])*(re[Fe][1]+re[Ve][1]),tt=xe+at;ze+=Math.abs(xe)>=Math.abs(at)?xe-tt+at:at-tt+xe,xe=tt}xe+ze>=0!=!!oe&&re.reverse()}return $=1,V=function re(oe,xe){var ze,Ve=oe&&oe.type;if(Ve==="FeatureCollection")for(ze=0;ze<oe.features.length;ze++)re(oe.features[ze],xe);else if(Ve==="GeometryCollection")for(ze=0;ze<oe.geometries.length;ze++)re(oe.geometries[ze],xe);else if(Ve==="Feature")re(oe.geometry,xe);else if(Ve==="Polygon")de(oe.coordinates,xe);else if(Ve==="MultiPolygon")for(ze=0;ze<oe.coordinates.length;ze++)de(oe.coordinates[ze],xe);return oe}}(),ae=g.cx(J);const fe=g.cs.VectorTileFeature.prototype.toGeoJSON;class ve{constructor(te){this._feature=te,this.extent=g.X,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))}loadGeometry(){if(this._feature.type===1){const te=[];for(const re of this._feature.geometry)te.push([new g.P(re[0],re[1])]);return te}{const te=[];for(const re of this._feature.geometry){const oe=[];for(const xe of re)oe.push(new g.P(xe[0],xe[1]));te.push(oe)}return te}}toGeoJSON(te,re,oe){return fe.call(this,te,re,oe)}}class Ce{constructor(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=g.X,this.length=te.length,this._features=te}feature(te){return new ve(this._features[te])}}var Me,Te,De,Ne={exports:{}},je=function(){if(De)return Ne.exports;De=1;var de=g.cA(),te=function(){if(Te)return Me;Te=1;var tt=g.cy(),$e=g.cz().VectorTileFeature;function Be(It,tn){this.options=tn||{},this.features=It,this.length=It.length}function Rt(It,tn){this.id=typeof It.id=="number"?It.id:void 0,this.type=It.type,this.rawGeometry=It.type===1?[It.geometry]:It.geometry,this.properties=It.tags,this.extent=tn||4096}return Me=Be,Be.prototype.feature=function(It){return new Rt(this.features[It],this.options.extent)},Rt.prototype.loadGeometry=function(){var It=this.rawGeometry;this.geometry=[];for(var tn=0;tn<It.length;tn++){for(var fn=It[tn],ct=[],Pt=0;Pt<fn.length;Pt++)ct.push(new tt(fn[Pt][0],fn[Pt][1]));this.geometry.push(ct)}return this.geometry},Rt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var It=this.geometry,tn=1/0,fn=-1/0,ct=1/0,Pt=-1/0,Yt=0;Yt<It.length;Yt++)for(var Cn=It[Yt],Zn=0;Zn<Cn.length;Zn++){var en=Cn[Zn];tn=Math.min(tn,en.x),fn=Math.max(fn,en.x),ct=Math.min(ct,en.y),Pt=Math.max(Pt,en.y)}return[tn,ct,fn,Pt]},Rt.prototype.toGeoJSON=$e.prototype.toGeoJSON,Me}();function re(tt){var $e=new de;return function(Be,Rt){for(var It in Be.layers)Rt.writeMessage(3,oe,Be.layers[It])}(tt,$e),$e.finish()}function oe(tt,$e){var Be;$e.writeVarintField(15,tt.version||1),$e.writeStringField(1,tt.name||""),$e.writeVarintField(5,tt.extent||4096);var Rt={keys:[],values:[],keycache:{},valuecache:{}};for(Be=0;Be<tt.length;Be++)Rt.feature=tt.feature(Be),$e.writeMessage(2,xe,Rt);var It=Rt.keys;for(Be=0;Be<It.length;Be++)$e.writeStringField(3,It[Be]);var tn=Rt.values;for(Be=0;Be<tn.length;Be++)$e.writeMessage(4,at,tn[Be])}function xe(tt,$e){var Be=tt.feature;Be.id!==void 0&&$e.writeVarintField(1,Be.id),$e.writeMessage(2,ze,tt),$e.writeVarintField(3,Be.type),$e.writeMessage(4,Fe,Be)}function ze(tt,$e){var Be=tt.feature,Rt=tt.keys,It=tt.values,tn=tt.keycache,fn=tt.valuecache;for(var ct in Be.properties){var Pt=Be.properties[ct],Yt=tn[ct];if(Pt!==null){Yt===void 0&&(Rt.push(ct),tn[ct]=Yt=Rt.length-1),$e.writeVarint(Yt);var Cn=typeof Pt;Cn!=="string"&&Cn!=="boolean"&&Cn!=="number"&&(Pt=JSON.stringify(Pt));var Zn=Cn+":"+Pt,en=fn[Zn];en===void 0&&(It.push(Pt),fn[Zn]=en=It.length-1),$e.writeVarint(en)}}}function Ve(tt,$e){return($e<<3)+(7&tt)}function We(tt){return tt<<1^tt>>31}function Fe(tt,$e){for(var Be=tt.loadGeometry(),Rt=tt.type,It=0,tn=0,fn=Be.length,ct=0;ct<fn;ct++){var Pt=Be[ct],Yt=1;Rt===1&&(Yt=Pt.length),$e.writeVarint(Ve(1,Yt));for(var Cn=Rt===3?Pt.length-1:Pt.length,Zn=0;Zn<Cn;Zn++){Zn===1&&Rt!==1&&$e.writeVarint(Ve(2,Cn-1));var en=Pt[Zn].x-It,Nt=Pt[Zn].y-tn;$e.writeVarint(We(en)),$e.writeVarint(We(Nt)),It+=en,tn+=Nt}Rt===3&&$e.writeVarint(Ve(7,1))}}function at(tt,$e){var Be=typeof tt;Be==="string"?$e.writeStringField(1,tt):Be==="boolean"?$e.writeBooleanField(7,tt):Be==="number"&&(tt%1!=0?$e.writeDoubleField(3,tt):tt<0?$e.writeSVarintField(6,tt):$e.writeVarintField(5,tt))}return Ne.exports=re,Ne.exports.fromVectorTileJs=re,Ne.exports.fromGeojsonVt=function(tt,$e){$e=$e||{};var Be={};for(var Rt in tt)Be[Rt]=new te(tt[Rt].features,$e),Be[Rt].name=Rt,Be[Rt].version=$e.version,Be[Rt].extent=$e.extent;return re({layers:Be})},Ne.exports.GeoJSONWrapper=te,Ne.exports}(),ye=g.cx(je);const Qe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:de=>de},bt=Math.fround||(Ot=new Float32Array(1),de=>(Ot[0]=+de,Ot[0]));var Ot;const mt=3,Dt=5,vt=6;class Ge{constructor(te){this.options=Object.assign(Object.create(Qe),te),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(te){const{log:re,minZoom:oe,maxZoom:xe}=this.options;re&&console.time("total time");const ze=`prepare ${te.length} points`;re&&console.time(ze),this.points=te;const Ve=[];for(let Fe=0;Fe<te.length;Fe++){const at=te[Fe];if(!at.geometry)continue;const[tt,$e]=at.geometry.coordinates,Be=bt(Ut(tt)),Rt=bt(Ie($e));Ve.push(Be,Rt,1/0,Fe,-1,1),this.options.reduce&&Ve.push(0)}let We=this.trees[xe+1]=this._createTree(Ve);re&&console.timeEnd(ze);for(let Fe=xe;Fe>=oe;Fe--){const at=+Date.now();We=this.trees[Fe]=this._createTree(this._cluster(We,Fe)),re&&console.log("z%d: %d clusters in %dms",Fe,We.numItems,+Date.now()-at)}return re&&console.timeEnd("total time"),this}getClusters(te,re){let oe=((te[0]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,te[1]));let ze=te[2]===180?180:((te[2]+180)%360+360)%360-180;const Ve=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)oe=-180,ze=180;else if(oe>ze){const $e=this.getClusters([oe,xe,180,Ve],re),Be=this.getClusters([-180,xe,ze,Ve],re);return $e.concat(Be)}const We=this.trees[this._limitZoom(re)],Fe=We.range(Ut(oe),Ie(Ve),Ut(ze),Ie(xe)),at=We.data,tt=[];for(const $e of Fe){const Be=this.stride*$e;tt.push(at[Be+Dt]>1?dt(at,Be,this.clusterProps):this.points[at[Be+mt]])}return tt}getChildren(te){const re=this._getOriginId(te),oe=this._getOriginZoom(te),xe="No cluster with the specified id.",ze=this.trees[oe];if(!ze)throw new Error(xe);const Ve=ze.data;if(re*this.stride>=Ve.length)throw new Error(xe);const We=this.options.radius/(this.options.extent*Math.pow(2,oe-1)),Fe=ze.within(Ve[re*this.stride],Ve[re*this.stride+1],We),at=[];for(const tt of Fe){const $e=tt*this.stride;Ve[$e+4]===te&&at.push(Ve[$e+Dt]>1?dt(Ve,$e,this.clusterProps):this.points[Ve[$e+mt]])}if(at.length===0)throw new Error(xe);return at}getLeaves(te,re,oe){const xe=[];return this._appendLeaves(xe,te,re=re||10,oe=oe||0,0),xe}getTile(te,re,oe){const xe=this.trees[this._limitZoom(te)],ze=Math.pow(2,te),{extent:Ve,radius:We}=this.options,Fe=We/Ve,at=(oe-Fe)/ze,tt=(oe+1+Fe)/ze,$e={features:[]};return this._addTileFeatures(xe.range((re-Fe)/ze,at,(re+1+Fe)/ze,tt),xe.data,re,oe,ze,$e),re===0&&this._addTileFeatures(xe.range(1-Fe/ze,at,1,tt),xe.data,ze,oe,ze,$e),re===ze-1&&this._addTileFeatures(xe.range(0,at,Fe/ze,tt),xe.data,-1,oe,ze,$e),$e.features.length?$e:null}getClusterExpansionZoom(te){let re=this._getOriginZoom(te)-1;for(;re<=this.options.maxZoom;){const oe=this.getChildren(te);if(re++,oe.length!==1)break;te=oe[0].properties.cluster_id}return re}_appendLeaves(te,re,oe,xe,ze){const Ve=this.getChildren(re);for(const We of Ve){const Fe=We.properties;if(Fe&&Fe.cluster?ze+Fe.point_count<=xe?ze+=Fe.point_count:ze=this._appendLeaves(te,Fe.cluster_id,oe,xe,ze):ze<xe?ze++:te.push(We),te.length===oe)break}return ze}_createTree(te){const re=new g.az(te.length/this.stride|0,this.options.nodeSize,Float32Array);for(let oe=0;oe<te.length;oe+=this.stride)re.add(te[oe],te[oe+1]);return re.finish(),re.data=te,re}_addTileFeatures(te,re,oe,xe,ze,Ve){for(const We of te){const Fe=We*this.stride,at=re[Fe+Dt]>1;let tt,$e,Be;if(at)tt=ot(re,Fe,this.clusterProps),$e=re[Fe],Be=re[Fe+1];else{const tn=this.points[re[Fe+mt]];tt=tn.properties;const[fn,ct]=tn.geometry.coordinates;$e=Ut(fn),Be=Ie(ct)}const Rt={type:1,geometry:[[Math.round(this.options.extent*($e*ze-oe)),Math.round(this.options.extent*(Be*ze-xe))]],tags:tt};let It;It=at||this.options.generateId?re[Fe+mt]:this.points[re[Fe+mt]].id,It!==void 0&&(Rt.id=It),Ve.features.push(Rt)}}_limitZoom(te){return Math.max(this.options.minZoom,Math.min(Math.floor(+te),this.options.maxZoom+1))}_cluster(te,re){const{radius:oe,extent:xe,reduce:ze,minPoints:Ve}=this.options,We=oe/(xe*Math.pow(2,re)),Fe=te.data,at=[],tt=this.stride;for(let $e=0;$e<Fe.length;$e+=tt){if(Fe[$e+2]<=re)continue;Fe[$e+2]=re;const Be=Fe[$e],Rt=Fe[$e+1],It=te.within(Fe[$e],Fe[$e+1],We),tn=Fe[$e+Dt];let fn=tn;for(const ct of It){const Pt=ct*tt;Fe[Pt+2]>re&&(fn+=Fe[Pt+Dt])}if(fn>tn&&fn>=Ve){let ct,Pt=Be*tn,Yt=Rt*tn,Cn=-1;const Zn=(($e/tt|0)<<5)+(re+1)+this.points.length;for(const en of It){const Nt=en*tt;if(Fe[Nt+2]<=re)continue;Fe[Nt+2]=re;const $n=Fe[Nt+Dt];Pt+=Fe[Nt]*$n,Yt+=Fe[Nt+1]*$n,Fe[Nt+4]=Zn,ze&&(ct||(ct=this._map(Fe,$e,!0),Cn=this.clusterProps.length,this.clusterProps.push(ct)),ze(ct,this._map(Fe,Nt)))}Fe[$e+4]=Zn,at.push(Pt/fn,Yt/fn,1/0,Zn,-1,fn),ze&&at.push(Cn)}else{for(let ct=0;ct<tt;ct++)at.push(Fe[$e+ct]);if(fn>1)for(const ct of It){const Pt=ct*tt;if(!(Fe[Pt+2]<=re)){Fe[Pt+2]=re;for(let Yt=0;Yt<tt;Yt++)at.push(Fe[Pt+Yt])}}}}return at}_getOriginId(te){return te-this.points.length>>5}_getOriginZoom(te){return(te-this.points.length)%32}_map(te,re,oe){if(te[re+Dt]>1){const Ve=this.clusterProps[te[re+vt]];return oe?Object.assign({},Ve):Ve}const xe=this.points[te[re+mt]].properties,ze=this.options.map(xe);return oe&&ze===xe?Object.assign({},ze):ze}}function dt(de,te,re){return{type:"Feature",id:de[te+mt],properties:ot(de,te,re),geometry:{type:"Point",coordinates:[(oe=de[te],360*(oe-.5)),ut(de[te+1])]}};var oe}function ot(de,te,re){const oe=de[te+Dt],xe=oe>=1e4?`${Math.round(oe/1e3)}k`:oe>=1e3?Math.round(oe/100)/10+"k":oe,ze=de[te+vt],Ve=ze===-1?{}:Object.assign({},re[ze]);return Object.assign(Ve,{cluster:!0,cluster_id:de[te+mt],point_count:oe,point_count_abbreviated:xe})}function Ut(de){return de/360+.5}function Ie(de){const te=Math.sin(de*Math.PI/180),re=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return re<0?0:re>1?1:re}function ut(de){const te=(180-360*de)*Math.PI/180;return 360*Math.atan(Math.exp(te))/Math.PI-90}function Bt(de,te,re,oe){let xe=oe;const ze=te+(re-te>>1);let Ve,We=re-te;const Fe=de[te],at=de[te+1],tt=de[re],$e=de[re+1];for(let Be=te+3;Be<re;Be+=3){const Rt=Lt(de[Be],de[Be+1],Fe,at,tt,$e);if(Rt>xe)Ve=Be,xe=Rt;else if(Rt===xe){const It=Math.abs(Be-ze);It<We&&(Ve=Be,We=It)}}xe>oe&&(Ve-te>3&&Bt(de,te,Ve,oe),de[Ve+2]=xe,re-Ve>3&&Bt(de,Ve,re,oe))}function Lt(de,te,re,oe,xe,ze){let Ve=xe-re,We=ze-oe;if(Ve!==0||We!==0){const Fe=((de-re)*Ve+(te-oe)*We)/(Ve*Ve+We*We);Fe>1?(re=xe,oe=ze):Fe>0&&(re+=Ve*Fe,oe+=We*Fe)}return Ve=de-re,We=te-oe,Ve*Ve+We*We}function Tt(de,te,re,oe){const xe={id:de??null,type:te,geometry:re,tags:oe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(te==="Point"||te==="MultiPoint"||te==="LineString")jt(xe,re);else if(te==="Polygon")jt(xe,re[0]);else if(te==="MultiLineString")for(const ze of re)jt(xe,ze);else if(te==="MultiPolygon")for(const ze of re)jt(xe,ze[0]);return xe}function jt(de,te){for(let re=0;re<te.length;re+=3)de.minX=Math.min(de.minX,te[re]),de.minY=Math.min(de.minY,te[re+1]),de.maxX=Math.max(de.maxX,te[re]),de.maxY=Math.max(de.maxY,te[re+1])}function qt(de,te,re,oe){if(!te.geometry)return;const xe=te.geometry.coordinates;if(xe&&xe.length===0)return;const ze=te.geometry.type,Ve=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2);let We=[],Fe=te.id;if(re.promoteId?Fe=te.properties[re.promoteId]:re.generateId&&(Fe=oe||0),ze==="Point")Sn(xe,We);else if(ze==="MultiPoint")for(const at of xe)Sn(at,We);else if(ze==="LineString")dn(xe,We,Ve,!1);else if(ze==="MultiLineString"){if(re.lineMetrics){for(const at of xe)We=[],dn(at,We,Ve,!1),de.push(Tt(Fe,"LineString",We,te.properties));return}An(xe,We,Ve,!1)}else if(ze==="Polygon")An(xe,We,Ve,!0);else{if(ze!=="MultiPolygon"){if(ze==="GeometryCollection"){for(const at of te.geometry.geometries)qt(de,{id:Fe,geometry:at,properties:te.properties},re,oe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const at of xe){const tt=[];An(at,tt,Ve,!0),We.push(tt)}}de.push(Tt(Fe,ze,We,te.properties))}function Sn(de,te){te.push(Un(de[0]),Wn(de[1]),0)}function dn(de,te,re,oe){let xe,ze,Ve=0;for(let Fe=0;Fe<de.length;Fe++){const at=Un(de[Fe][0]),tt=Wn(de[Fe][1]);te.push(at,tt,0),Fe>0&&(Ve+=oe?(xe*tt-at*ze)/2:Math.sqrt(Math.pow(at-xe,2)+Math.pow(tt-ze,2))),xe=at,ze=tt}const We=te.length-3;te[2]=1,Bt(te,0,We,re),te[We+2]=1,te.size=Math.abs(Ve),te.start=0,te.end=te.size}function An(de,te,re,oe){for(let xe=0;xe<de.length;xe++){const ze=[];dn(de[xe],ze,re,oe),te.push(ze)}}function Un(de){return de/360+.5}function Wn(de){const te=Math.sin(de*Math.PI/180),re=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return re<0?0:re>1?1:re}function ai(de,te,re,oe,xe,ze,Ve,We){if(oe/=te,ze>=(re/=te)&&Ve<oe)return de;if(Ve<re||ze>=oe)return null;const Fe=[];for(const at of de){const tt=at.geometry;let $e=at.type;const Be=xe===0?at.minX:at.minY,Rt=xe===0?at.maxX:at.maxY;if(Be>=re&&Rt<oe){Fe.push(at);continue}if(Rt<re||Be>=oe)continue;let It=[];if($e==="Point"||$e==="MultiPoint")Ni(tt,It,re,oe,xe);else if($e==="LineString")ci(tt,It,re,oe,xe,!1,We.lineMetrics);else if($e==="MultiLineString")Xr(tt,It,re,oe,xe,!1);else if($e==="Polygon")Xr(tt,It,re,oe,xe,!0);else if($e==="MultiPolygon")for(const tn of tt){const fn=[];Xr(tn,fn,re,oe,xe,!0),fn.length&&It.push(fn)}if(It.length){if(We.lineMetrics&&$e==="LineString"){for(const tn of It)Fe.push(Tt(at.id,$e,tn,at.tags));continue}$e!=="LineString"&&$e!=="MultiLineString"||(It.length===1?($e="LineString",It=It[0]):$e="MultiLineString"),$e!=="Point"&&$e!=="MultiPoint"||($e=It.length===3?"Point":"MultiPoint"),Fe.push(Tt(at.id,$e,It,at.tags))}}return Fe.length?Fe:null}function Ni(de,te,re,oe,xe){for(let ze=0;ze<de.length;ze+=3){const Ve=de[ze+xe];Ve>=re&&Ve<=oe&&kr(te,de[ze],de[ze+1],de[ze+2])}}function ci(de,te,re,oe,xe,ze,Ve){let We=Jn(de);const Fe=xe===0?eo:Co;let at,tt,$e=de.start;for(let fn=0;fn<de.length-3;fn+=3){const ct=de[fn],Pt=de[fn+1],Yt=de[fn+2],Cn=de[fn+3],Zn=de[fn+4],en=xe===0?ct:Pt,Nt=xe===0?Cn:Zn;let $n=!1;Ve&&(at=Math.sqrt(Math.pow(ct-Cn,2)+Math.pow(Pt-Zn,2))),en<re?Nt>re&&(tt=Fe(We,ct,Pt,Cn,Zn,re),Ve&&(We.start=$e+at*tt)):en>oe?Nt<oe&&(tt=Fe(We,ct,Pt,Cn,Zn,oe),Ve&&(We.start=$e+at*tt)):kr(We,ct,Pt,Yt),Nt<re&&en>=re&&(tt=Fe(We,ct,Pt,Cn,Zn,re),$n=!0),Nt>oe&&en<=oe&&(tt=Fe(We,ct,Pt,Cn,Zn,oe),$n=!0),!ze&&$n&&(Ve&&(We.end=$e+at*tt),te.push(We),We=Jn(de)),Ve&&($e+=at)}let Be=de.length-3;const Rt=de[Be],It=de[Be+1],tn=xe===0?Rt:It;tn>=re&&tn<=oe&&kr(We,Rt,It,de[Be+2]),Be=We.length-3,ze&&Be>=3&&(We[Be]!==We[0]||We[Be+1]!==We[1])&&kr(We,We[0],We[1],We[2]),We.length&&te.push(We)}function Jn(de){const te=[];return te.size=de.size,te.start=de.start,te.end=de.end,te}function Xr(de,te,re,oe,xe,ze){for(const Ve of de)ci(Ve,te,re,oe,xe,ze,!1)}function kr(de,te,re,oe){de.push(te,re,oe)}function eo(de,te,re,oe,xe,ze){const Ve=(ze-te)/(oe-te);return kr(de,ze,re+(xe-re)*Ve,1),Ve}function Co(de,te,re,oe,xe,ze){const Ve=(ze-re)/(xe-re);return kr(de,te+(oe-te)*Ve,ze,1),Ve}function ar(de,te){const re=[];for(let oe=0;oe<de.length;oe++){const xe=de[oe],ze=xe.type;let Ve;if(ze==="Point"||ze==="MultiPoint"||ze==="LineString")Ve=ja(xe.geometry,te);else if(ze==="MultiLineString"||ze==="Polygon"){Ve=[];for(const We of xe.geometry)Ve.push(ja(We,te))}else if(ze==="MultiPolygon"){Ve=[];for(const We of xe.geometry){const Fe=[];for(const at of We)Fe.push(ja(at,te));Ve.push(Fe)}}re.push(Tt(xe.id,ze,Ve,xe.tags))}return re}function ja(de,te){const re=[];re.size=de.size,de.start!==void 0&&(re.start=de.start,re.end=de.end);for(let oe=0;oe<de.length;oe+=3)re.push(de[oe]+te,de[oe+1],de[oe+2]);return re}function xs(de,te){if(de.transformed)return de;const re=1<<de.z,oe=de.x,xe=de.y;for(const ze of de.features){const Ve=ze.geometry,We=ze.type;if(ze.geometry=[],We===1)for(let Fe=0;Fe<Ve.length;Fe+=2)ze.geometry.push(Wo(Ve[Fe],Ve[Fe+1],te,re,oe,xe));else for(let Fe=0;Fe<Ve.length;Fe++){const at=[];for(let tt=0;tt<Ve[Fe].length;tt+=2)at.push(Wo(Ve[Fe][tt],Ve[Fe][tt+1],te,re,oe,xe));ze.geometry.push(at)}}return de.transformed=!0,de}function Wo(de,te,re,oe,xe,ze){return[Math.round(re*(de*oe-xe)),Math.round(re*(te*oe-ze))]}function Wr(de,te,re,oe,xe){const ze=te===xe.maxZoom?0:xe.tolerance/((1<<te)*xe.extent),Ve={features:[],numPoints:0,numSimplified:0,numFeatures:de.length,source:null,x:re,y:oe,z:te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const We of de)ws(Ve,We,ze,xe);return Ve}function ws(de,te,re,oe){const xe=te.geometry,ze=te.type,Ve=[];if(de.minX=Math.min(de.minX,te.minX),de.minY=Math.min(de.minY,te.minY),de.maxX=Math.max(de.maxX,te.maxX),de.maxY=Math.max(de.maxY,te.maxY),ze==="Point"||ze==="MultiPoint")for(let We=0;We<xe.length;We+=3)Ve.push(xe[We],xe[We+1]),de.numPoints++,de.numSimplified++;else if(ze==="LineString")to(Ve,xe,de,re,!1,!1);else if(ze==="MultiLineString"||ze==="Polygon")for(let We=0;We<xe.length;We++)to(Ve,xe[We],de,re,ze==="Polygon",We===0);else if(ze==="MultiPolygon")for(let We=0;We<xe.length;We++){const Fe=xe[We];for(let at=0;at<Fe.length;at++)to(Ve,Fe[at],de,re,!0,at===0)}if(Ve.length){let We=te.tags||null;if(ze==="LineString"&&oe.lineMetrics){We={};for(const at in te.tags)We[at]=te.tags[at];We.mapbox_clip_start=xe.start/xe.size,We.mapbox_clip_end=xe.end/xe.size}const Fe={geometry:Ve,type:ze==="Polygon"||ze==="MultiPolygon"?3:ze==="LineString"||ze==="MultiLineString"?2:1,tags:We};te.id!==null&&(Fe.id=te.id),de.features.push(Fe)}}function to(de,te,re,oe,xe,ze){const Ve=oe*oe;if(oe>0&&te.size<(xe?Ve:oe))return void(re.numPoints+=te.length/3);const We=[];for(let Fe=0;Fe<te.length;Fe+=3)(oe===0||te[Fe+2]>Ve)&&(re.numSimplified++,We.push(te[Fe],te[Fe+1])),re.numPoints++;xe&&function(Fe,at){let tt=0;for(let $e=0,Be=Fe.length,Rt=Be-2;$e<Be;Rt=$e,$e+=2)tt+=(Fe[$e]-Fe[Rt])*(Fe[$e+1]+Fe[Rt+1]);if(tt>0===at)for(let $e=0,Be=Fe.length;$e<Be/2;$e+=2){const Rt=Fe[$e],It=Fe[$e+1];Fe[$e]=Fe[Be-2-$e],Fe[$e+1]=Fe[Be-1-$e],Fe[Be-2-$e]=Rt,Fe[Be-1-$e]=It}}(We,ze),de.push(We)}const Qo={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ea{constructor(te,re){const oe=(re=this.options=function(ze,Ve){for(const We in Ve)ze[We]=Ve[We];return ze}(Object.create(Qo),re)).debug;if(oe&&console.time("preprocess data"),re.maxZoom<0||re.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(re.promoteId&&re.generateId)throw new Error("promoteId and generateId cannot be used together.");let xe=function(ze,Ve){const We=[];if(ze.type==="FeatureCollection")for(let Fe=0;Fe<ze.features.length;Fe++)qt(We,ze.features[Fe],Ve,Fe);else qt(We,ze.type==="Feature"?ze:{geometry:ze},Ve);return We}(te,re);this.tiles={},this.tileCoords=[],oe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",re.indexMaxZoom,re.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),xe=function(ze,Ve){const We=Ve.buffer/Ve.extent;let Fe=ze;const at=ai(ze,1,-1-We,We,0,-1,2,Ve),tt=ai(ze,1,1-We,2+We,0,-1,2,Ve);return(at||tt)&&(Fe=ai(ze,1,-We,1+We,0,-1,2,Ve)||[],at&&(Fe=ar(at,1).concat(Fe)),tt&&(Fe=Fe.concat(ar(tt,-1)))),Fe}(xe,re),xe.length&&this.splitTile(xe,0,0,0),oe&&(xe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(te,re,oe,xe,ze,Ve,We){const Fe=[te,re,oe,xe],at=this.options,tt=at.debug;for(;Fe.length;){xe=Fe.pop(),oe=Fe.pop(),re=Fe.pop(),te=Fe.pop();const $e=1<<re,Be=ac(re,oe,xe);let Rt=this.tiles[Be];if(!Rt&&(tt>1&&console.time("creation"),Rt=this.tiles[Be]=Wr(te,re,oe,xe,at),this.tileCoords.push({z:re,x:oe,y:xe}),tt)){tt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",re,oe,xe,Rt.numFeatures,Rt.numPoints,Rt.numSimplified),console.timeEnd("creation"));const $n=`z${re}`;this.stats[$n]=(this.stats[$n]||0)+1,this.total++}if(Rt.source=te,ze==null){if(re===at.indexMaxZoom||Rt.numPoints<=at.indexMaxPoints)continue}else{if(re===at.maxZoom||re===ze)continue;if(ze!=null){const $n=ze-re;if(oe!==Ve>>$n||xe!==We>>$n)continue}}if(Rt.source=null,te.length===0)continue;tt>1&&console.time("clipping");const It=.5*at.buffer/at.extent,tn=.5-It,fn=.5+It,ct=1+It;let Pt=null,Yt=null,Cn=null,Zn=null,en=ai(te,$e,oe-It,oe+fn,0,Rt.minX,Rt.maxX,at),Nt=ai(te,$e,oe+tn,oe+ct,0,Rt.minX,Rt.maxX,at);te=null,en&&(Pt=ai(en,$e,xe-It,xe+fn,1,Rt.minY,Rt.maxY,at),Yt=ai(en,$e,xe+tn,xe+ct,1,Rt.minY,Rt.maxY,at),en=null),Nt&&(Cn=ai(Nt,$e,xe-It,xe+fn,1,Rt.minY,Rt.maxY,at),Zn=ai(Nt,$e,xe+tn,xe+ct,1,Rt.minY,Rt.maxY,at),Nt=null),tt>1&&console.timeEnd("clipping"),Fe.push(Pt||[],re+1,2*oe,2*xe),Fe.push(Yt||[],re+1,2*oe,2*xe+1),Fe.push(Cn||[],re+1,2*oe+1,2*xe),Fe.push(Zn||[],re+1,2*oe+1,2*xe+1)}}getTile(te,re,oe){te=+te,re=+re,oe=+oe;const xe=this.options,{extent:ze,debug:Ve}=xe;if(te<0||te>24)return null;const We=1<<te,Fe=ac(te,re=re+We&We-1,oe);if(this.tiles[Fe])return xs(this.tiles[Fe],ze);Ve>1&&console.log("drilling down to z%d-%d-%d",te,re,oe);let at,tt=te,$e=re,Be=oe;for(;!at&&tt>0;)tt--,$e>>=1,Be>>=1,at=this.tiles[ac(tt,$e,Be)];return at&&at.source?(Ve>1&&(console.log("found parent tile z%d-%d-%d",tt,$e,Be),console.time("drilling down")),this.splitTile(at.source,tt,$e,Be,te,re,oe),Ve>1&&console.timeEnd("drilling down"),this.tiles[Fe]?xs(this.tiles[Fe],ze):null):null}}function ac(de,te,re){return 32*((1<<de)*re+te)+de}function Gs(de,te){return te?de.properties[te]:de.id}function tu(de,te){if(de==null)return!0;if(de.type==="Feature")return Gs(de,te)!=null;if(de.type==="FeatureCollection"){const re=new Set;for(const oe of de.features){const xe=Gs(oe,te);if(xe==null||re.has(xe))return!1;re.add(xe)}return!0}return!1}function nu(de,te){const re=new Map;if(de!=null)if(de.type==="Feature")re.set(Gs(de,te),de);else for(const oe of de.features)re.set(Gs(oe,te),oe);return re}class Zs extends L{constructor(){super(...arguments),this._dataUpdateable=new Map}loadVectorTile(te,re){return g._(this,void 0,void 0,function*(){const oe=te.tileID.canonical;if(!this._geoJSONIndex)throw new Error("Unable to parse the data into a cluster or geojson");const xe=this._geoJSONIndex.getTile(oe.z,oe.x,oe.y);if(!xe)return null;const ze=new Ce(xe.features);let Ve=ye(ze);return Ve.byteOffset===0&&Ve.byteLength===Ve.buffer.byteLength||(Ve=new Uint8Array(Ve)),{vectorTile:ze,rawData:Ve.buffer}})}loadData(te){return g._(this,void 0,void 0,function*(){var re;(re=this._pendingRequest)===null||re===void 0||re.abort();const oe=!!(te&&te.request&&te.request.collectResourceTiming)&&new g.cu(te.request);this._pendingRequest=new AbortController;try{this._pendingData=this.loadAndProcessGeoJSON(te,this._pendingRequest),this._geoJSONIndex=te.cluster?new Ge(function({superclusterOptions:Ve,clusterProperties:We}){if(!We||!Ve)return Ve;const Fe={},at={},tt={accumulated:null,zoom:0},$e={properties:null},Be=Object.keys(We);for(const Rt of Be){const[It,tn]=We[Rt],fn=g.cB(tn),ct=g.cB(typeof It=="string"?[It,["accumulated"],["get",Rt]]:It);Fe[Rt]=fn.value,at[Rt]=ct.value}return Ve.map=Rt=>{$e.properties=Rt;const It={};for(const tn of Be)It[tn]=Fe[tn].evaluate(tt,$e);return It},Ve.reduce=(Rt,It)=>{$e.properties=It;for(const tn of Be)tt.accumulated=Rt[tn],Rt[tn]=at[tn].evaluate(tt,$e)},Ve}(te)).load((yield this._pendingData).features):(xe=yield this._pendingData,new Ea(xe,te.geojsonVtOptions)),this.loaded={};const ze={};if(oe){const Ve=oe.finish();Ve&&(ze.resourceTiming={},ze.resourceTiming[te.source]=JSON.parse(JSON.stringify(Ve)))}return ze}catch(ze){if(delete this._pendingRequest,g.cf(ze))return{abandoned:!0};throw ze}var xe})}getData(){return g._(this,void 0,void 0,function*(){return this._pendingData})}reloadTile(te){const re=this.loaded;return re&&re[te.uid]?super.reloadTile(te):this.loadTile(te)}loadAndProcessGeoJSON(te,re){return g._(this,void 0,void 0,function*(){let oe=yield this.loadGeoJSON(te,re);if(delete this._pendingRequest,typeof oe!="object")throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`);if(ae(oe,!0),te.filter){const xe=g.cB(te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(xe.result==="error")throw new Error(xe.value.map(Ve=>`${Ve.key}: ${Ve.message}`).join(", "));oe={type:"FeatureCollection",features:oe.features.filter(Ve=>xe.value.evaluate({zoom:0},Ve))}}return oe})}loadGeoJSON(te,re){return g._(this,void 0,void 0,function*(){const{promoteId:oe}=te;if(te.request){const xe=yield g.h(te.request,re);return this._dataUpdateable=tu(xe.data,oe)?nu(xe.data,oe):void 0,xe.data}if(typeof te.data=="string")try{const xe=JSON.parse(te.data);return this._dataUpdateable=tu(xe,oe)?nu(xe,oe):void 0,xe}catch{throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`)}if(!te.dataDiff)throw new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`);if(!this._dataUpdateable)throw new Error(`Cannot update existing geojson data in ${te.source}`);return function(xe,ze,Ve){var We,Fe,at,tt;if(ze.removeAll&&xe.clear(),ze.remove)for(const $e of ze.remove)xe.delete($e);if(ze.add)for(const $e of ze.add){const Be=Gs($e,Ve);Be!=null&&xe.set(Be,$e)}if(ze.update)for(const $e of ze.update){let Be=xe.get($e.id);if(Be==null)continue;const Rt=!$e.removeAllProperties&&(((We=$e.removeProperties)===null||We===void 0?void 0:We.length)>0||((Fe=$e.addOrUpdateProperties)===null||Fe===void 0?void 0:Fe.length)>0);if(($e.newGeometry||$e.removeAllProperties||Rt)&&(Be=Object.assign({},Be),xe.set($e.id,Be),Rt&&(Be.properties=Object.assign({},Be.properties))),$e.newGeometry&&(Be.geometry=$e.newGeometry),$e.removeAllProperties)Be.properties={};else if(((at=$e.removeProperties)===null||at===void 0?void 0:at.length)>0)for(const It of $e.removeProperties)Object.prototype.hasOwnProperty.call(Be.properties,It)&&delete Be.properties[It];if(((tt=$e.addOrUpdateProperties)===null||tt===void 0?void 0:tt.length)>0)for(const{key:It,value:tn}of $e.addOrUpdateProperties)Be.properties[It]=tn}}(this._dataUpdateable,te.dataDiff,oe),{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())}})}removeSource(te){return g._(this,void 0,void 0,function*(){this._pendingRequest&&this._pendingRequest.abort()})}getClusterExpansionZoom(te){return this._geoJSONIndex.getClusterExpansionZoom(te.clusterId)}getClusterChildren(te){return this._geoJSONIndex.getChildren(te.clusterId)}getClusterLeaves(te){return this._geoJSONIndex.getLeaves(te.clusterId,te.limit,te.offset)}}class Rr{constructor(te){this.self=te,this.actor=new g.F(te),this.layerIndexes={},this.availableImages={},this.workerSources={},this.demWorkerSources={},this.externalWorkerSourceTypes={},this.self.registerWorkerSource=(re,oe)=>{if(this.externalWorkerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.externalWorkerSourceTypes[re]=oe},this.self.addProtocol=g.ch,this.self.removeProtocol=g.ci,this.self.registerRTLTextPlugin=re=>{g.cC.setMethods(re)},this.actor.registerMessageHandler("LDT",(re,oe)=>this._getDEMWorkerSource(re,oe.source).loadTile(oe)),this.actor.registerMessageHandler("RDT",(re,oe)=>g._(this,void 0,void 0,function*(){this._getDEMWorkerSource(re,oe.source).removeTile(oe)})),this.actor.registerMessageHandler("GCEZ",(re,oe)=>g._(this,void 0,void 0,function*(){return this._getWorkerSource(re,oe.type,oe.source).getClusterExpansionZoom(oe)})),this.actor.registerMessageHandler("GCC",(re,oe)=>g._(this,void 0,void 0,function*(){return this._getWorkerSource(re,oe.type,oe.source).getClusterChildren(oe)})),this.actor.registerMessageHandler("GCL",(re,oe)=>g._(this,void 0,void 0,function*(){return this._getWorkerSource(re,oe.type,oe.source).getClusterLeaves(oe)})),this.actor.registerMessageHandler("LD",(re,oe)=>this._getWorkerSource(re,oe.type,oe.source).loadData(oe)),this.actor.registerMessageHandler("GD",(re,oe)=>this._getWorkerSource(re,oe.type,oe.source).getData()),this.actor.registerMessageHandler("LT",(re,oe)=>this._getWorkerSource(re,oe.type,oe.source).loadTile(oe)),this.actor.registerMessageHandler("RT",(re,oe)=>this._getWorkerSource(re,oe.type,oe.source).reloadTile(oe)),this.actor.registerMessageHandler("AT",(re,oe)=>this._getWorkerSource(re,oe.type,oe.source).abortTile(oe)),this.actor.registerMessageHandler("RMT",(re,oe)=>this._getWorkerSource(re,oe.type,oe.source).removeTile(oe)),this.actor.registerMessageHandler("RS",(re,oe)=>g._(this,void 0,void 0,function*(){if(!this.workerSources[re]||!this.workerSources[re][oe.type]||!this.workerSources[re][oe.type][oe.source])return;const xe=this.workerSources[re][oe.type][oe.source];delete this.workerSources[re][oe.type][oe.source],xe.removeSource!==void 0&&xe.removeSource(oe)})),this.actor.registerMessageHandler("RM",re=>g._(this,void 0,void 0,function*(){delete this.layerIndexes[re],delete this.availableImages[re],delete this.workerSources[re],delete this.demWorkerSources[re]})),this.actor.registerMessageHandler("SR",(re,oe)=>g._(this,void 0,void 0,function*(){this.referrer=oe})),this.actor.registerMessageHandler("SRPS",(re,oe)=>this._syncRTLPluginState(re,oe)),this.actor.registerMessageHandler("IS",(re,oe)=>g._(this,void 0,void 0,function*(){this.self.importScripts(oe)})),this.actor.registerMessageHandler("SI",(re,oe)=>this._setImages(re,oe)),this.actor.registerMessageHandler("UL",(re,oe)=>g._(this,void 0,void 0,function*(){this._getLayerIndex(re).update(oe.layers,oe.removedIds)})),this.actor.registerMessageHandler("SL",(re,oe)=>g._(this,void 0,void 0,function*(){this._getLayerIndex(re).replace(oe)}))}_setImages(te,re){return g._(this,void 0,void 0,function*(){this.availableImages[te]=re;for(const oe in this.workerSources[te]){const xe=this.workerSources[te][oe];for(const ze in xe)xe[ze].availableImages=re}})}_syncRTLPluginState(te,re){return g._(this,void 0,void 0,function*(){return yield g.cC.syncState(re,this.self.importScripts)})}_getAvailableImages(te){let re=this.availableImages[te];return re||(re=[]),re}_getLayerIndex(te){let re=this.layerIndexes[te];return re||(re=this.layerIndexes[te]=new c),re}_getWorkerSource(te,re,oe){if(this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][re]||(this.workerSources[te][re]={}),!this.workerSources[te][re][oe]){const xe={sendAsync:(ze,Ve)=>(ze.targetMapId=te,this.actor.sendAsync(ze,Ve))};switch(re){case"vector":this.workerSources[te][re][oe]=new L(xe,this._getLayerIndex(te),this._getAvailableImages(te));break;case"geojson":this.workerSources[te][re][oe]=new Zs(xe,this._getLayerIndex(te),this._getAvailableImages(te));break;default:this.workerSources[te][re][oe]=new this.externalWorkerSourceTypes[re](xe,this._getLayerIndex(te),this._getAvailableImages(te))}}return this.workerSources[te][re][oe]}_getDEMWorkerSource(te,re){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][re]||(this.demWorkerSources[te][re]=new F),this.demWorkerSources[te][re]}}return g.i(self)&&(self.worker=new Rr(self)),Rr}),p("index",["exports","./shared"],function(g,c){var A="5.1.0";function D(){var b=new c.A(4);return c.A!=Float32Array&&(b[1]=0,b[2]=0),b[0]=1,b[3]=1,b}let N,L;const F={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(b,e,o){const f=requestAnimationFrame(e);b.signal.addEventListener("abort",()=>{cancelAnimationFrame(f),o(c.c())})},frameAsync(b){return new Promise((e,o)=>{this.frame(b,e,o)})},getImageData(b,e=0){return this.getImageCanvasContext(b).getImageData(-e,-e,b.width+2*e,b.height+2*e)},getImageCanvasContext(b){const e=window.document.createElement("canvas"),o=e.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return e.width=b.width,e.height=b.height,o.drawImage(b,0,0,b.width,b.height),o},resolveURL:b=>(N||(N=document.createElement("a")),N.href=b,N.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(L==null&&(L=matchMedia("(prefers-reduced-motion: reduce)")),L.matches)}};class V{static testProp(e){if(!V.docStyle)return e[0];for(let o=0;o<e.length;o++)if(e[o]in V.docStyle)return e[o];return e[0]}static create(e,o,f){const y=window.document.createElement(e);return o!==void 0&&(y.className=o),f&&f.appendChild(y),y}static createNS(e,o){return window.document.createElementNS(e,o)}static disableDrag(){V.docStyle&&V.selectProp&&(V.userSelect=V.docStyle[V.selectProp],V.docStyle[V.selectProp]="none")}static enableDrag(){V.docStyle&&V.selectProp&&(V.docStyle[V.selectProp]=V.userSelect)}static setTransform(e,o){e.style[V.transformProp]=o}static addEventListener(e,o,f,y={}){e.addEventListener(o,f,"passive"in y?y:y.capture)}static removeEventListener(e,o,f,y={}){e.removeEventListener(o,f,"passive"in y?y:y.capture)}static suppressClickInternal(e){e.preventDefault(),e.stopPropagation(),window.removeEventListener("click",V.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",V.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",V.suppressClickInternal,!0)},0)}static getScale(e){const o=e.getBoundingClientRect();return{x:o.width/e.offsetWidth||1,y:o.height/e.offsetHeight||1,boundingClientRect:o}}static getPoint(e,o,f){const y=o.boundingClientRect;return new c.P((f.clientX-y.left)/o.x-e.clientLeft,(f.clientY-y.top)/o.y-e.clientTop)}static mousePos(e,o){const f=V.getScale(e);return V.getPoint(e,f,o)}static touchPos(e,o){const f=[],y=V.getScale(e);for(let w=0;w<o.length;w++)f.push(V.getPoint(e,y,o[w]));return f}static mouseButton(e){return e.button}static remove(e){e.parentNode&&e.parentNode.removeChild(e)}static sanitize(e){const o=new DOMParser().parseFromString(e,"text/html").body||document.createElement("body"),f=o.querySelectorAll("script");for(const y of f)y.remove();return V.clean(o),o.innerHTML}static isPossiblyDangerous(e,o){const f=o.replace(/\s+/g,"").toLowerCase();return!(!["src","href","xlink:href"].includes(e)||!f.includes("javascript:")&&!f.includes("data:"))||!!e.startsWith("on")||void 0}static clean(e){const o=e.children;for(const f of o)V.removeAttributes(f),V.clean(f)}static removeAttributes(e){for(const{name:o,value:f}of e.attributes)V.isPossiblyDangerous(o,f)&&e.removeAttribute(o)}}V.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,V.selectProp=V.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),V.transformProp=V.testProp(["transform","WebkitTransform"]);const $={supported:!1,testSupport:function(b){!fe&&ae&&(ve?Ce(b):J=b)}};let J,ae,fe=!1,ve=!1;function Ce(b){const e=b.createTexture();b.bindTexture(b.TEXTURE_2D,e);try{if(b.texImage2D(b.TEXTURE_2D,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,ae),b.isContextLost())return;$.supported=!0}catch{}b.deleteTexture(e),fe=!0}var Me;typeof document<"u"&&(ae=document.createElement("img"),ae.onload=()=>{J&&Ce(J),J=null,ve=!0},ae.onerror=()=>{fe=!0,J=null},ae.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(b){let e,o,f,y;b.resetRequestQueue=()=>{e=[],o=0,f=0,y={}},b.addThrottleControl=P=>{const j=f++;return y[j]=P,j},b.removeThrottleControl=P=>{delete y[P],S()},b.getImage=(P,j,Z=!0)=>new Promise((Y,H)=>{$.supported&&(P.headers||(P.headers={}),P.headers.accept="image/webp,*/*"),c.e(P,{type:"image"}),e.push({abortController:j,requestParameters:P,supportImageRefresh:Z,state:"queued",onError:ee=>{H(ee)},onSuccess:ee=>{Y(ee)}}),S()});const w=P=>c._(this,void 0,void 0,function*(){P.state="running";const{requestParameters:j,supportImageRefresh:Z,onError:Y,onSuccess:H,abortController:ee}=P,ie=Z===!1&&!c.i(self)&&!c.g(j.url)&&(!j.headers||Object.keys(j.headers).reduce((ge,be)=>ge&&be==="accept",!0));o++;const me=ie?I(j,ee):c.m(j,ee);try{const ge=yield me;delete P.abortController,P.state="completed",ge.data instanceof HTMLImageElement||c.b(ge.data)?H(ge):ge.data&&H({data:yield(pe=ge.data,typeof createImageBitmap=="function"?c.d(pe):c.f(pe)),cacheControl:ge.cacheControl,expires:ge.expires})}catch(ge){delete P.abortController,Y(ge)}finally{o--,S()}var pe}),S=()=>{const P=(()=>{for(const j of Object.keys(y))if(y[j]())return!0;return!1})()?c.a.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:c.a.MAX_PARALLEL_IMAGE_REQUESTS;for(let j=o;j<P&&e.length>0;j++){const Z=e.shift();Z.abortController.signal.aborted?j--:w(Z)}},I=(P,j)=>new Promise((Z,Y)=>{const H=new Image,ee=P.url,ie=P.credentials;ie&&ie==="include"?H.crossOrigin="use-credentials":(ie&&ie==="same-origin"||!c.s(ee))&&(H.crossOrigin="anonymous"),j.signal.addEventListener("abort",()=>{H.src="",Y(c.c())}),H.fetchPriority="high",H.onload=()=>{H.onerror=H.onload=null,Z({data:H})},H.onerror=()=>{H.onerror=H.onload=null,j.signal.aborted||Y(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))},H.src=ee})}(Me||(Me={})),Me.resetRequestQueue();class Te{constructor(e){this._transformRequestFn=e}transformRequest(e,o){return this._transformRequestFn&&this._transformRequestFn(e,o)||{url:e}}setTransformRequest(e){this._transformRequestFn=e}}function De(b){const e=[];if(typeof b=="string")e.push({id:"default",url:b});else if(b&&b.length>0){const o=[];for(const{id:f,url:y}of b){const w=`${f}${y}`;o.indexOf(w)===-1&&(o.push(w),e.push({id:f,url:y}))}}return e}function Ne(b,e,o){try{const f=new URL(b);return f.pathname+=`${e}${o}`,f.toString()}catch{throw new Error(`Invalid sprite URL "${b}", must be absolute. Modify style specification directly or use TransformStyleFunction to correct the issue dynamically`)}}class je{constructor(e,o,f,y){this.context=e,this.format=f,this.texture=e.gl.createTexture(),this.update(o,y)}update(e,o,f){const{width:y,height:w}=e,S=!(this.size&&this.size[0]===y&&this.size[1]===w||f),{context:I}=this,{gl:P}=I;if(this.useMipmap=!!(o&&o.useMipmap),P.bindTexture(P.TEXTURE_2D,this.texture),I.pixelStoreUnpackFlipY.set(!1),I.pixelStoreUnpack.set(1),I.pixelStoreUnpackPremultiplyAlpha.set(this.format===P.RGBA&&(!o||o.premultiply!==!1)),S)this.size=[y,w],e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?P.texImage2D(P.TEXTURE_2D,0,this.format,this.format,P.UNSIGNED_BYTE,e):P.texImage2D(P.TEXTURE_2D,0,this.format,y,w,0,this.format,P.UNSIGNED_BYTE,e.data);else{const{x:j,y:Z}=f||{x:0,y:0};e instanceof HTMLImageElement||e instanceof HTMLCanvasElement||e instanceof HTMLVideoElement||e instanceof ImageData||c.b(e)?P.texSubImage2D(P.TEXTURE_2D,0,j,Z,P.RGBA,P.UNSIGNED_BYTE,e):P.texSubImage2D(P.TEXTURE_2D,0,j,Z,y,w,P.RGBA,P.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&P.generateMipmap(P.TEXTURE_2D)}bind(e,o,f){const{context:y}=this,{gl:w}=y;w.bindTexture(w.TEXTURE_2D,this.texture),f!==w.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(f=w.LINEAR),e!==this.filter&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,e),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,f||e),this.filter=e),o!==this.wrap&&(w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,o),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}function ye(b){const{userImage:e}=b;return!!(e&&e.render&&e.render())&&(b.data.replace(new Uint8Array(e.data.buffer)),!0)}class Qe extends c.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new c.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:o,promiseResolve:f}of this.requestors)f(this._getImagesForIds(o));this.requestors=[]}}getImage(e){const o=this.images[e];if(o&&!o.data&&o.spriteData){const f=o.spriteData;o.data=new c.R({width:f.width,height:f.height},f.context.getImageData(f.x,f.y,f.width,f.height).data),o.spriteData=null}return o}addImage(e,o){if(this.images[e])throw new Error(`Image id ${e} already exist, use updateImage instead`);this._validate(e,o)&&(this.images[e]=o)}_validate(e,o){let f=!0;const y=o.data||o.spriteData;return this._validateStretch(o.stretchX,y&&y.width)||(this.fire(new c.j(new Error(`Image "${e}" has invalid "stretchX" value`))),f=!1),this._validateStretch(o.stretchY,y&&y.height)||(this.fire(new c.j(new Error(`Image "${e}" has invalid "stretchY" value`))),f=!1),this._validateContent(o.content,o)||(this.fire(new c.j(new Error(`Image "${e}" has invalid "content" value`))),f=!1),f}_validateStretch(e,o){if(!e)return!0;let f=0;for(const y of e){if(y[0]<f||y[1]<y[0]||o<y[1])return!1;f=y[1]}return!0}_validateContent(e,o){if(!e)return!0;if(e.length!==4)return!1;const f=o.spriteData,y=f&&f.width||o.data.width,w=f&&f.height||o.data.height;return!(e[0]<0||y<e[0]||e[1]<0||w<e[1]||e[2]<0||y<e[2]||e[3]<0||w<e[3]||e[2]<e[0]||e[3]<e[1])}updateImage(e,o,f=!0){const y=this.getImage(e);if(f&&(y.data.width!==o.data.width||y.data.height!==o.data.height))throw new Error(`size mismatch between old image (${y.data.width}x${y.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=y.version+1,this.images[e]=o,this.updatedImages[e]=!0}removeImage(e){const o=this.images[e];delete this.images[e],delete this.patterns[e],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e){return new Promise((o,f)=>{let y=!0;if(!this.isLoaded())for(const w of e)this.images[w]||(y=!1);this.isLoaded()||y?o(this._getImagesForIds(e)):this.requestors.push({ids:e,promiseResolve:o})})}_getImagesForIds(e){const o={};for(const f of e){let y=this.getImage(f);y||(this.fire(new c.k("styleimagemissing",{id:f})),y=this.getImage(f)),y?o[f]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,textFitWidth:y.textFitWidth,textFitHeight:y.textFitHeight,hasRenderCallback:!!(y.userImage&&y.userImage.render)}:c.w(`Image "${f}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}return o}getPixelSize(){const{width:e,height:o}=this.atlasImage;return{width:e,height:o}}getPattern(e){const o=this.patterns[e],f=this.getImage(e);if(!f)return null;if(o&&o.position.version===f.version)return o.position;if(o)o.position.version=f.version;else{const y={w:f.data.width+2,h:f.data.height+2,x:0,y:0},w=new c.I(y,f);this.patterns[e]={bin:y,position:w}}return this._updatePatternAtlas(),this.patterns[e].position}bind(e){const o=e.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new je(e,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const e=[];for(const w in this.patterns)e.push(this.patterns[w].bin);const{w:o,h:f}=c.p(e),y=this.atlasImage;y.resize({width:o||1,height:f||1});for(const w in this.patterns){const{bin:S}=this.patterns[w],I=S.x+1,P=S.y+1,j=this.getImage(w).data,Z=j.width,Y=j.height;c.R.copy(j,y,{x:0,y:0},{x:I,y:P},{width:Z,height:Y}),c.R.copy(j,y,{x:0,y:Y-1},{x:I,y:P-1},{width:Z,height:1}),c.R.copy(j,y,{x:0,y:0},{x:I,y:P+Y},{width:Z,height:1}),c.R.copy(j,y,{x:Z-1,y:0},{x:I-1,y:P},{width:1,height:Y}),c.R.copy(j,y,{x:0,y:0},{x:I+Z,y:P},{width:1,height:Y})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const o of e){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const f=this.getImage(o);f||c.w(`Image with ID: "${o}" was not found`),ye(f)&&this.updateImage(o,f)}}}const bt=1e20;function Ot(b,e,o,f,y,w,S,I,P){for(let j=e;j<e+f;j++)mt(b,o*w+j,w,y,S,I,P);for(let j=o;j<o+y;j++)mt(b,j*w+e,1,f,S,I,P)}function mt(b,e,o,f,y,w,S){w[0]=0,S[0]=-1e20,S[1]=bt,y[0]=b[e];for(let I=1,P=0,j=0;I<f;I++){y[I]=b[e+I*o];const Z=I*I;do{const Y=w[P];j=(y[I]-y[Y]+Z-Y*Y)/(I-Y)/2}while(j<=S[P]&&--P>-1);P++,w[P]=I,S[P]=j,S[P+1]=bt}for(let I=0,P=0;I<f;I++){for(;S[P+1]<I;)P++;const j=w[P],Z=I-j;b[e+I*o]=y[j]+Z*Z}}class Dt{constructor(e,o){this.requestManager=e,this.localIdeographFontFamily=o,this.entries={}}setURL(e){this.url=e}getGlyphs(e){return c._(this,void 0,void 0,function*(){const o=[];for(const w in e)for(const S of e[w])o.push(this._getAndCacheGlyphsPromise(w,S));const f=yield Promise.all(o),y={};for(const{stack:w,id:S,glyph:I}of f)y[w]||(y[w]={}),y[w][S]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics};return y})}_getAndCacheGlyphsPromise(e,o){return c._(this,void 0,void 0,function*(){let f=this.entries[e];f||(f=this.entries[e]={glyphs:{},requests:{},ranges:{}});let y=f.glyphs[o];if(y!==void 0)return{stack:e,id:o,glyph:y};if(y=this._tinySDF(f,e,o),y)return f.glyphs[o]=y,{stack:e,id:o,glyph:y};const w=Math.floor(o/256);if(256*w>65535)throw new Error("glyphs > 65535 not supported");if(f.ranges[w])return{stack:e,id:o,glyph:y};if(!this.url)throw new Error("glyphsUrl is not set");if(!f.requests[w]){const I=Dt.loadGlyphRange(e,w,this.url,this.requestManager);f.requests[w]=I}const S=yield f.requests[w];for(const I in S)this._doesCharSupportLocalGlyph(+I)||(f.glyphs[+I]=S[+I]);return f.ranges[w]=!0,{stack:e,id:o,glyph:S[o]||null}})}_doesCharSupportLocalGlyph(e){return!!this.localIdeographFontFamily&&new RegExp("\\p{Ideo}|\\p{sc=Hang}|\\p{sc=Hira}|\\p{sc=Kana}","u").test(String.fromCodePoint(e))}_tinySDF(e,o,f){const y=this.localIdeographFontFamily;if(!y||!this._doesCharSupportLocalGlyph(f))return;let w=e.tinySDF;if(!w){let I="400";/bold/i.test(o)?I="900":/medium/i.test(o)?I="500":/light/i.test(o)&&(I="200"),w=e.tinySDF=new Dt.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:y,fontWeight:I})}const S=w.draw(String.fromCharCode(f));return{id:f,bitmap:new c.o({width:S.width||60,height:S.height||60},S.data),metrics:{width:S.glyphWidth/2||24,height:S.glyphHeight/2||24,left:S.glyphLeft/2+.5||0,top:S.glyphTop/2-27.5||-8,advance:S.glyphAdvance/2||24,isDoubleResolution:!0}}}}Dt.loadGlyphRange=function(b,e,o,f){return c._(this,void 0,void 0,function*(){const y=256*e,w=y+255,S=f.transformRequest(o.replace("{fontstack}",b).replace("{range}",`${y}-${w}`),"Glyphs"),I=yield c.l(S,new AbortController);if(!I||!I.data)throw new Error(`Could not load glyph range. range: ${e}, ${y}-${w}`);const P={};for(const j of c.n(I.data))P[j.id]=j;return P})},Dt.TinySDF=class{constructor({fontSize:b=24,buffer:e=3,radius:o=8,cutoff:f=.25,fontFamily:y="sans-serif",fontWeight:w="normal",fontStyle:S="normal"}={}){this.buffer=e,this.cutoff=f,this.radius=o;const I=this.size=b+4*e,P=this._createCanvas(I),j=this.ctx=P.getContext("2d",{willReadFrequently:!0});j.font=`${S} ${w} ${b}px ${y}`,j.textBaseline="alphabetic",j.textAlign="left",j.fillStyle="black",this.gridOuter=new Float64Array(I*I),this.gridInner=new Float64Array(I*I),this.f=new Float64Array(I),this.z=new Float64Array(I+1),this.v=new Uint16Array(I)}_createCanvas(b){const e=document.createElement("canvas");return e.width=e.height=b,e}draw(b){const{width:e,actualBoundingBoxAscent:o,actualBoundingBoxDescent:f,actualBoundingBoxLeft:y,actualBoundingBoxRight:w}=this.ctx.measureText(b),S=Math.ceil(o),I=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(w-y))),P=Math.min(this.size-this.buffer,S+Math.ceil(f)),j=I+2*this.buffer,Z=P+2*this.buffer,Y=Math.max(j*Z,0),H=new Uint8ClampedArray(Y),ee={data:H,width:j,height:Z,glyphWidth:I,glyphHeight:P,glyphTop:S,glyphLeft:0,glyphAdvance:e};if(I===0||P===0)return ee;const{ctx:ie,buffer:me,gridInner:pe,gridOuter:ge}=this;ie.clearRect(me,me,I,P),ie.fillText(b,me,me+S);const be=ie.getImageData(me,me,I,P);ge.fill(bt,0,Y),pe.fill(0,0,Y);for(let Se=0;Se<P;Se++)for(let ke=0;ke<I;ke++){const Re=be.data[4*(Se*I+ke)+3]/255;if(Re===0)continue;const Oe=(Se+me)*j+ke+me;if(Re===1)ge[Oe]=0,pe[Oe]=bt;else{const Pe=.5-Re;ge[Oe]=Pe>0?Pe*Pe:0,pe[Oe]=Pe<0?Pe*Pe:0}}Ot(ge,0,0,j,Z,j,this.f,this.v,this.z),Ot(pe,me,me,I,P,j,this.f,this.v,this.z);for(let Se=0;Se<Y;Se++){const ke=Math.sqrt(ge[Se])-Math.sqrt(pe[Se]);H[Se]=Math.round(255-255*(ke/this.radius+this.cutoff))}return ee}};class vt{constructor(){this.specification=c.v.light.position}possiblyEvaluate(e,o){return c.x(e.expression.evaluate(o))}interpolate(e,o,f){return{x:c.y.number(e.x,o.x,f),y:c.y.number(e.y,o.y,f),z:c.y.number(e.z,o.z,f)}}}let Ge;class dt extends c.E{constructor(e){super(),Ge=Ge||new c.q({anchor:new c.D(c.v.light.anchor),position:new vt,color:new c.D(c.v.light.color),intensity:new c.D(c.v.light.intensity)}),this._transitionable=new c.T(Ge),this.setLight(e),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,o={}){if(!this._validate(c.r,e,o))for(const f in e){const y=e[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),y):this._transitionable.setValue(f,y)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,o,f){return(!f||f.validate!==!1)&&c.t(this,e.call(c.u,{value:o,style:{glyphs:!0,sprite:!0},styleSpec:c.v}))}}const ot=new c.q({"sky-color":new c.D(c.v.sky["sky-color"]),"horizon-color":new c.D(c.v.sky["horizon-color"]),"fog-color":new c.D(c.v.sky["fog-color"]),"fog-ground-blend":new c.D(c.v.sky["fog-ground-blend"]),"horizon-fog-blend":new c.D(c.v.sky["horizon-fog-blend"]),"sky-horizon-blend":new c.D(c.v.sky["sky-horizon-blend"]),"atmosphere-blend":new c.D(c.v.sky["atmosphere-blend"])});class Ut extends c.E{constructor(e){super(),this._transitionable=new c.T(ot),this.setSky(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.z(0))}setSky(e,o={}){if(!this._validate(c.B,e,o)){e||(e={"sky-color":"transparent","horizon-color":"transparent","fog-color":"transparent","fog-ground-blend":1,"atmosphere-blend":0});for(const f in e){const y=e[f];f.endsWith("-transition")?this._transitionable.setTransition(f.slice(0,-11),y):this._transitionable.setValue(f,y)}}}getSky(){return this._transitionable.serialize()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,o,f={}){return(f==null?void 0:f.validate)!==!1&&c.t(this,e.call(c.u,c.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:c.v})))}calculateFogBlendOpacity(e){return e<60?0:e<70?(e-60)/10:1}}class Ie{constructor(e,o){this.width=e,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(e,o){const f=e.join(",")+String(o);return this.dashEntry[f]||(this.dashEntry[f]=this.addDash(e,o)),this.dashEntry[f]}getDashRanges(e,o,f){const y=[];let w=e.length%2==1?-e[e.length-1]*f:0,S=e[0]*f,I=!0;y.push({left:w,right:S,isDash:I,zeroLength:e[0]===0});let P=e[0];for(let j=1;j<e.length;j++){I=!I;const Z=e[j];w=P*f,P+=Z,S=P*f,y.push({left:w,right:S,isDash:I,zeroLength:Z===0})}return y}addRoundDash(e,o,f){const y=o/2;for(let w=-f;w<=f;w++){const S=this.width*(this.nextRow+f+w);let I=0,P=e[I];for(let j=0;j<this.width;j++){j/P.right>1&&(P=e[++I]);const Z=Math.abs(j-P.left),Y=Math.abs(j-P.right),H=Math.min(Z,Y);let ee;const ie=w/f*(y+1);if(P.isDash){const me=y-Math.abs(ie);ee=Math.sqrt(H*H+me*me)}else ee=y-Math.sqrt(H*H+ie*ie);this.data[S+j]=Math.max(0,Math.min(255,ee+128))}}}addRegularDash(e){for(let I=e.length-1;I>=0;--I){const P=e[I],j=e[I+1];P.zeroLength?e.splice(I,1):j&&j.isDash===P.isDash&&(j.left=P.left,e.splice(I,1))}const o=e[0],f=e[e.length-1];o.isDash===f.isDash&&(o.left=f.left-this.width,f.right=o.right+this.width);const y=this.width*this.nextRow;let w=0,S=e[w];for(let I=0;I<this.width;I++){I/S.right>1&&(S=e[++w]);const P=Math.abs(I-S.left),j=Math.abs(I-S.right),Z=Math.min(P,j);this.data[y+I]=Math.max(0,Math.min(255,(S.isDash?Z:-Z)+128))}}addDash(e,o){const f=o?7:0,y=2*f+1;if(this.nextRow+y>this.height)return c.w("LineAtlas out of space"),null;let w=0;for(let I=0;I<e.length;I++)w+=e[I];if(w!==0){const I=this.width/w,P=this.getDashRanges(e,this.width,I);o?this.addRoundDash(P,I,f):this.addRegularDash(P)}const S={y:(this.nextRow+f+.5)/this.height,height:2*f/this.height,width:w};return this.nextRow+=y,this.dirty=!0,S}bind(e){const o=e.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}const ut="maplibre_preloaded_worker_pool";class Bt{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Bt.workerCount;)this.workers.push(new Worker(c.a.WORKER_URL));return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ut]}numActive(){return Object.keys(this.active).length}}const Lt=Math.floor(F.hardwareConcurrency/2);let Tt,jt;function qt(){return Tt||(Tt=new Bt),Tt}Bt.workerCount=c.C(globalThis)?Math.max(Math.min(Lt,3),1):1;class Sn{constructor(e,o){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=o;const f=this.workerPool.acquire(o);for(let y=0;y<f.length;y++){const w=new c.F(f[y],o);w.name=`Worker ${y}`,this.actors.push(w)}if(!this.actors.length)throw new Error("No actors found")}broadcast(e,o){const f=[];for(const y of this.actors)f.push(y.sendAsync({type:e,data:o}));return Promise.all(f)}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(e=!0){this.actors.forEach(o=>{o.remove()}),this.actors=[],e&&this.workerPool.release(this.id)}registerMessageHandler(e,o){for(const f of this.actors)f.registerMessageHandler(e,o)}}function dn(){return jt||(jt=new Sn(qt(),c.G),jt.registerMessageHandler("GR",(b,e,o)=>c.m(e,o))),jt}function An(b,e){const o=c.H();return c.J(o,o,[1,1,0]),c.K(o,o,[.5*b.width,.5*b.height,1]),b.calculatePosMatrix?c.L(o,o,b.calculatePosMatrix(e.toUnwrapped())):o}function Un(b,e,o,f,y,w){var S;const I=function(Y,H,ee){if(Y)for(const ie of Y){const me=H[ie];if(me&&me.source===ee&&me.type==="fill-extrusion")return!0}else for(const ie in H){const me=H[ie];if(me.source===ee&&me.type==="fill-extrusion")return!0}return!1}((S=y==null?void 0:y.layers)!==null&&S!==void 0?S:null,e,b.id),P=w.maxPitchScaleFactor(),j=b.tilesIn(f,P,I);j.sort(Wn);const Z=[];for(const Y of j)Z.push({wrappedTileID:Y.tileID.wrapped().key,queryResults:Y.tile.queryRenderedFeatures(e,o,b._state,Y.queryGeometry,Y.cameraQueryGeometry,Y.scale,y,w,P,An(b.transform,Y.tileID))});return function(Y,H){for(const ee in Y)for(const ie of Y[ee])ai(ie,H);return Y}(function(Y){const H={},ee={};for(const ie of Y){const me=ie.queryResults,pe=ie.wrappedTileID,ge=ee[pe]=ee[pe]||{};for(const be in me){const Se=me[be],ke=ge[be]=ge[be]||{},Re=H[be]=H[be]||[];for(const Oe of Se)ke[Oe.featureIndex]||(ke[Oe.featureIndex]=!0,Re.push(Oe))}}return H}(Z),b)}function Wn(b,e){const o=b.tileID,f=e.tileID;return o.overscaledZ-f.overscaledZ||o.canonical.y-f.canonical.y||o.wrap-f.wrap||o.canonical.x-f.canonical.x}function ai(b,e){const o=b.feature,f=e.getFeatureState(o.layer["source-layer"],o.id);o.source=o.layer.source,o.layer["source-layer"]&&(o.sourceLayer=o.layer["source-layer"]),o.state=f}function Ni(b,e,o){return c._(this,void 0,void 0,function*(){let f=b;if(b.url?f=(yield c.h(e.transformRequest(b.url,"Source"),o)).data:yield F.frameAsync(o),!f)return null;const y=c.M(c.e(f,b),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);return"vector_layers"in f&&f.vector_layers&&(y.vectorLayerIds=f.vector_layers.map(w=>w.id)),y})}class ci{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):Array.isArray(e)&&(e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1])))}setNorthEast(e){return this._ne=e instanceof c.N?new c.N(e.lng,e.lat):c.N.convert(e),this}setSouthWest(e){return this._sw=e instanceof c.N?new c.N(e.lng,e.lat):c.N.convert(e),this}extend(e){const o=this._sw,f=this._ne;let y,w;if(e instanceof c.N)y=e,w=e;else{if(!(e instanceof ci))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(ci.convert(e)):this.extend(c.N.convert(e)):e&&("lng"in e||"lon"in e)&&"lat"in e?this.extend(c.N.convert(e)):this;if(y=e._sw,w=e._ne,!y||!w)return this}return o||f?(o.lng=Math.min(y.lng,o.lng),o.lat=Math.min(y.lat,o.lat),f.lng=Math.max(w.lng,f.lng),f.lat=Math.max(w.lat,f.lat)):(this._sw=new c.N(y.lng,y.lat),this._ne=new c.N(w.lng,w.lat)),this}getCenter(){return new c.N((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new c.N(this.getWest(),this.getNorth())}getSouthEast(){return new c.N(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:f}=c.N.convert(e);let y=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(y=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=f&&f<=this._ne.lat&&y}static convert(e){return e instanceof ci?e:e&&new ci(e)}static fromLngLat(e,o=0){const f=360*o/40075017,y=f/Math.cos(Math.PI/180*e.lat);return new ci(new c.N(e.lng-y,e.lat-f),new c.N(e.lng+y,e.lat+f))}adjustAntiMeridian(){const e=new c.N(this._sw.lng,this._sw.lat),o=new c.N(this._ne.lng,this._ne.lat);return new ci(e,e.lng>o.lng?new c.N(o.lng+360,o.lat):o)}}class Jn{constructor(e,o,f){this.bounds=ci.convert(this.validateBounds(e)),this.minzoom=o||0,this.maxzoom=f||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const o=Math.pow(2,e.z),f=Math.floor(c.O(this.bounds.getWest())*o),y=Math.floor(c.Q(this.bounds.getNorth())*o),w=Math.ceil(c.O(this.bounds.getEast())*o),S=Math.ceil(c.Q(this.bounds.getSouth())*o);return e.x>=f&&e.x<w&&e.y>=y&&e.y<S}}class Xr extends c.E{constructor(e,o,f,y){if(super(),this.id=e,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,c.e(this,c.M(o,["url","scheme","tileSize","promoteId"])),this._options=c.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const e=yield Ni(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),e&&(c.e(this,e),e.bounds&&(this.tileBounds=new Jn(e.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})))}catch(e){this._tileJSONRequest=null,this.fire(new c.j(e))}})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}setSourceProperty(e){this._tileJSONRequest&&this._tileJSONRequest.abort(),e(),this.load()}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}serialize(){return c.e({},this._options)}loadTile(e){return c._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f={request:this.map._requestManager.transformRequest(o,"Tile"),uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};f.request.collectResourceTiming=this._collectResourceTiming;let y="RT";if(e.actor&&e.state!=="expired"){if(e.state==="loading")return new Promise((w,S)=>{e.reloadPromise={resolve:w,reject:S}})}else e.actor=this.dispatcher.getActor(),y="LT";e.abortController=new AbortController;try{const w=yield e.actor.sendAsync({type:y,data:f},e.abortController);if(delete e.abortController,e.aborted)return;this._afterTileLoadWorkerResponse(e,w)}catch(w){if(delete e.abortController,e.aborted)return;if(w&&w.status!==404)throw w;this._afterTileLoadWorkerResponse(e,null)}})}_afterTileLoadWorkerResponse(e,o){if(o&&o.resourceTiming&&(e.resourceTiming=o.resourceTiming),o&&this.map._refreshExpiredTiles&&e.setExpiryData(o),e.loadVectorData(o,this.map.painter),e.reloadPromise){const f=e.reloadPromise;e.reloadPromise=null,this.loadTile(e).then(f.resolve).catch(f.reject)}}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.actor&&(yield e.actor.sendAsync({type:"AT",data:{uid:e.uid,type:this.type,source:this.id}}))})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),e.actor&&(yield e.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}}))})}hasTransition(){return!1}}class kr extends c.E{constructor(e,o,f,y){super(),this.id=e,this.dispatcher=f,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=c.e({type:"raster"},o),c.e(this,c.M(o,["url","scheme","tileSize"]))}load(){return c._(this,arguments,void 0,function*(e=!1){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this._tileJSONRequest=new AbortController;try{const o=yield Ni(this._options,this.map._requestManager,this._tileJSONRequest);this._tileJSONRequest=null,this._loaded=!0,o&&(c.e(this,o),o.bounds&&(this.tileBounds=new Jn(o.bounds,this.minzoom,this.maxzoom)),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new c.k("data",{dataType:"source",sourceDataType:"content",sourceDataChanged:e})))}catch(o){this._tileJSONRequest=null,this.fire(new c.j(o))}})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null)}setSourceProperty(e){this._tileJSONRequest&&(this._tileJSONRequest.abort(),this._tileJSONRequest=null),e(),this.load(!0)}setTiles(e){return this.setSourceProperty(()=>{this._options.tiles=e}),this}setUrl(e){return this.setSourceProperty(()=>{this.url=e,this._options.url=e}),this}serialize(){return c.e({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e){return c._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);e.abortController=new AbortController;try{const f=yield Me.getImage(this.map._requestManager.transformRequest(o,"Tile"),e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(f&&f.data){this.map._refreshExpiredTiles&&f.cacheControl&&f.expires&&e.setExpiryData({cacheControl:f.cacheControl,expires:f.expires});const y=this.map.painter.context,w=y.gl,S=f.data;e.texture=this.map.painter.getTileTexture(S.width),e.texture?e.texture.update(S,{useMipmap:!0}):(e.texture=new je(y,S,w.RGBA,{useMipmap:!0}),e.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE,w.LINEAR_MIPMAP_NEAREST)),e.state="loaded"}}catch(f){if(delete e.abortController,e.aborted)e.state="unloaded";else if(f)throw e.state="errored",f}})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController)})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.texture&&this.map.painter.saveTileTexture(e.texture)})}hasTransition(){return!1}}class eo extends kr{constructor(e,o,f,y){super(e,o,f,y),this.type="raster-dem",this.maxzoom=22,this._options=c.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(e){return c._(this,void 0,void 0,function*(){const o=e.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),f=this.map._requestManager.transformRequest(o,"Tile");e.neighboringTiles=this._getNeighboringTiles(e.tileID),e.abortController=new AbortController;try{const y=yield Me.getImage(f,e.abortController,this.map._refreshExpiredTiles);if(delete e.abortController,e.aborted)return void(e.state="unloaded");if(y&&y.data){const w=y.data;this.map._refreshExpiredTiles&&y.cacheControl&&y.expires&&e.setExpiryData({cacheControl:y.cacheControl,expires:y.expires});const S=c.b(w)&&c.U()?w:yield this.readImageNow(w),I={type:this.type,uid:e.uid,source:this.id,rawImageData:S,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};if(!e.actor||e.state==="expired"){e.actor=this.dispatcher.getActor();const P=yield e.actor.sendAsync({type:"LDT",data:I});e.dem=P,e.needsHillshadePrepare=!0,e.needsTerrainPrepare=!0,e.state="loaded"}}}catch(y){if(delete e.abortController,e.aborted)e.state="unloaded";else if(y)throw e.state="errored",y}})}readImageNow(e){return c._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&c.V()){const o=e.width+2,f=e.height+2;try{return new c.R({width:o,height:f},yield c.W(e,-1,-1,o,f))}catch{}}return F.getImageData(e,1)})}_getNeighboringTiles(e){const o=e.canonical,f=Math.pow(2,o.z),y=(o.x-1+f)%f,w=o.x===0?e.wrap-1:e.wrap,S=(o.x+1+f)%f,I=o.x+1===f?e.wrap+1:e.wrap,P={};return P[new c.S(e.overscaledZ,w,o.z,y,o.y).key]={backfilled:!1},P[new c.S(e.overscaledZ,I,o.z,S,o.y).key]={backfilled:!1},o.y>0&&(P[new c.S(e.overscaledZ,w,o.z,y,o.y-1).key]={backfilled:!1},P[new c.S(e.overscaledZ,e.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},P[new c.S(e.overscaledZ,I,o.z,S,o.y-1).key]={backfilled:!1}),o.y+1<f&&(P[new c.S(e.overscaledZ,w,o.z,y,o.y+1).key]={backfilled:!1},P[new c.S(e.overscaledZ,e.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},P[new c.S(e.overscaledZ,I,o.z,S,o.y+1).key]={backfilled:!1}),P}unloadTile(e){return c._(this,void 0,void 0,function*(){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded",e.actor&&(yield e.actor.sendAsync({type:"RDT",data:{type:this.type,uid:e.uid,source:this.id}}))})}}class Co extends c.E{constructor(e,o,f,y){super(),this.id=e,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=f.getActor(),this.setEventedParent(y),this._data=o.data,this._options=c.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId,o.clusterMaxZoom!==void 0&&this.maxzoom<=o.clusterMaxZoom&&c.w(`The maxzoom value "${this.maxzoom}" is expected to be greater than the clusterMaxZoom value "${o.clusterMaxZoom}".`),this.workerOptions=c.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:this._pixelsToTileUnits(o.buffer!==void 0?o.buffer:128),tolerance:this._pixelsToTileUnits(o.tolerance!==void 0?o.tolerance:.375),extent:c.X,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:c.X,radius:this._pixelsToTileUnits(o.clusterRadius||50),log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}_pixelsToTileUnits(e){return e*(c.X/this.tileSize)}load(){return c._(this,void 0,void 0,function*(){yield this._updateWorkerData()})}onAdd(e){this.map=e,this.load()}setData(e){return this._data=e,this._updateWorkerData(),this}updateData(e){return this._updateWorkerData(e),this}getData(){return c._(this,void 0,void 0,function*(){const e=c.e({type:this.type},this.workerOptions);return this.actor.sendAsync({type:"GD",data:e})})}setClusterOptions(e){return this.workerOptions.cluster=e.cluster,e&&(e.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=this._pixelsToTileUnits(e.clusterRadius)),e.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=e.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(e){return this.actor.sendAsync({type:"GCEZ",data:{type:this.type,clusterId:e,source:this.id}})}getClusterChildren(e){return this.actor.sendAsync({type:"GCC",data:{type:this.type,clusterId:e,source:this.id}})}getClusterLeaves(e,o,f){return this.actor.sendAsync({type:"GCL",data:{type:this.type,source:this.id,clusterId:e,limit:o,offset:f}})}_updateWorkerData(e){return c._(this,void 0,void 0,function*(){const o=c.e({type:this.type},this.workerOptions);e?o.dataDiff=e:typeof this._data=="string"?(o.request=this.map._requestManager.transformRequest(F.resolveURL(this._data),"Source"),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new c.k("dataloading",{dataType:"source"}));try{const f=yield this.actor.sendAsync({type:"LD",data:o});if(this._pendingLoads--,this._removed||f.abandoned)return void this.fire(new c.k("dataabort",{dataType:"source"}));let y=null;f.resourceTiming&&f.resourceTiming[this.id]&&(y=f.resourceTiming[this.id].slice(0));const w={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&c.e(w,{resourceTiming:y}),this.fire(new c.k("data",Object.assign(Object.assign({},w),{sourceDataType:"metadata"}))),this.fire(new c.k("data",Object.assign(Object.assign({},w),{sourceDataType:"content"})))}catch(f){if(this._pendingLoads--,this._removed)return void this.fire(new c.k("dataabort",{dataType:"source"}));this.fire(new c.j(f))}})}loaded(){return this._pendingLoads===0}loadTile(e){return c._(this,void 0,void 0,function*(){const o=e.actor?"RT":"LT";e.actor=this.actor;const f={type:this.type,uid:e.uid,tileID:e.tileID,zoom:e.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,subdivisionGranularity:this.map.style.projection.subdivisionGranularity};e.abortController=new AbortController;const y=yield this.actor.sendAsync({type:o,data:f},e.abortController);delete e.abortController,e.unloadVectorData(),e.aborted||e.loadVectorData(y,this.map.painter,o==="RT")})}abortTile(e){return c._(this,void 0,void 0,function*(){e.abortController&&(e.abortController.abort(),delete e.abortController),e.aborted=!0})}unloadTile(e){return c._(this,void 0,void 0,function*(){e.unloadVectorData(),yield this.actor.sendAsync({type:"RMT",data:{uid:e.uid,type:this.type,source:this.id}})})}onRemove(){this._removed=!0,this.actor.sendAsync({type:"RS",data:{type:this.type,source:this.id}})}serialize(){return c.e({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}class ar extends c.E{constructor(e,o,f,y){super(),this.flippedWindingOrder=!1,this.id=e,this.dispatcher=f,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=o}load(e){return c._(this,void 0,void 0,function*(){this._loaded=!1,this.fire(new c.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=new AbortController;try{const o=yield Me.getImage(this.map._requestManager.transformRequest(this.url,"Image"),this._request);this._request=null,this._loaded=!0,o&&o.data&&(this.image=o.data,e&&(this.coordinates=e),this._finishLoading())}catch(o){this._request=null,this._loaded=!0,this.fire(new c.j(o))}})}loaded(){return this._loaded}updateImage(e){return e.url?(this._request&&(this._request.abort(),this._request=null),this.options.url=e.url,this.load(e.coordinates).finally(()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new c.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._request&&(this._request.abort(),this._request=null)}setCoordinates(e){this.coordinates=e;const o=e.map(c.Y.fromLngLat);var f;return this.tileID=function(y){let w=1/0,S=1/0,I=-1/0,P=-1/0;for(const H of y)w=Math.min(w,H.x),S=Math.min(S,H.y),I=Math.max(I,H.x),P=Math.max(P,H.y);const j=Math.max(I-w,P-S),Z=Math.max(0,Math.floor(-Math.log(j)/Math.LN2)),Y=Math.pow(2,Z);return new c.Z(Z,Math.floor((w+I)/2*Y),Math.floor((S+P)/2*Y))}(o),this.minzoom=this.maxzoom=this.tileID.z,this.tileCoords=o.map(y=>this.tileID.getTilePoint(y)._round()),this.flippedWindingOrder=((f=this.tileCoords)[1].x-f[0].x)*(f[2].y-f[0].y)-(f[1].y-f[0].y)*(f[2].x-f[0].x)<0,this.fire(new c.k("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,o=e.gl;this.texture||(this.texture=new je(e,this.image,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let f=!1;for(const y in this.tiles){const w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(e){return c._(this,void 0,void 0,function*(){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={}):e.state="errored"})}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class ja extends ar{constructor(e,o,f,y){super(e,o,f,y),this.roundZoom=!0,this.type="video",this.options=o}load(){return c._(this,void 0,void 0,function*(){this._loaded=!1;const e=this.options;this.urls=[];for(const o of e.urls)this.urls.push(this.map._requestManager.transformRequest(o,"Source").url);try{const o=yield c.a0(this.urls);if(this._loaded=!0,!o)return;this.video=o,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading()}catch(o){this.fire(new c.j(o))}})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(e){if(this.video){const o=this.video.seekable;e<o.start(0)||e>o.end(0)?this.fire(new c.j(new c.$(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=e}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const e=this.map.painter.context,o=e.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new je(e,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE));let f=!1;for(const y in this.tiles){const w=this.tiles[y];w.state!=="loaded"&&(w.state="loaded",w.texture=this.texture,f=!0)}f&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class xs extends ar{constructor(e,o,f,y){super(e,o,f,y),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(S=>typeof S!="number"))||this.fire(new c.j(new c.$(`sources.${e}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new c.j(new c.$(`sources.${e}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new c.j(new c.$(`sources.${e}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new c.j(new c.$(`sources.${e}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new c.j(new c.$(`sources.${e}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){return c._(this,void 0,void 0,function*(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new c.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())})}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let e=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,e=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,e=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context,f=o.gl;this.texture?(e||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new je(o,this.canvas,f.RGBA,{premultiply:!0});let y=!1;for(const w in this.tiles){const S=this.tiles[w];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture,y=!0)}y&&this.fire(new c.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}}const Wo={},Wr=b=>{switch(b){case"geojson":return Co;case"image":return ar;case"raster":return kr;case"raster-dem":return eo;case"vector":return Xr;case"video":return ja;case"canvas":return xs}return Wo[b]},ws="RTLPluginLoaded";class to extends c.E{constructor(){super(...arguments),this.status="unavailable",this.url=null,this.dispatcher=dn()}_syncState(e){return this.status=e,this.dispatcher.broadcast("SRPS",{pluginStatus:e,pluginURL:this.url}).catch(o=>{throw this.status="error",o})}getRTLTextPluginStatus(){return this.status}clearRTLTextPlugin(){this.status="unavailable",this.url=null}setRTLTextPlugin(e){return c._(this,arguments,void 0,function*(o,f=!1){if(this.url)throw new Error("setRTLTextPlugin cannot be called multiple times.");if(this.url=F.resolveURL(o),!this.url)throw new Error(`requested url ${o} is invalid`);if(this.status==="unavailable"){if(!f)return this._requestImport();this.status="deferred",this._syncState(this.status)}else if(this.status==="requested")return this._requestImport()})}_requestImport(){return c._(this,void 0,void 0,function*(){yield this._syncState("loading"),this.status="loaded",this.fire(new c.k(ws))})}lazyLoad(){this.status==="unavailable"?this.status="requested":this.status==="deferred"&&this._requestImport()}}let Qo=null;function Ea(){return Qo||(Qo=new to),Qo}class ac{constructor(e,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=e,this.uid=c.a1(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const o=e+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(e){this.demTexture&&e.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(e,o,f){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(y,w){const S={};if(!w)return S;for(const I of y){const P=I.layerIds.map(j=>w.getLayer(j)).filter(Boolean);if(P.length!==0){I.layers=P,I.stateDependentLayerIds&&(I.stateDependentLayers=I.stateDependentLayerIds.map(j=>P.filter(Z=>Z.id===j)[0]));for(const j of P)S[j.id]=I}}return S}(e.buckets,o==null?void 0:o.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const w=this.buckets[y];if(w instanceof c.a3){if(this.hasSymbolBuckets=!0,!f)break;w.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const w=this.buckets[y];if(w instanceof c.a3&&w.hasRTLText){this.hasRTLText=!0,Ea().lazyLoad();break}}this.queryPadding=0;for(const y in this.buckets){const w=this.buckets[y];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(y).queryRadius(w))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new c.a2}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const f in this.buckets){const y=this.buckets[f];y.uploadPending()&&y.upload(e)}const o=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new je(e,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new je(e,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,o,f,y,w,S,I,P,j,Z){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:y,cameraQueryGeometry:w,scale:S,tileSize:this.tileSize,pixelPosMatrix:Z,transform:P,params:I,queryPadding:this.queryPadding*j},e,o,f):{}}querySourceFeatures(e,o){const f=this.latestFeatureIndex;if(!f||!f.rawTileData)return;const y=f.loadVTLayers(),w=o&&o.sourceLayer?o.sourceLayer:"",S=y._geojsonTileLayer||y[w];if(!S)return;const I=c.a4(o&&o.filter),{z:P,x:j,y:Z}=this.tileID.canonical,Y={z:P,x:j,y:Z};for(let H=0;H<S.length;H++){const ee=S.feature(H);if(I.needGeometry){const pe=c.a5(ee,!0);if(!I.filter(new c.z(this.tileID.overscaledZ),pe,this.tileID.canonical))continue}else if(!I.filter(new c.z(this.tileID.overscaledZ),ee))continue;const ie=f.getId(ee,w),me=new c.a6(ee,P,j,Z,ie);me.tile=Y,e.push(me)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const o=this.expirationTime;if(e.cacheControl){const f=c.a7(e.cacheControl);f["max-age"]&&(this.expirationTime=Date.now()+1e3*f["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const f=Date.now();let y=!1;if(this.expirationTime>f)y=!1;else if(o)if(this.expirationTime<o)y=!0;else{const w=this.expirationTime-o;w?this.expirationTime=f+Math.max(w,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(e).length===0)return;const f=this.latestFeatureIndex.loadVTLayers();for(const y in this.buckets){if(!o.style.hasLayer(y))continue;const w=this.buckets[y],S=w.layers[0].sourceLayer||"_geojsonTileLayer",I=f[S],P=e[S];if(!I||!P||Object.keys(P).length===0)continue;w.update(P,I,this.imageAtlas&&this.imageAtlas.patternPositions||{});const j=o&&o.style&&o.style.getLayer(y);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<F.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=F.now()+e}setDependencies(e,o){const f={};for(const y of o)f[y]=!0;this.dependencies[e]=f}hasDependency(e,o){for(const f of e){const y=this.dependencies[f];if(y){for(const w of o)if(y[w])return!0}}return!1}}class Gs{constructor(e,o){this.max=e,this.onRemove=o,this.reset()}reset(){for(const e in this.data)for(const o of this.data[e])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(e,o,f){const y=e.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const w={value:o,timeout:void 0};if(f!==void 0&&(w.timeout=setTimeout(()=>{this.remove(e,w)},f)),this.data[y].push(w),this.order.push(y),this.order.length>this.max){const S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const o=this.data[e].shift();return o.timeout&&clearTimeout(o.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),o.value}getByKey(e){const o=this.data[e];return o?o[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,o){if(!this.has(e))return this;const f=e.wrapped().key,y=o===void 0?0:this.data[f].indexOf(o),w=this.data[f][y];return this.data[f].splice(y,1),w.timeout&&clearTimeout(w.timeout),this.data[f].length===0&&delete this.data[f],this.onRemove(w.value),this.order.splice(this.order.indexOf(f),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(e){const o=[];for(const f in this.data)for(const y of this.data[f])e(y.value)||o.push(y);for(const f of o)this.remove(f.value.tileID,f)}}class tu{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,o,f){const y=String(o);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][y]=this.stateChanges[e][y]||{},c.e(this.stateChanges[e][y],f),this.deletedStates[e]===null){this.deletedStates[e]={};for(const w in this.state[e])w!==y&&(this.deletedStates[e][w]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][y]===null){this.deletedStates[e][y]={};for(const w in this.state[e][y])f[w]||(this.deletedStates[e][y][w]=null)}else for(const w in f)this.deletedStates[e]&&this.deletedStates[e][y]&&this.deletedStates[e][y][w]===null&&delete this.deletedStates[e][y][w]}removeFeatureState(e,o,f){if(this.deletedStates[e]===null)return;const y=String(o);if(this.deletedStates[e]=this.deletedStates[e]||{},f&&o!==void 0)this.deletedStates[e][y]!==null&&(this.deletedStates[e][y]=this.deletedStates[e][y]||{},this.deletedStates[e][y][f]=null);else if(o!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][y])for(f in this.deletedStates[e][y]={},this.stateChanges[e][y])this.deletedStates[e][y][f]=null;else this.deletedStates[e][y]=null;else this.deletedStates[e]=null}getState(e,o){const f=String(o),y=c.e({},(this.state[e]||{})[f],(this.stateChanges[e]||{})[f]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const w=this.deletedStates[e][o];if(w===null)return{};for(const S in w)delete y[S]}return y}initializeTileState(e,o){e.setFeatureState(this.state,o)}coalesceChanges(e,o){const f={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const w={};for(const S in this.stateChanges[y])this.state[y][S]||(this.state[y][S]={}),c.e(this.state[y][S],this.stateChanges[y][S]),w[S]=this.state[y][S];f[y]=w}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const w={};if(this.deletedStates[y]===null)for(const S in this.state[y])w[S]={},this.state[y][S]={};else for(const S in this.deletedStates[y]){if(this.deletedStates[y][S]===null)this.state[y][S]={};else for(const I of Object.keys(this.deletedStates[y][S]))delete this.state[y][S][I];w[S]=this.state[y][S]}f[y]=f[y]||{},c.e(f[y],w)}if(this.stateChanges={},this.deletedStates={},Object.keys(f).length!==0)for(const y in e)e[y].setFeatureState(f,o)}}function nu(b,e,o){const f=e.intersectsFrustum(b);if(!o)return f;const y=e.intersectsPlane(o);return f===0||y===0?0:f===2&&y===2?2:1}function Zs(b,e,o,f,y){let w=b;const S=Math.atan(e/o),I=Math.hypot(e,o);return w=b+c.a8(f/I/Math.max(.5,Math.cos(c.aa(y/2)))),w+=1*c.a8(Math.cos(S))/2,w+=c.ab(b-w,-0,0),w}function Rr(b,e){const o=(e.roundZoom?Math.round:Math.floor)(b.zoom+c.a8(b.tileSize/e.tileSize));return Math.max(0,o)}function de(b,e){const o=b.getCameraFrustum(),f=b.getClippingPlane(),y=b.screenPointToMercatorCoordinate(b.getCameraPoint()),w=c.Y.fromLngLat(b.center,b.elevation);y.z=w.z+Math.cos(b.pitchInRadians)*b.cameraToCenterDistance/b.worldSize;const S=b.getCoveringTilesDetailsProvider(),I=S.allowVariableZoom(b,e),P=Rr(b,e),j=e.minzoom||0,Z=e.maxzoom!==void 0?e.maxzoom:b.maxZoom,Y=Math.min(Math.max(0,P),Z),H=Math.pow(2,Y),ee=[H*y.x,H*y.y,0],ie=[H*w.x,H*w.y,0],me=Math.hypot(w.x-y.x,w.y-y.y),pe=Math.abs(w.z-y.z),ge=Math.hypot(me,pe),be=Re=>({zoom:0,x:0,y:0,wrap:Re,fullyVisible:!1}),Se=[],ke=[];if(b.renderWorldCopies&&S.allowWorldCopies())for(let Re=1;Re<=3;Re++)Se.push(be(-Re)),Se.push(be(Re));for(Se.push(be(0));Se.length>0;){const Re=Se.pop(),Oe=Re.x,Pe=Re.y;let He=Re.fullyVisible;const Ke={x:Oe,y:Pe,z:Re.zoom},st=S.getTileAABB(Ke,Re.wrap,b.elevation,e);if(!He){const Mt=nu(o,st,f);if(Mt===0)continue;He=Mt===2}const ht=S.distanceToTile2d(y.x,y.y,Ke,st);let nt=P;I&&(nt=(e.calculateTileZoom||Zs)(b.zoom+c.a8(b.tileSize/e.tileSize),ht,pe,ge,b.fov)),nt=(e.roundZoom?Math.round:Math.floor)(nt),nt=Math.max(0,nt);const kt=Math.min(nt,Z);if(Re.wrap=S.getWrap(w,Ke,Re.wrap),Re.zoom>=kt){if(Re.zoom<j)continue;const Mt=Y-Re.zoom,gt=ee[0]-.5-(Oe<<Mt),zt=ee[1]-.5-(Pe<<Mt),gn=e.reparseOverscaled?Math.max(Re.zoom,nt):Re.zoom;ke.push({tileID:new c.S(Re.zoom===Z?gn:Re.zoom,Re.wrap,Re.zoom,Oe,Pe),distanceSq:c.a9([ie[0]-.5-Oe,ie[1]-.5-Pe]),tileDistanceToCamera:Math.sqrt(gt*gt+zt*zt)})}else for(let Mt=0;Mt<4;Mt++)Se.push({zoom:Re.zoom+1,x:(Oe<<1)+Mt%2,y:(Pe<<1)+(Mt>>1),wrap:Re.wrap,fullyVisible:He})}return ke.sort((Re,Oe)=>Re.distanceSq-Oe.distanceSq).map(Re=>Re.tileID)}class te extends c.E{constructor(e,o,f){super(),this.id=e,this.dispatcher=f,this.on("data",y=>this._dataHandler(y)),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((y,w,S,I)=>{const P=new(Wr(w.type))(y,w,S,I);if(P.id!==y)throw new Error(`Expected Source id to be ${y} instead of ${P.id}`);return P})(e,o,f,this),this._tiles={},this._cache=new Gs(0,y=>this._unloadTile(y)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new tu,this._didEmitContent=!1,this._updated=!1}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null,this._maxTileCacheZoomLevels=e?e._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(e)}onRemove(e){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(e)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const e in this._tiles){const o=this._tiles[e];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(e,o,f){return c._(this,void 0,void 0,function*(){try{yield this._source.loadTile(e),this._tileLoaded(e,o,f)}catch(y){e.state="errored",y.status!==404?this._source.fire(new c.j(y,{tile:e})):this.update(this.transform,this.terrain)}})}_unloadTile(e){this._source.unloadTile&&this._source.unloadTile(e)}_abortTile(e){this._source.abortTile&&this._source.abortTile(e),this._source.fire(new c.k("dataabort",{tile:e,coord:e.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const f=this._tiles[o];f.upload(e),f.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(e=>e.tileID).sort(re).map(e=>e.key)}getRenderableIds(e){const o=[];for(const f in this._tiles)this._isIdRenderable(f,e)&&o.push(this._tiles[f]);return e?o.sort((f,y)=>{const w=f.tileID,S=y.tileID,I=new c.P(w.canonical.x,w.canonical.y)._rotate(-this.transform.bearingInRadians),P=new c.P(S.canonical.x,S.canonical.y)._rotate(-this.transform.bearingInRadians);return w.overscaledZ-S.overscaledZ||P.y-I.y||P.x-I.x}).map(f=>f.tileID.key):o.map(f=>f.tileID).sort(re).map(f=>f.key)}hasRenderableParent(e){const o=this.findLoadedParent(e,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(e,o){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(o||!this._tiles[e].holdingForFade())}reload(e){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)(e||this._tiles[o].state!=="errored")&&this._reloadTile(o,"reloading")}}_reloadTile(e,o){return c._(this,void 0,void 0,function*(){const f=this._tiles[e];f&&(f.state!=="loading"&&(f.state=o),yield this._loadTile(f,e,o))})}_tileLoaded(e,o,f){e.timeAdded=F.now(),f==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(o,e),this.getSource().type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),e.aborted||this._source.fire(new c.k("data",{dataType:"source",tile:e,coord:e.tileID}))}_backfillDEM(e){const o=this.getRenderableIds();for(let y=0;y<o.length;y++){const w=o[y];if(e.neighboringTiles&&e.neighboringTiles[w]){const S=this.getTileByID(w);f(e,S),f(S,e)}}function f(y,w){y.needsHillshadePrepare=!0,y.needsTerrainPrepare=!0;let S=w.tileID.canonical.x-y.tileID.canonical.x;const I=w.tileID.canonical.y-y.tileID.canonical.y,P=Math.pow(2,y.tileID.canonical.z),j=w.tileID.key;S===0&&I===0||Math.abs(I)>1||(Math.abs(S)>1&&(Math.abs(S+P)===1?S+=P:Math.abs(S-P)===1&&(S-=P)),w.dem&&y.dem&&(y.dem.backfillBorder(w.dem,S,I),y.neighboringTiles&&y.neighboringTiles[j]&&(y.neighboringTiles[j].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,o,f,y){for(const w in this._tiles){let S=this._tiles[w];if(y[w]||!S.hasData()||S.tileID.overscaledZ<=o||S.tileID.overscaledZ>f)continue;let I=S.tileID;for(;S&&S.tileID.overscaledZ>o+1;){const j=S.tileID.scaledTo(S.tileID.overscaledZ-1);S=this._tiles[j.key],S&&S.hasData()&&(I=j)}let P=I;for(;P.overscaledZ>o;)if(P=P.scaledTo(P.overscaledZ-1),e[P.key]||e[P.canonical.key]){y[I.key]=I;break}}}findLoadedParent(e,o){if(e.key in this._loadedParentTiles){const f=this._loadedParentTiles[e.key];return f&&f.tileID.overscaledZ>=o?f:null}for(let f=e.overscaledZ-1;f>=o;f--){const y=e.scaledTo(f),w=this._getLoadedTile(y);if(w)return w}}findLoadedSibling(e){return this._getLoadedTile(e)}_getLoadedTile(e){const o=this._tiles[e.key];return o&&o.hasData()?o:this._cache.getByKey(e.wrapped().key)}updateCacheSize(e){const o=Math.ceil(e.width/this._source.tileSize)+1,f=Math.ceil(e.height/this._source.tileSize)+1,y=Math.floor(o*f*(this._maxTileCacheZoomLevels===null?c.a.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),w=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(w)}handleWrapJump(e){const o=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,o){const f={};for(const y in this._tiles){const w=this._tiles[y];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+o),f[w.tileID.key]=w}this._tiles=f;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(y,this._tiles[y])}}_updateCoveredAndRetainedTiles(e,o,f,y,w,S){const I={},P={},j=Object.keys(e),Z=F.now();for(const Y of j){const H=e[Y],ee=this._tiles[Y];if(!ee||ee.fadeEndTime!==0&&ee.fadeEndTime<=Z)continue;const ie=this.findLoadedParent(H,o),me=this.findLoadedSibling(H),pe=ie||me||null;pe&&(this._addTile(pe.tileID),I[pe.tileID.key]=pe.tileID),P[Y]=H}this._retainLoadedChildren(P,y,f,e);for(const Y in I)e[Y]||(this._coveredTiles[Y]=!0,e[Y]=I[Y]);if(S){const Y={},H={};for(const ee of w)this._tiles[ee.key].hasData()?Y[ee.key]=ee:H[ee.key]=ee;for(const ee in H){const ie=H[ee].children(this._source.maxzoom);this._tiles[ie[0].key]&&this._tiles[ie[1].key]&&this._tiles[ie[2].key]&&this._tiles[ie[3].key]&&(Y[ie[0].key]=e[ie[0].key]=ie[0],Y[ie[1].key]=e[ie[1].key]=ie[1],Y[ie[2].key]=e[ie[2].key]=ie[2],Y[ie[3].key]=e[ie[3].key]=ie[3],delete H[ee])}for(const ee in H){const ie=H[ee],me=this.findLoadedParent(ie,this._source.minzoom),pe=this.findLoadedSibling(ie),ge=me||pe||null;if(ge){Y[ge.tileID.key]=e[ge.tileID.key]=ge.tileID;for(const be in Y)Y[be].isChildOf(ge.tileID)&&delete Y[be]}}for(const ee in this._tiles)Y[ee]||(this._coveredTiles[ee]=!0)}}update(e,o){if(!this._sourceLoaded||this._paused)return;let f;this.transform=e,this.terrain=o,this.updateCacheSize(e),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(Z=>new c.S(Z.canonical.z,Z.wrap,Z.canonical.z,Z.canonical.x,Z.canonical.y)):(f=de(e,{tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o,calculateTileZoom:this._source.calculateTileZoom}),this._source.hasTile&&(f=f.filter(Z=>this._source.hasTile(Z)))):f=[];const y=Rr(e,this._source),w=Math.max(y-te.maxOverzooming,this._source.minzoom),S=Math.max(y+te.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const Z={};for(const Y of f)if(Y.canonical.z>this._source.minzoom){const H=Y.scaledTo(Y.canonical.z-1);Z[H.key]=H;const ee=Y.scaledTo(Math.max(this._source.minzoom,Math.min(Y.canonical.z,5)));Z[ee.key]=ee}f=f.concat(Object.values(Z))}const I=f.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,I&&this.fire(new c.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const P=this._updateRetainedTiles(f,y);oe(this._source.type)&&this._updateCoveredAndRetainedTiles(P,w,S,y,f,o);for(const Z in P)this._tiles[Z].clearFadeHold();const j=c.ac(this._tiles,P);for(const Z of j){const Y=this._tiles[Z];Y.hasSymbolBuckets&&!Y.holdingForFade()?Y.setHoldDuration(this.map._fadeDuration):Y.hasSymbolBuckets&&!Y.symbolFadeFinished()||this._removeTile(Z)}this._updateLoadedParentTileCache(),this._updateLoadedSiblingTileCache()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(e)}_updateRetainedTiles(e,o){var f;const y={},w={},S=Math.max(o-te.maxOverzooming,this._source.minzoom),I=Math.max(o+te.maxUnderzooming,this._source.minzoom),P={};for(const j of e){const Z=this._addTile(j);y[j.key]=j,Z.hasData()||o<this._source.maxzoom&&(P[j.key]=j)}this._retainLoadedChildren(P,o,I,y);for(const j of e){let Z=this._tiles[j.key];if(Z.hasData())continue;if(o+1>this._source.maxzoom){const H=j.children(this._source.maxzoom)[0],ee=this.getTile(H);if(ee&&ee.hasData()){y[H.key]=H;continue}}else{const H=j.children(this._source.maxzoom);if(y[H[0].key]&&y[H[1].key]&&y[H[2].key]&&y[H[3].key])continue}let Y=Z.wasRequested();for(let H=j.overscaledZ-1;H>=S;--H){const ee=j.scaledTo(H);if(w[ee.key])break;if(w[ee.key]=!0,Z=this.getTile(ee),!Z&&Y&&(Z=this._addTile(ee)),Z){const ie=Z.hasData();if((ie||!(!((f=this.map)===null||f===void 0)&&f.cancelPendingTileRequestsWhileZooming)||Y)&&(y[ee.key]=ee),Y=Z.wasRequested(),ie)break}}}return y}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const o=[];let f,y=this._tiles[e].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){f=this._loadedParentTiles[y.key];break}o.push(y.key);const w=y.scaledTo(y.overscaledZ-1);if(f=this._getLoadedTile(w),f)break;y=w}for(const w of o)this._loadedParentTiles[w]=f}}_updateLoadedSiblingTileCache(){this._loadedSiblingTiles={};for(const e in this._tiles){const o=this._tiles[e].tileID,f=this._getLoadedTile(o);this._loadedSiblingTiles[o.key]=f}}_addTile(e){let o=this._tiles[e.key];if(o)return o;o=this._cache.getAndRemove(e),o&&(this._setTileReloadTimer(e.key,o),o.tileID=e,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,o)));const f=o;return o||(o=new ac(e,this._source.tileSize*e.overscaleFactor()),this._loadTile(o,e.key,o.state)),o.uses++,this._tiles[e.key]=o,f||this._source.fire(new c.k("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(e,o){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const f=o.getExpiryTimeout();f&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},f))}_removeTile(e){const o=this._tiles[e];o&&(o.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}_dataHandler(e){const o=e.sourceDataType;e.dataType==="source"&&o==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&e.dataType==="source"&&o==="content"&&(this.reload(e.sourceDataChanged),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(e);this._cache.reset()}tilesIn(e,o,f){const y=[],w=this.transform;if(!w)return y;const S=f?w.getCameraQueryGeometry(e):e,I=e.map(ie=>w.screenPointToMercatorCoordinate(ie,this.terrain)),P=S.map(ie=>w.screenPointToMercatorCoordinate(ie,this.terrain)),j=this.getIds();let Z=1/0,Y=1/0,H=-1/0,ee=-1/0;for(const ie of P)Z=Math.min(Z,ie.x),Y=Math.min(Y,ie.y),H=Math.max(H,ie.x),ee=Math.max(ee,ie.y);for(let ie=0;ie<j.length;ie++){const me=this._tiles[j[ie]];if(me.holdingForFade())continue;const pe=me.tileID,ge=Math.pow(2,w.zoom-me.tileID.overscaledZ),be=o*me.queryPadding*c.X/me.tileSize/ge,Se=[pe.getTilePoint(new c.Y(Z,Y)),pe.getTilePoint(new c.Y(H,ee))];if(Se[0].x-be<c.X&&Se[0].y-be<c.X&&Se[1].x+be>=0&&Se[1].y+be>=0){const ke=I.map(Oe=>pe.getTilePoint(Oe)),Re=P.map(Oe=>pe.getTilePoint(Oe));y.push({tile:me,tileID:pe,queryGeometry:ke,cameraQueryGeometry:Re,scale:ge})}}return y}getVisibleCoordinates(e){const o=this.getRenderableIds(e).map(f=>this._tiles[f].tileID);return this.transform&&this.transform.populateCache(o),o}hasTransition(){if(this._source.hasTransition())return!0;if(oe(this._source.type)){const e=F.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=e)return!0}return!1}setFeatureState(e,o,f){this._state.updateState(e=e||"_geojsonTileLayer",o,f)}removeFeatureState(e,o,f){this._state.removeFeatureState(e=e||"_geojsonTileLayer",o,f)}getFeatureState(e,o){return this._state.getState(e=e||"_geojsonTileLayer",o)}setDependencies(e,o,f){const y=this._tiles[e];y&&y.setDependencies(o,f)}reloadTilesForDependencies(e,o){for(const f in this._tiles)this._tiles[f].hasDependency(e,o)&&this._reloadTile(f,"reloading");this._cache.filter(f=>!f.hasDependency(e,o))}}function re(b,e){const o=Math.abs(2*b.wrap)-+(b.wrap<0),f=Math.abs(2*e.wrap)-+(e.wrap<0);return b.overscaledZ-e.overscaledZ||f-o||e.canonical.y-b.canonical.y||e.canonical.x-b.canonical.x}function oe(b){return b==="raster"||b==="image"||b==="video"}te.maxOverzooming=10,te.maxUnderzooming=3;class xe{constructor(e,o){this.reset(e,o)}reset(e,o){this.points=e||[],this._distances=[0];for(let f=1;f<this.points.length;f++)this._distances[f]=this._distances[f-1]+this.points[f].dist(this.points[f-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=c.ab(e,0,1);let o=1,f=this._distances[o];const y=e*this.paddedLength+this.padding;for(;f<y&&o<this._distances.length;)f=this._distances[++o];const w=o-1,S=this._distances[w],I=f-S,P=I>0?(y-S)/I:0;return this.points[w].mult(1-P).add(this.points[o].mult(P))}}function ze(b,e){let o=!0;return b==="always"||b!=="never"&&e!=="never"||(o=!1),o}class Ve{constructor(e,o,f){const y=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(e/f),this.yCellCount=Math.ceil(o/f);for(let S=0;S<this.xCellCount*this.yCellCount;S++)y.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=o,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,o,f,y,w){this._forEachCell(o,f,y,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(o),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(w)}insertCircle(e,o,f,y){this._forEachCell(o-y,f-y,o+y,f+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(o),this.circles.push(f),this.circles.push(y)}_insertBoxCell(e,o,f,y,w,S){this.boxCells[w].push(S)}_insertCircleCell(e,o,f,y,w,S){this.circleCells[w].push(S)}_query(e,o,f,y,w,S,I){if(f<0||e>this.width||y<0||o>this.height)return[];const P=[];if(e<=0&&o<=0&&this.width<=f&&this.height<=y){if(w)return[{key:null,x1:e,y1:o,x2:f,y2:y}];for(let j=0;j<this.boxKeys.length;j++)P.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(let j=0;j<this.circleKeys.length;j++){const Z=this.circles[3*j],Y=this.circles[3*j+1],H=this.circles[3*j+2];P.push({key:this.circleKeys[j],x1:Z-H,y1:Y-H,x2:Z+H,y2:Y+H})}}else this._forEachCell(e,o,f,y,this._queryCell,P,{hitTest:w,overlapMode:S,seenUids:{box:{},circle:{}}},I);return P}query(e,o,f,y){return this._query(e,o,f,y,!1,null)}hitTest(e,o,f,y,w,S){return this._query(e,o,f,y,!0,w,S).length>0}hitTestCircle(e,o,f,y,w){const S=e-f,I=e+f,P=o-f,j=o+f;if(I<0||S>this.width||j<0||P>this.height)return!1;const Z=[];return this._forEachCell(S,P,I,j,this._queryCellCircle,Z,{hitTest:!0,overlapMode:y,circle:{x:e,y:o,radius:f},seenUids:{box:{},circle:{}}},w),Z.length>0}_queryCell(e,o,f,y,w,S,I,P){const{seenUids:j,hitTest:Z,overlapMode:Y}=I,H=this.boxCells[w];if(H!==null){const ie=this.bboxes;for(const me of H)if(!j.box[me]){j.box[me]=!0;const pe=4*me,ge=this.boxKeys[me];if(e<=ie[pe+2]&&o<=ie[pe+3]&&f>=ie[pe+0]&&y>=ie[pe+1]&&(!P||P(ge))&&(!Z||!ze(Y,ge.overlapMode))&&(S.push({key:ge,x1:ie[pe],y1:ie[pe+1],x2:ie[pe+2],y2:ie[pe+3]}),Z))return!0}}const ee=this.circleCells[w];if(ee!==null){const ie=this.circles;for(const me of ee)if(!j.circle[me]){j.circle[me]=!0;const pe=3*me,ge=this.circleKeys[me];if(this._circleAndRectCollide(ie[pe],ie[pe+1],ie[pe+2],e,o,f,y)&&(!P||P(ge))&&(!Z||!ze(Y,ge.overlapMode))){const be=ie[pe],Se=ie[pe+1],ke=ie[pe+2];if(S.push({key:ge,x1:be-ke,y1:Se-ke,x2:be+ke,y2:Se+ke}),Z)return!0}}}return!1}_queryCellCircle(e,o,f,y,w,S,I,P){const{circle:j,seenUids:Z,overlapMode:Y}=I,H=this.boxCells[w];if(H!==null){const ie=this.bboxes;for(const me of H)if(!Z.box[me]){Z.box[me]=!0;const pe=4*me,ge=this.boxKeys[me];if(this._circleAndRectCollide(j.x,j.y,j.radius,ie[pe+0],ie[pe+1],ie[pe+2],ie[pe+3])&&(!P||P(ge))&&!ze(Y,ge.overlapMode))return S.push(!0),!0}}const ee=this.circleCells[w];if(ee!==null){const ie=this.circles;for(const me of ee)if(!Z.circle[me]){Z.circle[me]=!0;const pe=3*me,ge=this.circleKeys[me];if(this._circlesCollide(ie[pe],ie[pe+1],ie[pe+2],j.x,j.y,j.radius)&&(!P||P(ge))&&!ze(Y,ge.overlapMode))return S.push(!0),!0}}}_forEachCell(e,o,f,y,w,S,I,P){const j=this._convertToXCellCoord(e),Z=this._convertToYCellCoord(o),Y=this._convertToXCellCoord(f),H=this._convertToYCellCoord(y);for(let ee=j;ee<=Y;ee++)for(let ie=Z;ie<=H;ie++)if(w.call(this,e,o,f,y,this.xCellCount*ie+ee,S,I,P))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,o,f,y,w,S){const I=y-e,P=w-o,j=f+S;return j*j>I*I+P*P}_circleAndRectCollide(e,o,f,y,w,S,I){const P=(S-y)/2,j=Math.abs(e-(y+P));if(j>P+f)return!1;const Z=(I-w)/2,Y=Math.abs(o-(w+Z));if(Y>Z+f)return!1;if(j<=P||Y<=Z)return!0;const H=j-P,ee=Y-Z;return H*H+ee*ee<=f*f}}function We(b,e,o){const f=c.H();if(!b){const{vecSouth:Y,vecEast:H}=at(e),ee=D();ee[0]=H[0],ee[1]=H[1],ee[2]=Y[0],ee[3]=Y[1],y=ee,(Z=(S=(w=ee)[0])*(j=w[3])-(P=w[2])*(I=w[1]))&&(y[0]=j*(Z=1/Z),y[1]=-I*Z,y[2]=-P*Z,y[3]=S*Z),f[0]=ee[0],f[1]=ee[1],f[4]=ee[2],f[5]=ee[3]}var y,w,S,I,P,j,Z;return c.K(f,f,[1/o,1/o,1]),f}function Fe(b,e,o,f){if(b){const y=c.H();if(!e){const{vecSouth:w,vecEast:S}=at(o);y[0]=S[0],y[1]=S[1],y[4]=w[0],y[5]=w[1]}return c.K(y,y,[f,f,1]),y}return o.pixelsToClipSpaceMatrix}function at(b){const e=Math.cos(b.rollInRadians),o=Math.sin(b.rollInRadians),f=Math.cos(b.pitchInRadians),y=Math.cos(b.bearingInRadians),w=Math.sin(b.bearingInRadians),S=c.ad();S[0]=-y*f*o-w*e,S[1]=-w*f*o+y*e;const I=c.ae(S);I<1e-9?c.af(S):c.ag(S,S,1/I);const P=c.ad();P[0]=y*f*e-w*o,P[1]=w*f*e+y*o;const j=c.ae(P);return j<1e-9?c.af(P):c.ag(P,P,1/j),{vecEast:P,vecSouth:S}}function tt(b,e,o,f){let y;f?(y=[b,e,f(b,e),1],c.al(y,y,o)):(y=[b,e,0,1],Nr(y,y,o));const w=y[3];return{point:new c.P(y[0]/w,y[1]/w),signedDistanceFromCamera:w,isOccluded:!1}}function $e(b,e){return .5+b/e*.5}function Be(b,e){return b.x>=-e[0]&&b.x<=e[0]&&b.y>=-e[1]&&b.y<=e[1]}function Rt(b,e,o,f,y,w,S,I,P,j,Z,Y,H){const ee=o?b.textSizeData:b.iconSizeData,ie=c.ah(ee,e.transform.zoom),me=[256/e.width*2+1,256/e.height*2+1],pe=o?b.text.dynamicLayoutVertexArray:b.icon.dynamicLayoutVertexArray;pe.clear();const ge=b.lineVertexArray,be=o?b.text.placedSymbolArray:b.icon.placedSymbolArray,Se=e.transform.width/e.transform.height;let ke=!1;for(let Re=0;Re<be.length;Re++){const Oe=be.get(Re);if(Oe.hidden||Oe.writingMode===c.ai.vertical&&!ke){Ar(Oe.numGlyphs,pe);continue}ke=!1;const Pe=new c.P(Oe.anchorX,Oe.anchorY),He={getElevation:H,pitchedLabelPlaneMatrix:f,lineVertexArray:ge,pitchWithMap:w,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:e.transform,tileAnchorPoint:Pe,unwrappedTileID:P,width:j,height:Z,translation:Y},Ke=Zn(Oe.anchorX,Oe.anchorY,He);if(!Be(Ke.point,me)){Ar(Oe.numGlyphs,pe);continue}const st=$e(e.transform.cameraToCenterDistance,Ke.signedDistanceFromCamera),ht=c.aj(ee,ie,Oe),nt=w?ht*e.transform.getPitchedTextCorrection(Oe.anchorX,Oe.anchorY,P)/st:ht*st,kt=fn({projectionContext:He,pitchedLabelPlaneMatrixInverse:y,symbol:Oe,fontSize:nt,flip:!1,keepUpright:S,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:pe,aspectRatio:Se,rotateToLine:I});ke=kt.useVertical,(kt.notEnoughRoom||ke||kt.needsFlipping&&fn({projectionContext:He,pitchedLabelPlaneMatrixInverse:y,symbol:Oe,fontSize:nt,flip:!0,keepUpright:S,glyphOffsetArray:b.glyphOffsetArray,dynamicLayoutVertexArray:pe,aspectRatio:Se,rotateToLine:I}).notEnoughRoom)&&Ar(Oe.numGlyphs,pe)}o?b.text.dynamicLayoutVertexBuffer.updateData(pe):b.icon.dynamicLayoutVertexBuffer.updateData(pe)}function It(b,e,o,f,y,w,S,I){const P=w.glyphStartIndex+w.numGlyphs,j=w.lineStartIndex,Z=w.lineStartIndex+w.lineLength,Y=e.getoffsetX(w.glyphStartIndex),H=e.getoffsetX(P-1),ee=$n(b*Y,o,f,y,w.segment,j,Z,I,S);if(!ee)return null;const ie=$n(b*H,o,f,y,w.segment,j,Z,I,S);return ie?I.projectionCache.anyProjectionOccluded?null:{first:ee,last:ie}:null}function tn(b,e,o,f){return b===c.ai.horizontal&&Math.abs(o.y-e.y)>Math.abs(o.x-e.x)*f?{useVertical:!0}:(b===c.ai.vertical?e.y<o.y:e.x>o.x)?{needsFlipping:!0}:null}function fn(b){const{projectionContext:e,pitchedLabelPlaneMatrixInverse:o,symbol:f,fontSize:y,flip:w,keepUpright:S,glyphOffsetArray:I,dynamicLayoutVertexArray:P,aspectRatio:j,rotateToLine:Z}=b,Y=y/24,H=f.lineOffsetX*Y,ee=f.lineOffsetY*Y;let ie;if(f.numGlyphs>1){const me=f.glyphStartIndex+f.numGlyphs,pe=f.lineStartIndex,ge=f.lineStartIndex+f.lineLength,be=It(Y,I,H,ee,w,f,Z,e);if(!be)return{notEnoughRoom:!0};const Se=Cn(be.first.point.x,be.first.point.y,e,o),ke=Cn(be.last.point.x,be.last.point.y,e,o);if(S&&!w){const Re=tn(f.writingMode,Se,ke,j);if(Re)return Re}ie=[be.first];for(let Re=f.glyphStartIndex+1;Re<me-1;Re++)ie.push($n(Y*I.getoffsetX(Re),H,ee,w,f.segment,pe,ge,e,Z));ie.push(be.last)}else{if(S&&!w){const pe=Yt(e.tileAnchorPoint.x,e.tileAnchorPoint.y,e).point,ge=f.lineStartIndex+f.segment+1,be=new c.P(e.lineVertexArray.getx(ge),e.lineVertexArray.gety(ge)),Se=Yt(be.x,be.y,e),ke=Se.signedDistanceFromCamera>0?Se.point:ct(e.tileAnchorPoint,be,pe,1,e),Re=Cn(pe.x,pe.y,e,o),Oe=Cn(ke.x,ke.y,e,o),Pe=tn(f.writingMode,Re,Oe,j);if(Pe)return Pe}const me=$n(Y*I.getoffsetX(f.glyphStartIndex),H,ee,w,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,e,Z);if(!me||e.projectionCache.anyProjectionOccluded)return{notEnoughRoom:!0};ie=[me]}for(const me of ie)c.ak(P,me.point,me.angle);return{}}function ct(b,e,o,f,y){const w=b.add(b.sub(e)._unit()),S=Yt(w.x,w.y,y).point,I=o.sub(S);return o.add(I._mult(f/I.mag()))}function Pt(b,e,o){const f=e.projectionCache;if(f.projections[b])return f.projections[b];const y=new c.P(e.lineVertexArray.getx(b),e.lineVertexArray.gety(b)),w=Yt(y.x,y.y,e);if(w.signedDistanceFromCamera>0)return f.projections[b]=w.point,f.anyProjectionOccluded=f.anyProjectionOccluded||w.isOccluded,w.point;const S=b-o.direction;return ct(o.distanceFromAnchor===0?e.tileAnchorPoint:new c.P(e.lineVertexArray.getx(S),e.lineVertexArray.gety(S)),y,o.previousVertex,o.absOffsetX-o.distanceFromAnchor+1,e)}function Yt(b,e,o){const f=b+o.translation[0],y=e+o.translation[1];let w;return o.pitchWithMap?(w=tt(f,y,o.pitchedLabelPlaneMatrix,o.getElevation),w.isOccluded=!1):(w=o.transform.projectTileCoordinates(f,y,o.unwrappedTileID,o.getElevation),w.point.x=(.5*w.point.x+.5)*o.width,w.point.y=(.5*-w.point.y+.5)*o.height),w}function Cn(b,e,o,f){if(o.pitchWithMap){const y=[b,e,0,1];return c.al(y,y,f),o.transform.projectTileCoordinates(y[0]/y[3],y[1]/y[3],o.unwrappedTileID,o.getElevation).point}return{x:b/o.width*2-1,y:e/o.height*2-1}}function Zn(b,e,o){return o.transform.projectTileCoordinates(b,e,o.unwrappedTileID,o.getElevation)}function en(b,e,o){return b._unit()._perp()._mult(e*o)}function Nt(b,e,o,f,y,w,S,I,P){if(I.projectionCache.offsets[b])return I.projectionCache.offsets[b];const j=o.add(e);if(b+P.direction<f||b+P.direction>=y)return I.projectionCache.offsets[b]=j,j;const Z=Pt(b+P.direction,I,P),Y=en(Z.sub(o),S,P.direction),H=o.add(Y),ee=Z.add(Y);return I.projectionCache.offsets[b]=c.am(w,j,H,ee)||j,I.projectionCache.offsets[b]}function $n(b,e,o,f,y,w,S,I,P){const j=f?b-e:b+e;let Z=j>0?1:-1,Y=0;f&&(Z*=-1,Y=Math.PI),Z<0&&(Y+=Math.PI);let H,ee=Z>0?w+y:w+y+1;I.projectionCache.cachedAnchorPoint?H=I.projectionCache.cachedAnchorPoint:(H=Yt(I.tileAnchorPoint.x,I.tileAnchorPoint.y,I).point,I.projectionCache.cachedAnchorPoint=H);let ie,me,pe=H,ge=H,be=0,Se=0;const ke=Math.abs(j),Re=[];let Oe;for(;be+Se<=ke;){if(ee+=Z,ee<w||ee>=S)return null;be+=Se,ge=pe,me=ie;const Ke={absOffsetX:ke,direction:Z,distanceFromAnchor:be,previousVertex:ge};if(pe=Pt(ee,I,Ke),o===0)Re.push(ge),Oe=pe.sub(ge);else{let st;const ht=pe.sub(ge);st=ht.mag()===0?en(Pt(ee+Z,I,Ke).sub(pe),o,Z):en(ht,o,Z),me||(me=ge.add(st)),ie=Nt(ee,st,pe,w,S,me,o,I,Ke),Re.push(me),Oe=ie.sub(me)}Se=Oe.mag()}const Pe=Oe._mult((ke-be)/Se)._add(me||ge),He=Y+Math.atan2(pe.y-ge.y,pe.x-ge.x);return Re.push(Pe),{point:Pe,angle:P?He:0,path:Re}}const no=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ar(b,e){for(let o=0;o<b;o++){const f=e.length;e.resize(f+4),e.float32.set(no,3*f)}}function Nr(b,e,o){const f=e[0],y=e[1];return b[0]=o[0]*f+o[4]*y+o[12],b[1]=o[1]*f+o[5]*y+o[13],b[3]=o[3]*f+o[7]*y+o[15],b}const Fi=100;class Fa{constructor(e,o=new Ve(e.width+200,e.height+200,25),f=new Ve(e.width+200,e.height+200,25)){this.transform=e,this.grid=o,this.ignoredGrid=f,this.pitchFactor=Math.cos(e.pitch*Math.PI/180)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Fi,this.screenBottomBoundary=e.height+Fi,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(e,o,f,y,w,S,I,P,j,Z,Y,H){const ee=this.projectAndGetPerspectiveRatio(e.anchorPointX+P[0],e.anchorPointY+P[1],w,Z,H),ie=f*ee.perspectiveRatio;let me;if(S||I)me=this._projectCollisionBox(e,ie,y,w,S,I,P,ee,Z,Y,H);else{const Oe=ee.x+(Y?Y.x*ie:0),Pe=ee.y+(Y?Y.y*ie:0);me={allPointsOccluded:!1,box:[Oe+e.x1*ie,Pe+e.y1*ie,Oe+e.x2*ie,Pe+e.y2*ie]}}const[pe,ge,be,Se]=me.box,ke=S?me.allPointsOccluded:ee.isOccluded;let Re=ke;return Re||(Re=ee.perspectiveRatio<this.perspectiveRatioCutoff),Re||(Re=!this.isInsideGrid(pe,ge,be,Se)),Re||o!=="always"&&this.grid.hitTest(pe,ge,be,Se,o,j)?{box:[pe,ge,be,Se],placeable:!1,offscreen:!1,occluded:ke}:{box:[pe,ge,be,Se],placeable:!0,offscreen:this.isOffscreen(pe,ge,be,Se),occluded:ke}}placeCollisionCircles(e,o,f,y,w,S,I,P,j,Z,Y,H,ee,ie){const me=[],pe=new c.P(o.anchorX,o.anchorY),ge=this.getPerspectiveRatio(pe.x,pe.y,S,ie),be=(j?w*this.transform.getPitchedTextCorrection(o.anchorX,o.anchorY,S)/ge:w*ge)/c.as,Se={getElevation:ie,pitchedLabelPlaneMatrix:I,lineVertexArray:f,pitchWithMap:j,projectionCache:{projections:{},offsets:{},cachedAnchorPoint:void 0,anyProjectionOccluded:!1},transform:this.transform,tileAnchorPoint:pe,unwrappedTileID:S,width:this.transform.width,height:this.transform.height,translation:ee},ke=It(be,y,o.lineOffsetX*be,o.lineOffsetY*be,!1,o,!1,Se);let Re=!1,Oe=!1,Pe=!0;if(ke){const He=.5*Y*ge+H,Ke=new c.P(-100,-100),st=new c.P(this.screenRightBoundary,this.screenBottomBoundary),ht=new xe,nt=ke.first,kt=ke.last;let Mt=[];for(let gn=nt.path.length-1;gn>=1;gn--)Mt.push(nt.path[gn]);for(let gn=1;gn<kt.path.length;gn++)Mt.push(kt.path[gn]);const gt=2.5*He;if(j){const gn=this.projectPathToScreenSpace(Mt,Se);Mt=gn.some(qn=>qn.signedDistanceFromCamera<=0)?[]:gn.map(qn=>qn.point)}let zt=[];if(Mt.length>0){const gn=Mt[0].clone(),qn=Mt[0].clone();for(let Ui=1;Ui<Mt.length;Ui++)gn.x=Math.min(gn.x,Mt[Ui].x),gn.y=Math.min(gn.y,Mt[Ui].y),qn.x=Math.max(qn.x,Mt[Ui].x),qn.y=Math.max(qn.y,Mt[Ui].y);zt=gn.x>=Ke.x&&qn.x<=st.x&&gn.y>=Ke.y&&qn.y<=st.y?[Mt]:qn.x<Ke.x||gn.x>st.x||qn.y<Ke.y||gn.y>st.y?[]:c.ao([Mt],Ke.x,Ke.y,st.x,st.y)}for(const gn of zt){ht.reset(gn,.25*He);let qn=0;qn=ht.length<=.5*He?1:Math.ceil(ht.paddedLength/gt)+1;for(let Ui=0;Ui<qn;Ui++){const yi=Ui/Math.max(qn-1,1),Ti=ht.lerp(yi),hi=Ti.x+Fi,ii=Ti.y+Fi;me.push(hi,ii,He,0);const _i=hi-He,na=ii-He,Ei=hi+He,Pi=ii+He;if(Pe=Pe&&this.isOffscreen(_i,na,Ei,Pi),Oe=Oe||this.isInsideGrid(_i,na,Ei,Pi),e!=="always"&&this.grid.hitTestCircle(hi,ii,He,e,Z)&&(Re=!0,!P))return{circles:[],offscreen:!1,collisionDetected:Re}}}}return{circles:!P&&Re||!Oe||ge<this.perspectiveRatioCutoff?[]:me,offscreen:Pe,collisionDetected:Re}}projectPathToScreenSpace(e,o){const f=function(y,w){const S=c.H();return c.an(S,w.pitchedLabelPlaneMatrix),y.map(I=>{const P=tt(I.x,I.y,S,w.getElevation),j=w.transform.projectTileCoordinates(P.point.x,P.point.y,w.unwrappedTileID,w.getElevation);return j.point.x=(.5*j.point.x+.5)*w.width,j.point.y=(.5*-j.point.y+.5)*w.height,j})}(e,o);return function(y){let w=0,S=0,I=0,P=0;for(let j=0;j<y.length;j++)y[j].isOccluded?(I=j+1,P=0):(P++,P>S&&(S=P,w=I));return y.slice(w,w+S)}(f)}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let f=1/0,y=1/0,w=-1/0,S=-1/0;for(const Z of e){const Y=new c.P(Z.x+Fi,Z.y+Fi);f=Math.min(f,Y.x),y=Math.min(y,Y.y),w=Math.max(w,Y.x),S=Math.max(S,Y.y),o.push(Y)}const I=this.grid.query(f,y,w,S).concat(this.ignoredGrid.query(f,y,w,S)),P={},j={};for(const Z of I){const Y=Z.key;if(P[Y.bucketInstanceId]===void 0&&(P[Y.bucketInstanceId]={}),P[Y.bucketInstanceId][Y.featureIndex])continue;const H=[new c.P(Z.x1,Z.y1),new c.P(Z.x2,Z.y1),new c.P(Z.x2,Z.y2),new c.P(Z.x1,Z.y2)];c.ap(o,H)&&(P[Y.bucketInstanceId][Y.featureIndex]=!0,j[Y.bucketInstanceId]===void 0&&(j[Y.bucketInstanceId]=[]),j[Y.bucketInstanceId].push(Y.featureIndex))}return j}insertCollisionBox(e,o,f,y,w,S){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:w,collisionGroupID:S,overlapMode:o},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,o,f,y,w,S){const I=f?this.ignoredGrid:this.grid,P={bucketInstanceId:y,featureIndex:w,collisionGroupID:S,overlapMode:o};for(let j=0;j<e.length;j+=4)I.insertCircle(P,e[j],e[j+1],e[j+2])}projectAndGetPerspectiveRatio(e,o,f,y,w){if(w){let S;y?(S=[e,o,y(e,o),1],c.al(S,S,w)):(S=[e,o,0,1],Nr(S,S,w));const I=S[3];return{x:(S[0]/I+1)/2*this.transform.width+Fi,y:(-S[1]/I+1)/2*this.transform.height+Fi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/I*.5,isOccluded:!1,signedDistanceFromCamera:I}}{const S=this.transform.projectTileCoordinates(e,o,f,y);return{x:(S.point.x+1)/2*this.transform.width+Fi,y:(1-S.point.y)/2*this.transform.height+Fi,perspectiveRatio:.5+this.transform.cameraToCenterDistance/S.signedDistanceFromCamera*.5,isOccluded:S.isOccluded,signedDistanceFromCamera:S.signedDistanceFromCamera}}}getPerspectiveRatio(e,o,f,y){const w=this.transform.projectTileCoordinates(e,o,f,y);return .5+this.transform.cameraToCenterDistance/w.signedDistanceFromCamera*.5}isOffscreen(e,o,f,y){return f<Fi||e>=this.screenRightBoundary||y<Fi||o>this.screenBottomBoundary}isInsideGrid(e,o,f,y){return f>=0&&e<this.gridRightBoundary&&y>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const e=c.aq([]);return c.J(e,e,[-100,-100,0]),e}_projectCollisionBox(e,o,f,y,w,S,I,P,j,Z,Y){let H=1,ee=0,ie=0,me=1;const pe=e.anchorPointX+I[0],ge=e.anchorPointY+I[1];if(S&&!w){const Mt=this.projectAndGetPerspectiveRatio(pe+1,ge,y,j,Y),gt=Mt.x-P.x,zt=Math.atan((Mt.y-P.y)/gt)+(gt<0?Math.PI:0),gn=Math.sin(zt),qn=Math.cos(zt);H=qn,ee=gn,ie=-gn,me=qn}else if(!S&&w){const Mt=at(this.transform);H=Mt.vecEast[0],ee=Mt.vecEast[1],ie=Mt.vecSouth[0],me=Mt.vecSouth[1]}let be=P.x,Se=P.y,ke=o;w&&(be=pe,Se=ge,ke=Math.pow(2,-(this.transform.zoom-f.overscaledZ)),ke*=this.transform.getPitchedTextCorrection(pe,ge,y),Z||(ke*=c.ab(.5+P.signedDistanceFromCamera/this.transform.cameraToCenterDistance*.5,0,4))),Z&&(be+=H*Z.x*ke+ie*Z.y*ke,Se+=ee*Z.x*ke+me*Z.y*ke);const Re=e.x1*ke,Oe=e.x2*ke,Pe=(Re+Oe)/2,He=e.y1*ke,Ke=e.y2*ke,st=(He+Ke)/2,ht=[{offsetX:Re,offsetY:He},{offsetX:Pe,offsetY:He},{offsetX:Oe,offsetY:He},{offsetX:Oe,offsetY:st},{offsetX:Oe,offsetY:Ke},{offsetX:Pe,offsetY:Ke},{offsetX:Re,offsetY:Ke},{offsetX:Re,offsetY:st}];let nt=[];for(const{offsetX:Mt,offsetY:gt}of ht)nt.push(new c.P(be+H*Mt+ie*gt,Se+ee*Mt+me*gt));let kt=!1;if(w){const Mt=nt.map(gt=>this.projectAndGetPerspectiveRatio(gt.x,gt.y,y,j,Y));kt=Mt.some(gt=>!gt.isOccluded),nt=Mt.map(gt=>new c.P(gt.x,gt.y))}else kt=!0;return{box:c.ar(nt),allPointsOccluded:!kt}}}class wi{constructor(e,o,f,y){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?o:-o))):y&&f?1:0,this.placed=f}isHidden(){return this.opacity===0&&!this.placed}}class oc{constructor(e,o,f,y,w){this.text=new wi(e?e.text:null,o,f,w),this.icon=new wi(e?e.icon:null,o,y,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Mo{constructor(e,o,f){this.text=e,this.icon=o,this.skipFade=f}}class vl{constructor(e,o,f,y,w){this.bucketInstanceId=e,this.featureIndex=o,this.sourceLayerIndex=f,this.bucketIndex=y,this.tileID=w}}class Ko{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const o=++this.maxGroupID;this.collisionGroups[e]={ID:o,predicate:f=>f.collisionGroupID===o}}return this.collisionGroups[e]}}function Do(b,e,o,f,y){const{horizontalAlign:w,verticalAlign:S}=c.ay(b);return new c.P(-(w-.5)*e+f[0]*y,-(S-.5)*o+f[1]*y)}class Zr{constructor(e,o,f,y,w){this.transform=e.clone(),this.terrain=o,this.collisionIndex=new Fa(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new Ko(y),this.collisionCircleArrays={},this.collisionBoxArrays=new Map,this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}_getTerrainElevationFunc(e){const o=this.terrain;return o?(f,y)=>o.getElevation(e,f,y):null}getBucketParts(e,o,f,y){const w=f.getBucket(o),S=f.latestFeatureIndex;if(!w||!S||o.id!==w.layerIds[0])return;const I=f.collisionBoxArray,P=w.layers[0].layout,j=w.layers[0].paint,Z=Math.pow(2,this.transform.zoom-f.tileID.overscaledZ),Y=f.tileSize/c.X,H=f.tileID.toUnwrapped(),ee=P.get("text-rotation-alignment")==="map",ie=c.at(f,1,this.transform.zoom),me=c.au(this.collisionIndex.transform,f,j.get("text-translate"),j.get("text-translate-anchor")),pe=c.au(this.collisionIndex.transform,f,j.get("icon-translate"),j.get("icon-translate-anchor")),ge=We(ee,this.transform,ie);this.retainedQueryData[w.bucketInstanceId]=new vl(w.bucketInstanceId,S,w.sourceLayerIndex,w.index,f.tileID);const be={bucket:w,layout:P,translationText:me,translationIcon:pe,unwrappedTileID:H,pitchedLabelPlaneMatrix:ge,scale:Z,textPixelRatio:Y,holdingForFade:f.holdingForFade(),collisionBoxArray:I,partiallyEvaluatedTextSize:c.ah(w.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(y)for(const Se of w.sortKeyRanges){const{sortKey:ke,symbolInstanceStart:Re,symbolInstanceEnd:Oe}=Se;e.push({sortKey:ke,symbolInstanceStart:Re,symbolInstanceEnd:Oe,parameters:be})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:be})}attemptAnchorPlacement(e,o,f,y,w,S,I,P,j,Z,Y,H,ee,ie,me,pe,ge,be,Se,ke){const Re=c.av[e.textAnchor],Oe=[e.textOffset0,e.textOffset1],Pe=Do(Re,f,y,Oe,w),He=this.collisionIndex.placeCollisionBox(o,H,P,j,Z,I,S,pe,Y.predicate,Se,Pe,ke);if((!be||this.collisionIndex.placeCollisionBox(be,H,P,j,Z,I,S,ge,Y.predicate,Se,Pe,ke).placeable)&&He.placeable){let Ke;if(this.prevPlacement&&this.prevPlacement.variableOffsets[ee.crossTileID]&&this.prevPlacement.placements[ee.crossTileID]&&this.prevPlacement.placements[ee.crossTileID].text&&(Ke=this.prevPlacement.variableOffsets[ee.crossTileID].anchor),ee.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[ee.crossTileID]={textOffset:Oe,width:f,height:y,anchor:Re,textBoxScale:w,prevAnchor:Ke},this.markUsedJustification(ie,Re,ee,me),ie.allowVerticalPlacement&&(this.markUsedOrientation(ie,me,ee),this.placedOrientations[ee.crossTileID]=me),{shift:Pe,placedGlyphBoxes:He}}}placeLayerBucketPart(e,o,f){const{bucket:y,layout:w,translationText:S,translationIcon:I,unwrappedTileID:P,pitchedLabelPlaneMatrix:j,textPixelRatio:Z,holdingForFade:Y,collisionBoxArray:H,partiallyEvaluatedTextSize:ee,collisionGroup:ie}=e.parameters,me=w.get("text-optional"),pe=w.get("icon-optional"),ge=c.aw(w,"text-overlap","text-allow-overlap"),be=ge==="always",Se=c.aw(w,"icon-overlap","icon-allow-overlap"),ke=Se==="always",Re=w.get("text-rotation-alignment")==="map",Oe=w.get("text-pitch-alignment")==="map",Pe=w.get("icon-text-fit")!=="none",He=w.get("symbol-z-order")==="viewport-y",Ke=be&&(ke||!y.hasIconData()||pe),st=ke&&(be||!y.hasTextData()||me);!y.collisionArrays&&H&&y.deserializeCollisionBoxes(H);const ht=this.retainedQueryData[y.bucketInstanceId].tileID,nt=this._getTerrainElevationFunc(ht),kt=this.transform.getFastPathSimpleProjectionMatrix(ht),Mt=(gt,zt,gn)=>{var qn,Ui;if(o[gt.crossTileID])return;if(Y)return void(this.placements[gt.crossTileID]=new Mo(!1,!1,!1));let yi=!1,Ti=!1,hi=!0,ii=null,_i={box:null,placeable:!1,offscreen:null,occluded:!1},na={placeable:!1},Ei=null,Pi=null,mr=null,Da=0,Vo=0,Ia=0;zt.textFeatureIndex?Da=zt.textFeatureIndex:gt.useRuntimeCollisionCircles&&(Da=gt.featureIndex),zt.verticalTextFeatureIndex&&(Vo=zt.verticalTextFeatureIndex);const Rs=zt.textBox;if(Rs){const ka=vi=>{let Ii=c.ai.horizontal;if(y.allowVerticalPlacement&&!vi&&this.prevPlacement){const Ga=this.prevPlacement.placedOrientations[gt.crossTileID];Ga&&(this.placedOrientations[gt.crossTileID]=Ga,Ii=Ga,this.markUsedOrientation(y,Ii,gt))}return Ii},uo=(vi,Ii)=>{if(y.allowVerticalPlacement&&gt.numVerticalGlyphVertices>0&&zt.verticalTextBox){for(const Ga of y.writingModes)if(Ga===c.ai.vertical?(_i=Ii(),na=_i):_i=vi(),_i&&_i.placeable)break}else _i=vi()},ho=gt.textAnchorOffsetStartIndex,va=gt.textAnchorOffsetEndIndex;if(va===ho){const vi=(Ii,Ga)=>{const Vi=this.collisionIndex.placeCollisionBox(Ii,ge,Z,ht,P,Oe,Re,S,ie.predicate,nt,void 0,kt);return Vi&&Vi.placeable&&(this.markUsedOrientation(y,Ga,gt),this.placedOrientations[gt.crossTileID]=Ga),Vi};uo(()=>vi(Rs,c.ai.horizontal),()=>{const Ii=zt.verticalTextBox;return y.allowVerticalPlacement&&gt.numVerticalGlyphVertices>0&&Ii?vi(Ii,c.ai.vertical):{box:null,offscreen:null}}),ka(_i&&_i.placeable)}else{let vi=c.av[(Ui=(qn=this.prevPlacement)===null||qn===void 0?void 0:qn.variableOffsets[gt.crossTileID])===null||Ui===void 0?void 0:Ui.anchor];const Ii=(Vi,ry,fp)=>{const zr=Vi.x2-Vi.x1,ia=Vi.y2-Vi.y1,Ll=gt.textBoxScale,Bl=Pe&&Se==="never"?ry:null;let ll=null,pp=ge==="never"?1:2,kh="never";vi&&pp++;for(let Rc=0;Rc<pp;Rc++){for(let Rh=ho;Rh<va;Rh++){const Hd=y.textAnchorOffsets.get(Rh);if(vi&&Hd.textAnchor!==vi)continue;const Xd=this.attemptAnchorPlacement(Hd,Vi,zr,ia,Ll,Re,Oe,Z,ht,P,ie,kh,gt,y,fp,S,I,Bl,nt);if(Xd&&(ll=Xd.placedGlyphBoxes,ll&&ll.placeable))return yi=!0,ii=Xd.shift,ll}vi?vi=null:kh=ge}return f&&!ll&&(ll={box:this.collisionIndex.placeCollisionBox(Rs,"always",Z,ht,P,Oe,Re,S,ie.predicate,nt,void 0,kt).box,offscreen:!1,placeable:!1,occluded:!1}),ll};uo(()=>Ii(Rs,zt.iconBox,c.ai.horizontal),()=>{const Vi=zt.verticalTextBox;return y.allowVerticalPlacement&&(!_i||!_i.placeable)&&gt.numVerticalGlyphVertices>0&&Vi?Ii(Vi,zt.verticalIconBox,c.ai.vertical):{box:null,occluded:!0,offscreen:null}}),_i&&(yi=_i.placeable,hi=_i.offscreen);const Ga=ka(_i&&_i.placeable);if(!yi&&this.prevPlacement){const Vi=this.prevPlacement.variableOffsets[gt.crossTileID];Vi&&(this.variableOffsets[gt.crossTileID]=Vi,this.markUsedJustification(y,Vi.anchor,gt,Ga))}}}if(Ei=_i,yi=Ei&&Ei.placeable,hi=Ei&&Ei.offscreen,gt.useRuntimeCollisionCircles){const ka=y.text.placedSymbolArray.get(gt.centerJustifiedTextSymbolIndex),uo=c.aj(y.textSizeData,ee,ka),ho=w.get("text-padding");Pi=this.collisionIndex.placeCollisionCircles(ge,ka,y.lineVertexArray,y.glyphOffsetArray,uo,P,j,f,Oe,ie.predicate,gt.collisionCircleDiameter,ho,S,nt),Pi.circles.length&&Pi.collisionDetected&&!f&&c.w("Collisions detected, but collision boxes are not shown"),yi=be||Pi.circles.length>0&&!Pi.collisionDetected,hi=hi&&Pi.offscreen}if(zt.iconFeatureIndex&&(Ia=zt.iconFeatureIndex),zt.iconBox){const ka=uo=>this.collisionIndex.placeCollisionBox(uo,Se,Z,ht,P,Oe,Re,I,ie.predicate,nt,Pe&&ii?ii:void 0,kt);na&&na.placeable&&zt.verticalIconBox?(mr=ka(zt.verticalIconBox),Ti=mr.placeable):(mr=ka(zt.iconBox),Ti=mr.placeable),hi=hi&&mr.offscreen}const Eu=me||gt.numHorizontalGlyphVertices===0&&gt.numVerticalGlyphVertices===0,cs=pe||gt.numIconVertices===0;Eu||cs?cs?Eu||(Ti=Ti&&yi):yi=Ti&&yi:Ti=yi=Ti&&yi;const sl=Ti&&mr.placeable;if(yi&&Ei.placeable&&this.collisionIndex.insertCollisionBox(Ei.box,ge,w.get("text-ignore-placement"),y.bucketInstanceId,na&&na.placeable&&Vo?Vo:Da,ie.ID),sl&&this.collisionIndex.insertCollisionBox(mr.box,Se,w.get("icon-ignore-placement"),y.bucketInstanceId,Ia,ie.ID),Pi&&yi&&this.collisionIndex.insertCollisionCircles(Pi.circles,ge,w.get("text-ignore-placement"),y.bucketInstanceId,Da,ie.ID),f&&this.storeCollisionData(y.bucketInstanceId,gn,zt,Ei,mr,Pi),gt.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(y.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[gt.crossTileID]=new Mo((yi||Ke)&&!(Ei!=null&&Ei.occluded),(Ti||st)&&!(mr!=null&&mr.occluded),hi||y.justReloaded),o[gt.crossTileID]=!0};if(He){if(e.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const gt=y.getSortedSymbolIndexes(-this.transform.bearingInRadians);for(let zt=gt.length-1;zt>=0;--zt){const gn=gt[zt];Mt(y.symbolInstances.get(gn),y.collisionArrays[gn],gn)}}else for(let gt=e.symbolInstanceStart;gt<e.symbolInstanceEnd;gt++)Mt(y.symbolInstances.get(gt),y.collisionArrays[gt],gt);y.justReloaded=!1}storeCollisionData(e,o,f,y,w,S){if(f.textBox||f.iconBox){let I,P;this.collisionBoxArrays.has(e)?I=this.collisionBoxArrays.get(e):(I=new Map,this.collisionBoxArrays.set(e,I)),I.has(o)?P=I.get(o):(P={text:null,icon:null},I.set(o,P)),f.textBox&&(P.text=y.box),f.iconBox&&(P.icon=w.box)}if(S){let I=this.collisionCircleArrays[e];I===void 0&&(I=this.collisionCircleArrays[e]=[]);for(let P=0;P<S.circles.length;P+=4)I.push(S.circles[P+0]-Fi),I.push(S.circles[P+1]-Fi),I.push(S.circles[P+2]),I.push(S.collisionDetected?1:0)}}markUsedJustification(e,o,f,y){let w;w=y===c.ai.vertical?f.verticalPlacedTextSymbolIndex:{left:f.leftJustifiedTextSymbolIndex,center:f.centerJustifiedTextSymbolIndex,right:f.rightJustifiedTextSymbolIndex}[c.ax(o)];const S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex,f.verticalPlacedTextSymbolIndex];for(const I of S)I>=0&&(e.text.placedSymbolArray.get(I).crossTileID=w>=0&&I!==w?0:f.crossTileID)}markUsedOrientation(e,o,f){const y=o===c.ai.horizontal||o===c.ai.horizontalOnly?o:0,w=o===c.ai.vertical?o:0,S=[f.leftJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.rightJustifiedTextSymbolIndex];for(const I of S)e.text.placedSymbolArray.get(I).placedOrientation=y;f.verticalPlacedTextSymbolIndex&&(e.text.placedSymbolArray.get(f.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let f=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const y=o?o.symbolFadeChange(e):1,w=o?o.opacities:{},S=o?o.variableOffsets:{},I=o?o.placedOrientations:{};for(const P in this.placements){const j=this.placements[P],Z=w[P];Z?(this.opacities[P]=new oc(Z,y,j.text,j.icon),f=f||j.text!==Z.text.placed||j.icon!==Z.icon.placed):(this.opacities[P]=new oc(null,y,j.text,j.icon,j.skipFade),f=f||j.text||j.icon)}for(const P in w){const j=w[P];if(!this.opacities[P]){const Z=new oc(j,y,!1,!1);Z.isHidden()||(this.opacities[P]=Z,f=f||j.text.placed||j.icon.placed)}}for(const P in S)this.variableOffsets[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.variableOffsets[P]=S[P]);for(const P in I)this.placedOrientations[P]||!this.opacities[P]||this.opacities[P].isHidden()||(this.placedOrientations[P]=I[P]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");f?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:e)}updateLayerOpacities(e,o){const f={};for(const y of o){const w=y.getBucket(e);w&&y.latestFeatureIndex&&e.id===w.layerIds[0]&&this.updateBucketOpacities(w,y.tileID,f,y.collisionBoxArray)}}updateBucketOpacities(e,o,f,y){e.hasTextData()&&(e.text.opacityVertexArray.clear(),e.text.hasVisibleVertices=!1),e.hasIconData()&&(e.icon.opacityVertexArray.clear(),e.icon.hasVisibleVertices=!1),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const w=e.layers[0],S=w.layout,I=new oc(null,0,!1,!1,!0),P=S.get("text-allow-overlap"),j=S.get("icon-allow-overlap"),Z=w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Y=S.get("text-rotation-alignment")==="map",H=S.get("text-pitch-alignment")==="map",ee=S.get("icon-text-fit")!=="none",ie=new oc(null,0,P&&(j||!e.hasIconData()||S.get("icon-optional")),j&&(P||!e.hasTextData()||S.get("text-optional")),!0);!e.collisionArrays&&y&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(y);const me=(ge,be,Se)=>{for(let ke=0;ke<be/4;ke++)ge.opacityVertexArray.emplaceBack(Se);ge.hasVisibleVertices=ge.hasVisibleVertices||Se!==Ts},pe=this.collisionBoxArrays.get(e.bucketInstanceId);for(let ge=0;ge<e.symbolInstances.length;ge++){const be=e.symbolInstances.get(ge),{numHorizontalGlyphVertices:Se,numVerticalGlyphVertices:ke,crossTileID:Re}=be;let Oe=this.opacities[Re];f[Re]?Oe=I:Oe||(Oe=ie,this.opacities[Re]=Oe),f[Re]=!0;const Pe=be.numIconVertices>0,He=this.placedOrientations[be.crossTileID],Ke=He===c.ai.vertical,st=He===c.ai.horizontal||He===c.ai.horizontalOnly;if(Se>0||ke>0){const nt=Gf(Oe.text);me(e.text,Se,Ke?Ts:nt),me(e.text,ke,st?Ts:nt);const kt=Oe.text.isHidden();[be.rightJustifiedTextSymbolIndex,be.centerJustifiedTextSymbolIndex,be.leftJustifiedTextSymbolIndex].forEach(zt=>{zt>=0&&(e.text.placedSymbolArray.get(zt).hidden=kt||Ke?1:0)}),be.verticalPlacedTextSymbolIndex>=0&&(e.text.placedSymbolArray.get(be.verticalPlacedTextSymbolIndex).hidden=kt||st?1:0);const Mt=this.variableOffsets[be.crossTileID];Mt&&this.markUsedJustification(e,Mt.anchor,be,He);const gt=this.placedOrientations[be.crossTileID];gt&&(this.markUsedJustification(e,"left",be,gt),this.markUsedOrientation(e,gt,be))}if(Pe){const nt=Gf(Oe.icon),kt=!(ee&&be.verticalPlacedIconSymbolIndex&&Ke);be.placedIconSymbolIndex>=0&&(me(e.icon,be.numIconVertices,kt?nt:Ts),e.icon.placedSymbolArray.get(be.placedIconSymbolIndex).hidden=Oe.icon.isHidden()),be.verticalPlacedIconSymbolIndex>=0&&(me(e.icon,be.numVerticalIconVertices,kt?Ts:nt),e.icon.placedSymbolArray.get(be.verticalPlacedIconSymbolIndex).hidden=Oe.icon.isHidden())}const ht=pe&&pe.has(ge)?pe.get(ge):{text:null,icon:null};if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const nt=e.collisionArrays[ge];if(nt){let kt=new c.P(0,0);if(nt.textBox||nt.verticalTextBox){let Mt=!0;if(Z){const gt=this.variableOffsets[Re];gt?(kt=Do(gt.anchor,gt.width,gt.height,gt.textOffset,gt.textBoxScale),Y&&kt._rotate(H?-this.transform.bearingInRadians:this.transform.bearingInRadians)):Mt=!1}if(nt.textBox||nt.verticalTextBox){let gt;nt.textBox&&(gt=Ke),nt.verticalTextBox&&(gt=st),yd(e.textCollisionBox.collisionVertexArray,Oe.text.placed,!Mt||gt,ht.text,kt.x,kt.y)}}if(nt.iconBox||nt.verticalIconBox){const Mt=!!(!st&&nt.verticalIconBox);let gt;nt.iconBox&&(gt=Mt),nt.verticalIconBox&&(gt=!Mt),yd(e.iconCollisionBox.collisionVertexArray,Oe.icon.placed,gt,ht.icon,ee?kt.x:0,ee?kt.y:0)}}}}if(e.sortFeatures(-this.transform.bearingInRadians),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.text.opacityVertexArray.length!==e.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${e.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${e.text.layoutVertexArray.length}) / 4`);if(e.icon.opacityVertexArray.length!==e.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${e.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${e.icon.layoutVertexArray.length}) / 4`);e.bucketInstanceId in this.collisionCircleArrays&&(e.collisionCircleArray=this.collisionCircleArrays[e.bucketInstanceId],delete this.collisionCircleArrays[e.bucketInstanceId])}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,o){const f=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*f>e}setStale(){this.stale=!0}}function yd(b,e,o,f,y,w){f&&f.length!==0||(f=[0,0,0,0]);const S=f[0]-Fi,I=f[1]-Fi,P=f[2]-Fi,j=f[3]-Fi;b.emplaceBack(e?1:0,o?1:0,y||0,w||0,S,I),b.emplaceBack(e?1:0,o?1:0,y||0,w||0,P,I),b.emplaceBack(e?1:0,o?1:0,y||0,w||0,P,j),b.emplaceBack(e?1:0,o?1:0,y||0,w||0,S,j)}const Uf=Math.pow(2,25),Io=Math.pow(2,24),sc=Math.pow(2,17),$s=Math.pow(2,16),Kg=Math.pow(2,9),vm=Math.pow(2,8),Vf=Math.pow(2,1);function Gf(b){if(b.opacity===0&&!b.placed)return 0;if(b.opacity===1&&b.placed)return 4294967295;const e=b.placed?1:0,o=Math.floor(127*b.opacity);return o*Uf+e*Io+o*sc+e*$s+o*Kg+e*vm+o*Vf+e}const Ts=0;class iu{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&!e.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,o,f,y,w){const S=this._bucketParts;for(;this._currentTileIndex<e.length;)if(o.getBucketParts(S,y,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort((I,P)=>I.sortKey-P.sortKey));this._currentPartIndex<S.length;)if(o.placeLayerBucketPart(S[this._currentPartIndex],this._seenCrossTileIDs,f),this._currentPartIndex++,w())return!0;return!1}}class Es{constructor(e,o,f,y,w,S,I,P){this.placement=new Zr(e,o,S,I,P),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(e,o,f){const y=F.now(),w=()=>!this._forceFullPlacement&&F.now()-y>2;for(;this._currentPlacementIndex>=0;){const S=o[e[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=I)&&(!S.maxzoom||S.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new iu(S)),this._inProgressLayer.continuePlacement(f[S.source],this.placement,this._showCollisionBoxes,S,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Qr=512/c.X/2;class _d{constructor(e,o,f){this.tileID=e,this.bucketInstanceId=f,this._symbolsByKey={};const y=new Map;for(let w=0;w<o.length;w++){const S=o.get(w),I=S.key,P=y.get(I);P?P.push(S):y.set(I,[S])}for(const[w,S]of y){const I={positions:S.map(P=>({x:Math.floor(P.anchorX*Qr),y:Math.floor(P.anchorY*Qr)})),crossTileIDs:S.map(P=>P.crossTileID)};if(I.positions.length>128){const P=new c.az(I.positions.length,16,Uint16Array);for(const{x:j,y:Z}of I.positions)P.add(j,Z);P.finish(),delete I.positions,I.index=P}this._symbolsByKey[w]=I}}getScaledCoordinates(e,o){const{x:f,y,z:w}=this.tileID.canonical,{x:S,y:I,z:P}=o.canonical,j=Qr/Math.pow(2,P-w),Z=(I*c.X+e.anchorY)*j,Y=y*c.X*Qr;return{x:Math.floor((S*c.X+e.anchorX)*j-f*c.X*Qr),y:Math.floor(Z-Y)}}findMatches(e,o,f){const y=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let w=0;w<e.length;w++){const S=e.get(w);if(S.crossTileID)continue;const I=this._symbolsByKey[S.key];if(!I)continue;const P=this.getScaledCoordinates(S,o);if(I.index){const j=I.index.range(P.x-y,P.y-y,P.x+y,P.y+y).sort();for(const Z of j){const Y=I.crossTileIDs[Z];if(!f[Y]){f[Y]=!0,S.crossTileID=Y;break}}}else if(I.positions)for(let j=0;j<I.positions.length;j++){const Z=I.positions[j],Y=I.crossTileIDs[j];if(Math.abs(Z.x-P.x)<=y&&Math.abs(Z.y-P.y)<=y&&!f[Y]){f[Y]=!0,S.crossTileID=Y;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:e})=>e)}}class vd{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ah{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const o=Math.round((e-this.lng)/360);if(o!==0)for(const f in this.indexes){const y=this.indexes[f],w={};for(const S in y){const I=y[S];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+o),w[I.tileID.key]=I}this.indexes[f]=w}this.lng=e}addBucket(e,o,f){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let w=0;w<o.symbolInstances.length;w++)o.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const y=this.usedCrossTileIDs[e.overscaledZ];for(const w in this.indexes){const S=this.indexes[w];if(Number(w)>e.overscaledZ)for(const I in S){const P=S[I];P.tileID.isChildOf(e)&&P.findMatches(o.symbolInstances,e,y)}else{const I=S[e.scaledTo(Number(w)).key];I&&I.findMatches(o.symbolInstances,e,y)}}for(let w=0;w<o.symbolInstances.length;w++){const S=o.symbolInstances.get(w);S.crossTileID||(S.crossTileID=f.generate(),y[S.crossTileID]=!0)}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new _d(e,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(e,o){for(const f of o.getCrossTileIDsLists())for(const y of f)delete this.usedCrossTileIDs[e][y]}removeStaleBuckets(e){let o=!1;for(const f in this.indexes){const y=this.indexes[f];for(const w in y)e[y[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(f,y[w]),delete y[w],o=!0)}return o}}class bl{constructor(){this.layerIndexes={},this.crossTileIDs=new vd,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,o,f){let y=this.layerIndexes[e.id];y===void 0&&(y=this.layerIndexes[e.id]=new ah);let w=!1;const S={};y.handleWrapJump(f);for(const I of o){const P=I.getBucket(e);P&&e.id===P.layerIds[0]&&(P.bucketInstanceId||(P.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(I.tileID,P,this.crossTileIDs)&&(w=!0),S[P.bucketInstanceId]=!0)}return y.removeStaleBuckets(S)&&(w=!0),w}pruneUnusedLayers(e){const o={};e.forEach(f=>{o[f]=!0});for(const f in this.layerIndexes)o[f]||delete this.layerIndexes[f]}}var ru="void main() {fragColor=vec4(1.0);}";const Ss={prelude:hn(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
out highp vec4 fragColor;`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}mat3 rotationMatrixFromAxisAngle(vec3 u,float angle) {float c=cos(angle);float s=sin(angle);float c2=1.0-c;return mat3(u.x*u.x*c2+      c,u.x*u.y*c2-u.z*s,u.x*u.z*c2+u.y*s,u.y*u.x*c2+u.z*s,u.y*u.y*c2+    c,u.y*u.z*c2-u.x*s,u.z*u.x*c2-u.y*s,u.z*u.y*c2+u.x*s,u.z*u.z*c2+    c
);}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
#ifdef GLOBE
if ((pos.y <-32767.5) || (pos.y > 32766.5)) {return 0.0;}
#endif
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}const float PI=3.141592653589793;uniform mat4 u_projection_matrix;`),projectionMercator:hn("","float projectLineThickness(float tileY) {return 1.0;}float projectCircleRadius(float tileY) {return 1.0;}vec4 projectTile(vec2 p) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);return result;}vec4 projectTile(vec2 p,vec2 rawPos) {vec4 result=u_projection_matrix*vec4(p,0.0,1.0);if (rawPos.y <-32767.5 || rawPos.y > 32766.5) {result.z=-10000000.0;}return result;}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return u_projection_matrix*vec4(posInTile,elevation,1.0);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {return projectTileWithElevation(posInTile,elevation);}"),projectionGlobe:hn("",`#define GLOBE_RADIUS 6371008.8
uniform highp vec4 u_projection_tile_mercator_coords;uniform highp vec4 u_projection_clipping_plane;uniform highp float u_projection_transition;uniform mat4 u_projection_fallback_matrix;vec3 globeRotateVector(vec3 vec,vec2 angles) {vec3 axisRight=vec3(vec.z,0.0,-vec.x);vec3 axisUp=cross(axisRight,vec);axisRight=normalize(axisRight);axisUp=normalize(axisUp);vec2 t=tan(angles);return normalize(vec+axisRight*t.x+axisUp*t.y);}mat3 globeGetRotationMatrix(vec3 spherePos) {vec3 axisRight=vec3(spherePos.z,0.0,-spherePos.x);vec3 axisDown=cross(axisRight,spherePos);axisRight=normalize(axisRight);axisDown=normalize(axisDown);return mat3(axisRight,axisDown,spherePos
);}float circumferenceRatioAtTileY(float tileY) {float mercator_pos_y=u_projection_tile_mercator_coords.y+u_projection_tile_mercator_coords.w*tileY;float spherical_y=2.0*atan(exp(PI-(mercator_pos_y*PI*2.0)))-PI*0.5;return cos(spherical_y);}float projectLineThickness(float tileY) {float thickness=1.0/circumferenceRatioAtTileY(tileY); 
if (u_projection_transition < 0.999) {return mix(1.0,thickness,u_projection_transition);} else {return thickness;}}vec3 projectToSphere(vec2 translatedPos,vec2 rawPos) {vec2 mercator_pos=u_projection_tile_mercator_coords.xy+u_projection_tile_mercator_coords.zw*translatedPos;vec2 spherical;spherical.x=mercator_pos.x*PI*2.0+PI;spherical.y=2.0*atan(exp(PI-(mercator_pos.y*PI*2.0)))-PI*0.5;float len=cos(spherical.y);vec3 pos=vec3(sin(spherical.x)*len,sin(spherical.y),cos(spherical.x)*len
);if (rawPos.y <-32767.5) {pos=vec3(0.0,1.0,0.0);}if (rawPos.y > 32766.5) {pos=vec3(0.0,-1.0,0.0);}return pos;}vec3 projectToSphere(vec2 posInTile) {return projectToSphere(posInTile,vec2(0.0,0.0));}float globeComputeClippingZ(vec3 spherePos) {return (1.0-(dot(spherePos,u_projection_clipping_plane.xyz)+u_projection_clipping_plane.w));}vec4 interpolateProjection(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);globePosition.z=globeComputeClippingZ(elevatedPos)*globePosition.w;if (u_projection_transition > 0.999) {return globePosition;}vec4 flatPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);const float z_globeness_threshold=0.2;vec4 result=globePosition;result.z=mix(0.0,globePosition.z,clamp((u_projection_transition-z_globeness_threshold)/(1.0-z_globeness_threshold),0.0,1.0));result.xyw=mix(flatPosition.xyw,globePosition.xyw,u_projection_transition);if ((posInTile.y <-32767.5) || (posInTile.y > 32766.5)) {result=globePosition;const float poles_hidden_anim_percentage=0.02;result.z=mix(globePosition.z,100.0,pow(max((1.0-u_projection_transition)/poles_hidden_anim_percentage,0.0),8.0));}return result;}vec4 interpolateProjectionFor3D(vec2 posInTile,vec3 spherePos,float elevation) {vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);vec4 globePosition=u_projection_matrix*vec4(elevatedPos,1.0);if (u_projection_transition > 0.999) {return globePosition;}vec4 fallbackPosition=u_projection_fallback_matrix*vec4(posInTile,elevation,1.0);return mix(fallbackPosition,globePosition,u_projection_transition);}vec4 projectTile(vec2 posInTile) {return interpolateProjection(posInTile,projectToSphere(posInTile),0.0);}vec4 projectTile(vec2 posInTile,vec2 rawPos) {return interpolateProjection(posInTile,projectToSphere(posInTile,rawPos),0.0);}vec4 projectTileWithElevation(vec2 posInTile,float elevation) {return interpolateProjection(posInTile,projectToSphere(posInTile),elevation);}vec4 projectTileFor3D(vec2 posInTile,float elevation) {vec3 spherePos=projectToSphere(posInTile,posInTile);return interpolateProjectionFor3D(posInTile,spherePos,elevation);}`),background:hn(`uniform vec4 u_color;uniform float u_opacity;void main() {fragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),backgroundPattern:hn(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;void main() {gl_Position=projectTile(a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:hn(`in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);float antialiased_blur=v_data.z;float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));fragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);const float epsilon=0.5/255.0;if (fragColor.r < epsilon && fragColor.g < epsilon && fragColor.b < epsilon && fragColor.a < epsilon) {discard;}
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform highp float u_globe_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;uniform vec2 u_translate;in vec2 a_pos;out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 pos_raw=a_pos+32768.0;vec2 extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);vec2 circle_center=floor(pos_raw/8.0)+u_translate;float ele=get_elevation(circle_center);v_visibility=calculate_visibility(projectTileWithElevation(circle_center,ele));if (u_pitch_with_map) {
#ifdef GLOBE
vec3 center_vector=projectToSphere(circle_center);
#endif
float angle_scale=u_globe_extrude_scale;vec2 corner_position=circle_center;if (u_scale_with_map) {angle_scale*=(radius+stroke_width);corner_position+=extrude*u_extrude_scale*(radius+stroke_width);} else {
#ifdef GLOBE
vec4 projected_center=interpolateProjection(circle_center,center_vector,ele);
#else
vec4 projected_center=projectTileWithElevation(circle_center,ele);
#endif
corner_position+=extrude*u_extrude_scale*(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);angle_scale*=(radius+stroke_width)*(projected_center.w/u_camera_to_center_distance);}
#ifdef GLOBE
vec2 angles=extrude*angle_scale;vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(corner_position,corner_vector,ele);
#else
gl_Position=projectTileWithElevation(corner_position,ele);
#endif
} else {gl_Position=projectTileWithElevation(circle_center,ele);if (gl_Position.z/gl_Position.w > 1.0) {gl_Position.xy=vec2(10000.0);}if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}float antialiasblur=-max(1.0/u_device_pixel_ratio/(radius+stroke_width),blur);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:hn(ru,"in vec2 a_pos;void main() {gl_Position=projectTile(a_pos);}"),heatmap:hn(`uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);fragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;uniform highp float u_globe_extrude_scale;in vec2 a_pos;out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 pos_raw=a_pos+32768.0;vec2 unscaled_extrude=vec2(mod(pos_raw,8.0)/7.0*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 circle_center=floor(pos_raw/8.0);
#ifdef GLOBE
vec2 angles=v_extrude*radius*u_globe_extrude_scale;vec3 center_vector=projectToSphere(circle_center);vec3 corner_vector=globeRotateVector(center_vector,angles);gl_Position=interpolateProjection(circle_center+extrude,corner_vector,0.0);
#else
gl_Position=projectTileFor3D(circle_center+extrude,get_elevation(circle_center));
#endif
}`),heatmapTexture:hn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));fragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:hn("in float v_placed;in float v_notUsed;void main() {float alpha=0.5;fragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {fragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {fragColor*=.1;}}","in vec2 a_anchor_pos;in vec2 a_placed;in vec2 a_box_real;uniform vec2 u_pixel_extrude_scale;out float v_placed;out float v_notUsed;void main() {gl_Position=projectTileWithElevation(a_anchor_pos,get_elevation(a_anchor_pos));gl_Position.xy=((a_box_real+0.5)*u_pixel_extrude_scale*2.0-1.0)*vec2(1.0,-1.0)*gl_Position.w;if (gl_Position.z/gl_Position.w < 1.1) {gl_Position.z=0.5;}v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:hn("in float v_radius;in vec2 v_extrude;in float v_collision;void main() {float alpha=0.5;float stroke_radius=0.9;float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);fragColor=color*alpha*opacity_t;}","in vec2 a_pos;in float a_radius;in vec2 a_flags;uniform vec2 u_viewport_size;out float v_radius;out vec2 v_extrude;out float v_collision;void main() {float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_collision=collision;gl_Position=vec4((a_pos/u_viewport_size*2.0-1.0)*vec2(1.0,-1.0),0.0,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:hn("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);fragColor=mix(u_color,overlay_color,overlay_color.a);}","in vec2 a_pos;out vec2 v_uv;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=projectTileWithElevation(a_pos*u_overlay_scale,get_elevation(a_pos));}"),depth:hn(ru,`in vec2 a_pos;void main() {
#ifdef GLOBE
gl_Position=projectTileFor3D(a_pos,0.0);
#else
gl_Position=u_projection_matrix*vec4(a_pos,0.0,1.0);
#endif
}`),fill:hn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
fragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_fill_translate;in vec2 a_pos;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);}`),fillOutline:hn(`in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=outline_color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillOutlinePattern:hn(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;in vec2 v_pos_a;in vec2 v_pos_b;in vec2 v_pos;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);fragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;out vec2 v_pos;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
}`),fillPattern:hn(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);fragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;uniform vec2 u_fill_translate;in vec2 a_pos;out vec2 v_pos_a;out vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=projectTile(a_pos+u_fill_translate,a_pos);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:hn(`in vec4 v_color;void main() {fragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
out vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;vec3 normalForLighting=normal/16384.0;float directional=clamp(dot(normalForLighting,u_lightpos),0.0,1.0);
#ifdef GLOBE
mat3 rotMatrix=globeGetRotationMatrix(spherePos);normalForLighting=rotMatrix*normalForLighting;directional=mix(directional,clamp(dot(normalForLighting,u_lightpos_globe),0.0,1.0),u_projection_transition);
#endif
directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:hn(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;in vec2 v_pos_a;in vec2 v_pos_b;in vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);fragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec2 u_fill_translate;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp vec3 u_lightpos_globe;uniform lowp float u_lightintensity;in vec2 a_pos;in vec4 a_normal_ed;
#ifdef TERRAIN3D
in vec2 a_centroid;
#endif
#ifdef GLOBE
out vec3 v_sphere_pos;
#endif
out vec2 v_pos_a;out vec2 v_pos_b;out vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float elevation=t > 0.0 ? height : base;vec2 posInTile=a_pos+u_fill_translate;
#ifdef GLOBE
vec3 spherePos=projectToSphere(posInTile,a_pos);vec3 elevatedPos=spherePos*(1.0+elevation/GLOBE_RADIUS);v_sphere_pos=elevatedPos;gl_Position=interpolateProjectionFor3D(posInTile,spherePos,elevation);
#else
gl_Position=u_projection_matrix*vec4(posInTile,elevation,1.0);
#endif
vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,elevation*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:hn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));fragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:hn(`uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);fragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=projectTile(a_pos,a_pos);v_pos=a_pos/8192.0;if (a_pos.y <-32767.5) {v_pos.y=0.0;}if (a_pos.y > 32766.5) {v_pos.y=1.0;}}"),line:hn(`uniform lowp float u_device_pixel_ratio;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp float v_linesofar;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:hn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec2 v_uv;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture(u_image,v_uv);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;in float a_uv_x;in float a_split_index;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec2 v_uv;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:hn(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture(u_image,pos_a),texture(u_image,pos_b),u_fade);fragColor=color*alpha*opacity;
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;out vec2 v_normal;out vec2 v_width2;out float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:hn(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;in vec2 v_normal;in vec2 v_width2;in vec2 v_tex_a;in vec2 v_tex_b;in float v_gamma_scale;
#ifdef GLOBE
in float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture(u_image,v_tex_a).a;float sdfdist_b=texture(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);fragColor=color*(alpha*opacity);
#ifdef GLOBE
if (v_depth > 1.0) {discard;}
#endif
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
in vec2 a_pos_normal;in vec4 a_data;uniform vec2 u_translation;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;out vec2 v_normal;out vec2 v_width2;out vec2 v_tex_a;out vec2 v_tex_b;out float v_gamma_scale;
#ifdef GLOBE
out float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float adjustedThickness=projectLineThickness(pos.y);vec4 projected_no_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation);vec4 projected_with_extrude=projectTile(pos+offset2/u_ratio*adjustedThickness+u_translation+dist/u_ratio*adjustedThickness);gl_Position=projected_with_extrude;
#ifdef GLOBE
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length((projected_with_extrude.xy-projected_no_extrude.xy)/projected_with_extrude.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:hn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;in vec2 v_pos0;in vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture(u_image0,v_pos0);vec4 color1=texture(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);fragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;uniform vec4 u_coords_top;uniform vec4 u_coords_bottom;in vec2 a_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {vec2 fractionalPos=a_pos/8192.0;vec2 position=mix(mix(u_coords_top.xy,u_coords_top.zw,fractionalPos.x),mix(u_coords_bottom.xy,u_coords_bottom.zw,fractionalPos.x),fractionalPos.y);gl_Position=projectTile(position,position);v_pos0=((fractionalPos-0.5)/u_buffer_scale)+0.5;
#ifdef GLOBE
if (a_pos.y <-32767.5) {v_pos0.y=0.0;}if (a_pos.y > 32766.5) {v_pos0.y=1.0;}
#endif
v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),symbolIcon:hn(`uniform sampler2D u_texture;in vec2 v_tex;in float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;fragColor=texture(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_tex;out float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}gl_Position=finalPos;v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:hn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;in vec2 v_data0;in vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec4 a_pixeloffset;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_translation;uniform float u_pitched_scale;out vec2 v_data0;out vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:hn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;in vec4 v_data0;in vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;fragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);fragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
fragColor=vec4(1.0);
#endif
}`,`in vec4 a_pos_offset;in vec4 a_data;in vec3 a_projected_pos;in float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform bool u_is_along_line;uniform bool u_is_variable_anchor;uniform vec2 u_translation;uniform float u_pitched_scale;out vec4 v_data0;out vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 translated_a_pos=a_pos+u_translation;vec4 projectedPoint=projectTileWithElevation(translated_a_pos,ele);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=projectTileWithElevation(translated_a_pos+vec2(1,0),ele);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos;if (u_is_along_line || u_is_variable_anchor) {projected_pos=vec4(a_projected_pos.xy,ele,1.0);} else if (u_pitch_with_map) {projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy+u_translation,ele,1.0);} else {projected_pos=u_label_plane_matrix*projectTileWithElevation(a_projected_pos.xy+u_translation,ele);}float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;float projectionScaling=1.0;
#ifdef GLOBE
if(u_pitch_with_map && !u_is_along_line) {float anchor_pos_tile_y=(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w,z,1.0)).y;projectionScaling=mix(projectionScaling,1.0/circumferenceRatioAtTileY(anchor_pos_tile_y)*u_pitched_scale,u_projection_transition);}
#endif
vec4 finalPos=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale)*projectionScaling,z,1.0);if(u_pitch_with_map) {finalPos=projectTileWithElevation(finalPos.xy,finalPos.z);}float gamma_scale=finalPos.w;gl_Position=finalPos;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:hn("uniform sampler2D u_texture;uniform vec4 u_fog_color;uniform vec4 u_horizon_color;uniform float u_fog_ground_blend;uniform float u_fog_ground_blend_opacity;uniform float u_horizon_fog_blend;uniform bool u_is_globe_mode;in vec2 v_texture_pos;in float v_fog_depth;const float gamma=2.2;vec4 gammaToLinear(vec4 color) {return pow(color,vec4(gamma));}vec4 linearToGamma(vec4 color) {return pow(color,vec4(1.0/gamma));}void main() {vec4 surface_color=texture(u_texture,vec2(v_texture_pos.x,1.0-v_texture_pos.y));if (!u_is_globe_mode && v_fog_depth > u_fog_ground_blend) {vec4 surface_color_linear=gammaToLinear(surface_color);float blend_color=smoothstep(0.0,1.0,max((v_fog_depth-u_horizon_fog_blend)/(1.0-u_horizon_fog_blend),0.0));vec4 fog_horizon_color_linear=mix(gammaToLinear(u_fog_color),gammaToLinear(u_horizon_color),blend_color);float factor_fog=max(v_fog_depth-u_fog_ground_blend,0.0)/(1.0-u_fog_ground_blend);fragColor=linearToGamma(mix(surface_color_linear,fog_horizon_color_linear,pow(factor_fog,2.0)*u_fog_ground_blend_opacity));} else {fragColor=surface_color;}}","in vec3 a_pos3d;uniform mat4 u_fog_matrix;uniform float u_ele_delta;out vec2 v_texture_pos;out float v_fog_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta);vec4 pos=u_fog_matrix*vec4(a_pos3d.xy,ele,1.0);v_fog_depth=pos.z/pos.w*0.5+0.5;}"),terrainDepth:hn("in float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {fragColor=pack(v_depth);}","in vec3 a_pos3d;uniform float u_ele_delta;out float v_depth;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);v_depth=gl_Position.z/gl_Position.w;}"),terrainCoords:hn("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;in vec2 v_texture_pos;void main() {vec4 rgba=texture(u_texture,v_texture_pos);fragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}","in vec3 a_pos3d;uniform float u_ele_delta;out vec2 v_texture_pos;void main() {float ele=get_elevation(a_pos3d.xy);float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/8192.0;gl_Position=projectTileFor3D(a_pos3d.xy,ele-ele_delta);}"),projectionErrorMeasurement:hn("in vec4 v_output_error_encoded;void main() {fragColor=v_output_error_encoded;}","in vec2 a_pos;uniform highp float u_input;uniform highp float u_output_expected;out vec4 v_output_error_encoded;void main() {float real_output=2.0*atan(exp(PI-(u_input*PI*2.0)))-PI*0.5;float error=real_output-u_output_expected;float abs_error=abs(error)*128.0;v_output_error_encoded.x=min(floor(abs_error*256.0),255.0)/255.0;abs_error-=v_output_error_encoded.x;v_output_error_encoded.y=min(floor(abs_error*65536.0),255.0)/255.0;abs_error-=v_output_error_encoded.x/255.0;v_output_error_encoded.z=min(floor(abs_error*16777216.0),255.0)/255.0;v_output_error_encoded.w=error >=0.0 ? 1.0 : 0.0;gl_Position=vec4(a_pos,0.0,1.0);}"),atmosphere:hn(`in vec3 view_direction;uniform vec3 u_sun_pos;uniform vec3 u_globe_position;uniform float u_globe_radius;uniform float u_atmosphere_blend;/**Shader use from https:*Made some change to adapt to MapLibre Globe geometry*/const float PI=3.141592653589793;const int iSteps=5;const int jSteps=3;/*radius of the planet*/const float EARTH_RADIUS=6371e3;/*radius of the atmosphere*/const float ATMOS_RADIUS=6471e3;vec2 rsi(vec3 r0,vec3 rd,float sr) {float a=dot(rd,rd);float b=2.0*dot(rd,r0);float c=dot(r0,r0)-(sr*sr);float d=(b*b)-4.0*a*c;if (d < 0.0) return vec2(1e5,-1e5);return vec2((-b-sqrt(d))/(2.0*a),(-b+sqrt(d))/(2.0*a));}vec4 atmosphere(vec3 r,vec3 r0,vec3 pSun,float iSun,float rPlanet,float rAtmos,vec3 kRlh,float kMie,float shRlh,float shMie,float g) {pSun=normalize(pSun);r=normalize(r);vec2 p=rsi(r0,r,rAtmos);if (p.x > p.y) {return vec4(0.0,0.0,0.0,1.0);}if (p.x < 0.0) {p.x=0.0;}vec3 pos=r0+r*p.x;vec2 p2=rsi(r0,r,rPlanet);if (p2.x <=p2.y && p2.x > 0.0) {p.y=min(p.y,p2.x);}float iStepSize=(p.y-p.x)/float(iSteps);float iTime=p.x+iStepSize*0.5;vec3 totalRlh=vec3(0,0,0);vec3 totalMie=vec3(0,0,0);float iOdRlh=0.0;float iOdMie=0.0;float mu=dot(r,pSun);float mumu=mu*mu;float gg=g*g;float pRlh=3.0/(16.0*PI)*(1.0+mumu);float pMie=3.0/(8.0*PI)*((1.0-gg)*(mumu+1.0))/(pow(1.0+gg-2.0*mu*g,1.5)*(2.0+gg));for (int i=0; i < iSteps; i++) {vec3 iPos=r0+r*iTime;float iHeight=length(iPos)-rPlanet;float odStepRlh=exp(-iHeight/shRlh)*iStepSize;float odStepMie=exp(-iHeight/shMie)*iStepSize;iOdRlh+=odStepRlh;iOdMie+=odStepMie;float jStepSize=rsi(iPos,pSun,rAtmos).y/float(jSteps);float jTime=jStepSize*0.5;float jOdRlh=0.0;float jOdMie=0.0;for (int j=0; j < jSteps; j++) {vec3 jPos=iPos+pSun*jTime;float jHeight=length(jPos)-rPlanet;jOdRlh+=exp(-jHeight/shRlh)*jStepSize;jOdMie+=exp(-jHeight/shMie)*jStepSize;jTime+=jStepSize;}vec3 attn=exp(-(kMie*(iOdMie+jOdMie)+kRlh*(iOdRlh+jOdRlh)));totalRlh+=odStepRlh*attn;totalMie+=odStepMie*attn;iTime+=iStepSize;}float opacity=exp(-(length(kRlh)*length(totalRlh)+kMie*length(totalMie)));vec3 color=iSun*(pRlh*kRlh*totalRlh+pMie*kMie*totalMie);return vec4(color,opacity);}void main() {vec3 scale_camera_pos=-u_globe_position*EARTH_RADIUS/u_globe_radius;vec4 color=atmosphere(normalize(view_direction),scale_camera_pos,u_sun_pos,22.0,EARTH_RADIUS,ATMOS_RADIUS,vec3(5.5e-6,13.0e-6,22.4e-6),21e-6,8e3,1.2e3,0.758
);color.rgb=1.0-exp(-1.0*color.rgb);color=pow(color,vec4(1.0/2.2));fragColor=vec4(color.rgb,1.0-color.a)*u_atmosphere_blend;}`,"in vec2 a_pos;uniform mat4 u_inv_proj_matrix;out vec3 view_direction;void main() {view_direction=(u_inv_proj_matrix*vec4(a_pos,0.0,1.0)).xyz;gl_Position=vec4(a_pos,0.0,1.0);}"),sky:hn("uniform vec4 u_sky_color;uniform vec4 u_horizon_color;uniform vec2 u_horizon;uniform vec2 u_horizon_normal;uniform float u_sky_horizon_blend;uniform float u_sky_blend;void main() {float x=gl_FragCoord.x;float y=gl_FragCoord.y;float blend=(y-u_horizon.y)*u_horizon_normal.y+(x-u_horizon.x)*u_horizon_normal.x;if (blend > 0.0) {if (blend < u_sky_horizon_blend) {fragColor=mix(u_sky_color,u_horizon_color,pow(1.0-blend/u_sky_horizon_blend,2.0));} else {fragColor=u_sky_color;}}fragColor=mix(fragColor,vec4(vec3(0.0),0.0),u_sky_blend);}","in vec2 a_pos;void main() {gl_Position=vec4(a_pos,1.0,1.0);}")};function hn(b,e){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,f=e.match(/in ([\w]+) ([\w]+)/g),y=b.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),w=e.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=w?w.concat(y):y,I={};return{fragmentSource:b=b.replace(o,(P,j,Z,Y,H)=>(I[H]=!0,j==="define"?`
#ifndef HAS_UNIFORM_u_${H}
in ${Z} ${Y} ${H};
#else
uniform ${Z} ${Y} u_${H};
#endif
`:`
#ifdef HAS_UNIFORM_u_${H}
    ${Z} ${Y} ${H} = u_${H};
#endif
`)),vertexSource:e=e.replace(o,(P,j,Z,Y,H)=>{const ee=Y==="float"?"vec2":"vec4",ie=H.match(/color/)?"color":ee;return I[H]?j==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
in ${Z} ${ee} a_${H};
out ${Z} ${Y} ${H};
#else
uniform ${Z} ${Y} u_${H};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = a_${H};
#else
    ${Z} ${Y} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${H} = unpack_mix_${ie}(a_${H}, u_${H}_t);
#else
    ${Z} ${Y} ${H} = u_${H};
#endif
`:j==="define"?`
#ifndef HAS_UNIFORM_u_${H}
uniform lowp float u_${H}_t;
in ${Z} ${ee} a_${H};
#else
uniform ${Z} ${Y} u_${H};
#endif
`:ie==="vec4"?`
#ifndef HAS_UNIFORM_u_${H}
    ${Z} ${Y} ${H} = a_${H};
#else
    ${Z} ${Y} ${H} = u_${H};
#endif
`:`
#ifndef HAS_UNIFORM_u_${H}
    ${Z} ${Y} ${H} = unpack_mix_${ie}(a_${H}, u_${H}_t);
#else
    ${Z} ${Y} ${H} = u_${H};
#endif
`}),staticAttributes:f,staticUniforms:S}}class ko{constructor(e,o,f){this.vertexBuffer=e,this.indexBuffer=o,this.segments=f}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.vertexBuffer=null,this.indexBuffer=null,this.segments=null}}var Dn=c.aA([{name:"a_pos",type:"Int16",components:2}]);const au="#define PROJECTION_MERCATOR",lc="mercator";class ou{constructor(){this._cachedMesh=null}get name(){return"mercator"}get useSubdivision(){return!1}get shaderVariantName(){return lc}get shaderDefine(){return au}get shaderPreludeCode(){return Ss.projectionMercator}get vertexShaderPreludeCode(){return Ss.projectionMercator.vertexSource}get subdivisionGranularity(){return c.aB.noSubdivision}get useGlobeControls(){return!1}get transitionState(){return 0}get latitudeErrorCorrectionRadians(){return 0}destroy(){}updateGPUdependent(e){}getMeshFromTileID(e,o,f,y,w){if(this._cachedMesh)return this._cachedMesh;const S=new c.aC;S.emplaceBack(0,0),S.emplaceBack(c.X,0),S.emplaceBack(0,c.X),S.emplaceBack(c.X,c.X);const I=e.createVertexBuffer(S,Dn.members),P=c.aD.simpleSegment(0,0,4,2),j=new c.aE;j.emplaceBack(1,0,2),j.emplaceBack(1,2,3);const Z=e.createIndexBuffer(j);return this._cachedMesh=new ko(I,Z,P),this._cachedMesh}recalculate(){}hasTransition(){return!1}setErrorQueryLatitudeDegrees(e){}}function or(b,e){const o=c.ab(e.lat,-85.051129,c.aF);return new c.P(c.O(e.lng)*b,c.Q(o)*b)}function qi(b,e){return new c.Y(e.x/b,e.y/b).toLngLat()}function Hi(b){return b.cameraToCenterDistance*Math.min(.85*Math.tan(c.aa(90-b.pitch)),Math.tan(c.aa(89.25-b.pitch)))}function bd(b,e){const o=b.canonical,f=e/c.aG(o.z),y=o.x+Math.pow(2,o.z)*b.wrap,w=c.aq(new Float64Array(16));return c.J(w,w,[y*f,o.y*f,0]),c.K(w,w,[f/c.X,f/c.X,1]),w}function oa(b,e,o,f,y){const w=c.Y.fromLngLat(b,e),S=y*c.aH(1,b.lat),I=S*Math.cos(c.aa(o)),P=Math.sqrt(S*S-I*I),j=P*Math.sin(c.aa(-f)),Z=P*Math.cos(c.aa(-f));return new c.Y(w.x+j,w.y+Z,w.z+I)}class Kr{constructor(e=0,o=0,f=0,y=0){if(isNaN(e)||e<0||isNaN(o)||o<0||isNaN(f)||f<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=o,this.left=f,this.right=y}interpolate(e,o,f){return o.top!=null&&e.top!=null&&(this.top=c.y.number(e.top,o.top,f)),o.bottom!=null&&e.bottom!=null&&(this.bottom=c.y.number(e.bottom,o.bottom,f)),o.left!=null&&e.left!=null&&(this.left=c.y.number(e.left,o.left,f)),o.right!=null&&e.right!=null&&(this.right=c.y.number(e.right,o.right,f)),this}getCenter(e,o){const f=c.ab((this.left+e-this.right)/2,0,e),y=c.ab((this.top+o-this.bottom)/2,0,o);return new c.P(f,y)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Kr(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function da(b,e){if(!b.renderWorldCopies||b.lngRange)return;const o=e.lng-b.center.lng;e.lng+=o>180?-360:o<-180?360:0}function Zf(b){return Math.max(0,Math.floor(b))}class As{constructor(e,o,f,y,w,S){this._callbacks=e,this._tileSize=512,this._renderWorldCopies=S===void 0||!!S,this._minZoom=o||0,this._maxZoom=f||22,this._minPitch=y??0,this._maxPitch=w??60,this.setMaxBounds(),this._width=0,this._height=0,this._center=new c.N(0,0),this._elevation=0,this._zoom=0,this._tileZoom=Zf(this._zoom),this._scale=c.aG(this._zoom),this._bearingInRadians=0,this._fovInRadians=.6435011087932844,this._pitchInRadians=0,this._rollInRadians=0,this._unmodified=!0,this._edgeInsets=new Kr,this._minElevationForCurrentTile=0,this._autoCalculateNearFarZ=!0}apply(e,o,f){this._latRange=e.latRange,this._lngRange=e.lngRange,this._width=e.width,this._height=e.height,this._center=e.center,this._elevation=e.elevation,this._minElevationForCurrentTile=e.minElevationForCurrentTile,this._zoom=e.zoom,this._tileZoom=Zf(this._zoom),this._scale=c.aG(this._zoom),this._bearingInRadians=e.bearingInRadians,this._fovInRadians=e.fovInRadians,this._pitchInRadians=e.pitchInRadians,this._rollInRadians=e.rollInRadians,this._unmodified=e.unmodified,this._edgeInsets=new Kr(e.padding.top,e.padding.bottom,e.padding.left,e.padding.right),this._minZoom=e.minZoom,this._maxZoom=e.maxZoom,this._minPitch=e.minPitch,this._maxPitch=e.maxPitch,this._renderWorldCopies=e.renderWorldCopies,this._cameraToCenterDistance=e.cameraToCenterDistance,this._nearZ=e.nearZ,this._farZ=e.farZ,this._autoCalculateNearFarZ=!f&&e.autoCalculateNearFarZ,o&&this._constrain(),this._calcMatrices()}get pixelsToClipSpaceMatrix(){return this._pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._clipSpaceToPixelsMatrix}get minElevationForCurrentTile(){return this._minElevationForCurrentTile}setMinElevationForCurrentTile(e){this._minElevationForCurrentTile=e}get tileSize(){return this._tileSize}get tileZoom(){return this._tileZoom}get scale(){return this._scale}get width(){return this._width}get height(){return this._height}get bearingInRadians(){return this._bearingInRadians}get lngRange(){return this._lngRange}get latRange(){return this._latRange}get pixelsToGLUnits(){return this._pixelsToGLUnits}get minZoom(){return this._minZoom}setMinZoom(e){this._minZoom!==e&&(this._minZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get maxZoom(){return this._maxZoom}setMaxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.setZoom(this.getConstrained(this._center,this.zoom).zoom))}get minPitch(){return this._minPitch}setMinPitch(e){this._minPitch!==e&&(this._minPitch=e,this.setPitch(Math.max(this.pitch,e)))}get maxPitch(){return this._maxPitch}setMaxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.setPitch(Math.min(this.pitch,e)))}get renderWorldCopies(){return this._renderWorldCopies}setRenderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this._tileSize*this._scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new c.P(this._width,this._height)}get bearing(){return this._bearingInRadians/Math.PI*180}setBearing(e){const o=c.aI(e,-180,180)*Math.PI/180;var f,y,w,S,I,P,j,Z,Y;this._bearingInRadians!==o&&(this._unmodified=!1,this._bearingInRadians=o,this._calcMatrices(),this._rotationMatrix=D(),f=this._rotationMatrix,w=-this._bearingInRadians,S=(y=this._rotationMatrix)[0],I=y[1],P=y[2],j=y[3],Z=Math.sin(w),Y=Math.cos(w),f[0]=S*Y+P*Z,f[1]=I*Y+j*Z,f[2]=S*-Z+P*Y,f[3]=I*-Z+j*Y)}get rotationMatrix(){return this._rotationMatrix}get pitchInRadians(){return this._pitchInRadians}get pitch(){return this._pitchInRadians/Math.PI*180}setPitch(e){const o=c.ab(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitchInRadians!==o&&(this._unmodified=!1,this._pitchInRadians=o,this._calcMatrices())}get rollInRadians(){return this._rollInRadians}get roll(){return this._rollInRadians/Math.PI*180}setRoll(e){const o=e/180*Math.PI;this._rollInRadians!==o&&(this._unmodified=!1,this._rollInRadians=o,this._calcMatrices())}get fovInRadians(){return this._fovInRadians}get fov(){return c.aJ(this._fovInRadians)}setFov(e){e=c.ab(e,.1,150),this.fov!==e&&(this._unmodified=!1,this._fovInRadians=c.aa(e),this._calcMatrices())}get zoom(){return this._zoom}setZoom(e){const o=this.getConstrained(this._center,e).zoom;this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this._tileZoom=Math.max(0,Math.floor(o)),this._scale=c.aG(o),this._constrain(),this._calcMatrices())}get center(){return this._center}setCenter(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}setElevation(e){e!==this._elevation&&(this._elevation=e,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}setPadding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this._width,this._height)}get pixelsPerMeter(){return this._pixelPerMeter}get unmodified(){return this._unmodified}get cameraToCenterDistance(){return this._cameraToCenterDistance}get nearZ(){return this._nearZ}get farZ(){return this._farZ}get autoCalculateNearFarZ(){return this._autoCalculateNearFarZ}overrideNearFarZ(e,o){this._autoCalculateNearFarZ=!1,this._nearZ=e,this._farZ=o,this._calcMatrices()}clearNearFarZOverride(){this._autoCalculateNearFarZ=!0,this._calcMatrices()}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,o,f){this._unmodified=!1,this._edgeInsets.interpolate(e,o,f),this._constrain(),this._calcMatrices()}resize(e,o,f=!0){this._width=e,this._height=o,f&&this._constrain(),this._calcMatrices()}getMaxBounds(){return this._latRange&&this._latRange.length===2&&this._lngRange&&this._lngRange.length===2?new ci([this._lngRange[0],this._latRange[0]],[this._lngRange[1],this._latRange[1]]):null}setMaxBounds(e){e?(this._lngRange=[e.getWest(),e.getEast()],this._latRange=[e.getSouth(),e.getNorth()],this._constrain()):(this._lngRange=null,this._latRange=[-85.051129,c.aF])}getConstrained(e,o){return this._callbacks.getConstrained(e,o)}getCameraQueryGeometry(e,o){if(o.length===1)return[o[0],e];{let f=e.x,y=e.y,w=e.x,S=e.y;for(const I of o)f=Math.min(f,I.x),y=Math.min(y,I.y),w=Math.max(w,I.x),S=Math.max(S,I.y);return[new c.P(f,y),new c.P(w,y),new c.P(w,S),new c.P(f,S),new c.P(f,y)]}}_constrain(){if(!this.center||!this._width||!this._height||this._constraining)return;this._constraining=!0;const e=this._unmodified,{center:o,zoom:f}=this.getConstrained(this.center,this.zoom);this.setCenter(o),this.setZoom(f),this._unmodified=e,this._constraining=!1}_calcMatrices(){if(this._width&&this._height){this._pixelsToGLUnits=[2/this._width,-2/this._height];let e=c.aq(new Float64Array(16));c.K(e,e,[this._width/2,-this._height/2,1]),c.J(e,e,[1,-1,0]),this._clipSpaceToPixelsMatrix=e,e=c.aq(new Float64Array(16)),c.K(e,e,[1,-1,1]),c.J(e,e,[-1,-1,0]),c.K(e,e,[2/this._width,2/this._height,1]),this._pixelsToClipSpaceMatrix=e,this._cameraToCenterDistance=.5/Math.tan(this.fovInRadians/2)*this._height}this._callbacks.calcMatrices()}calculateCenterFromCameraLngLatAlt(e,o,f,y){const w=f!==void 0?f:this.bearing,S=y=y!==void 0?y:this.pitch,I=c.Y.fromLngLat(e,o),P=-Math.cos(c.aa(S)),j=Math.sin(c.aa(S)),Z=j*Math.sin(c.aa(w)),Y=-j*Math.cos(c.aa(w));let H=this.elevation;const ee=o-H;let ie;P*ee>=0||Math.abs(P)<.1?(ie=1e4,H=o+ie*P):ie=-ee/P;let me,pe,ge=c.aK(1,I.y),be=0;do{if(be+=1,be>10)break;pe=ie/ge,me=new c.Y(I.x+Z*pe,I.y+Y*pe),ge=1/me.meterInMercatorCoordinateUnits()}while(Math.abs(ie-pe*ge)>1e-12);return{center:me.toLngLat(),elevation:H,zoom:c.a8(this.height/2/Math.tan(this.fovInRadians/2)/pe/this.tileSize)}}recalculateZoomAndCenter(e){if(this.elevation-e==0)return;const o=c.aH(1,this.center.lat)*this.worldSize,f=this.cameraToCenterDistance/o,y=c.Y.fromLngLat(this.center,this.elevation),w=oa(this.center,this.elevation,this.pitch,this.bearing,f);this._elevation=e;const S=this.calculateCenterFromCameraLngLatAlt(w.toLngLat(),c.aK(w.z,y.y),this.bearing,this.pitch);this._elevation=S.elevation,this._center=S.center,this.setZoom(S.zoom)}getCameraPoint(){const e=Math.tan(this.pitchInRadians)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new c.P(e*Math.sin(this.rollInRadians),e*Math.cos(this.rollInRadians)))}getCameraAltitude(){return Math.cos(this.pitchInRadians)*this._cameraToCenterDistance/this._pixelPerMeter+this.elevation}getCameraLngLat(){const e=c.aH(1,this.center.lat)*this.worldSize;return oa(this.center,this.elevation,this.pitch,this.bearing,this.cameraToCenterDistance/e).toLngLat()}getMercatorTileCoordinates(e){if(!e)return[0,0,1,1];const o=e.canonical.z>=0?1<<e.canonical.z:Math.pow(2,e.canonical.z);return[e.canonical.x/o,e.canonical.y/o,1/o/c.X,1/o/c.X]}}class Ai{constructor(e,o){this.min=e,this.max=o,this.center=c.aL([],c.aM([],this.min,this.max),.5)}quadrant(e){const o=[e%2==0,e<2],f=c.aN(this.min),y=c.aN(this.max);for(let w=0;w<o.length;w++)f[w]=o[w]?this.min[w]:this.center[w],y[w]=o[w]?this.center[w]:this.max[w];return y[2]=this.max[2],new Ai(f,y)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}intersectsFrustum(e){let o=!0;for(let f=0;f<e.planes.length;f++){const y=this.intersectsPlane(e.planes[f]);if(y===0)return 0;y===1&&(o=!1)}return o?2:e.aabb.min[0]>this.max[0]||e.aabb.min[1]>this.max[1]||e.aabb.min[2]>this.max[2]||e.aabb.max[0]<this.min[0]||e.aabb.max[1]<this.min[1]||e.aabb.max[2]<this.min[2]?0:1}intersectsPlane(e){let o=e[3],f=e[3];for(let y=0;y<3;y++)e[y]>0?(o+=e[y]*this.min[y],f+=e[y]*this.max[y]):(f+=e[y]*this.min[y],o+=e[y]*this.max[y]);return o>=0?2:f<0?0:1}}class cc{distanceToTile2d(e,o,f,y){const w=y.distanceX([e,o]),S=y.distanceY([e,o]);return Math.hypot(w,S)}getWrap(e,o,f){return f}getTileAABB(e,o,f,y){var w,S;let I=f,P=f;if(y.terrain){const Z=new c.S(e.z,o,e.z,e.x,e.y),Y=y.terrain.getMinMaxElevation(Z);I=(w=Y.minElevation)!==null&&w!==void 0?w:f,P=(S=Y.maxElevation)!==null&&S!==void 0?S:f}const j=1<<e.z;return new Ai([o+e.x/j,e.y/j,I],[o+(e.x+1)/j,(e.y+1)/j,P])}allowVariableZoom(e,o){const f=e.fov*(Math.abs(Math.cos(e.rollInRadians))*e.height+Math.abs(Math.sin(e.rollInRadians))*e.width)/e.height,y=c.ab(78.5-f/2,0,60);return!!o.terrain||e.pitch>y||e.padding.top>=.1}allowWorldCopies(){return!0}recalculateCache(){}}class Sa{constructor(e,o,f){this.points=e,this.planes=o,this.aabb=f}static fromInvProjectionMatrix(e,o=1,f=0){const y=Math.pow(2,f),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(j=>{const Z=1/(j=c.al([],j,e))[3]/o*y;return c.aO(j,j,[Z,Z,1/j[3],Z])}),S=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(j=>{const Z=c.aP([],w[j[0]],w[j[1]]),Y=c.aP([],w[j[2]],w[j[1]]),H=c.aQ([],c.aR([],Z,Y)),ee=-c.aS(H,w[j[1]]);return H.concat(ee)}),I=[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY],P=[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY];for(const j of w)for(let Z=0;Z<3;Z++)I[Z]=Math.min(I[Z],j[Z]),P[Z]=Math.max(P[Z],j[Z]);return new Sa(w,S,new Ai(I,P))}}class Ua{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,o,f){return this._helper.interpolatePadding(e,o,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,o,f=!0){this._helper.resize(e,o,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,o){this._helper.overrideNearFarZ(e,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e,o){}constructor(e,o,f,y,w){this._posMatrixCache=new Map,this._alignedPosMatrixCache=new Map,this._fogMatrixCacheF32=new Map,this._helper=new As({calcMatrices:()=>{this._calcMatrices()},getConstrained:(S,I)=>this.getConstrained(S,I)},e,o,f,y,w),this._coveringTilesDetailsProvider=new cc}clone(){const e=new Ua;return e.apply(this),e}apply(e,o,f){this._helper.apply(e,o,f)}get cameraPosition(){return this._cameraPosition}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._viewProjMatrix}get inverseProjectionMatrix(){return this._invProjMatrix}get mercatorMatrix(){return this._mercatorMatrix}getVisibleUnwrappedCoordinates(e){const o=[new c.aT(0,e)];if(this._helper._renderWorldCopies){const f=this.screenPointToMercatorCoordinate(new c.P(0,0)),y=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,0)),w=this.screenPointToMercatorCoordinate(new c.P(this._helper._width,this._helper._height)),S=this.screenPointToMercatorCoordinate(new c.P(0,this._helper._height)),I=Math.floor(Math.min(f.x,y.x,w.x,S.x)),P=Math.floor(Math.max(f.x,y.x,w.x,S.x)),j=1;for(let Z=I-j;Z<=P+j;Z++)Z!==0&&o.push(new c.aT(Z,e))}return o}getCameraFrustum(){return Sa.fromInvProjectionMatrix(this._invViewProjMatrix,this.worldSize)}getClippingPlane(){return null}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){const o=this.screenPointToLocation(this.centerPoint,e),f=e?e.getElevationForLngLatZoom(o,this._helper._tileZoom):0;this._helper.recalculateZoomAndCenter(f)}setLocationAtPoint(e,o){const f=c.aH(this.elevation,this.center.lat),y=this.screenPointToMercatorCoordinateAtZ(o,f),w=this.screenPointToMercatorCoordinateAtZ(this.centerPoint,f),S=c.Y.fromLngLat(e),I=new c.Y(S.x-(y.x-w.x),S.y-(y.y-w.y));this.setCenter(I==null?void 0:I.toLngLat()),this._helper._renderWorldCopies&&this.setCenter(this.center.wrap())}locationToScreenPoint(e,o){return o?this.coordinatePoint(c.Y.fromLngLat(e),o.getElevationForLngLatZoom(e,this._helper._tileZoom),this._pixelMatrix3D):this.coordinatePoint(c.Y.fromLngLat(e))}screenPointToLocation(e,o){var f;return(f=this.screenPointToMercatorCoordinate(e,o))===null||f===void 0?void 0:f.toLngLat()}screenPointToMercatorCoordinate(e,o){if(o){const f=o.pointCoordinate(e);if(f!=null)return f}return this.screenPointToMercatorCoordinateAtZ(e)}screenPointToMercatorCoordinateAtZ(e,o){const f=o||0,y=[e.x,e.y,0,1],w=[e.x,e.y,1,1];c.al(y,y,this._pixelMatrixInverse),c.al(w,w,this._pixelMatrixInverse);const S=y[3],I=w[3],P=y[1]/S,j=w[1]/I,Z=y[2]/S,Y=w[2]/I,H=Z===Y?0:(f-Z)/(Y-Z);return new c.Y(c.y.number(y[0]/S,w[0]/I,H)/this.worldSize,c.y.number(P,j,H)/this.worldSize,f)}coordinatePoint(e,o=0,f=this._pixelMatrix){const y=[e.x*this.worldSize,e.y*this.worldSize,o,1];return c.al(y,y,f),new c.P(y[0]/y[3],y[1]/y[3])}getBounds(){const e=Math.max(0,this._helper._height/2-Hi(this));return new ci().extend(this.screenPointToLocation(new c.P(0,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,e))).extend(this.screenPointToLocation(new c.P(this._helper._width,this._helper._height))).extend(this.screenPointToLocation(new c.P(0,this._helper._height)))}isPointOnMapSurface(e,o){return o?o.pointCoordinate(e)!=null:e.y>this.height/2-Hi(this)}calculatePosMatrix(e,o=!1,f){var y;const w=(y=e.key)!==null&&y!==void 0?y:c.aU(e.wrap,e.canonical.z,e.canonical.z,e.canonical.x,e.canonical.y),S=o?this._alignedPosMatrixCache:this._posMatrixCache;if(S.has(w)){const j=S.get(w);return f?j.f32:j.f64}const I=bd(e,this.worldSize);c.L(I,o?this._alignedProjMatrix:this._viewProjMatrix,I);const P={f64:I,f32:new Float32Array(I)};return S.set(w,P),f?P.f32:P.f64}calculateFogMatrix(e){const o=e.key,f=this._fogMatrixCacheF32;if(f.has(o))return f.get(o);const y=bd(e,this.worldSize);return c.L(y,this._fogMatrix,y),f.set(o,new Float32Array(y)),f.get(o)}getConstrained(e,o){o=c.ab(+o,this.minZoom,this.maxZoom);const f={center:new c.N(e.lng,e.lat),zoom:o};let y=this._helper._lngRange;this._helper._renderWorldCopies||y!==null||(y=[-179.9999999999,180-1e-10]);const w=this.tileSize*c.aG(f.zoom);let S=0,I=w,P=0,j=w,Z=0,Y=0;const{x:H,y:ee}=this.size;if(this._helper._latRange){const Se=this._helper._latRange;S=c.Q(Se[1])*w,I=c.Q(Se[0])*w,I-S<ee&&(Z=ee/(I-S))}y&&(P=c.aI(c.O(y[0])*w,0,w),j=c.aI(c.O(y[1])*w,0,w),j<P&&(j+=w),j-P<H&&(Y=H/(j-P)));const{x:ie,y:me}=or(w,e);let pe,ge;const be=Math.max(Y||0,Z||0);if(be){const Se=new c.P(Y?(j+P)/2:ie,Z?(I+S)/2:me);return f.center=qi(w,Se).wrap(),f.zoom+=c.a8(be),f}if(this._helper._latRange){const Se=ee/2;me-Se<S&&(ge=S+Se),me+Se>I&&(ge=I-Se)}if(y){const Se=(P+j)/2;let ke=ie;this._helper._renderWorldCopies&&(ke=c.aI(ie,Se-w/2,Se+w/2));const Re=H/2;ke-Re<P&&(pe=P+Re),ke+Re>j&&(pe=j-Re)}if(pe!==void 0||ge!==void 0){const Se=new c.P(pe??ie,ge??me);f.center=qi(w,Se).wrap()}return f}calculateCenterFromCameraLngLatAlt(e,o,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(e,o,f,y)}_calculateNearFarZIfNeeded(e,o,f){if(!this._helper.autoCalculateNearFarZ)return;const y=Math.min(this.elevation,this.minElevationForCurrentTile,this.getCameraAltitude()-100),w=e-y*this._helper._pixelPerMeter/Math.cos(o),S=y<0?w:e,I=Math.PI/2+this.pitchInRadians,P=c.aa(this.fov)*(Math.abs(Math.cos(c.aa(this.roll)))*this.height+Math.abs(Math.sin(c.aa(this.roll)))*this.width)/this.height*(.5+f.y/this.height),j=Math.sin(P)*S/Math.sin(c.ab(Math.PI-I-P,.01,Math.PI-.01)),Z=Hi(this),Y=Math.atan(Z/this._helper.cameraToCenterDistance),H=c.aa(.75),ee=Y>H?2*Y*(.5+f.y/(2*Z)):H,ie=Math.sin(ee)*S/Math.sin(c.ab(Math.PI-I-ee,.01,Math.PI-.01)),me=Math.min(j,ie);this._helper._farZ=1.01*(Math.cos(Math.PI/2-o)*me+S),this._helper._nearZ=this._helper._height/50}_calcMatrices(){if(!this._helper._height)return;const e=this.centerOffset,o=or(this.worldSize,this.center),f=o.x,y=o.y;this._helper._pixelPerMeter=c.aH(1,this.center.lat)*this.worldSize;const w=c.aa(Math.min(this.pitch,89.25)),S=Math.max(this._helper.cameraToCenterDistance/2,this._helper.cameraToCenterDistance+this._helper._elevation*this._helper._pixelPerMeter/Math.cos(w));let I;this._calculateNearFarZIfNeeded(S,w,e),I=new Float64Array(16),c.aV(I,this.fovInRadians,this._helper._width/this._helper._height,this._helper._nearZ,this._helper._farZ),this._invProjMatrix=new Float64Array(16),c.an(this._invProjMatrix,I),I[8]=2*-e.x/this._helper._width,I[9]=2*e.y/this._helper._height,this._projectionMatrix=c.aW(I),c.K(I,I,[1,-1,1]),c.J(I,I,[0,0,-this._helper.cameraToCenterDistance]),c.aX(I,I,-this.rollInRadians),c.aY(I,I,this.pitchInRadians),c.aX(I,I,-this.bearingInRadians),c.J(I,I,[-f,-y,0]),this._mercatorMatrix=c.K([],I,[this.worldSize,this.worldSize,this.worldSize]),c.K(I,I,[1,1,this._helper._pixelPerMeter]),this._pixelMatrix=c.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,I),c.J(I,I,[0,0,-this.elevation]),this._viewProjMatrix=I,this._invViewProjMatrix=c.an([],I);const P=[0,0,-1,1];c.al(P,P,this._invViewProjMatrix),this._cameraPosition=[P[0]/P[3],P[1]/P[3],P[2]/P[3]],this._fogMatrix=new Float64Array(16),c.aV(this._fogMatrix,this.fovInRadians,this.width/this.height,S,this._helper._farZ),this._fogMatrix[8]=2*-e.x/this.width,this._fogMatrix[9]=2*e.y/this.height,c.K(this._fogMatrix,this._fogMatrix,[1,-1,1]),c.J(this._fogMatrix,this._fogMatrix,[0,0,-this.cameraToCenterDistance]),c.aX(this._fogMatrix,this._fogMatrix,-this.rollInRadians),c.aY(this._fogMatrix,this._fogMatrix,this.pitchInRadians),c.aX(this._fogMatrix,this._fogMatrix,-this.bearingInRadians),c.J(this._fogMatrix,this._fogMatrix,[-f,-y,0]),c.K(this._fogMatrix,this._fogMatrix,[1,1,this._helper._pixelPerMeter]),c.J(this._fogMatrix,this._fogMatrix,[0,0,-this.elevation]),this._pixelMatrix3D=c.L(new Float64Array(16),this.clipSpaceToPixelsMatrix,I);const j=this._helper._width%2/2,Z=this._helper._height%2/2,Y=Math.cos(this.bearingInRadians),H=Math.sin(-this.bearingInRadians),ee=f-Math.round(f)+Y*j+H*Z,ie=y-Math.round(y)+Y*Z+H*j,me=new Float64Array(I);if(c.J(me,me,[ee>.5?ee-1:ee,ie>.5?ie-1:ie,0]),this._alignedProjMatrix=me,I=c.an(new Float64Array(16),this._pixelMatrix),!I)throw new Error("failed to invert matrix");this._pixelMatrixInverse=I,this._clearMatrixCaches()}_clearMatrixCaches(){this._posMatrixCache.clear(),this._alignedPosMatrixCache.clear(),this._fogMatrixCacheF32.clear()}maxPitchScaleFactor(){if(!this._pixelMatrixInverse)return 1;const e=this.screenPointToMercatorCoordinate(new c.P(0,0)),o=[e.x*this.worldSize,e.y*this.worldSize,0,1];return c.al(o,o,this._pixelMatrix)[3]/this._helper.cameraToCenterDistance}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){const e=c.aH(1,this.center.lat)*this.worldSize;return oa(this.center,this.elevation,this.pitch,this.bearing,this._helper.cameraToCenterDistance/e).toLngLat()}lngLatToCameraDepth(e,o){const f=c.Y.fromLngLat(e),y=[f.x*this.worldSize,f.y*this.worldSize,o,1];return c.al(y,y,this._viewProjMatrix),y[2]/y[3]}getProjectionData(e){const{overscaledTileID:o,aligned:f,applyTerrainMatrix:y}=e,w=this._helper.getMercatorTileCoordinates(o),S=o?this.calculatePosMatrix(o,f,!0):null;let I;return I=o&&o.terrainRttPosMatrix32f&&y?o.terrainRttPosMatrix32f:S||c.aZ(),{mainMatrix:I,tileMercatorCoords:w,clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:I}}isLocationOccluded(e){return!1}getPixelScale(){return 1}getCircleRadiusCorrection(){return 1}getPitchedTextCorrection(e,o,f){return 1}transformLightDirection(e){return c.aN(e)}getRayDirectionFromPixel(e){throw new Error("Not implemented.")}projectTileCoordinates(e,o,f,y){const w=this.calculatePosMatrix(f);let S;y?(S=[e,o,y(e,o),1],c.al(S,S,w)):(S=[e,o,0,1],Nr(S,S,w));const I=S[3];return{point:new c.P(S[0]/I,S[1]/I),signedDistanceFromCamera:I,isOccluded:!1}}populateCache(e){for(const o of e)this.calculatePosMatrix(o)}getMatrixForModel(e,o){const f=c.Y.fromLngLat(e,o),y=f.meterInMercatorCoordinateUnits(),w=c.a_();return c.J(w,w,[f.x,f.y,f.z]),c.aX(w,w,Math.PI),c.aY(w,w,Math.PI/2),c.K(w,w,[-y,y,y]),w}getProjectionDataForCustomLayer(e=!0){const o=new c.S(0,0,0,0,0),f=this.getProjectionData({overscaledTileID:o,applyGlobeMatrix:e}),y=bd(o,this.worldSize);c.L(y,this._viewProjMatrix,y),f.tileMercatorCoords=[0,0,1,1];const w=[c.X,c.X,this.worldSize/this._helper.pixelsPerMeter],S=c.a$();return c.K(S,y,w),f.fallbackMatrix=S,f.mainMatrix=S,f}getFastPathSimpleProjectionMatrix(e){return this.calculatePosMatrix(e)}}function io(){c.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}function oh(b){if(b.useSlerp)if(b.k<1){const e=c.b0(b.startEulerAngles.roll,b.startEulerAngles.pitch,b.startEulerAngles.bearing),o=c.b0(b.endEulerAngles.roll,b.endEulerAngles.pitch,b.endEulerAngles.bearing),f=new Float64Array(4);c.b1(f,e,o,b.k);const y=c.b2(f);b.tr.setRoll(y.roll),b.tr.setPitch(y.pitch),b.tr.setBearing(y.bearing)}else b.tr.setRoll(b.endEulerAngles.roll),b.tr.setPitch(b.endEulerAngles.pitch),b.tr.setBearing(b.endEulerAngles.bearing);else b.tr.setRoll(c.y.number(b.startEulerAngles.roll,b.endEulerAngles.roll,b.k)),b.tr.setPitch(c.y.number(b.startEulerAngles.pitch,b.endEulerAngles.pitch,b.k)),b.tr.setBearing(c.y.number(b.startEulerAngles.bearing,b.endEulerAngles.bearing,b.k))}function Cs(b,e,o,f,y){const w=y.padding,S=or(y.worldSize,o.getNorthWest()),I=or(y.worldSize,o.getNorthEast()),P=or(y.worldSize,o.getSouthEast()),j=or(y.worldSize,o.getSouthWest()),Z=c.aa(-f),Y=S.rotate(Z),H=I.rotate(Z),ee=P.rotate(Z),ie=j.rotate(Z),me=new c.P(Math.max(Y.x,H.x,ie.x,ee.x),Math.max(Y.y,H.y,ie.y,ee.y)),pe=new c.P(Math.min(Y.x,H.x,ie.x,ee.x),Math.min(Y.y,H.y,ie.y,ee.y)),ge=me.sub(pe),be=(y.width-(w.left+w.right+e.left+e.right))/ge.x,Se=(y.height-(w.top+w.bottom+e.top+e.bottom))/ge.y;if(Se<0||be<0)return void io();const ke=Math.min(c.a8(y.scale*Math.min(be,Se)),b.maxZoom),Re=c.P.convert(b.offset),Oe=new c.P((e.left-e.right)/2,(e.top-e.bottom)/2).rotate(c.aa(f)),Pe=Re.add(Oe).mult(y.scale/c.aG(ke));return{center:qi(y.worldSize,S.add(P).div(2).sub(Pe)),zoom:ke,bearing:f}}class xl{get useGlobeControls(){return!1}handlePanInertia(e,o){return{easingOffset:e,easingCenter:o.center}}handleMapControlsRollPitchBearingZoom(e,o){e.bearingDelta&&o.setBearing(o.bearing+e.bearingDelta),e.pitchDelta&&o.setPitch(o.pitch+e.pitchDelta),e.rollDelta&&o.setRoll(o.roll+e.rollDelta),e.zoomDelta&&o.setZoom(o.zoom+e.zoomDelta)}handleMapControlsPan(e,o,f){e.around.distSqr(o.centerPoint)<.01||o.setLocationAtPoint(f,e.around)}cameraForBoxAndBearing(e,o,f,y,w){return Cs(e,o,f,y,w)}handleJumpToCenterZoom(e,o){e.zoom!==(o.zoom!==void 0?+o.zoom:e.zoom)&&e.setZoom(+o.zoom),o.center!==void 0&&e.setCenter(c.N.convert(o.center))}handleEaseTo(e,o){const f=e.zoom,y=e.padding,w={roll:e.roll,pitch:e.pitch,bearing:e.bearing},S={roll:o.roll===void 0?e.roll:o.roll,pitch:o.pitch===void 0?e.pitch:o.pitch,bearing:o.bearing===void 0?e.bearing:o.bearing},I=o.zoom!==void 0,P=!e.isPaddingEqual(o.padding);let j=!1;const Z=I?+o.zoom:e.zoom;let Y=e.centerPoint.add(o.offsetAsPoint);const H=e.screenPointToLocation(Y),{center:ee,zoom:ie}=e.getConstrained(c.N.convert(o.center||H),Z??f);da(e,ee);const me=or(e.worldSize,H),pe=or(e.worldSize,ee).sub(me),ge=c.aG(ie-f);return j=ie!==f,{easeFunc:be=>{if(j&&e.setZoom(c.y.number(f,ie,be)),c.b3(w,S)||oh({startEulerAngles:w,endEulerAngles:S,tr:e,k:be,useSlerp:w.roll!=S.roll}),P&&(e.interpolatePadding(y,o.padding,be),Y=e.centerPoint.add(o.offsetAsPoint)),o.around)e.setLocationAtPoint(o.around,o.aroundPoint);else{const Se=c.aG(e.zoom-f),ke=ie>f?Math.min(2,ge):Math.max(.5,ge),Re=Math.pow(ke,1-be),Oe=qi(e.worldSize,me.add(pe.mult(be*Re)).mult(Se));e.setLocationAtPoint(e.renderWorldCopies?Oe.wrap():Oe,Y)}},isZooming:j,elevationCenter:ee}}handleFlyTo(e,o){const f=o.zoom!==void 0,y=e.zoom,w=e.getConstrained(c.N.convert(o.center||o.locationAtOffset),f?+o.zoom:y),S=w.center,I=w.zoom;da(e,S);const P=or(e.worldSize,o.locationAtOffset),j=or(e.worldSize,S).sub(P),Z=j.mag(),Y=c.aG(I-y);let H;if(o.minZoom!==void 0){const ee=Math.min(+o.minZoom,y,I),ie=e.getConstrained(S,ee).zoom;H=c.aG(ie-y)}return{easeFunc:(ee,ie,me,pe)=>{e.setZoom(ee===1?I:y+c.a8(ie));const ge=ee===1?S:qi(e.worldSize,P.add(j.mult(me)).mult(ie));e.setLocationAtPoint(e.renderWorldCopies?ge.wrap():ge,pe)},scaleOfZoom:Y,targetCenter:S,scaleOfMinZoom:H,pixelPathLength:Z}}}class Ci{constructor(e,o,f){this.blendFunction=e,this.blendColor=o,this.mask=f}}Ci.Replace=[1,0],Ci.disabled=new Ci(Ci.Replace,c.b4.transparent,[!1,!1,!1,!1]),Ci.unblended=new Ci(Ci.Replace,c.b4.transparent,[!0,!0,!0,!0]),Ci.alphaBlended=new Ci([1,771],c.b4.transparent,[!0,!0,!0,!0]);const Ms=2305;class Tn{constructor(e,o,f){this.enable=e,this.mode=o,this.frontFace=f}}Tn.disabled=new Tn(!1,1029,Ms),Tn.backCCW=new Tn(!0,1029,Ms),Tn.frontCCW=new Tn(!0,1028,Ms);class pn{constructor(e,o,f){this.func=e,this.mask=o,this.range=f}}pn.ReadOnly=!1,pn.ReadWrite=!0,pn.disabled=new pn(519,pn.ReadOnly,[0,1]);const wl=7680;class Vn{constructor(e,o,f,y,w,S){this.test=e,this.ref=o,this.mask=f,this.fail=y,this.depthFail=w,this.pass=S}}Vn.disabled=new Vn({func:519,mask:0},0,0,wl,wl,wl);const Ys=new WeakMap;function Va(b){var e;if(Ys.has(b))return Ys.get(b);{const o=(e=b.getParameter(b.VERSION))===null||e===void 0?void 0:e.startsWith("WebGL 2.0");return Ys.set(b,o),o}}class su{get awaitingQuery(){return!!this._readbackQueue}constructor(e){this._readbackWaitFrames=4,this._measureWaitFrames=6,this._texWidth=1,this._texHeight=1,this._measuredError=0,this._updateCount=0,this._lastReadbackFrame=-1e3,this._readbackQueue=null,this._cachedRenderContext=e;const o=e.context,f=o.gl;this._texFormat=f.RGBA,this._texType=f.UNSIGNED_BYTE;const y=new c.aC;y.emplaceBack(-1,-1),y.emplaceBack(2,-1),y.emplaceBack(-1,2);const w=new c.aE;w.emplaceBack(0,1,2),this._fullscreenTriangle=new ko(o.createVertexBuffer(y,Dn.members),o.createIndexBuffer(w),c.aD.simpleSegment(0,0,y.length,w.length)),this._resultBuffer=new Uint8Array(4),o.activeTexture.set(f.TEXTURE1);const S=f.createTexture();f.bindTexture(f.TEXTURE_2D,S),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,f.CLAMP_TO_EDGE),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,f.NEAREST),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,f.NEAREST),f.texImage2D(f.TEXTURE_2D,0,this._texFormat,this._texWidth,this._texHeight,0,this._texFormat,this._texType,null),this._fbo=o.createFramebuffer(this._texWidth,this._texHeight,!1,!1),this._fbo.colorAttachment.set(S),Va(f)&&(this._pbo=f.createBuffer(),f.bindBuffer(f.PIXEL_PACK_BUFFER,this._pbo),f.bufferData(f.PIXEL_PACK_BUFFER,4,f.STREAM_READ),f.bindBuffer(f.PIXEL_PACK_BUFFER,null))}destroy(){const e=this._cachedRenderContext.context.gl;this._fullscreenTriangle.destroy(),this._fbo.destroy(),e.deleteBuffer(this._pbo),this._fullscreenTriangle=null,this._fbo=null,this._pbo=null,this._resultBuffer=null}updateErrorLoop(e,o){const f=this._updateCount;return this._readbackQueue?f>=this._readbackQueue.frameNumberIssued+this._readbackWaitFrames&&this._tryReadback():f>=this._lastReadbackFrame+this._measureWaitFrames&&this._renderErrorTexture(e,o),this._updateCount++,this._measuredError}_bindFramebuffer(){const e=this._cachedRenderContext.context,o=e.gl;e.activeTexture.set(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,this._fbo.colorAttachment.get()),e.bindFramebuffer.set(this._fbo.framebuffer)}_renderErrorTexture(e,o){const f=this._cachedRenderContext.context,y=f.gl;if(this._bindFramebuffer(),f.viewport.set([0,0,this._texWidth,this._texHeight]),f.clear({color:c.b4.transparent}),this._cachedRenderContext.useProgram("projectionErrorMeasurement").draw(f,y.TRIANGLES,pn.disabled,Vn.disabled,Ci.unblended,Tn.disabled,((w,S)=>({u_input:w,u_output_expected:S}))(e,o),null,null,"$clipping",this._fullscreenTriangle.vertexBuffer,this._fullscreenTriangle.indexBuffer,this._fullscreenTriangle.segments),this._pbo&&Va(y)){y.bindBuffer(y.PIXEL_PACK_BUFFER,this._pbo),y.readBuffer(y.COLOR_ATTACHMENT0),y.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,0),y.bindBuffer(y.PIXEL_PACK_BUFFER,null);const w=y.fenceSync(y.SYNC_GPU_COMMANDS_COMPLETE,0);y.flush(),this._readbackQueue={frameNumberIssued:this._updateCount,sync:w}}else this._readbackQueue={frameNumberIssued:this._updateCount,sync:null}}_tryReadback(){const e=this._cachedRenderContext.context.gl;if(this._pbo&&this._readbackQueue&&Va(e)){const o=e.clientWaitSync(this._readbackQueue.sync,0,0);if(o===e.WAIT_FAILED)return c.w("WebGL2 clientWaitSync failed."),this._readbackQueue=null,void(this._lastReadbackFrame=this._updateCount);if(o===e.TIMEOUT_EXPIRED)return;e.bindBuffer(e.PIXEL_PACK_BUFFER,this._pbo),e.getBufferSubData(e.PIXEL_PACK_BUFFER,0,this._resultBuffer,0,4),e.bindBuffer(e.PIXEL_PACK_BUFFER,null)}else this._bindFramebuffer(),e.readPixels(0,0,this._texWidth,this._texHeight,this._texFormat,this._texType,this._resultBuffer);this._readbackQueue=null,this._measuredError=su._parseRGBA8float(this._resultBuffer),this._lastReadbackFrame=this._updateCount}static _parseRGBA8float(e){let o=0;return o+=e[0]/256,o+=e[1]/65536,o+=e[2]/16777216,e[3]<127&&(o=-o),o/128}}const Jr=c.X/128;function Jo(b,e){const o=b.granularity!==void 0?Math.max(b.granularity,1):1,f=o+(b.generateBorders?2:0),y=o+(b.extendToNorthPole||b.generateBorders?1:0)+(b.extendToSouthPole||b.generateBorders?1:0),w=f+1,S=y+1,I=b.generateBorders?-1:0,P=b.generateBorders||b.extendToNorthPole?-1:0,j=o+(b.generateBorders?1:0),Z=o+(b.generateBorders||b.extendToSouthPole?1:0),Y=w*S,H=f*y*6,ee=w*S>65536;if(ee&&e==="16bit")throw new Error("Granularity is too large and meshes would not fit inside 16 bit vertex indices.");const ie=ee||e==="32bit",me=new Int16Array(2*Y);let pe=0;for(let Se=P;Se<=Z;Se++)for(let ke=I;ke<=j;ke++){let Re=ke/o*c.X;ke===-1&&(Re=-64),ke===o+1&&(Re=c.X+Jr);let Oe=Se/o*c.X;Se===-1&&(Oe=b.extendToNorthPole?c.b6:-64),Se===o+1&&(Oe=b.extendToSouthPole?c.b7:c.X+Jr),me[pe++]=Re,me[pe++]=Oe}const ge=ie?new Uint32Array(H):new Uint16Array(H);let be=0;for(let Se=0;Se<y;Se++)for(let ke=0;ke<f;ke++){const Re=ke+1+Se*w,Oe=ke+(Se+1)*w,Pe=ke+1+(Se+1)*w;ge[be++]=ke+Se*w,ge[be++]=Oe,ge[be++]=Re,ge[be++]=Re,ge[be++]=Oe,ge[be++]=Pe}return{vertices:me.buffer.slice(0),indices:ge.buffer.slice(0),uses32bitIndices:ie}}const Ds=new c.aB({fill:new c.b8(128,2),line:new c.b8(512,0),tile:new c.b8(128,32),stencil:new c.b8(128,1),circle:3});class lu{constructor(){this._tileMeshCache={},this._errorCorrectionUsable=0,this._errorMeasurementLastValue=0,this._errorCorrectionPreviousValue=0,this._errorMeasurementLastChangeTime=-1e3}get name(){return"vertical-perspective"}get transitionState(){return 1}get useSubdivision(){return!0}get shaderVariantName(){return"globe"}get shaderDefine(){return"#define GLOBE"}get shaderPreludeCode(){return Ss.projectionGlobe}get vertexShaderPreludeCode(){return Ss.projectionMercator.vertexSource}get subdivisionGranularity(){return Ds}get useGlobeControls(){return!0}get latitudeErrorCorrectionRadians(){return this._errorCorrectionUsable}destroy(){this._errorMeasurement&&this._errorMeasurement.destroy()}updateGPUdependent(e){this._errorMeasurement||(this._errorMeasurement=new su(e));const o=c.Q(this._errorQueryLatitudeDegrees),f=2*Math.atan(Math.exp(Math.PI-o*Math.PI*2))-.5*Math.PI,y=this._errorMeasurement.updateErrorLoop(o,f),w=F.now();y!==this._errorMeasurementLastValue&&(this._errorCorrectionPreviousValue=this._errorCorrectionUsable,this._errorMeasurementLastValue=y,this._errorMeasurementLastChangeTime=w);const S=Math.min(Math.max((w-this._errorMeasurementLastChangeTime)/1e3/.5,0),1);this._errorCorrectionUsable=c.b9(this._errorCorrectionPreviousValue,-this._errorMeasurementLastValue,c.ba(S))}_getMeshKey(e){return`${e.granularity.toString(36)}_${e.generateBorders?"b":""}${e.extendToNorthPole?"n":""}${e.extendToSouthPole?"s":""}`}getMeshFromTileID(e,o,f,y,w){const S=(w==="stencil"?Ds.stencil:Ds.tile).getGranularityForZoomLevel(o.z);return this._getMesh(e,{granularity:S,generateBorders:f,extendToNorthPole:o.y===0&&y,extendToSouthPole:o.y===(1<<o.z)-1&&y})}_getMesh(e,o){const f=this._getMeshKey(o);if(f in this._tileMeshCache)return this._tileMeshCache[f];const y=function(w,S){const I=Jo(S,"16bit"),P=c.aC.deserialize({arrayBuffer:I.vertices,length:I.vertices.byteLength/2/2}),j=c.aE.deserialize({arrayBuffer:I.indices,length:I.indices.byteLength/2/3});return new ko(w.createVertexBuffer(P,Dn.members),w.createIndexBuffer(j),c.aD.simpleSegment(0,0,P.length,j.length))}(e,o);return this._tileMeshCache[f]=y,y}recalculate(e){}hasTransition(){const e=F.now();let o=!1;return o=o||(e-this._errorMeasurementLastChangeTime)/1e3<.7,o=o||this._errorMeasurement&&this._errorMeasurement.awaitingQuery,o}setErrorQueryLatitudeDegrees(e){this._errorQueryLatitudeDegrees=e}}const $f=new c.q({type:new c.D(c.v.projection.type)});class sh extends c.E{constructor(e){super(),this._transitionable=new c.T($f),this.setProjection(e),this._transitioning=this._transitionable.untransitioned(),this.recalculate(new c.z(0)),this._mercatorProjection=new ou,this._verticalPerspectiveProjection=new lu}get transitionState(){const e=this.properties.get("type");if(typeof e=="string"&&e==="mercator")return 0;if(typeof e=="string"&&e==="vertical-perspective")return 1;if(e instanceof c.bb){if(e.from==="vertical-perspective"&&e.to==="mercator")return 1-e.transition;if(e.from==="mercator"&&e.to==="vertical-perspective")return e.transition}return 1}get useGlobeRendering(){return this.transitionState>0}get latitudeErrorCorrectionRadians(){return this._verticalPerspectiveProjection.latitudeErrorCorrectionRadians}get currentProjection(){return this.useGlobeRendering?this._verticalPerspectiveProjection:this._mercatorProjection}get name(){return"globe"}get useSubdivision(){return this.currentProjection.useSubdivision}get shaderVariantName(){return this.currentProjection.shaderVariantName}get shaderDefine(){return this.currentProjection.shaderDefine}get shaderPreludeCode(){return this.currentProjection.shaderPreludeCode}get vertexShaderPreludeCode(){return this.currentProjection.vertexShaderPreludeCode}get subdivisionGranularity(){return this.currentProjection.subdivisionGranularity}get useGlobeControls(){return this.transitionState>0}destroy(){this._mercatorProjection.destroy(),this._verticalPerspectiveProjection.destroy()}updateGPUdependent(e){this._mercatorProjection.updateGPUdependent(e),this._verticalPerspectiveProjection.updateGPUdependent(e)}getMeshFromTileID(e,o,f,y,w){return this.currentProjection.getMeshFromTileID(e,o,f,y,w)}setProjection(e){this._transitionable.setValue("type",(e==null?void 0:e.type)||"mercator")}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()||this.currentProjection.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}setErrorQueryLatitudeDegrees(e){this._verticalPerspectiveProjection.setErrorQueryLatitudeDegrees(e),this._mercatorProjection.setErrorQueryLatitudeDegrees(e)}}function xd(b){const e=uc(b.worldSize,b.center.lat);return 2*Math.PI*e}function qs(b,e,o,f,y){const w=1/(1<<y),S=e/c.X*w+f*w,I=c.bd((b/c.X*w+o*w)*Math.PI*2+Math.PI,2*Math.PI),P=2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI,j=Math.cos(P),Z=new Float64Array(3);return Z[0]=Math.sin(I)*j,Z[1]=Math.sin(P),Z[2]=Math.cos(I)*j,Z}function ui(b){return function(e,o){const f=Math.cos(o),y=new Float64Array(3);return y[0]=Math.sin(e)*f,y[1]=Math.sin(o),y[2]=Math.cos(e)*f,y}(b.lng*Math.PI/180,b.lat*Math.PI/180)}function uc(b,e){return b/(2*Math.PI)/Math.cos(e*Math.PI/180)}function es(b){const e=Math.asin(b[1])/Math.PI*180,o=Math.sqrt(b[0]*b[0]+b[2]*b[2]);if(o>1e-6){const f=b[0]/o,y=Math.acos(b[2]/o),w=(f>0?y:-y)/Math.PI*180;return new c.N(c.aI(w,-180,180),e)}return new c.N(0,e)}function hc(b){return Math.cos(b*Math.PI/180)}function $r(b,e){const o=hc(b),f=hc(e);return c.a8(f/o)}function lh(b,e){const o=b.rotate(e.bearingInRadians),f=e.zoom+$r(e.center.lat,0),y=c.b9(1/hc(e.center.lat),1/hc(Math.min(Math.abs(e.center.lat),60)),c.bc(f,7,3,0,1)),w=360/xd({worldSize:e.worldSize,center:{lat:e.center.lat}});return new c.N(e.center.lng-o.x*w*y,c.ab(e.center.lat+o.y*w,-85.051129,c.aF))}function Tl(b){const e=.5*b,o=Math.sin(e),f=Math.cos(e);return Math.log(o+f)-Math.log(f-o)}function bm(b,e,o,f){const y=b.lat+o*f;if(Math.abs(o)>1){const w=(Math.sign(b.lat+o)!==Math.sign(b.lat)?-Math.abs(b.lat):Math.abs(b.lat))*Math.PI/180,S=Math.abs(b.lat+o)*Math.PI/180,I=Tl(w+f*(S-w)),P=Tl(w),j=Tl(S);return new c.N(b.lng+e*((I-P)/(j-P)),y)}return new c.N(b.lng+e*f,y)}class Jg{constructor(e){this._cachePrevious=new Map,this._cache=new Map,this._hadAnyChanges=!1,this._aabbFactory=e}recalculateCache(){if(!this._hadAnyChanges)return;const e=this._cachePrevious;this._cachePrevious=this._cache,this._cache=e,this._cache.clear(),this._hadAnyChanges=!1}getTileAABB(e,o,f,y){const w=`${e.z}_${e.x}_${e.y}`,S=this._cache.get(w);if(S)return S;const I=this._cachePrevious.get(w);if(I)return this._cache.set(w,I),I;const P=this._aabbFactory(e,o,f,y);return this._cache.set(w,P),this._hadAnyChanges=!0,P}}function wd(b,e,o){const f=b-e;return f<0?-f:Math.max(0,f-o)}function Yf(b,e,o,f,y){const w=b-o;let S;return S=w<0?Math.min(-w,1+w-y):w>1?Math.min(Math.max(w-y,0),1-w):0,Math.max(S,wd(e,f,y))}class xm{constructor(){this._aabbCache=new Jg(this._computeTileAABB)}recalculateCache(){this._aabbCache.recalculateCache()}distanceToTile2d(e,o,f,y){const w=1<<f.z,S=1/w,I=f.x/w,P=f.y/w;let j=2;return j=Math.min(j,Yf(e,o,I,P,S)),j=Math.min(j,Yf(e,o,I+.5,-P-S,S)),j=Math.min(j,Yf(e,o,I+.5,2-P-S,S)),j}getWrap(e,o,f){const y=1<<o.z,w=1/y,S=o.x/y,I=wd(e.x,S,w),P=wd(e.x,S-1,w),j=wd(e.x,S+1,w),Z=Math.min(I,P,j);return Z===j?1:Z===P?-1:0}allowVariableZoom(e,o){return Rr(e,o)>4}allowWorldCopies(){return!1}getTileAABB(e,o,f,y){return this._aabbCache.getTileAABB(e,o,f,y)}_computeTileAABB(e,o,f,y){if(e.z<=0)return new Ai([-1,-1,-1],[1,1,1]);if(e.z===1)return new Ai([e.x===0?-1:0,e.y===0?0:-1,-1],[e.x===0?0:1,e.y===0?1:0,1]);{const w=[qs(0,0,e.x,e.y,e.z),qs(c.X,0,e.x,e.y,e.z),qs(c.X,c.X,e.x,e.y,e.z),qs(0,c.X,e.x,e.y,e.z)],S=[1,1,1],I=[-1,-1,-1];for(const P of w)for(let j=0;j<3;j++)S[j]=Math.min(S[j],P[j]),I[j]=Math.max(I[j],P[j]);if(e.y===0||e.y===(1<<e.z)-1){const P=[0,e.y===0?1:-1,0];for(let j=0;j<3;j++)S[j]=Math.min(S[j],P[j]),I[j]=Math.max(I[j],P[j])}return new Ai(S,I)}}}class Td{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,o,f){return this._helper.interpolatePadding(e,o,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,o){this._helper.resize(e,o)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,o){this._helper.overrideNearFarZ(e,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}setTransitionState(e){}constructor(){this._cachedClippingPlane=c.be(),this._projectionMatrix=c.a_(),this._globeViewProjMatrix32f=c.aZ(),this._globeViewProjMatrixNoCorrection=c.a_(),this._globeViewProjMatrixNoCorrectionInverted=c.a_(),this._globeProjMatrixInverted=c.a_(),this._cameraPosition=c.bf(),this._globeLatitudeErrorCorrectionRadians=0,this._helper=new As({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,o)=>this.getConstrained(e,o)}),this._coveringTilesDetailsProvider=new xm}clone(){const e=new Td;return e.apply(this),e}apply(e,o){this._globeLatitudeErrorCorrectionRadians=o||0,this._helper.apply(e)}get projectionMatrix(){return this._projectionMatrix}get modelViewProjectionMatrix(){return this._globeViewProjMatrixNoCorrection}get inverseProjectionMatrix(){return this._globeProjMatrixInverted}get cameraPosition(){const e=c.bf();return e[0]=this._cameraPosition[0],e[1]=this._cameraPosition[1],e[2]=this._cameraPosition[2],e}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}getProjectionData(e){const{overscaledTileID:o,applyGlobeMatrix:f}=e,y=this._helper.getMercatorTileCoordinates(o);return{mainMatrix:this._globeViewProjMatrix32f,tileMercatorCoords:y,clippingPlane:this._cachedClippingPlane,projectionTransition:f?1:0,fallbackMatrix:this._globeViewProjMatrix32f}}_computeClippingPlane(e){const o=this.pitchInRadians,f=this.cameraToCenterDistance/e,y=Math.sin(o)*f,w=Math.cos(o)*f+1,S=1/Math.sqrt(y*y+w*w)*1;let I=-y,P=w;const j=Math.sqrt(I*I+P*P);I/=j,P/=j;const Z=[0,I,P];return c.bg(Z,Z,[0,0,0],-this.bearingInRadians),c.bh(Z,Z,[0,0,0],-1*this.center.lat*Math.PI/180),c.bi(Z,Z,[0,0,0],this.center.lng*Math.PI/180),c.aL(Z,Z,.25),[...Z,.25*-S]}isLocationOccluded(e){return!this.isSurfacePointVisible(ui(e))}transformLightDirection(e){const o=this._helper._center.lng*Math.PI/180,f=this._helper._center.lat*Math.PI/180,y=Math.cos(f),w=[Math.sin(o)*y,Math.sin(f),Math.cos(o)*y],S=[w[2],0,-w[0]],I=[0,0,0];c.aR(I,S,w),c.aQ(S,S),c.aQ(I,I);const P=[0,0,0];return c.aQ(P,[S[0]*e[0]+I[0]*e[1]+w[0]*e[2],S[1]*e[0]+I[1]*e[1]+w[1]*e[2],S[2]*e[0]+I[2]*e[1]+w[2]*e[2]]),P}getPixelScale(){return 1/Math.cos(this._helper._center.lat*Math.PI/180)}getCircleRadiusCorrection(){return Math.cos(this._helper._center.lat*Math.PI/180)}getPitchedTextCorrection(e,o,f){const y=function(I,P,j){const Z=1/(1<<j.z);return new c.Y(I/c.X*Z+j.x*Z,P/c.X*Z+j.y*Z)}(e,o,f.canonical),w=(S=y.y,[c.bd(y.x*Math.PI*2+Math.PI,2*Math.PI),2*Math.atan(Math.exp(Math.PI-S*Math.PI*2))-.5*Math.PI]);var S;return this.getCircleRadiusCorrection()/Math.cos(w[1])}projectTileCoordinates(e,o,f,y){const w=f.canonical,S=qs(e,o,w.x,w.y,w.z),I=1+(y?y(e,o):0)/c.bo,P=[S[0]*I,S[1]*I,S[2]*I,1];c.al(P,P,this._globeViewProjMatrixNoCorrection);const j=this._cachedClippingPlane,Z=j[0]*S[0]+j[1]*S[1]+j[2]*S[2]+j[3]<0;return{point:new c.P(P[0]/P[3],P[1]/P[3]),signedDistanceFromCamera:P[3],isOccluded:Z}}_calcMatrices(){if(!this._helper._width||!this._helper._height)return;const e=uc(this.worldSize,this.center.lat),o=c.a$(),f=c.a$();this._helper.autoCalculateNearFarZ&&(this._helper._nearZ=.5,this._helper._farZ=this.cameraToCenterDistance+2*e),c.aV(o,this.fovInRadians,this.width/this.height,this._helper._nearZ,this._helper._farZ);const y=this.centerOffset;o[8]=2*-y.x/this._helper._width,o[9]=2*y.y/this._helper._height,this._projectionMatrix=c.aW(o),this._globeProjMatrixInverted=c.a$(),c.an(this._globeProjMatrixInverted,o),c.J(o,o,[0,0,-this.cameraToCenterDistance]),c.aX(o,o,this.rollInRadians),c.aY(o,o,-this.pitchInRadians),c.aX(o,o,this.bearingInRadians),c.J(o,o,[0,0,-e]);const w=c.bf();w[0]=e,w[1]=e,w[2]=e,c.aY(f,o,this.center.lat*Math.PI/180),c.bj(f,f,-this.center.lng*Math.PI/180),c.K(f,f,w),this._globeViewProjMatrixNoCorrection=f,c.aY(o,o,this.center.lat*Math.PI/180-this._globeLatitudeErrorCorrectionRadians),c.bj(o,o,-this.center.lng*Math.PI/180),c.K(o,o,w),this._globeViewProjMatrix32f=new Float32Array(o),this._globeViewProjMatrixNoCorrectionInverted=c.a$(),c.an(this._globeViewProjMatrixNoCorrectionInverted,f);const S=c.bf();this._cameraPosition=c.bf(),this._cameraPosition[2]=this.cameraToCenterDistance/e,c.bg(this._cameraPosition,this._cameraPosition,S,-this.rollInRadians),c.bh(this._cameraPosition,this._cameraPosition,S,this.pitchInRadians),c.bg(this._cameraPosition,this._cameraPosition,S,-this.bearingInRadians),c.aM(this._cameraPosition,this._cameraPosition,[0,0,1]),c.bh(this._cameraPosition,this._cameraPosition,S,-this.center.lat*Math.PI/180),c.bi(this._cameraPosition,this._cameraPosition,S,this.center.lng*Math.PI/180),this._cachedClippingPlane=this._computeClippingPlane(e);const I=c.aW(this._globeViewProjMatrixNoCorrectionInverted);c.K(I,I,[1,1,-1]),this._cachedFrustum=Sa.fromInvProjectionMatrix(I)}calculateFogMatrix(e){c.w("calculateFogMatrix is not supported on globe projection.");const o=c.a$();return c.aq(o),o}getVisibleUnwrappedCoordinates(e){return[new c.aT(0,e)]}getCameraFrustum(){return this._cachedFrustum}getClippingPlane(){return this._cachedClippingPlane}getCoveringTilesDetailsProvider(){return this._coveringTilesDetailsProvider}recalculateZoomAndCenter(e){e&&c.w("terrain is not fully supported on vertical perspective projection."),this._helper.recalculateZoomAndCenter(0)}maxPitchScaleFactor(){return 1}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,o){if(!this._globeViewProjMatrixNoCorrection)return 1;const f=ui(e);c.aL(f,f,1+o/c.bo);const y=c.be();return c.al(y,[f[0],f[1],f[2],1],this._globeViewProjMatrixNoCorrection),y[2]/y[3]}populateCache(e){}getBounds(){const e=.5*this.width,o=.5*this.height,f=[new c.P(0,0),new c.P(e,0),new c.P(this.width,0),new c.P(this.width,o),new c.P(this.width,this.height),new c.P(e,this.height),new c.P(0,this.height),new c.P(0,o)],y=[];for(const Y of f)y.push(this.unprojectScreenPoint(Y));let w=0,S=0,I=0,P=0;const j=this.center;for(const Y of y){const H=c.bk(j.lng,Y.lng),ee=c.bk(j.lat,Y.lat);H<S&&(S=H),H>w&&(w=H),ee<P&&(P=ee),ee>I&&(I=ee)}const Z=[j.lng+S,j.lat+P,j.lng+w,j.lat+I];return this.isSurfacePointOnScreen([0,1,0])&&(Z[3]=90,Z[0]=-180,Z[2]=180),this.isSurfacePointOnScreen([0,-1,0])&&(Z[1]=-90,Z[0]=-180,Z[2]=180),new ci(Z)}getConstrained(e,o){const f=c.ab(e.lat,-85.051129,c.aF),y=c.ab(+o,this.minZoom+$r(0,f),this.maxZoom);return{center:new c.N(e.lng,f),zoom:y}}calculateCenterFromCameraLngLatAlt(e,o,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(e,o,f,y)}setLocationAtPoint(e,o){const f=ui(this.unprojectScreenPoint(o)),y=ui(e),w=c.bf();c.bl(w);const S=c.bf();c.bi(S,f,w,-this.center.lng*Math.PI/180),c.bh(S,S,w,this.center.lat*Math.PI/180);const I=y[0]*y[0]+y[2]*y[2],P=S[0]*S[0];if(I<P)return;const j=Math.sqrt(I-P),Z=-j,Y=c.bm(y[0],y[2],S[0],j),H=c.bm(y[0],y[2],S[0],Z),ee=c.bf();c.bi(ee,y,w,-Y);const ie=c.bm(ee[1],ee[2],S[1],S[2]),me=c.bf();c.bi(me,y,w,-H);const pe=c.bm(me[1],me[2],S[1],S[2]),ge=.5*Math.PI,be=ie>=-ge&&ie<=ge,Se=pe>=-ge&&pe<=ge;let ke,Re;if(be&&Se){const Ke=this.center.lng*Math.PI/180,st=this.center.lat*Math.PI/180;c.bp(Y,Ke)+c.bp(ie,st)<c.bp(H,Ke)+c.bp(pe,st)?(ke=Y,Re=ie):(ke=H,Re=pe)}else if(be)ke=Y,Re=ie;else{if(!Se)return;ke=H,Re=pe}const Oe=ke/Math.PI*180,Pe=Re/Math.PI*180,He=this.center.lat;this.setCenter(new c.N(Oe,c.ab(Pe,-90,90))),this.setZoom(this.zoom+$r(He,this.center.lat))}locationToScreenPoint(e,o){const f=ui(e);if(o){const y=o.getElevationForLngLatZoom(e,this._helper._tileZoom);c.aL(f,f,1+y/c.bo)}return this._projectSurfacePointToScreen(f)}_projectSurfacePointToScreen(e){const o=c.be();return c.al(o,[...e,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],new c.P((.5*o[0]+.5)*this.width,(.5*-o[1]+.5)*this.height)}screenPointToMercatorCoordinate(e,o){if(o){const f=o.pointCoordinate(e);if(f)return f}return c.Y.fromLngLat(this.unprojectScreenPoint(e))}screenPointToLocation(e,o){var f;return(f=this.screenPointToMercatorCoordinate(e,o))===null||f===void 0?void 0:f.toLngLat()}isPointOnMapSurface(e,o){const f=this._cameraPosition,y=this.getRayDirectionFromPixel(e);return!!this.rayPlanetIntersection(f,y)}getRayDirectionFromPixel(e){const o=c.be();o[0]=e.x/this.width*2-1,o[1]=-1*(e.y/this.height*2-1),o[2]=1,o[3]=1,c.al(o,o,this._globeViewProjMatrixNoCorrectionInverted),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3];const f=c.bf();f[0]=o[0]-this._cameraPosition[0],f[1]=o[1]-this._cameraPosition[1],f[2]=o[2]-this._cameraPosition[2];const y=c.bf();return c.aQ(y,f),y}isSurfacePointVisible(e){const o=this._cachedClippingPlane;return o[0]*e[0]+o[1]*e[1]+o[2]*e[2]+o[3]>=0}isSurfacePointOnScreen(e){if(!this.isSurfacePointVisible(e))return!1;const o=c.be();return c.al(o,[...e,1],this._globeViewProjMatrixNoCorrection),o[0]/=o[3],o[1]/=o[3],o[2]/=o[3],o[0]>-1&&o[0]<1&&o[1]>-1&&o[1]<1&&o[2]>-1&&o[2]<1}rayPlanetIntersection(e,o){const f=c.aS(e,o),y=c.bf(),w=c.bf();c.aL(w,o,f),c.aP(y,e,w);const S=1-c.aS(y,y);if(S<0)return null;const I=c.aS(e,e)-1,P=-f+(f<0?1:-1)*Math.sqrt(S),j=I/P,Z=P;return{tMin:Math.min(j,Z),tMax:Math.max(j,Z)}}unprojectScreenPoint(e){const o=this._cameraPosition,f=this.getRayDirectionFromPixel(e),y=this.rayPlanetIntersection(o,f);if(y){const j=c.bf();c.aM(j,o,[f[0]*y.tMin,f[1]*y.tMin,f[2]*y.tMin]);const Z=c.bf();return c.aQ(Z,j),es(Z)}const w=this._cachedClippingPlane[0]*f[0]+this._cachedClippingPlane[1]*f[1]+this._cachedClippingPlane[2]*f[2],S=-c.bn(this._cachedClippingPlane,o)/w,I=c.bf();if(S>0)c.aM(I,o,[f[0]*S,f[1]*S,f[2]*S]);else{const j=c.bf();c.aM(j,o,[2*f[0],2*f[1],2*f[2]]);const Z=c.bn(this._cachedClippingPlane,j);c.aP(I,j,[this._cachedClippingPlane[0]*Z,this._cachedClippingPlane[1]*Z,this._cachedClippingPlane[2]*Z])}const P=c.bf();return c.aQ(P,I),es(P)}getMatrixForModel(e,o){const f=c.N.convert(e),y=1/c.bo,w=c.a_();return c.bj(w,w,f.lng/180*Math.PI),c.aY(w,w,-f.lat/180*Math.PI),c.J(w,w,[0,0,1+o/c.bo]),c.aY(w,w,.5*Math.PI),c.K(w,w,[y,y,y]),w}getProjectionDataForCustomLayer(e=!0){const o=this.getProjectionData({overscaledTileID:new c.S(0,0,0,0,0),applyGlobeMatrix:e});return o.tileMercatorCoords=[0,0,1,1],o}getFastPathSimpleProjectionMatrix(e){}}class dc{get pixelsToClipSpaceMatrix(){return this._helper.pixelsToClipSpaceMatrix}get clipSpaceToPixelsMatrix(){return this._helper.clipSpaceToPixelsMatrix}get pixelsToGLUnits(){return this._helper.pixelsToGLUnits}get centerOffset(){return this._helper.centerOffset}get size(){return this._helper.size}get rotationMatrix(){return this._helper.rotationMatrix}get centerPoint(){return this._helper.centerPoint}get pixelsPerMeter(){return this._helper.pixelsPerMeter}setMinZoom(e){this._helper.setMinZoom(e)}setMaxZoom(e){this._helper.setMaxZoom(e)}setMinPitch(e){this._helper.setMinPitch(e)}setMaxPitch(e){this._helper.setMaxPitch(e)}setRenderWorldCopies(e){this._helper.setRenderWorldCopies(e)}setBearing(e){this._helper.setBearing(e)}setPitch(e){this._helper.setPitch(e)}setRoll(e){this._helper.setRoll(e)}setFov(e){this._helper.setFov(e)}setZoom(e){this._helper.setZoom(e)}setCenter(e){this._helper.setCenter(e)}setElevation(e){this._helper.setElevation(e)}setMinElevationForCurrentTile(e){this._helper.setMinElevationForCurrentTile(e)}setPadding(e){this._helper.setPadding(e)}interpolatePadding(e,o,f){return this._helper.interpolatePadding(e,o,f)}isPaddingEqual(e){return this._helper.isPaddingEqual(e)}resize(e,o,f=!0){this._helper.resize(e,o,f)}getMaxBounds(){return this._helper.getMaxBounds()}setMaxBounds(e){this._helper.setMaxBounds(e)}overrideNearFarZ(e,o){this._helper.overrideNearFarZ(e,o)}clearNearFarZOverride(){this._helper.clearNearFarZOverride()}getCameraQueryGeometry(e){return this._helper.getCameraQueryGeometry(this.getCameraPoint(),e)}get tileSize(){return this._helper.tileSize}get tileZoom(){return this._helper.tileZoom}get scale(){return this._helper.scale}get worldSize(){return this._helper.worldSize}get width(){return this._helper.width}get height(){return this._helper.height}get lngRange(){return this._helper.lngRange}get latRange(){return this._helper.latRange}get minZoom(){return this._helper.minZoom}get maxZoom(){return this._helper.maxZoom}get zoom(){return this._helper.zoom}get center(){return this._helper.center}get minPitch(){return this._helper.minPitch}get maxPitch(){return this._helper.maxPitch}get pitch(){return this._helper.pitch}get pitchInRadians(){return this._helper.pitchInRadians}get roll(){return this._helper.roll}get rollInRadians(){return this._helper.rollInRadians}get bearing(){return this._helper.bearing}get bearingInRadians(){return this._helper.bearingInRadians}get fov(){return this._helper.fov}get fovInRadians(){return this._helper.fovInRadians}get elevation(){return this._helper.elevation}get minElevationForCurrentTile(){return this._helper.minElevationForCurrentTile}get padding(){return this._helper.padding}get unmodified(){return this._helper.unmodified}get renderWorldCopies(){return this._helper.renderWorldCopies}get cameraToCenterDistance(){return this._helper.cameraToCenterDistance}get nearZ(){return this._helper.nearZ}get farZ(){return this._helper.farZ}get autoCalculateNearFarZ(){return this._helper.autoCalculateNearFarZ}get isGlobeRendering(){return this._globeness>0}setTransitionState(e,o){this._globeness=e,this._globeLatitudeErrorCorrectionRadians=o,this._calcMatrices(),this._verticalPerspectiveTransform.getCoveringTilesDetailsProvider().recalculateCache(),this._mercatorTransform.getCoveringTilesDetailsProvider().recalculateCache()}get currentTransform(){return this.isGlobeRendering?this._verticalPerspectiveTransform:this._mercatorTransform}constructor(){this._globeLatitudeErrorCorrectionRadians=0,this._globeness=1,this._helper=new As({calcMatrices:()=>{this._calcMatrices()},getConstrained:(e,o)=>this.getConstrained(e,o)}),this._globeness=1,this._mercatorTransform=new Ua,this._verticalPerspectiveTransform=new Td}clone(){const e=new dc;return e._globeness=this._globeness,e._globeLatitudeErrorCorrectionRadians=this._globeLatitudeErrorCorrectionRadians,e.apply(this),e}apply(e){this._helper.apply(e),this._mercatorTransform.apply(this),this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians)}get projectionMatrix(){return this.currentTransform.projectionMatrix}get modelViewProjectionMatrix(){return this.currentTransform.modelViewProjectionMatrix}get inverseProjectionMatrix(){return this.currentTransform.inverseProjectionMatrix}get cameraPosition(){return this.currentTransform.cameraPosition}getProjectionData(e){const o=this._mercatorTransform.getProjectionData(e),f=this._verticalPerspectiveTransform.getProjectionData(e);return{mainMatrix:this.isGlobeRendering?f.mainMatrix:o.mainMatrix,clippingPlane:f.clippingPlane,tileMercatorCoords:f.tileMercatorCoords,projectionTransition:e.applyGlobeMatrix?this._globeness:0,fallbackMatrix:o.fallbackMatrix}}isLocationOccluded(e){return this.currentTransform.isLocationOccluded(e)}transformLightDirection(e){return this.currentTransform.transformLightDirection(e)}getPixelScale(){return c.b9(this._mercatorTransform.getPixelScale(),this._verticalPerspectiveTransform.getPixelScale(),this._globeness)}getCircleRadiusCorrection(){return c.b9(this._mercatorTransform.getCircleRadiusCorrection(),this._verticalPerspectiveTransform.getCircleRadiusCorrection(),this._globeness)}getPitchedTextCorrection(e,o,f){const y=this._mercatorTransform.getPitchedTextCorrection(e,o,f),w=this._verticalPerspectiveTransform.getPitchedTextCorrection(e,o,f);return c.b9(y,w,this._globeness)}projectTileCoordinates(e,o,f,y){return this.currentTransform.projectTileCoordinates(e,o,f,y)}_calcMatrices(){this._helper._width&&this._helper._height&&(this._verticalPerspectiveTransform.apply(this,this._globeLatitudeErrorCorrectionRadians),this._helper._nearZ=this._verticalPerspectiveTransform.nearZ,this._helper._farZ=this._verticalPerspectiveTransform.farZ,this._mercatorTransform.apply(this,!0,this.isGlobeRendering),this._helper._nearZ=this._mercatorTransform.nearZ,this._helper._farZ=this._mercatorTransform.farZ)}calculateFogMatrix(e){return this.currentTransform.calculateFogMatrix(e)}getVisibleUnwrappedCoordinates(e){return this.currentTransform.getVisibleUnwrappedCoordinates(e)}getCameraFrustum(){return this.currentTransform.getCameraFrustum()}getClippingPlane(){return this.currentTransform.getClippingPlane()}getCoveringTilesDetailsProvider(){return this.currentTransform.getCoveringTilesDetailsProvider()}recalculateZoomAndCenter(e){this._mercatorTransform.recalculateZoomAndCenter(e),this._verticalPerspectiveTransform.recalculateZoomAndCenter(e)}maxPitchScaleFactor(){return this._mercatorTransform.maxPitchScaleFactor()}getCameraPoint(){return this._helper.getCameraPoint()}getCameraAltitude(){return this._helper.getCameraAltitude()}getCameraLngLat(){return this._helper.getCameraLngLat()}lngLatToCameraDepth(e,o){return this.currentTransform.lngLatToCameraDepth(e,o)}populateCache(e){this._mercatorTransform.populateCache(e),this._verticalPerspectiveTransform.populateCache(e)}getBounds(){return this.currentTransform.getBounds()}getConstrained(e,o){return this.currentTransform.getConstrained(e,o)}calculateCenterFromCameraLngLatAlt(e,o,f,y){return this._helper.calculateCenterFromCameraLngLatAlt(e,o,f,y)}setLocationAtPoint(e,o){if(!this.isGlobeRendering)return this._mercatorTransform.setLocationAtPoint(e,o),void this.apply(this._mercatorTransform);this._verticalPerspectiveTransform.setLocationAtPoint(e,o),this.apply(this._verticalPerspectiveTransform)}locationToScreenPoint(e,o){return this.currentTransform.locationToScreenPoint(e,o)}screenPointToMercatorCoordinate(e,o){return this.currentTransform.screenPointToMercatorCoordinate(e,o)}screenPointToLocation(e,o){return this.currentTransform.screenPointToLocation(e,o)}isPointOnMapSurface(e,o){return this.currentTransform.isPointOnMapSurface(e,o)}getRayDirectionFromPixel(e){return this._verticalPerspectiveTransform.getRayDirectionFromPixel(e)}getMatrixForModel(e,o){return this.currentTransform.getMatrixForModel(e,o)}getProjectionDataForCustomLayer(e=!0){const o=this._mercatorTransform.getProjectionDataForCustomLayer(e);if(!this.isGlobeRendering)return o;const f=this._verticalPerspectiveTransform.getProjectionDataForCustomLayer(e);return f.fallbackMatrix=o.mainMatrix,f}getFastPathSimpleProjectionMatrix(e){return this.currentTransform.getFastPathSimpleProjectionMatrix(e)}}class ro{get useGlobeControls(){return!0}handlePanInertia(e,o){const f=lh(e,o);return Math.abs(f.lng-o.center.lng)>180&&(f.lng=o.center.lng+179.5*Math.sign(f.lng-o.center.lng)),{easingCenter:f,easingOffset:new c.P(0,0)}}handleMapControlsRollPitchBearingZoom(e,o){const f=e.around,y=o.screenPointToLocation(f);e.bearingDelta&&o.setBearing(o.bearing+e.bearingDelta),e.pitchDelta&&o.setPitch(o.pitch+e.pitchDelta),e.rollDelta&&o.setRoll(o.roll+e.rollDelta);const w=o.zoom;e.zoomDelta&&o.setZoom(o.zoom+e.zoomDelta);const S=o.zoom-w;if(S===0)return;const I=c.bk(o.center.lng,y.lng),P=I/(Math.abs(I/180)+1),j=c.bk(o.center.lat,y.lat),Z=o.getRayDirectionFromPixel(f),Y=o.cameraPosition,H=-1*c.aS(Y,Z),ee=c.bf();c.aM(ee,Y,[Z[0]*H,Z[1]*H,Z[2]*H]);const ie=c.bq(ee)-1,me=Math.exp(.5*-Math.max(ie-.3,0)),pe=uc(o.worldSize,o.center.lat)/Math.min(o.width,o.height),ge=c.bc(pe,.9,.5,1,.25),be=(1-c.aG(-S))*Math.min(me,ge),Se=o.center.lat,ke=o.zoom,Re=new c.N(o.center.lng+P*be,c.ab(o.center.lat+j*be,-85.051129,c.aF));o.setLocationAtPoint(y,f);const Oe=o.center,Pe=c.bc(Math.abs(I),45,85,0,1),He=c.bc(pe,.75,.35,0,1),Ke=Math.pow(Math.max(Pe,He),.25),st=c.bk(Oe.lng,Re.lng),ht=c.bk(Oe.lat,Re.lat);o.setCenter(new c.N(Oe.lng+st*Ke,Oe.lat+ht*Ke).wrap()),o.setZoom(ke+$r(Se,o.center.lat))}handleMapControlsPan(e,o,f){if(!e.panDelta)return;const y=o.center.lat,w=o.zoom;o.setCenter(lh(e.panDelta,o).wrap()),o.setZoom(w+$r(y,o.center.lat))}cameraForBoxAndBearing(e,o,f,y,w){const S=Cs(e,o,f,y,w),I=o.left/w.width*2-1,P=(w.width-o.right)/w.width*2-1,j=o.top/w.height*-2+1,Z=(w.height-o.bottom)/w.height*-2+1,Y=c.bk(f.getWest(),f.getEast())<0,H=Y?f.getEast():f.getWest(),ee=Y?f.getWest():f.getEast(),ie=Math.max(f.getNorth(),f.getSouth()),me=Math.min(f.getNorth(),f.getSouth()),pe=H+.5*c.bk(H,ee),ge=ie+.5*c.bk(ie,me),be=w.clone();be.setCenter(S.center),be.setBearing(S.bearing),be.setPitch(0),be.setRoll(0),be.setZoom(S.zoom);const Se=be.modelViewProjectionMatrix,ke=[ui(f.getNorthWest()),ui(f.getNorthEast()),ui(f.getSouthWest()),ui(f.getSouthEast()),ui(new c.N(ee,ge)),ui(new c.N(H,ge)),ui(new c.N(pe,ie)),ui(new c.N(pe,me))],Re=ui(S.center);let Oe=Number.POSITIVE_INFINITY;for(const Pe of ke)I<0&&(Oe=ro.getLesserNonNegativeNonNull(Oe,ro.solveVectorScale(Pe,Re,Se,"x",I))),P>0&&(Oe=ro.getLesserNonNegativeNonNull(Oe,ro.solveVectorScale(Pe,Re,Se,"x",P))),j>0&&(Oe=ro.getLesserNonNegativeNonNull(Oe,ro.solveVectorScale(Pe,Re,Se,"y",j))),Z<0&&(Oe=ro.getLesserNonNegativeNonNull(Oe,ro.solveVectorScale(Pe,Re,Se,"y",Z)));if(Number.isFinite(Oe)&&Oe!==0)return S.zoom=be.zoom+c.a8(Oe),S;io()}handleJumpToCenterZoom(e,o){const f=e.center.lat,y=e.getConstrained(o.center?c.N.convert(o.center):e.center,e.zoom).center;e.setCenter(y.wrap());const w=o.zoom!==void 0?+o.zoom:e.zoom+$r(f,y.lat);e.zoom!==w&&e.setZoom(w)}handleEaseTo(e,o){const f=e.zoom,y=e.center,w=e.padding,S={roll:e.roll,pitch:e.pitch,bearing:e.bearing},I={roll:o.roll===void 0?e.roll:o.roll,pitch:o.pitch===void 0?e.pitch:o.pitch,bearing:o.bearing===void 0?e.bearing:o.bearing},P=o.zoom!==void 0,j=!e.isPaddingEqual(o.padding);let Z=!1;const Y=o.center?c.N.convert(o.center):y,H=e.getConstrained(Y,f).center;da(e,H);const ee=e.clone();ee.setCenter(H),ee.setZoom(P?+o.zoom:f+$r(y.lat,Y.lat)),ee.setBearing(o.bearing);const ie=new c.P(c.ab(e.centerPoint.x+o.offsetAsPoint.x,0,e.width),c.ab(e.centerPoint.y+o.offsetAsPoint.y,0,e.height));ee.setLocationAtPoint(H,ie);const me=(o.offset&&o.offsetAsPoint.mag())>0?ee.center:H,pe=P?+o.zoom:f+$r(y.lat,me.lat),ge=f+$r(y.lat,0),be=pe+$r(me.lat,0),Se=c.bk(y.lng,me.lng),ke=c.bk(y.lat,me.lat),Re=c.aG(be-ge);return Z=pe!==f,{easeFunc:Oe=>{if(c.b3(S,I)||oh({startEulerAngles:S,endEulerAngles:I,tr:e,k:Oe,useSlerp:S.roll!=I.roll}),j&&e.interpolatePadding(w,o.padding,Oe),o.around)c.w("Easing around a point is not supported under globe projection."),e.setLocationAtPoint(o.around,o.aroundPoint);else{const Pe=be>ge?Math.min(2,Re):Math.max(.5,Re),He=Math.pow(Pe,1-Oe),Ke=bm(y,Se,ke,Oe*He);e.setCenter(Ke.wrap())}if(Z){const Pe=c.y.number(ge,be,Oe)+$r(0,e.center.lat);e.setZoom(Pe)}},isZooming:Z,elevationCenter:me}}handleFlyTo(e,o){const f=o.zoom!==void 0,y=e.center,w=e.zoom,S=!e.isPaddingEqual(o.padding),I=e.getConstrained(c.N.convert(o.center||o.locationAtOffset),w).center,P=f?+o.zoom:e.zoom+$r(e.center.lat,I.lat),j=e.clone();j.setCenter(I),S&&j.setPadding(o.padding),j.setZoom(P),j.setBearing(o.bearing);const Z=new c.P(c.ab(e.centerPoint.x+o.offsetAsPoint.x,0,e.width),c.ab(e.centerPoint.y+o.offsetAsPoint.y,0,e.height));j.setLocationAtPoint(I,Z);const Y=j.center;da(e,Y);const H=function(Se,ke,Re){const Oe=ui(ke),Pe=ui(Re),He=c.aS(Oe,Pe),Ke=Math.acos(He),st=xd(Se);return Ke/(2*Math.PI)*st}(e,y,Y),ee=w+$r(y.lat,0),ie=P+$r(Y.lat,0),me=c.aG(ie-ee);let pe;if(typeof o.minZoom=="number"){const Se=+o.minZoom+$r(Y.lat,0),ke=Math.min(Se,ee,ie)+$r(0,Y.lat),Re=e.getConstrained(Y,ke).zoom+$r(Y.lat,0);pe=c.aG(Re-ee)}const ge=c.bk(y.lng,Y.lng),be=c.bk(y.lat,Y.lat);return{easeFunc:(Se,ke,Re,Oe)=>{const Pe=bm(y,ge,be,Re),He=Se===1?Y:Pe;e.setCenter(He.wrap());const Ke=ee+c.a8(ke);e.setZoom(Se===1?P:Ke+$r(0,He.lat))},scaleOfZoom:me,targetCenter:Y,scaleOfMinZoom:pe,pixelPathLength:H}}static solveVectorScale(e,o,f,y,w){const S=y==="x"?[f[0],f[4],f[8],f[12]]:[f[1],f[5],f[9],f[13]],I=[f[3],f[7],f[11],f[15]],P=e[0]*S[0]+e[1]*S[1]+e[2]*S[2],j=e[0]*I[0]+e[1]*I[1]+e[2]*I[2],Z=o[0]*S[0]+o[1]*S[1]+o[2]*S[2],Y=o[0]*I[0]+o[1]*I[1]+o[2]*I[2];return Z+w*j===P+w*Y||I[3]*(P-Z)+S[3]*(Y-j)+P*Y==Z*j?null:(Z+S[3]-w*Y-w*I[3])/(Z-P-w*Y+w*j)}static getLesserNonNegativeNonNull(e,o){return o!==null&&o>=0&&o<e?o:e}}class ch{constructor(e){this._globe=e,this._mercatorCameraHelper=new xl,this._verticalPerspectiveCameraHelper=new ro}get useGlobeControls(){return this._globe.useGlobeRendering}get currentHelper(){return this.useGlobeControls?this._verticalPerspectiveCameraHelper:this._mercatorCameraHelper}handlePanInertia(e,o){return this.currentHelper.handlePanInertia(e,o)}handleMapControlsRollPitchBearingZoom(e,o){return this.currentHelper.handleMapControlsRollPitchBearingZoom(e,o)}handleMapControlsPan(e,o,f){this.currentHelper.handleMapControlsPan(e,o,f)}cameraForBoxAndBearing(e,o,f,y,w){return this.currentHelper.cameraForBoxAndBearing(e,o,f,y,w)}handleJumpToCenterZoom(e,o){this.currentHelper.handleJumpToCenterZoom(e,o)}handleEaseTo(e,o){return this.currentHelper.handleEaseTo(e,o)}handleFlyTo(e,o){return this.currentHelper.handleFlyTo(e,o)}}const El=(b,e)=>c.t(b,e&&e.filter(o=>o.identifier!=="source.canvas")),qf=c.br();class Ro extends c.E{constructor(e,o={}){super(),this._rtlPluginLoaded=()=>{for(const f in this.sourceCaches){const y=this.sourceCaches[f].getSource().type;y!=="vector"&&y!=="geojson"||this.sourceCaches[f].reload()}},this.map=e,this.dispatcher=new Sn(qt(),e._getMapId()),this.dispatcher.registerMessageHandler("GG",(f,y)=>this.getGlyphs(f,y)),this.dispatcher.registerMessageHandler("GI",(f,y)=>this.getImages(f,y)),this.imageManager=new Qe,this.imageManager.setEventedParent(this),this.glyphManager=new Dt(e._requestManager,o.localIdeographFontFamily),this.lineAtlas=new Ie(256,512),this.crossTileSymbolIndex=new bl,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new c.bs,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("SR",c.bt()),Ea().on(ws,this._rtlPluginLoaded),this.on("data",f=>{if(f.dataType!=="source"||f.sourceDataType!=="metadata")return;const y=this.sourceCaches[f.sourceId];if(!y)return;const w=y.getSource();if(w&&w.vectorLayerIds)for(const S in this._layers){const I=this._layers[S];I.source===w.id&&this._validateLayer(I)}})}loadURL(e,o={},f){this.fire(new c.k("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const y=this.map._requestManager.transformRequest(e,"Style");this._loadStyleRequest=new AbortController;const w=this._loadStyleRequest;c.h(y,this._loadStyleRequest).then(S=>{this._loadStyleRequest=null,this._load(S.data,o,f)}).catch(S=>{this._loadStyleRequest=null,S&&!w.signal.aborted&&this.fire(new c.j(S))})}loadJSON(e,o={},f){this.fire(new c.k("dataloading",{dataType:"style"})),this._frameRequest=new AbortController,F.frameAsync(this._frameRequest).then(()=>{this._frameRequest=null,o.validate=o.validate!==!1,this._load(e,o,f)}).catch(()=>{})}loadEmpty(){this.fire(new c.k("dataloading",{dataType:"style"})),this._load(qf,{validate:!1})}_load(e,o,f){var y,w;const S=o.transformStyle?o.transformStyle(f,e):e;if(!o.validate||!El(this,c.u(S))){this._loaded=!0,this.stylesheet=S;for(const I in S.sources)this.addSource(I,S.sources[I],{validate:!1});S.sprite?this._loadSprite(S.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(S.glyphs),this._createLayers(),this.light=new dt(this.stylesheet.light),this._setProjectionInternal(((y=this.stylesheet.projection)===null||y===void 0?void 0:y.type)||"mercator"),this.sky=new Ut(this.stylesheet.sky),this.map.setTerrain((w=this.stylesheet.terrain)!==null&&w!==void 0?w:null),this.fire(new c.k("data",{dataType:"style"})),this.fire(new c.k("style.load"))}}_createLayers(){const e=c.bu(this.stylesheet.layers);this.dispatcher.broadcast("SL",e),this._order=e.map(o=>o.id),this._layers={},this._serializedLayers=null;for(const o of e){const f=c.bv(o);f.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=f}}_loadSprite(e,o=!1,f=void 0){let y;this.imageManager.setLoaded(!1),this._spriteRequest=new AbortController,function(w,S,I,P){return c._(this,void 0,void 0,function*(){const j=De(w),Z=I>1?"@2x":"",Y={},H={};for(const{id:ee,url:ie}of j){const me=S.transformRequest(Ne(ie,Z,".json"),"SpriteJSON");Y[ee]=c.h(me,P);const pe=S.transformRequest(Ne(ie,Z,".png"),"SpriteImage");H[ee]=Me.getImage(pe,P)}return yield Promise.all([...Object.values(Y),...Object.values(H)]),function(ee,ie){return c._(this,void 0,void 0,function*(){const me={};for(const pe in ee){me[pe]={};const ge=F.getImageCanvasContext((yield ie[pe]).data),be=(yield ee[pe]).data;for(const Se in be){const{width:ke,height:Re,x:Oe,y:Pe,sdf:He,pixelRatio:Ke,stretchX:st,stretchY:ht,content:nt,textFitWidth:kt,textFitHeight:Mt}=be[Se];me[pe][Se]={data:null,pixelRatio:Ke,sdf:He,stretchX:st,stretchY:ht,content:nt,textFitWidth:kt,textFitHeight:Mt,spriteData:{width:ke,height:Re,x:Oe,y:Pe,context:ge}}}}return me})}(Y,H)})}(e,this.map._requestManager,this.map.getPixelRatio(),this._spriteRequest).then(w=>{if(this._spriteRequest=null,w)for(const S in w){this._spritesImagesIds[S]=[];const I=this._spritesImagesIds[S]?this._spritesImagesIds[S].filter(P=>!(P in w)):[];for(const P of I)this.imageManager.removeImage(P),this._changedImages[P]=!0;for(const P in w[S]){const j=S==="default"?P:`${S}:${P}`;this._spritesImagesIds[S].push(j),j in this.imageManager.images?this.imageManager.updateImage(j,w[S][P],!1):this.imageManager.addImage(j,w[S][P]),o&&(this._changedImages[j]=!0)}}}).catch(w=>{this._spriteRequest=null,y=w,this.fire(new c.j(y))}).finally(()=>{this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"})),f&&f(y)})}_unloadSprite(){for(const e of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(e),this._changedImages[e]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}_validateLayer(e){const o=this.sourceCaches[e.source];if(!o)return;const f=e.sourceLayer;if(!f)return;const y=o.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(f)===-1)&&this.fire(new c.j(new Error(`Source layer "${f}" does not exist on source "${y.id}" as specified by style layer "${e.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this.sourceCaches)if(!this.sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(e,o=!1){const f=this._serializedAllLayers();if(!e||e.length===0)return Object.values(o?c.bw(f):f);const y=[];for(const w of e)if(f[w]){const S=o?c.bw(f[w]):f[w];y.push(S)}return y}_serializedAllLayers(){let e=this._serializedLayers;if(e)return e;e=this._serializedLayers={};const o=Object.keys(this._layers);for(const f of o){const y=this._layers[f];y.type!=="custom"&&(e[f]=y.serialize())}return e}hasTransitions(){var e,o,f;if(!((e=this.light)===null||e===void 0)&&e.hasTransition()||!((o=this.sky)===null||o===void 0)&&o.hasTransition()||!((f=this.projection)===null||f===void 0)&&f.hasTransition())return!0;for(const y in this.sourceCaches)if(this.sourceCaches[y].hasTransition())return!0;for(const y in this._layers)if(this._layers[y].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(e){if(!this._loaded)return;const o=this._changed;if(o){const y=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(y.length||w.length)&&this._updateWorkerLayers(y,w);for(const S in this._updatedSources){const I=this._updatedSources[S];if(I==="reload")this._reloadSource(S);else{if(I!=="clear")throw new Error(`Invalid action ${I}`);this._clearSource(S)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const S in this._updatedPaintProps)this._layers[S].updateTransitions(e);this.light.updateTransitions(e),this.sky.updateTransitions(e),this._resetUpdates()}const f={};for(const y in this.sourceCaches){const w=this.sourceCaches[y];f[y]=w.used,w.used=!1}for(const y of this._order){const w=this._layers[y];w.recalculate(e,this._availableImages),!w.isHidden(e.zoom)&&w.source&&(this.sourceCaches[w.source].used=!0)}for(const y in f){const w=this.sourceCaches[y];!!f[y]!=!!w.used&&w.fire(new c.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:y}))}this.light.recalculate(e),this.sky.recalculate(e),this.projection.recalculate(e),this.z=e.zoom,o&&this.fire(new c.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const e in this.sourceCaches)this.sourceCaches[e].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(e,o){this.dispatcher.broadcast("UL",{layers:this._serializeByIds(e,!1),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(e,o={}){var f;this._checkLoaded();const y=this.serialize();if(e=o.transformStyle?o.transformStyle(y,e):e,((f=o.validate)===null||f===void 0||f)&&El(this,c.u(e)))return!1;(e=c.bw(e)).layers=c.bu(e.layers);const w=c.bx(y,e),S=this._getOperationsToPerform(w);if(S.unimplemented.length>0)throw new Error(`Unimplemented: ${S.unimplemented.join(", ")}.`);if(S.operations.length===0)return!1;for(const I of S.operations)I();return this.stylesheet=e,this._serializedLayers=null,!0}_getOperationsToPerform(e){const o=[],f=[];for(const y of e)switch(y.command){case"setCenter":case"setZoom":case"setBearing":case"setPitch":case"setRoll":continue;case"addLayer":o.push(()=>this.addLayer.apply(this,y.args));break;case"removeLayer":o.push(()=>this.removeLayer.apply(this,y.args));break;case"setPaintProperty":o.push(()=>this.setPaintProperty.apply(this,y.args));break;case"setLayoutProperty":o.push(()=>this.setLayoutProperty.apply(this,y.args));break;case"setFilter":o.push(()=>this.setFilter.apply(this,y.args));break;case"addSource":o.push(()=>this.addSource.apply(this,y.args));break;case"removeSource":o.push(()=>this.removeSource.apply(this,y.args));break;case"setLayerZoomRange":o.push(()=>this.setLayerZoomRange.apply(this,y.args));break;case"setLight":o.push(()=>this.setLight.apply(this,y.args));break;case"setGeoJSONSourceData":o.push(()=>this.setGeoJSONSourceData.apply(this,y.args));break;case"setGlyphs":o.push(()=>this.setGlyphs.apply(this,y.args));break;case"setSprite":o.push(()=>this.setSprite.apply(this,y.args));break;case"setTerrain":o.push(()=>this.map.setTerrain.apply(this,y.args));break;case"setSky":o.push(()=>this.setSky.apply(this,y.args));break;case"setProjection":this.setProjection.apply(this,y.args);break;case"setTransition":o.push(()=>{});break;default:f.push(y.command)}return{operations:o,unimplemented:f}}addImage(e,o){if(this.getImage(e))return this.fire(new c.j(new Error(`An image named "${e}" already exists.`)));this.imageManager.addImage(e,o),this._afterImageUpdated(e)}updateImage(e,o){this.imageManager.updateImage(e,o)}getImage(e){return this.imageManager.getImage(e)}removeImage(e){if(!this.getImage(e))return this.fire(new c.j(new Error(`An image named "${e}" does not exist.`)));this.imageManager.removeImage(e),this._afterImageUpdated(e)}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(e,o,f={}){if(this._checkLoaded(),this.sourceCaches[e]!==void 0)throw new Error(`Source "${e}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(c.u.source,`sources.${e}`,o,null,f))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const y=this.sourceCaches[e]=new te(e,o,this.dispatcher);y.style=this,y.setEventedParent(this,()=>({isSourceLoaded:y.loaded(),source:y.serialize(),sourceId:e})),y.onAdd(this.map),this._changed=!0}removeSource(e){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error("There is no source with this ID");for(const f in this._layers)if(this._layers[f].source===e)return this.fire(new c.j(new Error(`Source "${e}" cannot be removed while layer "${f}" is using it.`)));const o=this.sourceCaches[e];delete this.sourceCaches[e],delete this._updatedSources[e],o.fire(new c.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:e})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(e,o){if(this._checkLoaded(),this.sourceCaches[e]===void 0)throw new Error(`There is no source with this ID=${e}`);const f=this.sourceCaches[e].getSource();if(f.type!=="geojson")throw new Error(`geojsonSource.type is ${f.type}, which is !== 'geojson`);f.setData(o),this._changed=!0}getSource(e){return this.sourceCaches[e]&&this.sourceCaches[e].getSource()}addLayer(e,o,f={}){this._checkLoaded();const y=e.id;if(this.getLayer(y))return void this.fire(new c.j(new Error(`Layer "${y}" already exists on this map.`)));let w;if(e.type==="custom"){if(El(this,c.by(e)))return;w=c.bv(e)}else{if("source"in e&&typeof e.source=="object"&&(this.addSource(y,e.source),e=c.bw(e),e=c.e(e,{source:y})),this._validate(c.u.layer,`layers.${y}`,e,{arrayIndex:-1},f))return;w=c.bv(e),this._validateLayer(w),w.setEventedParent(this,{layer:{id:y}})}const S=o?this._order.indexOf(o):this._order.length;if(o&&S===-1)this.fire(new c.j(new Error(`Cannot add layer "${y}" before non-existing layer "${o}".`)));else{if(this._order.splice(S,0,y),this._layerOrderChanged=!0,this._layers[y]=w,this._removedLayers[y]&&w.source&&w.type!=="custom"){const I=this._removedLayers[y];delete this._removedLayers[y],I.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",this.sourceCaches[w.source].pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map)}}moveLayer(e,o){if(this._checkLoaded(),this._changed=!0,!this._layers[e])return void this.fire(new c.j(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===o)return;const f=this._order.indexOf(e);this._order.splice(f,1);const y=o?this._order.indexOf(o):this._order.length;o&&y===-1?this.fire(new c.j(new Error(`Cannot move layer "${e}" before non-existing layer "${o}".`))):(this._order.splice(y,0,e),this._layerOrderChanged=!0)}removeLayer(e){this._checkLoaded();const o=this._layers[e];if(!o)return void this.fire(new c.j(new Error(`Cannot remove non-existing layer "${e}".`)));o.setEventedParent(null);const f=this._order.indexOf(e);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=o,delete this._layers[e],this._serializedLayers&&delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],o.onRemove&&o.onRemove(this.map)}getLayer(e){return this._layers[e]}getLayersOrder(){return[...this._order]}hasLayer(e){return e in this._layers}setLayerZoomRange(e,o,f){this._checkLoaded();const y=this.getLayer(e);y?y.minzoom===o&&y.maxzoom===f||(o!=null&&(y.minzoom=o),f!=null&&(y.maxzoom=f),this._updateLayer(y)):this.fire(new c.j(new Error(`Cannot set the zoom range of non-existing layer "${e}".`)))}setFilter(e,o,f={}){this._checkLoaded();const y=this.getLayer(e);if(y){if(!c.bz(y.filter,o))return o==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(c.u.filter,`layers.${y.id}.filter`,o,null,f)||(y.filter=c.bw(o),this._updateLayer(y)))}else this.fire(new c.j(new Error(`Cannot filter non-existing layer "${e}".`)))}getFilter(e){return c.bw(this.getLayer(e).filter)}setLayoutProperty(e,o,f,y={}){this._checkLoaded();const w=this.getLayer(e);w?c.bz(w.getLayoutProperty(o),f)||(w.setLayoutProperty(o,f,y),this._updateLayer(w)):this.fire(new c.j(new Error(`Cannot style non-existing layer "${e}".`)))}getLayoutProperty(e,o){const f=this.getLayer(e);if(f)return f.getLayoutProperty(o);this.fire(new c.j(new Error(`Cannot get style of non-existing layer "${e}".`)))}setPaintProperty(e,o,f,y={}){this._checkLoaded();const w=this.getLayer(e);w?c.bz(w.getPaintProperty(o),f)||(w.setPaintProperty(o,f,y)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[e]=!0,this._serializedLayers=null):this.fire(new c.j(new Error(`Cannot style non-existing layer "${e}".`)))}getPaintProperty(e,o){return this.getLayer(e).getPaintProperty(o)}setFeatureState(e,o){this._checkLoaded();const f=e.source,y=e.sourceLayer,w=this.sourceCaches[f];if(w===void 0)return void this.fire(new c.j(new Error(`The source '${f}' does not exist in the map's style.`)));const S=w.getSource().type;S==="geojson"&&y?this.fire(new c.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):S!=="vector"||y?(e.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),w.setFeatureState(y,e.id,o)):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(e,o){this._checkLoaded();const f=e.source,y=this.sourceCaches[f];if(y===void 0)return void this.fire(new c.j(new Error(`The source '${f}' does not exist in the map's style.`)));const w=y.getSource().type,S=w==="vector"?e.sourceLayer:void 0;w!=="vector"||S?o&&typeof e.id!="string"&&typeof e.id!="number"?this.fire(new c.j(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(S,e.id,o):this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(e){this._checkLoaded();const o=e.source,f=e.sourceLayer,y=this.sourceCaches[o];if(y!==void 0)return y.getSource().type!=="vector"||f?(e.id===void 0&&this.fire(new c.j(new Error("The feature id parameter must be provided."))),y.getFeatureState(f,e.id)):void this.fire(new c.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new c.j(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return c.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const e=c.bA(this.sourceCaches,w=>w.serialize()),o=this._serializeByIds(this._order,!0),f=this.map.getTerrain()||void 0,y=this.stylesheet;return c.bB({version:y.version,name:y.name,metadata:y.metadata,light:y.light,sky:y.sky,center:y.center,zoom:y.zoom,bearing:y.bearing,pitch:y.pitch,sprite:y.sprite,glyphs:y.glyphs,transition:y.transition,projection:y.projection,sources:e,layers:o,terrain:f},w=>w!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0,e.source&&!this._updatedSources[e.source]&&this.sourceCaches[e.source].getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",this.sourceCaches[e.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(e){const o=S=>this._layers[S].type==="fill-extrusion",f={},y=[];for(let S=this._order.length-1;S>=0;S--){const I=this._order[S];if(o(I)){f[I]=S;for(const P of e){const j=P[I];if(j)for(const Z of j)y.push(Z)}}}y.sort((S,I)=>I.intersectionZ-S.intersectionZ);const w=[];for(let S=this._order.length-1;S>=0;S--){const I=this._order[S];if(o(I))for(let P=y.length-1;P>=0;P--){const j=y[P].feature;if(f[j.layer.id]<S)break;w.push(j),y.pop()}else for(const P of e){const j=P[I];if(j)for(const Z of j)w.push(Z.feature)}}return w}queryRenderedFeatures(e,o,f){o&&o.filter&&this._validate(c.u.filter,"queryRenderedFeatures.filter",o.filter,null,o);const y={};if(o&&o.layers){if(!(Array.isArray(o.layers)||o.layers instanceof Set))return this.fire(new c.j(new Error("parameters.layers must be an Array or a Set of strings"))),[];for(const j of o.layers){const Z=this._layers[j];if(!Z)return this.fire(new c.j(new Error(`The layer '${j}' does not exist in the map's style and cannot be queried for features.`))),[];y[Z.source]=!0}}const w=[];o.availableImages=this._availableImages;const S=this._serializedAllLayers(),I=o.layers instanceof Set?o.layers:Array.isArray(o.layers)?new Set(o.layers):null,P=Object.assign(Object.assign({},o),{layers:I});for(const j in this.sourceCaches)o.layers&&!y[j]||w.push(Un(this.sourceCaches[j],this._layers,S,e,P,f));return this.placement&&w.push(function(j,Z,Y,H,ee,ie,me){const pe={},ge=ie.queryRenderedSymbols(H),be=[];for(const Se of Object.keys(ge).map(Number))be.push(me[Se]);be.sort(Wn);for(const Se of be){const ke=Se.featureIndex.lookupSymbolFeatures(ge[Se.bucketInstanceId],Z,Se.bucketIndex,Se.sourceLayerIndex,ee.filter,ee.layers,ee.availableImages,j);for(const Re in ke){const Oe=pe[Re]=pe[Re]||[],Pe=ke[Re];Pe.sort((He,Ke)=>{const st=Se.featureSortOrder;if(st){const ht=st.indexOf(He.featureIndex);return st.indexOf(Ke.featureIndex)-ht}return Ke.featureIndex-He.featureIndex});for(const He of Pe)Oe.push(He)}}return function(Se,ke,Re){for(const Oe in Se)for(const Pe of Se[Oe])ai(Pe,Re[ke[Oe].source]);return Se}(pe,j,Y)}(this._layers,S,this.sourceCaches,e,P,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(e,o){o&&o.filter&&this._validate(c.u.filter,"querySourceFeatures.filter",o.filter,null,o);const f=this.sourceCaches[e];return f?function(y,w){const S=y.getRenderableIds().map(j=>y.getTileByID(j)),I=[],P={};for(let j=0;j<S.length;j++){const Z=S[j],Y=Z.tileID.canonical.key;P[Y]||(P[Y]=!0,Z.querySourceFeatures(I,w))}return I}(f,o):[]}getLight(){return this.light.getLight()}setLight(e,o={}){this._checkLoaded();const f=this.light.getLight();let y=!1;for(const S in e)if(!c.bz(e[S],f[S])){y=!0;break}if(!y)return;const w={now:F.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(e,o),this.light.updateTransitions(w)}getProjection(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.projection}setProjection(e){if(this._checkLoaded(),this.projection){if(this.projection.name===e.type)return;this.projection.destroy(),delete this.projection}this.stylesheet.projection=e,this._setProjectionInternal(e.type)}getSky(){var e;return(e=this.stylesheet)===null||e===void 0?void 0:e.sky}setSky(e,o={}){this._checkLoaded();const f=this.getSky();let y=!1;if(!e&&!f)return;if(e&&!f)y=!0;else if(!e&&f)y=!0;else for(const S in e)if(!c.bz(e[S],f[S])){y=!0;break}if(!y)return;const w={now:F.now(),transition:c.e({duration:300,delay:0},this.stylesheet.transition)};this.stylesheet.sky=e,this.sky.setSky(e,o),this.sky.updateTransitions(w)}_setProjectionInternal(e){const o=function(f){if(Array.isArray(f)){const y=new sh({type:f});return{projection:y,transform:new dc,cameraHelper:new ch(y)}}switch(f){case"mercator":return{projection:new ou,transform:new Ua,cameraHelper:new xl};case"globe":{const y=new sh({type:["interpolate",["linear"],["zoom"],11,"vertical-perspective",12,"mercator"]});return{projection:y,transform:new dc,cameraHelper:new ch(y)}}case"vertical-perspective":return{projection:new lu,transform:new Td,cameraHelper:new ro};default:return c.w(`Unknown projection name: ${f}. Falling back to mercator projection.`),{projection:new ou,transform:new Ua,cameraHelper:new xl}}}(e);this.projection=o.projection,this.map.migrateProjection(o.transform,o.cameraHelper);for(const f in this.sourceCaches)this.sourceCaches[f].reload()}_validate(e,o,f,y,w={}){return(!w||w.validate!==!1)&&El(this,e.call(c.u,c.e({key:o,style:this.serialize(),value:f,styleSpec:c.v},y)))}_remove(e=!0){this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._loadStyleRequest&&(this._loadStyleRequest.abort(),this._loadStyleRequest=null),this._spriteRequest&&(this._spriteRequest.abort(),this._spriteRequest=null),Ea().off(ws,this._rtlPluginLoaded);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const f=this.sourceCaches[o];f.setEventedParent(null),f.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),e&&this.dispatcher.broadcast("RM",void 0),this.dispatcher.remove(e)}_clearSource(e){this.sourceCaches[e].clearTiles()}_reloadSource(e){this.sourceCaches[e].resume(),this.sourceCaches[e].reload()}_updateSources(e){for(const o in this.sourceCaches)this.sourceCaches[o].update(e,this.map.terrain)}_generateCollisionBoxes(){for(const e in this.sourceCaches)this._reloadSource(e)}_updatePlacement(e,o,f,y,w=!1){let S=!1,I=!1;const P={};for(const j of this._order){const Z=this._layers[j];if(Z.type!=="symbol")continue;if(!P[Z.source]){const H=this.sourceCaches[Z.source];P[Z.source]=H.getRenderableIds(!0).map(ee=>H.getTileByID(ee)).sort((ee,ie)=>ie.tileID.overscaledZ-ee.tileID.overscaledZ||(ee.tileID.isLessThan(ie.tileID)?-1:1))}const Y=this.crossTileSymbolIndex.addLayer(Z,P[Z.source],e.center.lng);S=S||Y}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((w=w||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(F.now(),e.zoom))&&(this.pauseablePlacement=new Es(e,this.map.terrain,this._order,w,o,f,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,P),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(F.now()),I=!0),S&&this.pauseablePlacement.placement.setStale()),I||S)for(const j of this._order){const Z=this._layers[j];Z.type==="symbol"&&this.placement.updateLayerOpacities(Z,P[Z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(F.now())}_releaseSymbolFadeTiles(){for(const e in this.sourceCaches)this.sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,o){return c._(this,void 0,void 0,function*(){const f=yield this.imageManager.getImages(o.icons);this._updateTilesForChangedImages();const y=this.sourceCaches[o.source];return y&&y.setDependencies(o.tileID.key,o.type,o.icons),f})}getGlyphs(e,o){return c._(this,void 0,void 0,function*(){const f=yield this.glyphManager.getGlyphs(o.stacks),y=this.sourceCaches[o.source];return y&&y.setDependencies(o.tileID.key,o.type,[""]),f})}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(e,o={}){this._checkLoaded(),e&&this._validate(c.u.glyphs,"glyphs",e,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=e,this.glyphManager.entries={},this.glyphManager.setURL(e))}addSprite(e,o,f={},y){this._checkLoaded();const w=[{id:e,url:o}],S=[...De(this.stylesheet.sprite),...w];this._validate(c.u.sprite,"sprite",S,null,f)||(this.stylesheet.sprite=S,this._loadSprite(w,!0,y))}removeSprite(e){this._checkLoaded();const o=De(this.stylesheet.sprite);if(o.find(f=>f.id===e)){if(this._spritesImagesIds[e])for(const f of this._spritesImagesIds[e])this.imageManager.removeImage(f),this._changedImages[f]=!0;o.splice(o.findIndex(f=>f.id===e),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[e],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("SI",this._availableImages),this.fire(new c.k("data",{dataType:"style"}))}else this.fire(new c.j(new Error(`Sprite "${e}" doesn't exists on this map.`)))}getSprite(){return De(this.stylesheet.sprite)}setSprite(e,o={},f){this._checkLoaded(),e&&this._validate(c.u.sprite,"sprite",e,null,o)||(this.stylesheet.sprite=e,e?this._loadSprite(e,!0,f):(this._unloadSprite(),f&&f(null)))}}var ey=c.aA([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Ed{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(e,o,f,y,w,S,I,P,j){this.context=e;let Z=this.boundPaintVertexBuffers.length!==y.length;for(let Y=0;!Z&&Y<y.length;Y++)this.boundPaintVertexBuffers[Y]!==y[Y]&&(Z=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==f||Z||this.boundIndexBuffer!==w||this.boundVertexOffset!==S||this.boundDynamicVertexBuffer!==I||this.boundDynamicVertexBuffer2!==P||this.boundDynamicVertexBuffer3!==j?this.freshBind(o,f,y,w,S,I,P,j):(e.bindVertexArray.set(this.vao),I&&I.bind(),w&&w.dynamicDraw&&w.bind(),P&&P.bind(),j&&j.bind())}freshBind(e,o,f,y,w,S,I,P){const j=e.numAttributes,Z=this.context,Y=Z.gl;this.vao&&this.destroy(),this.vao=Z.createVertexArray(),Z.bindVertexArray.set(this.vao),this.boundProgram=e,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=f,this.boundIndexBuffer=y,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=S,this.boundDynamicVertexBuffer2=I,this.boundDynamicVertexBuffer3=P,o.enableAttributes(Y,e);for(const H of f)H.enableAttributes(Y,e);S&&S.enableAttributes(Y,e),I&&I.enableAttributes(Y,e),P&&P.enableAttributes(Y,e),o.bind(),o.setVertexAttribPointers(Y,e,w);for(const H of f)H.bind(),H.setVertexAttribPointers(Y,e,w);S&&(S.bind(),S.setVertexAttribPointers(Y,e,w)),y&&y.bind(),I&&(I.bind(),I.setVertexAttribPointers(Y,e,w)),P&&(P.bind(),P.setVertexAttribPointers(Y,e,w)),Z.currentNumAttributes=j}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}const uh=(b,e,o,f,y)=>({u_texture:0,u_ele_delta:b,u_fog_matrix:e,u_fog_color:o?o.properties.get("fog-color"):c.b4.white,u_fog_ground_blend:o?o.properties.get("fog-ground-blend"):1,u_fog_ground_blend_opacity:y?0:o?o.calculateFogBlendOpacity(f):0,u_horizon_color:o?o.properties.get("horizon-color"):c.b4.white,u_horizon_fog_blend:o?o.properties.get("horizon-fog-blend"):1,u_is_globe_mode:y?1:0}),hh={mainMatrix:"u_projection_matrix",tileMercatorCoords:"u_projection_tile_mercator_coords",clippingPlane:"u_projection_clipping_plane",projectionTransition:"u_projection_transition",fallbackMatrix:"u_projection_fallback_matrix"};function Sd(b){const e=[];for(let o=0;o<b.length;o++){if(b[o]===null)continue;const f=b[o].split(" ");e.push(f.pop())}return e}class Ad{constructor(e,o,f,y,w,S,I,P){const j=e.gl;this.program=j.createProgram();const Z=Sd(o.staticAttributes),Y=f?f.getBinderAttributes():[],H=Z.concat(Y),ee=Ss.prelude.staticUniforms?Sd(Ss.prelude.staticUniforms):[],ie=I.staticUniforms?Sd(I.staticUniforms):[],me=o.staticUniforms?Sd(o.staticUniforms):[],pe=f?f.getBinderUniforms():[],ge=ee.concat(ie).concat(me).concat(pe),be=[];for(const Ke of ge)be.indexOf(Ke)<0&&be.push(Ke);const Se=f?f.defines():[];Va(j)&&Se.unshift("#version 300 es"),w&&Se.push("#define OVERDRAW_INSPECTOR;"),S&&Se.push("#define TERRAIN3D;"),P&&Se.push(P);let ke=Se.concat(Ss.prelude.fragmentSource,I.fragmentSource,o.fragmentSource).join(`
`),Re=Se.concat(Ss.prelude.vertexSource,I.vertexSource,o.vertexSource).join(`
`);Va(j)||(ke=function(Ke){return Ke.replace(/\bin\s/g,"varying ").replace("out highp vec4 fragColor;","").replace(/fragColor/g,"gl_FragColor").replace(/texture\(/g,"texture2D(")}(ke),Re=function(Ke){return Ke.replace(/\bin\s/g,"attribute ").replace(/\bout\s/g,"varying ").replace(/texture\(/g,"texture2D(")}(Re));const Oe=j.createShader(j.FRAGMENT_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(Oe,ke),j.compileShader(Oe),!j.getShaderParameter(Oe,j.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${j.getShaderInfoLog(Oe)}`);j.attachShader(this.program,Oe);const Pe=j.createShader(j.VERTEX_SHADER);if(j.isContextLost())return void(this.failedToCreate=!0);if(j.shaderSource(Pe,Re),j.compileShader(Pe),!j.getShaderParameter(Pe,j.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${j.getShaderInfoLog(Pe)}`);j.attachShader(this.program,Pe),this.attributes={};const He={};this.numAttributes=H.length;for(let Ke=0;Ke<this.numAttributes;Ke++)H[Ke]&&(j.bindAttribLocation(this.program,Ke,H[Ke]),this.attributes[H[Ke]]=Ke);if(j.linkProgram(this.program),!j.getProgramParameter(this.program,j.LINK_STATUS))throw new Error(`Program failed to link: ${j.getProgramInfoLog(this.program)}`);j.deleteShader(Pe),j.deleteShader(Oe);for(let Ke=0;Ke<be.length;Ke++){const st=be[Ke];if(st&&!He[st]){const ht=j.getUniformLocation(this.program,st);ht&&(He[st]=ht)}}this.fixedUniforms=y(e,He),this.terrainUniforms=((Ke,st)=>({u_depth:new c.bC(Ke,st.u_depth),u_terrain:new c.bC(Ke,st.u_terrain),u_terrain_dim:new c.b5(Ke,st.u_terrain_dim),u_terrain_matrix:new c.bD(Ke,st.u_terrain_matrix),u_terrain_unpack:new c.bE(Ke,st.u_terrain_unpack),u_terrain_exaggeration:new c.b5(Ke,st.u_terrain_exaggeration)}))(e,He),this.projectionUniforms=((Ke,st)=>({u_projection_matrix:new c.bD(Ke,st.u_projection_matrix),u_projection_tile_mercator_coords:new c.bE(Ke,st.u_projection_tile_mercator_coords),u_projection_clipping_plane:new c.bE(Ke,st.u_projection_clipping_plane),u_projection_transition:new c.b5(Ke,st.u_projection_transition),u_projection_fallback_matrix:new c.bD(Ke,st.u_projection_fallback_matrix)}))(e,He),this.binderUniforms=f?f.getUniforms(e,He):[]}draw(e,o,f,y,w,S,I,P,j,Z,Y,H,ee,ie,me,pe,ge,be,Se){const ke=e.gl;if(this.failedToCreate)return;if(e.program.set(this.program),e.setDepthMode(f),e.setStencilMode(y),e.setColorMode(w),e.setCullFace(S),P){e.activeTexture.set(ke.TEXTURE2),ke.bindTexture(ke.TEXTURE_2D,P.depthTexture),e.activeTexture.set(ke.TEXTURE3),ke.bindTexture(ke.TEXTURE_2D,P.texture);for(const Oe in this.terrainUniforms)this.terrainUniforms[Oe].set(P[Oe])}if(j)for(const Oe in j)this.projectionUniforms[hh[Oe]].set(j[Oe]);if(I)for(const Oe in this.fixedUniforms)this.fixedUniforms[Oe].set(I[Oe]);pe&&pe.setUniforms(e,this.binderUniforms,ie,{zoom:me});let Re=0;switch(o){case ke.LINES:Re=2;break;case ke.TRIANGLES:Re=3;break;case ke.LINE_STRIP:Re=1}for(const Oe of ee.get()){const Pe=Oe.vaos||(Oe.vaos={});(Pe[Z]||(Pe[Z]=new Ed)).bind(e,this,Y,pe?pe.getPaintVertexBuffers():[],H,Oe.vertexOffset,ge,be,Se),ke.drawElements(o,Oe.primitiveLength*Re,ke.UNSIGNED_SHORT,Oe.primitiveOffset*Re*2)}}}function wm(b,e,o){const f=1/c.at(o,1,e.transform.tileZoom),y=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,e.transform.tileZoom)/y,S=w*(o.tileID.canonical.x+o.tileID.wrap*y),I=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[f,b.fromScale,b.toScale],u_fade:b.t,u_pixel_coord_upper:[S>>16,I>>16],u_pixel_coord_lower:[65535&S,65535&I]}}const fc=(b,e,o,f)=>{const y=b.style.light,w=y.properties.get("position"),S=[w.x,w.y,w.z],I=c.bI();y.properties.get("anchor")==="viewport"&&c.bJ(I,b.transform.bearingInRadians),c.bK(S,S,I);const P=b.transform.transformLightDirection(S),j=y.properties.get("color");return{u_lightpos:S,u_lightpos_globe:P,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[j.r,j.g,j.b],u_vertical_gradient:+e,u_opacity:o,u_fill_translate:f}},ty=(b,e,o,f,y,w,S)=>c.e(fc(b,e,o,f),wm(w,b,S),{u_height_factor:-Math.pow(2,y.overscaledZ)/S.tileSize/8}),Hf=(b,e,o,f)=>c.e(wm(e,b,o),{u_fill_translate:f}),ny=(b,e)=>({u_world:b,u_fill_translate:e}),Cd=(b,e,o,f,y)=>c.e(Hf(b,e,o,y),{u_world:f}),pc=(b,e,o,f,y)=>{const w=b.transform;let S,I,P=0;if(o.paint.get("circle-pitch-alignment")==="map"){const j=c.at(e,1,w.zoom);S=!0,I=[j,j],P=j/(c.X*Math.pow(2,e.tileID.overscaledZ))*2*Math.PI*y}else S=!1,I=w.pixelsToGLUnits;return{u_camera_to_center_distance:w.cameraToCenterDistance,u_scale_with_map:+(o.paint.get("circle-pitch-scale")==="map"),u_pitch_with_map:+S,u_device_pixel_ratio:b.pixelRatio,u_extrude_scale:I,u_globe_extrude_scale:P,u_translate:f}},Tm=b=>({u_pixel_extrude_scale:[1/b.width,1/b.height]}),Xf=b=>({u_viewport_size:[b.width,b.height]}),Md=(b,e=1)=>({u_color:b,u_overlay:0,u_overlay_scale:e}),Dd=(b,e,o,f)=>{const y=c.at(b,1,e)/(c.X*Math.pow(2,b.tileID.overscaledZ))*2*Math.PI*f;return{u_extrude_scale:c.at(b,1,e),u_intensity:o,u_globe_extrude_scale:y}},Hs=(b,e,o,f)=>{const y=c.H();c.bL(y,0,b.width,b.height,0,0,1);const w=b.context.gl;return{u_matrix:y,u_world:[w.drawingBufferWidth,w.drawingBufferHeight],u_image:o,u_color_ramp:f,u_opacity:e.paint.get("heatmap-opacity")}},Wf=(b,e,o)=>{const f=o.paint.get("hillshade-shadow-color"),y=o.paint.get("hillshade-highlight-color"),w=o.paint.get("hillshade-accent-color");let S=o.paint.get("hillshade-illumination-direction")*(Math.PI/180);return o.paint.get("hillshade-illumination-anchor")==="viewport"&&(S+=b.transform.bearingInRadians),{u_image:0,u_latrange:dh(0,e.tileID),u_light:[o.paint.get("hillshade-exaggeration"),S],u_shadow:f,u_highlight:y,u_accent:w}},mc=(b,e)=>{const o=e.stride,f=c.H();return c.bL(f,0,c.X,-8192,0,0,1),c.J(f,f,[0,-8192,0]),{u_matrix:f,u_image:1,u_dimension:[o,o],u_zoom:b.overscaledZ,u_unpack:e.getUnpackVector()}};function dh(b,e){const o=Math.pow(2,e.canonical.z),f=e.canonical.y;return[new c.Y(0,f/o).toLngLat().lat,new c.Y(0,(f+1)/o).toLngLat().lat]}const Qf=(b,e,o,f)=>{const y=b.transform;return{u_translation:yc(b,e,o),u_ratio:f/c.at(e,1,y.zoom),u_device_pixel_ratio:b.pixelRatio,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},Id=(b,e,o,f,y)=>c.e(Qf(b,e,o,f),{u_image:0,u_image_height:y}),Em=(b,e,o,f,y)=>{const w=b.transform,S=gc(e,w);return{u_translation:yc(b,e,o),u_texsize:e.imageAtlasTexture.size,u_ratio:f/c.at(e,1,w.zoom),u_device_pixel_ratio:b.pixelRatio,u_image:0,u_scale:[S,y.fromScale,y.toScale],u_fade:y.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}},Sm=(b,e,o,f,y,w)=>{const S=b.lineAtlas,I=gc(e,b.transform),P=o.layout.get("line-cap")==="round",j=S.getDash(y.from,P),Z=S.getDash(y.to,P),Y=j.width*w.fromScale,H=Z.width*w.toScale;return c.e(Qf(b,e,o,f),{u_patternscale_a:[I/Y,-j.height/2],u_patternscale_b:[I/H,-Z.height/2],u_sdfgamma:S.width/(256*Math.min(Y,H)*b.pixelRatio)/2,u_image:0,u_tex_y_a:j.y,u_tex_y_b:Z.y,u_mix:w.t})};function gc(b,e){return 1/c.at(b,1,e.tileZoom)}function yc(b,e,o){return c.au(b.transform,e,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const Am=(b,e,o,f,y)=>{return{u_tl_parent:b,u_scale_parent:e,u_buffer_scale:1,u_fade_t:o.mix,u_opacity:o.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(S=f.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(w=f.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:cu(f.paint.get("raster-hue-rotate")),u_coords_top:[y[0].x,y[0].y,y[1].x,y[1].y],u_coords_bottom:[y[3].x,y[3].y,y[2].x,y[2].y]};var w,S};function cu(b){b*=Math.PI/180;const e=Math.sin(b),o=Math.cos(b);return[(2*o+1)/3,(-Math.sqrt(3)*e-o+1)/3,(Math.sqrt(3)*e-o+1)/3]}const kd=(b,e,o,f,y,w,S,I,P,j,Z,Y,H)=>{const ee=S.transform;return{u_is_size_zoom_constant:+(b==="constant"||b==="source"),u_is_size_feature_constant:+(b==="constant"||b==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:ee.cameraToCenterDistance,u_pitch:ee.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:ee.width/ee.height,u_fade_change:S.options.fadeDuration?S.symbolFadeChange:1,u_label_plane_matrix:I,u_coord_matrix:P,u_is_text:+Z,u_pitch_with_map:+f,u_is_along_line:y,u_is_variable_anchor:w,u_texsize:Y,u_texture:0,u_translation:j,u_pitched_scale:H}},uu=(b,e,o,f,y,w,S,I,P,j,Z,Y,H,ee)=>{const ie=S.transform;return c.e(kd(b,e,o,f,y,w,S,I,P,j,Z,Y,ee),{u_gamma_scale:f?Math.cos(ie.pitch*Math.PI/180)*ie.cameraToCenterDistance:1,u_device_pixel_ratio:S.pixelRatio,u_is_halo:1})},ts=(b,e,o,f,y,w,S,I,P,j,Z,Y,H)=>c.e(uu(b,e,o,f,y,w,S,I,P,j,!0,Z,0,H),{u_texsize_icon:Y,u_texture_icon:1}),fh=(b,e)=>({u_opacity:b,u_color:e}),Rd=(b,e,o,f,y)=>c.e(function(w,S,I,P){const j=I.imageManager.getPattern(w.from.toString()),Z=I.imageManager.getPattern(w.to.toString()),{width:Y,height:H}=I.imageManager.getPixelSize(),ee=Math.pow(2,P.tileID.overscaledZ),ie=P.tileSize*Math.pow(2,I.transform.tileZoom)/ee,me=ie*(P.tileID.canonical.x+P.tileID.wrap*ee),pe=ie*P.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:j.tl,u_pattern_br_a:j.br,u_pattern_tl_b:Z.tl,u_pattern_br_b:Z.br,u_texsize:[Y,H],u_mix:S.t,u_pattern_size_a:j.displaySize,u_pattern_size_b:Z.displaySize,u_scale_a:S.fromScale,u_scale_b:S.toScale,u_tile_units_to_pixels:1/c.at(P,1,I.transform.tileZoom),u_pixel_coord_upper:[me>>16,pe>>16],u_pixel_coord_lower:[65535&me,65535&pe]}}(o,y,e,f),{u_opacity:b}),ph=(b,e)=>{},Kf={fillExtrusion:(b,e)=>({u_lightpos:new c.bG(b,e.u_lightpos),u_lightpos_globe:new c.bG(b,e.u_lightpos_globe),u_lightintensity:new c.b5(b,e.u_lightintensity),u_lightcolor:new c.bG(b,e.u_lightcolor),u_vertical_gradient:new c.b5(b,e.u_vertical_gradient),u_opacity:new c.b5(b,e.u_opacity),u_fill_translate:new c.bH(b,e.u_fill_translate)}),fillExtrusionPattern:(b,e)=>({u_lightpos:new c.bG(b,e.u_lightpos),u_lightpos_globe:new c.bG(b,e.u_lightpos_globe),u_lightintensity:new c.b5(b,e.u_lightintensity),u_lightcolor:new c.bG(b,e.u_lightcolor),u_vertical_gradient:new c.b5(b,e.u_vertical_gradient),u_height_factor:new c.b5(b,e.u_height_factor),u_opacity:new c.b5(b,e.u_opacity),u_fill_translate:new c.bH(b,e.u_fill_translate),u_image:new c.bC(b,e.u_image),u_texsize:new c.bH(b,e.u_texsize),u_pixel_coord_upper:new c.bH(b,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bH(b,e.u_pixel_coord_lower),u_scale:new c.bG(b,e.u_scale),u_fade:new c.b5(b,e.u_fade)}),fill:(b,e)=>({u_fill_translate:new c.bH(b,e.u_fill_translate)}),fillPattern:(b,e)=>({u_image:new c.bC(b,e.u_image),u_texsize:new c.bH(b,e.u_texsize),u_pixel_coord_upper:new c.bH(b,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bH(b,e.u_pixel_coord_lower),u_scale:new c.bG(b,e.u_scale),u_fade:new c.b5(b,e.u_fade),u_fill_translate:new c.bH(b,e.u_fill_translate)}),fillOutline:(b,e)=>({u_world:new c.bH(b,e.u_world),u_fill_translate:new c.bH(b,e.u_fill_translate)}),fillOutlinePattern:(b,e)=>({u_world:new c.bH(b,e.u_world),u_image:new c.bC(b,e.u_image),u_texsize:new c.bH(b,e.u_texsize),u_pixel_coord_upper:new c.bH(b,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bH(b,e.u_pixel_coord_lower),u_scale:new c.bG(b,e.u_scale),u_fade:new c.b5(b,e.u_fade),u_fill_translate:new c.bH(b,e.u_fill_translate)}),circle:(b,e)=>({u_camera_to_center_distance:new c.b5(b,e.u_camera_to_center_distance),u_scale_with_map:new c.bC(b,e.u_scale_with_map),u_pitch_with_map:new c.bC(b,e.u_pitch_with_map),u_extrude_scale:new c.bH(b,e.u_extrude_scale),u_device_pixel_ratio:new c.b5(b,e.u_device_pixel_ratio),u_globe_extrude_scale:new c.b5(b,e.u_globe_extrude_scale),u_translate:new c.bH(b,e.u_translate)}),collisionBox:(b,e)=>({u_pixel_extrude_scale:new c.bH(b,e.u_pixel_extrude_scale)}),collisionCircle:(b,e)=>({u_viewport_size:new c.bH(b,e.u_viewport_size)}),debug:(b,e)=>({u_color:new c.bF(b,e.u_color),u_overlay:new c.bC(b,e.u_overlay),u_overlay_scale:new c.b5(b,e.u_overlay_scale)}),depth:ph,clippingMask:ph,heatmap:(b,e)=>({u_extrude_scale:new c.b5(b,e.u_extrude_scale),u_intensity:new c.b5(b,e.u_intensity),u_globe_extrude_scale:new c.b5(b,e.u_globe_extrude_scale)}),heatmapTexture:(b,e)=>({u_matrix:new c.bD(b,e.u_matrix),u_world:new c.bH(b,e.u_world),u_image:new c.bC(b,e.u_image),u_color_ramp:new c.bC(b,e.u_color_ramp),u_opacity:new c.b5(b,e.u_opacity)}),hillshade:(b,e)=>({u_image:new c.bC(b,e.u_image),u_latrange:new c.bH(b,e.u_latrange),u_light:new c.bH(b,e.u_light),u_shadow:new c.bF(b,e.u_shadow),u_highlight:new c.bF(b,e.u_highlight),u_accent:new c.bF(b,e.u_accent)}),hillshadePrepare:(b,e)=>({u_matrix:new c.bD(b,e.u_matrix),u_image:new c.bC(b,e.u_image),u_dimension:new c.bH(b,e.u_dimension),u_zoom:new c.b5(b,e.u_zoom),u_unpack:new c.bE(b,e.u_unpack)}),line:(b,e)=>({u_translation:new c.bH(b,e.u_translation),u_ratio:new c.b5(b,e.u_ratio),u_device_pixel_ratio:new c.b5(b,e.u_device_pixel_ratio),u_units_to_pixels:new c.bH(b,e.u_units_to_pixels)}),lineGradient:(b,e)=>({u_translation:new c.bH(b,e.u_translation),u_ratio:new c.b5(b,e.u_ratio),u_device_pixel_ratio:new c.b5(b,e.u_device_pixel_ratio),u_units_to_pixels:new c.bH(b,e.u_units_to_pixels),u_image:new c.bC(b,e.u_image),u_image_height:new c.b5(b,e.u_image_height)}),linePattern:(b,e)=>({u_translation:new c.bH(b,e.u_translation),u_texsize:new c.bH(b,e.u_texsize),u_ratio:new c.b5(b,e.u_ratio),u_device_pixel_ratio:new c.b5(b,e.u_device_pixel_ratio),u_image:new c.bC(b,e.u_image),u_units_to_pixels:new c.bH(b,e.u_units_to_pixels),u_scale:new c.bG(b,e.u_scale),u_fade:new c.b5(b,e.u_fade)}),lineSDF:(b,e)=>({u_translation:new c.bH(b,e.u_translation),u_ratio:new c.b5(b,e.u_ratio),u_device_pixel_ratio:new c.b5(b,e.u_device_pixel_ratio),u_units_to_pixels:new c.bH(b,e.u_units_to_pixels),u_patternscale_a:new c.bH(b,e.u_patternscale_a),u_patternscale_b:new c.bH(b,e.u_patternscale_b),u_sdfgamma:new c.b5(b,e.u_sdfgamma),u_image:new c.bC(b,e.u_image),u_tex_y_a:new c.b5(b,e.u_tex_y_a),u_tex_y_b:new c.b5(b,e.u_tex_y_b),u_mix:new c.b5(b,e.u_mix)}),raster:(b,e)=>({u_tl_parent:new c.bH(b,e.u_tl_parent),u_scale_parent:new c.b5(b,e.u_scale_parent),u_buffer_scale:new c.b5(b,e.u_buffer_scale),u_fade_t:new c.b5(b,e.u_fade_t),u_opacity:new c.b5(b,e.u_opacity),u_image0:new c.bC(b,e.u_image0),u_image1:new c.bC(b,e.u_image1),u_brightness_low:new c.b5(b,e.u_brightness_low),u_brightness_high:new c.b5(b,e.u_brightness_high),u_saturation_factor:new c.b5(b,e.u_saturation_factor),u_contrast_factor:new c.b5(b,e.u_contrast_factor),u_spin_weights:new c.bG(b,e.u_spin_weights),u_coords_top:new c.bE(b,e.u_coords_top),u_coords_bottom:new c.bE(b,e.u_coords_bottom)}),symbolIcon:(b,e)=>({u_is_size_zoom_constant:new c.bC(b,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bC(b,e.u_is_size_feature_constant),u_size_t:new c.b5(b,e.u_size_t),u_size:new c.b5(b,e.u_size),u_camera_to_center_distance:new c.b5(b,e.u_camera_to_center_distance),u_pitch:new c.b5(b,e.u_pitch),u_rotate_symbol:new c.bC(b,e.u_rotate_symbol),u_aspect_ratio:new c.b5(b,e.u_aspect_ratio),u_fade_change:new c.b5(b,e.u_fade_change),u_label_plane_matrix:new c.bD(b,e.u_label_plane_matrix),u_coord_matrix:new c.bD(b,e.u_coord_matrix),u_is_text:new c.bC(b,e.u_is_text),u_pitch_with_map:new c.bC(b,e.u_pitch_with_map),u_is_along_line:new c.bC(b,e.u_is_along_line),u_is_variable_anchor:new c.bC(b,e.u_is_variable_anchor),u_texsize:new c.bH(b,e.u_texsize),u_texture:new c.bC(b,e.u_texture),u_translation:new c.bH(b,e.u_translation),u_pitched_scale:new c.b5(b,e.u_pitched_scale)}),symbolSDF:(b,e)=>({u_is_size_zoom_constant:new c.bC(b,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bC(b,e.u_is_size_feature_constant),u_size_t:new c.b5(b,e.u_size_t),u_size:new c.b5(b,e.u_size),u_camera_to_center_distance:new c.b5(b,e.u_camera_to_center_distance),u_pitch:new c.b5(b,e.u_pitch),u_rotate_symbol:new c.bC(b,e.u_rotate_symbol),u_aspect_ratio:new c.b5(b,e.u_aspect_ratio),u_fade_change:new c.b5(b,e.u_fade_change),u_label_plane_matrix:new c.bD(b,e.u_label_plane_matrix),u_coord_matrix:new c.bD(b,e.u_coord_matrix),u_is_text:new c.bC(b,e.u_is_text),u_pitch_with_map:new c.bC(b,e.u_pitch_with_map),u_is_along_line:new c.bC(b,e.u_is_along_line),u_is_variable_anchor:new c.bC(b,e.u_is_variable_anchor),u_texsize:new c.bH(b,e.u_texsize),u_texture:new c.bC(b,e.u_texture),u_gamma_scale:new c.b5(b,e.u_gamma_scale),u_device_pixel_ratio:new c.b5(b,e.u_device_pixel_ratio),u_is_halo:new c.bC(b,e.u_is_halo),u_translation:new c.bH(b,e.u_translation),u_pitched_scale:new c.b5(b,e.u_pitched_scale)}),symbolTextAndIcon:(b,e)=>({u_is_size_zoom_constant:new c.bC(b,e.u_is_size_zoom_constant),u_is_size_feature_constant:new c.bC(b,e.u_is_size_feature_constant),u_size_t:new c.b5(b,e.u_size_t),u_size:new c.b5(b,e.u_size),u_camera_to_center_distance:new c.b5(b,e.u_camera_to_center_distance),u_pitch:new c.b5(b,e.u_pitch),u_rotate_symbol:new c.bC(b,e.u_rotate_symbol),u_aspect_ratio:new c.b5(b,e.u_aspect_ratio),u_fade_change:new c.b5(b,e.u_fade_change),u_label_plane_matrix:new c.bD(b,e.u_label_plane_matrix),u_coord_matrix:new c.bD(b,e.u_coord_matrix),u_is_text:new c.bC(b,e.u_is_text),u_pitch_with_map:new c.bC(b,e.u_pitch_with_map),u_is_along_line:new c.bC(b,e.u_is_along_line),u_is_variable_anchor:new c.bC(b,e.u_is_variable_anchor),u_texsize:new c.bH(b,e.u_texsize),u_texsize_icon:new c.bH(b,e.u_texsize_icon),u_texture:new c.bC(b,e.u_texture),u_texture_icon:new c.bC(b,e.u_texture_icon),u_gamma_scale:new c.b5(b,e.u_gamma_scale),u_device_pixel_ratio:new c.b5(b,e.u_device_pixel_ratio),u_is_halo:new c.bC(b,e.u_is_halo),u_translation:new c.bH(b,e.u_translation),u_pitched_scale:new c.b5(b,e.u_pitched_scale)}),background:(b,e)=>({u_opacity:new c.b5(b,e.u_opacity),u_color:new c.bF(b,e.u_color)}),backgroundPattern:(b,e)=>({u_opacity:new c.b5(b,e.u_opacity),u_image:new c.bC(b,e.u_image),u_pattern_tl_a:new c.bH(b,e.u_pattern_tl_a),u_pattern_br_a:new c.bH(b,e.u_pattern_br_a),u_pattern_tl_b:new c.bH(b,e.u_pattern_tl_b),u_pattern_br_b:new c.bH(b,e.u_pattern_br_b),u_texsize:new c.bH(b,e.u_texsize),u_mix:new c.b5(b,e.u_mix),u_pattern_size_a:new c.bH(b,e.u_pattern_size_a),u_pattern_size_b:new c.bH(b,e.u_pattern_size_b),u_scale_a:new c.b5(b,e.u_scale_a),u_scale_b:new c.b5(b,e.u_scale_b),u_pixel_coord_upper:new c.bH(b,e.u_pixel_coord_upper),u_pixel_coord_lower:new c.bH(b,e.u_pixel_coord_lower),u_tile_units_to_pixels:new c.b5(b,e.u_tile_units_to_pixels)}),terrain:(b,e)=>({u_texture:new c.bC(b,e.u_texture),u_ele_delta:new c.b5(b,e.u_ele_delta),u_fog_matrix:new c.bD(b,e.u_fog_matrix),u_fog_color:new c.bF(b,e.u_fog_color),u_fog_ground_blend:new c.b5(b,e.u_fog_ground_blend),u_fog_ground_blend_opacity:new c.b5(b,e.u_fog_ground_blend_opacity),u_horizon_color:new c.bF(b,e.u_horizon_color),u_horizon_fog_blend:new c.b5(b,e.u_horizon_fog_blend),u_is_globe_mode:new c.b5(b,e.u_is_globe_mode)}),terrainDepth:(b,e)=>({u_ele_delta:new c.b5(b,e.u_ele_delta)}),terrainCoords:(b,e)=>({u_texture:new c.bC(b,e.u_texture),u_terrain_coords_id:new c.b5(b,e.u_terrain_coords_id),u_ele_delta:new c.b5(b,e.u_ele_delta)}),projectionErrorMeasurement:(b,e)=>({u_input:new c.b5(b,e.u_input),u_output_expected:new c.b5(b,e.u_output_expected)}),atmosphere:(b,e)=>({u_sun_pos:new c.bG(b,e.u_sun_pos),u_atmosphere_blend:new c.b5(b,e.u_atmosphere_blend),u_globe_position:new c.bG(b,e.u_globe_position),u_globe_radius:new c.b5(b,e.u_globe_radius),u_inv_proj_matrix:new c.bD(b,e.u_inv_proj_matrix)}),sky:(b,e)=>({u_sky_color:new c.bF(b,e.u_sky_color),u_horizon_color:new c.bF(b,e.u_horizon_color),u_horizon:new c.bH(b,e.u_horizon),u_horizon_normal:new c.bH(b,e.u_horizon_normal),u_sky_horizon_blend:new c.b5(b,e.u_sky_horizon_blend),u_sky_blend:new c.b5(b,e.u_sky_blend)})};class Jf{constructor(e,o,f){this.context=e;const y=e.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!f,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const _c={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ep{constructor(e,o,f,y){this.length=o.length,this.attributes=f,this.itemSize=o.bytesPerElement,this.dynamicDraw=y,this.context=e;const w=e.gl;this.buffer=w.createBuffer(),e.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){if(e.length!==this.length)throw new Error(`Length of new data is ${e.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,o){for(let f=0;f<this.attributes.length;f++){const y=o.attributes[this.attributes[f].name];y!==void 0&&e.enableVertexAttribArray(y)}}setVertexAttribPointers(e,o,f){for(let y=0;y<this.attributes.length;y++){const w=this.attributes[y],S=o.attributes[w.name];S!==void 0&&e.vertexAttribPointer(S,w.components,e[_c[w.type]],!1,this.itemSize,w.offset+this.itemSize*(f||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class oi{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class iy extends oi{getDefault(){return c.b4.transparent}set(e){const o=this.current;(e.r!==o.r||e.g!==o.g||e.b!==o.b||e.a!==o.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class ao extends oi{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class mh extends oi{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class tp extends oi{getDefault(){return[!0,!0,!0,!0]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||e[3]!==o[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class Cm extends oi{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class np extends oi{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class gh extends oi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const o=this.current;(e.func!==o.func||e.ref!==o.ref||e.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class hu extends oi{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class Nd extends oi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=e,this.dirty=!1}}class ip extends oi{getDefault(){return[0,1]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class No extends oi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=e,this.dirty=!1}}class Sl extends oi{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class fa extends oi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.BLEND):o.disable(o.BLEND),this.current=e,this.dirty=!1}}class Pd extends oi{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class rp extends oi{getDefault(){return c.b4.transparent}set(e){const o=this.current;(e.r!==o.r||e.g!==o.g||e.b!==o.b||e.a!==o.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Xs extends oi{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class Po extends oi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;e?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=e,this.dirty=!1}}class du extends oi{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class yh extends oi{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class ns extends oi{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class _h extends oi{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class ap extends oi{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const o=this.current;(e[0]!==o[0]||e[1]!==o[1]||e[2]!==o[2]||e[3]!==o[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class vc extends oi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class fu extends oi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Mm extends oi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class op extends oi{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class Yn extends oi{getDefault(){return null}set(e){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class vh extends oi{getDefault(){return null}set(e){var o;if(e===this.current&&!this.dirty)return;const f=this.gl;Va(f)?f.bindVertexArray(e):(o=f.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(e),this.current=e,this.dirty=!1}}class Dm extends oi{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class zo extends oi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class pa extends oi{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Al extends oi{constructor(e,o){super(e),this.context=e,this.parent=o}getDefault(){return null}}class sp extends Al{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class bh extends Al{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class zd extends Al{set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,e),this.current=e,this.dirty=!1}}const pu="Framebuffer is not complete";class is{constructor(e,o,f,y,w){this.context=e,this.width=o,this.height=f;const S=e.gl,I=this.framebuffer=S.createFramebuffer();if(this.colorAttachment=new sp(e,I),y)this.depthAttachment=w?new zd(e,I):new bh(e,I);else if(w)throw new Error("Stencil cannot be set without depth");if(S.checkFramebufferStatus(S.FRAMEBUFFER)!==S.FRAMEBUFFER_COMPLETE)throw new Error(pu)}destroy(){const e=this.context.gl,o=this.colorAttachment.get();if(o&&e.deleteTexture(o),this.depthAttachment){const f=this.depthAttachment.get();f&&e.deleteRenderbuffer(f)}e.deleteFramebuffer(this.framebuffer)}}class xh{constructor(e){var o,f;if(this.gl=e,this.clearColor=new iy(this),this.clearDepth=new ao(this),this.clearStencil=new mh(this),this.colorMask=new tp(this),this.depthMask=new Cm(this),this.stencilMask=new np(this),this.stencilFunc=new gh(this),this.stencilOp=new hu(this),this.stencilTest=new Nd(this),this.depthRange=new ip(this),this.depthTest=new No(this),this.depthFunc=new Sl(this),this.blend=new fa(this),this.blendFunc=new Pd(this),this.blendColor=new rp(this),this.blendEquation=new Xs(this),this.cullFace=new Po(this),this.cullFaceSide=new du(this),this.frontFace=new yh(this),this.program=new ns(this),this.activeTexture=new _h(this),this.viewport=new ap(this),this.bindFramebuffer=new vc(this),this.bindRenderbuffer=new fu(this),this.bindTexture=new Mm(this),this.bindVertexBuffer=new op(this),this.bindElementBuffer=new Yn(this),this.bindVertexArray=new vh(this),this.pixelStoreUnpack=new Dm(this),this.pixelStoreUnpackPremultiplyAlpha=new zo(this),this.pixelStoreUnpackFlipY=new pa(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE),Va(e)){this.HALF_FLOAT=e.HALF_FLOAT;const y=e.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=e.RGBA16F)!==null&&o!==void 0?o:y==null?void 0:y.RGBA16F_EXT,this.RGB16F=(f=e.RGB16F)!==null&&f!==void 0?f:y==null?void 0:y.RGB16F_EXT,e.getExtension("EXT_color_buffer_float")}else{e.getExtension("EXT_color_buffer_half_float"),e.getExtension("OES_texture_half_float_linear");const y=e.getExtension("OES_texture_half_float");this.HALF_FLOAT=y==null?void 0:y.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,o){return new Jf(this,e,o)}createVertexBuffer(e,o,f){return new ep(this,e,o,f)}createRenderbuffer(e,o,f){const y=this.gl,w=y.createRenderbuffer();return this.bindRenderbuffer.set(w),y.renderbufferStorage(y.RENDERBUFFER,e,o,f),this.bindRenderbuffer.set(null),w}createFramebuffer(e,o,f,y){return new is(this,e,o,f,y)}clear({color:e,depth:o,stencil:f}){const y=this.gl;let w=0;e&&(w|=y.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(w|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),f!==void 0&&(w|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(f),this.stencilMask.set(255)),y.clear(w)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){c.bz(e.blendFunction,Ci.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor)),this.colorMask.set(e.mask)}createVertexArray(){var e;return Va(this.gl)?this.gl.createVertexArray():(e=this.gl.getExtension("OES_vertex_array_object"))===null||e===void 0?void 0:e.createVertexArrayOES()}deleteVertexArray(e){var o;return Va(this.gl)?this.gl.deleteVertexArray(e):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(e)}unbindVAO(){this.bindVertexArray.set(null)}}let Ws;function Qs(b,e,o,f,y){const w=b.context,S=b.transform,I=w.gl,P=b.useProgram("collisionBox"),j=[];let Z=0,Y=0;for(let ge=0;ge<f.length;ge++){const be=f[ge],Se=e.getTile(be).getBucket(o);if(!Se)continue;const ke=y?Se.textCollisionBox:Se.iconCollisionBox,Re=Se.collisionCircleArray;Re.length>0&&(j.push({circleArray:Re,circleOffset:Y,coord:be}),Z+=Re.length/4,Y=Z),ke&&P.draw(w,I.LINES,pn.disabled,Vn.disabled,b.colorModeForRenderPass(),Tn.disabled,Tm(b.transform),b.style.map.terrain&&b.style.map.terrain.getTerrainData(be),S.getProjectionData({overscaledTileID:be,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),o.id,ke.layoutVertexBuffer,ke.indexBuffer,ke.segments,null,b.transform.zoom,null,null,ke.collisionVertexBuffer)}if(!y||!j.length)return;const H=b.useProgram("collisionCircle"),ee=new c.bM;ee.resize(4*Z),ee._trim();let ie=0;for(const ge of j)for(let be=0;be<ge.circleArray.length/4;be++){const Se=4*be,ke=ge.circleArray[Se+0],Re=ge.circleArray[Se+1],Oe=ge.circleArray[Se+2],Pe=ge.circleArray[Se+3];ee.emplace(ie++,ke,Re,Oe,Pe,0),ee.emplace(ie++,ke,Re,Oe,Pe,1),ee.emplace(ie++,ke,Re,Oe,Pe,2),ee.emplace(ie++,ke,Re,Oe,Pe,3)}(!Ws||Ws.length<2*Z)&&(Ws=function(ge){const be=2*ge,Se=new c.bO;Se.resize(be),Se._trim();for(let ke=0;ke<be;ke++){const Re=6*ke;Se.uint16[Re+0]=4*ke+0,Se.uint16[Re+1]=4*ke+1,Se.uint16[Re+2]=4*ke+2,Se.uint16[Re+3]=4*ke+2,Se.uint16[Re+4]=4*ke+3,Se.uint16[Re+5]=4*ke+0}return Se}(Z));const me=w.createIndexBuffer(Ws,!0),pe=w.createVertexBuffer(ee,c.bN.members,!0);for(const ge of j){const be=Xf(b.transform);H.draw(w,I.TRIANGLES,pn.disabled,Vn.disabled,b.colorModeForRenderPass(),Tn.disabled,be,b.style.map.terrain&&b.style.map.terrain.getTerrainData(ge.coord),null,o.id,pe,me,c.aD.simpleSegment(0,2*ge.circleOffset,ge.circleArray.length,ge.circleArray.length/2),null,b.transform.zoom,null,null,null)}pe.destroy(),me.destroy()}const lp=c.aq(new Float32Array(16));function Aa(b,e,o,f,y,w){const{horizontalAlign:S,verticalAlign:I}=c.ay(b);return new c.P((-(S-.5)*e/y+f[0])*w,(-(I-.5)*o/y+f[1])*w)}function Ks(b,e,o,f,y,w){const S=e.tileAnchorPoint.add(new c.P(e.translation[0],e.translation[1]));if(e.pitchWithMap){let I=f.mult(w);o||(I=I.rotate(-y));const P=S.add(I);return tt(P.x,P.y,e.pitchedLabelPlaneMatrix,e.getElevation).point}if(o){const I=Yt(e.tileAnchorPoint.x+1,e.tileAnchorPoint.y,e).point.sub(b),P=Math.atan(I.y/I.x)+(I.x<0?Math.PI:0);return b.add(f.rotate(P))}return b.add(f)}function Cl(b,e,o,f,y,w,S,I,P,j,Z,Y){const H=b.text.placedSymbolArray,ee=b.text.dynamicLayoutVertexArray,ie=b.icon.dynamicLayoutVertexArray,me={};ee.clear();for(let pe=0;pe<H.length;pe++){const ge=H.get(pe),be=ge.hidden||!ge.crossTileID||b.allowVerticalPlacement&&!ge.placedOrientation?null:f[ge.crossTileID];if(be){const Se=new c.P(ge.anchorX,ge.anchorY),ke={getElevation:Y,width:y.width,height:y.height,pitchedLabelPlaneMatrix:w,pitchWithMap:o,transform:y,tileAnchorPoint:Se,translation:j,unwrappedTileID:Z},Re=o?Zn(Se.x,Se.y,ke):Yt(Se.x,Se.y,ke),Oe=$e(y.cameraToCenterDistance,Re.signedDistanceFromCamera);let Pe=c.aj(b.textSizeData,I,ge)*Oe/c.as;o&&(Pe*=b.tilePixelRatio/S);const{width:He,height:Ke,anchor:st,textOffset:ht,textBoxScale:nt}=be,kt=Aa(st,He,Ke,ht,nt,Pe),Mt=y.getPitchedTextCorrection(Se.x+j[0],Se.y+j[1],Z),gt=Ks(Re.point,ke,e,kt,-y.bearingInRadians,Mt),zt=b.allowVerticalPlacement&&ge.placedOrientation===c.ai.vertical?Math.PI/2:0;for(let gn=0;gn<ge.numGlyphs;gn++)c.ak(ee,gt,zt);P&&ge.associatedIconIndex>=0&&(me[ge.associatedIconIndex]={shiftedAnchor:gt,angle:zt})}else Ar(ge.numGlyphs,ee)}if(P){ie.clear();const pe=b.icon.placedSymbolArray;for(let ge=0;ge<pe.length;ge++){const be=pe.get(ge);if(be.hidden)Ar(be.numGlyphs,ie);else{const Se=me[ge];if(Se)for(let ke=0;ke<be.numGlyphs;ke++)c.ak(ie,Se.shiftedAnchor,Se.angle);else Ar(be.numGlyphs,ie)}}b.icon.dynamicLayoutVertexBuffer.updateData(ie)}b.text.dynamicLayoutVertexBuffer.updateData(ee)}function Od(b,e,o){return o.iconsInText&&e?"symbolTextAndIcon":b?"symbolSDF":"symbolIcon"}function bc(b,e,o,f,y,w,S,I,P,j,Z,Y,H){const ee=b.context,ie=ee.gl,me=b.transform,pe=I==="map",ge=P==="map",be=I!=="viewport"&&o.layout.get("symbol-placement")!=="point",Se=pe&&!ge&&!be,ke=!o.layout.get("symbol-sort-key").isConstant();let Re=!1;const Oe=b.getDepthModeForSublayer(0,pn.ReadOnly),Pe=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),He=[],Ke=me.getCircleRadiusCorrection();for(const st of f){const ht=e.getTile(st),nt=ht.getBucket(o);if(!nt)continue;const kt=y?nt.text:nt.icon;if(!kt||!kt.segments.get().length||!kt.hasVisibleVertices)continue;const Mt=kt.programConfigurations.get(o.id),gt=y||nt.sdfIcons,zt=y?nt.textSizeData:nt.iconSizeData,gn=ge||me.pitch!==0,qn=b.useProgram(Od(gt,y,nt),Mt),Ui=c.ah(zt,me.zoom),yi=b.style.map.terrain&&b.style.map.terrain.getTerrainData(st);let Ti,hi,ii,_i,na=[0,0],Ei=null;if(y)hi=ht.glyphAtlasTexture,ii=ie.LINEAR,Ti=ht.glyphAtlasTexture.size,nt.iconsInText&&(na=ht.imageAtlasTexture.size,Ei=ht.imageAtlasTexture,_i=gn||b.options.rotating||b.options.zooming||zt.kind==="composite"||zt.kind==="camera"?ie.LINEAR:ie.NEAREST);else{const vi=o.layout.get("icon-size").constantOr(0)!==1||nt.iconsNeedLinear;hi=ht.imageAtlasTexture,ii=gt||b.options.rotating||b.options.zooming||vi||gn?ie.LINEAR:ie.NEAREST,Ti=ht.imageAtlasTexture.size}const Pi=c.at(ht,1,b.transform.zoom),mr=We(pe,b.transform,Pi),Da=c.H();c.an(Da,mr);const Vo=Fe(ge,pe,b.transform,Pi),Ia=c.au(me,ht,w,S),Rs=me.getProjectionData({overscaledTileID:st,applyGlobeMatrix:!H,applyTerrainMatrix:!0}),Eu=Pe&&nt.hasTextData(),cs=o.layout.get("icon-text-fit")!=="none"&&Eu&&nt.hasIconData();if(be){const vi=b.style.map.terrain?(Ga,Vi)=>b.style.map.terrain.getElevation(st,Ga,Vi):null,Ii=o.layout.get("text-rotation-alignment")==="map";Rt(nt,b,y,mr,Da,ge,j,Ii,st.toUnwrapped(),me.width,me.height,Ia,vi)}const sl=y&&Pe||cs,ka=be||sl?lp:ge?mr:b.transform.clipSpaceToPixelsMatrix,uo=gt&&o.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let ho;ho=gt?nt.iconsInText?ts(zt.kind,Ui,Se,ge,be,sl,b,ka,Vo,Ia,Ti,na,Ke):uu(zt.kind,Ui,Se,ge,be,sl,b,ka,Vo,Ia,y,Ti,0,Ke):kd(zt.kind,Ui,Se,ge,be,sl,b,ka,Vo,Ia,y,Ti,Ke);const va={program:qn,buffers:kt,uniformValues:ho,projectionData:Rs,atlasTexture:hi,atlasTextureIcon:Ei,atlasInterpolation:ii,atlasInterpolationIcon:_i,isSDF:gt,hasHalo:uo};if(ke&&nt.canOverlap){Re=!0;const vi=kt.segments.get();for(const Ii of vi)He.push({segments:new c.aD([Ii]),sortKey:Ii.sortKey,state:va,terrainData:yi})}else He.push({segments:kt.segments,sortKey:0,state:va,terrainData:yi})}Re&&He.sort((st,ht)=>st.sortKey-ht.sortKey);for(const st of He){const ht=st.state;if(ee.activeTexture.set(ie.TEXTURE0),ht.atlasTexture.bind(ht.atlasInterpolation,ie.CLAMP_TO_EDGE),ht.atlasTextureIcon&&(ee.activeTexture.set(ie.TEXTURE1),ht.atlasTextureIcon&&ht.atlasTextureIcon.bind(ht.atlasInterpolationIcon,ie.CLAMP_TO_EDGE)),ht.isSDF){const nt=ht.uniformValues;ht.hasHalo&&(nt.u_is_halo=1,oo(ht.buffers,st.segments,o,b,ht.program,Oe,Z,Y,nt,ht.projectionData,st.terrainData)),nt.u_is_halo=0}oo(ht.buffers,st.segments,o,b,ht.program,Oe,Z,Y,ht.uniformValues,ht.projectionData,st.terrainData)}}function oo(b,e,o,f,y,w,S,I,P,j,Z){const Y=f.context;y.draw(Y,Y.gl.TRIANGLES,w,S,I,Tn.backCCW,P,Z,j,o.id,b.layoutVertexBuffer,b.indexBuffer,e,o.paint,f.transform.zoom,b.programConfigurations.get(o.id),b.dynamicLayoutVertexBuffer,b.opacityVertexBuffer)}function so(b,e,o,f,y){const w=b.context,S=w.gl,I=Vn.disabled,P=new Ci([S.ONE,S.ONE],c.b4.transparent,[!0,!0,!0,!0]),j=e.getBucket(o);if(!j)return;const Z=f.key;let Y=o.heatmapFbos.get(Z);Y||(Y=Oo(w,e.tileSize,e.tileSize),o.heatmapFbos.set(Z,Y)),w.bindFramebuffer.set(Y.framebuffer),w.viewport.set([0,0,e.tileSize,e.tileSize]),w.clear({color:c.b4.transparent});const H=j.programConfigurations.get(o.id),ee=b.useProgram("heatmap",H,!y),ie=b.transform.getProjectionData({overscaledTileID:e.tileID,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),me=b.style.map.terrain.getTerrainData(f);ee.draw(w,S.TRIANGLES,pn.disabled,I,P,Tn.disabled,Dd(e,b.transform.zoom,o.paint.get("heatmap-intensity"),1),me,ie,o.id,j.layoutVertexBuffer,j.indexBuffer,j.segments,o.paint,b.transform.zoom,H)}function Is(b,e,o,f,y){const w=b.context,S=w.gl,I=b.transform;w.setColorMode(b.colorModeForRenderPass());const P=rs(w,e),j=o.key,Z=e.heatmapFbos.get(j);if(!Z)return;w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,Z.colorAttachment.get()),w.activeTexture.set(S.TEXTURE1),P.bind(S.LINEAR,S.CLAMP_TO_EDGE);const Y=I.getProjectionData({overscaledTileID:o,applyTerrainMatrix:y,applyGlobeMatrix:!f});b.useProgram("heatmapTexture").draw(w,S.TRIANGLES,pn.disabled,Vn.disabled,b.colorModeForRenderPass(),Tn.disabled,Hs(b,e,0,1),null,Y,e.id,b.rasterBoundsBuffer,b.quadTriangleIndexBuffer,b.rasterBoundsSegments,e.paint,I.zoom),Z.destroy(),e.heatmapFbos.delete(j)}function Oo(b,e,o){var f,y;const w=b.gl,S=w.createTexture();w.bindTexture(w.TEXTURE_2D,S),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_S,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_WRAP_T,w.CLAMP_TO_EDGE),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MIN_FILTER,w.LINEAR),w.texParameteri(w.TEXTURE_2D,w.TEXTURE_MAG_FILTER,w.LINEAR);const I=(f=b.HALF_FLOAT)!==null&&f!==void 0?f:w.UNSIGNED_BYTE,P=(y=b.RGBA16F)!==null&&y!==void 0?y:w.RGBA;w.texImage2D(w.TEXTURE_2D,0,P,e,o,0,w.RGBA,I,null);const j=b.createFramebuffer(e,o,!1,!1);return j.colorAttachment.set(S),j}function rs(b,e){return e.colorRampTexture||(e.colorRampTexture=new je(b,e.colorRamp,b.gl.RGBA)),e.colorRampTexture}function Js(b,e,o,f,y){if(!o||!f||!f.imageAtlas)return;const w=f.imageAtlas.patternPositions;let S=w[o.to.toString()],I=w[o.from.toString()];if(!S&&I&&(S=I),!I&&S&&(I=S),!S||!I){const P=y.getPaintProperty(e);S=w[P],I=w[P]}S&&I&&b.setConstantPatternPositions(S,I)}function mu(b,e,o,f,y,w,S,I){const P=b.context.gl,j="fill-pattern",Z=o.paint.get(j),Y=Z&&Z.constantOr(1),H=o.getCrossfadeParameters();let ee,ie,me,pe,ge;const be=b.transform,Se=o.paint.get("fill-translate"),ke=o.paint.get("fill-translate-anchor");S?(ie=Y&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ee=P.LINES):(ie=Y?"fillPattern":"fill",ee=P.TRIANGLES);const Re=Z.constantOr(null);for(const Oe of f){const Pe=e.getTile(Oe);if(Y&&!Pe.patternsLoaded())continue;const He=Pe.getBucket(o);if(!He)continue;const Ke=He.programConfigurations.get(o.id),st=b.useProgram(ie,Ke),ht=b.style.map.terrain&&b.style.map.terrain.getTerrainData(Oe);Y&&(b.context.activeTexture.set(P.TEXTURE0),Pe.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),Ke.updatePaintBuffers(H)),Js(Ke,j,Re,Pe,o);const nt=be.getProjectionData({overscaledTileID:Oe,applyGlobeMatrix:!I,applyTerrainMatrix:!0}),kt=c.au(be,Pe,Se,ke);if(S){pe=He.indexBuffer2,ge=He.segments2;const gt=[P.drawingBufferWidth,P.drawingBufferHeight];me=ie==="fillOutlinePattern"&&Y?Cd(b,H,Pe,gt,kt):ny(gt,kt)}else pe=He.indexBuffer,ge=He.segments,me=Y?Hf(b,H,Pe,kt):{u_fill_translate:kt};let Mt;if(b.renderPass==="translucent"&&I){const[gt]=b.getStencilConfigForOverlapAndUpdateStencilID(f);Mt=gt[Oe.overscaledZ]}else Mt=b.stencilModeForClipping(Oe);st.draw(b.context,ee,y,Mt,w,Tn.backCCW,me,ht,nt,o.id,He.layoutVertexBuffer,pe,ge,o.paint,b.transform.zoom,Ke)}}function xc(b,e,o,f,y,w,S,I){const P=b.context,j=P.gl,Z="fill-extrusion-pattern",Y=o.paint.get(Z),H=Y.constantOr(1),ee=o.getCrossfadeParameters(),ie=o.paint.get("fill-extrusion-opacity"),me=Y.constantOr(null),pe=b.transform;for(const ge of f){const be=e.getTile(ge),Se=be.getBucket(o);if(!Se)continue;const ke=b.style.map.terrain&&b.style.map.terrain.getTerrainData(ge),Re=Se.programConfigurations.get(o.id),Oe=b.useProgram(H?"fillExtrusionPattern":"fillExtrusion",Re);H&&(b.context.activeTexture.set(j.TEXTURE0),be.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),Re.updatePaintBuffers(ee));const Pe=pe.getProjectionData({overscaledTileID:ge,applyGlobeMatrix:!I,applyTerrainMatrix:!0});Js(Re,Z,me,be,o);const He=c.au(pe,be,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),Ke=o.paint.get("fill-extrusion-vertical-gradient"),st=H?ty(b,Ke,ie,He,ge,ee,be):fc(b,Ke,ie,He);Oe.draw(P,P.gl.TRIANGLES,y,w,S,Tn.backCCW,st,ke,Pe,o.id,Se.layoutVertexBuffer,Se.indexBuffer,Se.segments,o.paint,b.transform.zoom,Re,b.style.map.terrain&&Se.centroidVertexBuffer)}}function wh(b,e,o,f,y,w,S,I,P){var j;const Z=b.style.projection,Y=b.context,H=b.transform,ee=Y.gl,ie=b.useProgram("hillshade"),me=!b.options.moving;for(const pe of f){const ge=e.getTile(pe),be=ge.fbo;if(!be)continue;const Se=Z.getMeshFromTileID(Y,pe.canonical,I,!0,"raster"),ke=(j=b.style.map.terrain)===null||j===void 0?void 0:j.getTerrainData(pe);Y.activeTexture.set(ee.TEXTURE0),ee.bindTexture(ee.TEXTURE_2D,be.colorAttachment.get());const Re=H.getProjectionData({overscaledTileID:pe,aligned:me,applyGlobeMatrix:!P,applyTerrainMatrix:!0});ie.draw(Y,ee.TRIANGLES,w,y[pe.overscaledZ],S,Tn.backCCW,Wf(b,ge,o),ke,Re,o.id,Se.vertexBuffer,Se.indexBuffer,Se.segments)}}const ea=[new c.P(0,0),new c.P(c.X,0),new c.P(c.X,c.X),new c.P(0,c.X)];function Rn(b,e,o,f,y,w,S,I,P=!1,j=!1){const Z=f[f.length-1].overscaledZ,Y=b.context,H=Y.gl,ee=b.useProgram("raster"),ie=b.transform,me=b.style.projection,pe=b.colorModeForRenderPass(),ge=!b.options.moving;for(const be of f){const Se=b.getDepthModeForSublayer(be.overscaledZ-Z,o.paint.get("raster-opacity")===1?pn.ReadWrite:pn.ReadOnly,H.LESS),ke=e.getTile(be);ke.registerFadeDuration(o.paint.get("raster-fade-duration"));const Re=e.findLoadedParent(be,0),Oe=e.findLoadedSibling(be),Pe=Bn(ke,Re||Oe||null,e,o,b.transform,b.style.map.terrain);let He,Ke;const st=o.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;Y.activeTexture.set(H.TEXTURE0),ke.texture.bind(st,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),Y.activeTexture.set(H.TEXTURE1),Re?(Re.texture.bind(st,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),He=Math.pow(2,Re.tileID.overscaledZ-ke.tileID.overscaledZ),Ke=[ke.tileID.canonical.x*He%1,ke.tileID.canonical.y*He%1]):ke.texture.bind(st,H.CLAMP_TO_EDGE,H.LINEAR_MIPMAP_NEAREST),ke.texture.useMipmap&&Y.extTextureFilterAnisotropic&&b.transform.pitch>20&&H.texParameterf(H.TEXTURE_2D,Y.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Y.extTextureFilterAnisotropicMax);const ht=b.style.map.terrain&&b.style.map.terrain.getTerrainData(be),nt=ie.getProjectionData({overscaledTileID:be,aligned:ge,applyGlobeMatrix:!j,applyTerrainMatrix:!0}),kt=Am(Ke||[0,0],He||1,Pe,o,I),Mt=me.getMeshFromTileID(Y,be.canonical,w,S,"raster");ee.draw(Y,H.TRIANGLES,Se,y?y[be.overscaledZ]:Vn.disabled,pe,P?Tn.frontCCW:Tn.backCCW,kt,ht,nt,o.id,Mt.vertexBuffer,Mt.indexBuffer,Mt.segments)}}function Bn(b,e,o,f,y,w){const S=f.paint.get("raster-fade-duration");if(!w&&S>0){const I=F.now(),P=(I-b.timeAdded)/S,j=e?(I-e.timeAdded)/S:-1,Z=o.getSource(),Y=Rr(y,{tileSize:Z.tileSize,roundZoom:Z.roundZoom}),H=!e||Math.abs(e.tileID.overscaledZ-Y)>Math.abs(b.tileID.overscaledZ-Y),ee=H&&b.refreshedUponExpiration?1:c.ab(H?P:1-j,0,1);return b.refreshedUponExpiration&&P>=1&&(b.refreshedUponExpiration=!1),e?{opacity:1,mix:1-ee}:{opacity:ee,mix:0}}return{opacity:1,mix:0}}const fr=new c.b4(1,0,0,1),Lo=new c.b4(0,1,0,1),Th=new c.b4(0,0,1,1),Ml=new c.b4(1,0,1,1),wc=new c.b4(0,1,1,1);function Tc(b,e,o,f){el(b,0,e+o/2,b.transform.width,o,f)}function Dl(b,e,o,f){el(b,e-o/2,0,o,b.transform.height,f)}function el(b,e,o,f,y,w){const S=b.context,I=S.gl;I.enable(I.SCISSOR_TEST),I.scissor(e*b.pixelRatio,o*b.pixelRatio,f*b.pixelRatio,y*b.pixelRatio),S.clear({color:w}),I.disable(I.SCISSOR_TEST)}function gu(b,e,o){const f=b.context,y=f.gl,w=b.useProgram("debug"),S=pn.disabled,I=Vn.disabled,P=b.colorModeForRenderPass(),j="$debug",Z=b.style.map.terrain&&b.style.map.terrain.getTerrainData(o);f.activeTexture.set(y.TEXTURE0);const Y=e.getTileByID(o.key).latestRawTileData,H=Math.floor((Y&&Y.byteLength||0)/1024),ee=e.getTile(o).tileSize,ie=512/Math.min(ee,512)*(o.overscaledZ/b.transform.zoom)*.5;let me=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(me+=` => ${o.overscaledZ}`),function(ge,be){ge.initDebugOverlayCanvas();const Se=ge.debugOverlayCanvas,ke=ge.context.gl,Re=ge.debugOverlayCanvas.getContext("2d");Re.clearRect(0,0,Se.width,Se.height),Re.shadowColor="white",Re.shadowBlur=2,Re.lineWidth=1.5,Re.strokeStyle="white",Re.textBaseline="top",Re.font="bold 36px Open Sans, sans-serif",Re.fillText(be,5,5),Re.strokeText(be,5,5),ge.debugOverlayTexture.update(Se),ge.debugOverlayTexture.bind(ke.LINEAR,ke.CLAMP_TO_EDGE)}(b,`${me} ${H}kB`);const pe=b.transform.getProjectionData({overscaledTileID:o,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(f,y.TRIANGLES,S,I,Ci.alphaBlended,Tn.disabled,Md(c.b4.transparent,ie),null,pe,j,b.debugBuffer,b.quadTriangleIndexBuffer,b.debugSegments),w.draw(f,y.LINE_STRIP,S,I,P,Tn.disabled,Md(c.b4.red),Z,pe,j,b.debugBuffer,b.tileBorderIndexBuffer,b.debugSegments)}function Ec(b,e,o,f){const{isRenderingGlobe:y}=f,w=b.context,S=w.gl,I=b.transform,P=b.colorModeForRenderPass(),j=b.getDepthModeFor3D(),Z=b.useProgram("terrain");w.bindFramebuffer.set(null),w.viewport.set([0,0,b.width,b.height]);for(const Y of o){const H=e.getTerrainMesh(Y.tileID),ee=b.renderToTexture.getTexture(Y),ie=e.getTerrainData(Y.tileID);w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,ee.texture);const me=e.getMeshFrameDelta(I.zoom),pe=I.calculateFogMatrix(Y.tileID.toUnwrapped()),ge=uh(me,pe,b.style.sky,I.pitch,y),be=I.getProjectionData({overscaledTileID:Y.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});Z.draw(w,S.TRIANGLES,j,Vn.disabled,P,Tn.backCCW,ge,ie,be,"terrain",H.vertexBuffer,H.indexBuffer,H.segments)}}function Ld(b,e){if(!e.mesh){const o=new c.aC;o.emplaceBack(-1,-1),o.emplaceBack(1,-1),o.emplaceBack(1,1),o.emplaceBack(-1,1);const f=new c.aE;f.emplaceBack(0,1,2),f.emplaceBack(0,2,3),e.mesh=new ko(b.createVertexBuffer(o,Dn.members),b.createIndexBuffer(f),c.aD.simpleSegment(0,0,o.length,f.length))}return e.mesh}class Bd{constructor(e,o){this.context=new xh(e),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:c.aq(new Float64Array(16)),renderTime:0},this.setup(),this.numSublayers=te.maxUnderzooming+te.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new bl}resize(e,o,f){if(this.width=Math.floor(e*f),this.height=Math.floor(o*f),this.pixelRatio=f,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style._order)this.style._layers[y].resize()}setup(){const e=this.context,o=new c.aC;o.emplaceBack(0,0),o.emplaceBack(c.X,0),o.emplaceBack(0,c.X),o.emplaceBack(c.X,c.X),this.tileExtentBuffer=e.createVertexBuffer(o,Dn.members),this.tileExtentSegments=c.aD.simpleSegment(0,0,4,2);const f=new c.aC;f.emplaceBack(0,0),f.emplaceBack(c.X,0),f.emplaceBack(0,c.X),f.emplaceBack(c.X,c.X),this.debugBuffer=e.createVertexBuffer(f,Dn.members),this.debugSegments=c.aD.simpleSegment(0,0,4,5);const y=new c.bT;y.emplaceBack(0,0,0,0),y.emplaceBack(c.X,0,c.X,0),y.emplaceBack(0,c.X,0,c.X),y.emplaceBack(c.X,c.X,c.X,c.X),this.rasterBoundsBuffer=e.createVertexBuffer(y,ey.members),this.rasterBoundsSegments=c.aD.simpleSegment(0,0,4,2);const w=new c.aC;w.emplaceBack(0,0),w.emplaceBack(c.X,0),w.emplaceBack(0,c.X),w.emplaceBack(c.X,c.X),this.rasterBoundsBufferPosOnly=e.createVertexBuffer(w,Dn.members),this.rasterBoundsSegmentsPosOnly=c.aD.simpleSegment(0,0,4,5);const S=new c.aC;S.emplaceBack(0,0),S.emplaceBack(1,0),S.emplaceBack(0,1),S.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(S,Dn.members),this.viewportSegments=c.aD.simpleSegment(0,0,4,2);const I=new c.bU;I.emplaceBack(0),I.emplaceBack(1),I.emplaceBack(3),I.emplaceBack(2),I.emplaceBack(0),this.tileBorderIndexBuffer=e.createIndexBuffer(I);const P=new c.aE;P.emplaceBack(1,0,2),P.emplaceBack(1,2,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(P);const j=this.context.gl;this.stencilClearMode=new Vn({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO),this.tileExtentMesh=new ko(this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}clearStencil(){const e=this.context,o=e.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const f=c.H();c.bL(f,0,this.width,this.height,0,0,1),c.K(f,f,[o.drawingBufferWidth,o.drawingBufferHeight,0]);const y={mainMatrix:f,tileMercatorCoords:[0,0,1,1],clippingPlane:[0,0,0,0],projectionTransition:0,fallbackMatrix:f};this.useProgram("clippingMask",null,!0).draw(e,o.TRIANGLES,pn.disabled,this.stencilClearMode,Ci.disabled,Tn.disabled,null,null,y,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(e,o,f){if(this.currentStencilSource===e.source||!e.isTileClipped()||!o||!o.length)return;this.currentStencilSource=e.source,this.nextStencilID+o.length>256&&this.clearStencil();const y=this.context;y.setColorMode(Ci.disabled),y.setDepthMode(pn.disabled);const w={};for(const S of o)w[S.key]=this.nextStencilID++;this._renderTileMasks(w,o,f,!0),this._renderTileMasks(w,o,f,!1),this._tileClippingMaskIDs=w}_renderTileMasks(e,o,f,y){const w=this.context,S=w.gl,I=this.style.projection,P=this.transform,j=this.useProgram("clippingMask");for(const Z of o){const Y=e[Z.key],H=this.style.map.terrain&&this.style.map.terrain.getTerrainData(Z),ee=I.getMeshFromTileID(this.context,Z.canonical,y,!0,"stencil"),ie=P.getProjectionData({overscaledTileID:Z,applyGlobeMatrix:!0,applyTerrainMatrix:!0});j.draw(w,S.TRIANGLES,pn.disabled,new Vn({func:S.ALWAYS,mask:0},Y,255,S.KEEP,S.KEEP,S.REPLACE),Ci.disabled,f?Tn.disabled:Tn.backCCW,null,H,ie,"$clipping",ee.vertexBuffer,ee.indexBuffer,ee.segments)}}_renderTilesDepthBuffer(){const e=this.context,o=e.gl,f=this.style.projection,y=this.transform,w=this.useProgram("depth"),S=this.getDepthModeFor3D(),I=de(y,{tileSize:y.tileSize});for(const P of I){const j=this.style.map.terrain&&this.style.map.terrain.getTerrainData(P),Z=f.getMeshFromTileID(this.context,P.canonical,!0,!0,"raster"),Y=y.getProjectionData({overscaledTileID:P,applyGlobeMatrix:!0,applyTerrainMatrix:!0});w.draw(e,o.TRIANGLES,S,Vn.disabled,Ci.disabled,Tn.backCCW,null,j,Y,"$clipping",Z.vertexBuffer,Z.indexBuffer,Z.segments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,o=this.context.gl;return new Vn({func:o.NOTEQUAL,mask:255},e,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(e){const o=this.context.gl;return new Vn({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,o.KEEP,o.KEEP,o.REPLACE)}getStencilConfigForOverlapAndUpdateStencilID(e){const o=this.context.gl,f=e.sort((S,I)=>I.overscaledZ-S.overscaledZ),y=f[f.length-1].overscaledZ,w=f[0].overscaledZ-y+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const S={};for(let I=0;I<w;I++)S[I+y]=new Vn({func:o.GEQUAL,mask:255},I+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=w,[S,f]}return[{[y]:Vn.disabled},f]}stencilConfigForOverlapTwoPass(e){const o=this.context.gl,f=e.sort((S,I)=>I.overscaledZ-S.overscaledZ),y=f[f.length-1].overscaledZ,w=f[0].overscaledZ-y+1;if(this.clearStencil(),w>1){const S={},I={};for(let P=0;P<w;P++)S[P+y]=new Vn({func:o.GREATER,mask:255},w+1+P,255,o.KEEP,o.KEEP,o.REPLACE),I[P+y]=new Vn({func:o.GREATER,mask:255},1+P,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID=2*w+1,[S,I,f]}return this.nextStencilID=3,[{[y]:new Vn({func:o.GREATER,mask:255},2,255,o.KEEP,o.KEEP,o.REPLACE)},{[y]:new Vn({func:o.GREATER,mask:255},1,255,o.KEEP,o.KEEP,o.REPLACE)},f]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Ci([e.CONSTANT_COLOR,e.ONE],new c.b4(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Ci.unblended:Ci.alphaBlended}getDepthModeForSublayer(e,o,f){if(!this.opaquePassEnabledForLayer())return pn.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new pn(f||this.context.gl.LEQUAL,o,[y,y])}getDepthModeFor3D(){return new pn(this.context.gl.LEQUAL,pn.ReadWrite,this.depthRangeFor3D)}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,o){var f,y;this.style=e,this.options=o,this.lineAtlas=e.lineAtlas,this.imageManager=e.imageManager,this.glyphManager=e.glyphManager,this.symbolFadeChange=e.placement.symbolFadeChange(F.now()),this.imageManager.beginFrame();const w=this.style._order,S=this.style.sourceCaches,I={},P={},j={},Z={isRenderingToTexture:!1,isRenderingGlobe:((f=e.projection)===null||f===void 0?void 0:f.transitionState)>0};for(const H in S){const ee=S[H];ee.used&&ee.prepare(this.context),I[H]=ee.getVisibleCoordinates(!1),P[H]=I[H].slice().reverse(),j[H]=ee.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let H=0;H<w.length;H++)if(this.style._layers[w[H]].is3D()){this.opaquePassCutoff=H;break}this.maybeDrawDepthAndCoords(!1),this.renderToTexture&&(this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0),this.renderPass="offscreen";for(const H of w){const ee=this.style._layers[H];if(!ee.hasOffscreenPass()||ee.isHidden(this.transform.zoom))continue;const ie=P[ee.source];(ee.type==="custom"||ie.length)&&this.renderLayer(this,S[ee.source],ee,ie,Z)}if((y=this.style.projection)===null||y===void 0||y.updateGPUdependent({context:this.context,useProgram:H=>this.useProgram(H)}),this.context.viewport.set([0,0,this.width,this.height]),this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?c.b4.black:c.b4.transparent,depth:1}),this.clearStencil(),this.style.sky&&function(H,ee){const ie=H.context,me=ie.gl,pe=((Oe,Pe,He)=>{const Ke=Math.cos(Pe.rollInRadians),st=Math.sin(Pe.rollInRadians),ht=Hi(Pe),nt=Pe.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}).projectionTransition;return{u_sky_color:Oe.properties.get("sky-color"),u_horizon_color:Oe.properties.get("horizon-color"),u_horizon:[(Pe.width/2-ht*st)*He,(Pe.height/2+ht*Ke)*He],u_horizon_normal:[-st,Ke],u_sky_horizon_blend:Oe.properties.get("sky-horizon-blend")*Pe.height/2*He,u_sky_blend:nt}})(ee,H.style.map.transform,H.pixelRatio),ge=new pn(me.LEQUAL,pn.ReadWrite,[0,1]),be=Vn.disabled,Se=H.colorModeForRenderPass(),ke=H.useProgram("sky"),Re=Ld(ie,ee);ke.draw(ie,me.TRIANGLES,ge,be,Se,Tn.disabled,pe,null,void 0,"sky",Re.vertexBuffer,Re.indexBuffer,Re.segments)}(this,this.style.sky),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(e._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=w.length-1;this.currentLayer>=0;this.currentLayer--){const H=this.style._layers[w[this.currentLayer]],ee=S[H.source],ie=I[H.source];this._renderTileClippingMasks(H,ie,!1),this.renderLayer(this,ee,H,ie,Z)}this.renderPass="translucent";let Y=!1;for(this.currentLayer=0;this.currentLayer<w.length;this.currentLayer++){const H=this.style._layers[w[this.currentLayer]],ee=S[H.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(H,Z))continue;this.opaquePassEnabledForLayer()||Y||(Y=!0,Z.isRenderingGlobe&&!this.style.map.terrain&&this._renderTilesDepthBuffer());const ie=(H.type==="symbol"?j:P)[H.source];this._renderTileClippingMasks(H,I[H.source],!1),this.renderLayer(this,ee,H,ie,Z)}if(Z.isRenderingGlobe&&function(H,ee,ie){const me=H.context,pe=me.gl,ge=H.useProgram("atmosphere"),be=new pn(pe.LEQUAL,pn.ReadOnly,[0,1]),Se=H.transform,ke=function(nt,kt){const Mt=nt.properties.get("position"),gt=[-Mt.x,-Mt.y,-Mt.z],zt=c.aq(new Float64Array(16));return nt.properties.get("anchor")==="map"&&(c.aX(zt,zt,kt.rollInRadians),c.aY(zt,zt,-kt.pitchInRadians),c.aX(zt,zt,kt.bearingInRadians),c.aY(zt,zt,kt.center.lat*Math.PI/180),c.bj(zt,zt,-kt.center.lng*Math.PI/180)),c.bS(gt,gt,zt),gt}(ie,H.transform),Re=Se.getProjectionData({overscaledTileID:null,applyGlobeMatrix:!0,applyTerrainMatrix:!0}),Oe=ee.properties.get("atmosphere-blend")*Re.projectionTransition;if(Oe===0)return;const Pe=uc(Se.worldSize,Se.center.lat),He=Se.inverseProjectionMatrix,Ke=new Float64Array(4);Ke[3]=1,c.al(Ke,Ke,Se.modelViewProjectionMatrix),Ke[0]/=Ke[3],Ke[1]/=Ke[3],Ke[2]/=Ke[3],Ke[3]=1,c.al(Ke,Ke,He),Ke[0]/=Ke[3],Ke[1]/=Ke[3],Ke[2]/=Ke[3],Ke[3]=1;const st=((nt,kt,Mt,gt,zt)=>({u_sun_pos:nt,u_atmosphere_blend:kt,u_globe_position:Mt,u_globe_radius:gt,u_inv_proj_matrix:zt}))(ke,Oe,[Ke[0],Ke[1],Ke[2]],Pe,He),ht=Ld(me,ee);ge.draw(me,pe.TRIANGLES,be,Vn.disabled,Ci.alphaBlended,Tn.disabled,st,null,null,"atmosphere",ht.vertexBuffer,ht.indexBuffer,ht.segments)}(this,this.style.sky,this.style.light),this.options.showTileBoundaries){const H=function(ee,ie){let me=null;const pe=Object.values(ee._layers).flatMap(ke=>ke.source&&!ke.isHidden(ie)?[ee.sourceCaches[ke.source]]:[]),ge=pe.filter(ke=>ke.getSource().type==="vector"),be=pe.filter(ke=>ke.getSource().type!=="vector"),Se=ke=>{(!me||me.getSource().maxzoom<ke.getSource().maxzoom)&&(me=ke)};return ge.forEach(ke=>Se(ke)),me||be.forEach(ke=>Se(ke)),me}(this.style,this.transform.zoom);H&&function(ee,ie,me){for(let pe=0;pe<me.length;pe++)gu(ee,ie,me[pe])}(this,H,H.getVisibleCoordinates())}this.options.showPadding&&function(H){const ee=H.transform.padding;Tc(H,H.transform.height-(ee.top||0),3,fr),Tc(H,ee.bottom||0,3,Lo),Dl(H,ee.left||0,3,Th),Dl(H,H.transform.width-(ee.right||0),3,Ml);const ie=H.transform.centerPoint;(function(me,pe,ge,be){el(me,pe-1,ge-10,2,20,be),el(me,pe-10,ge-1,20,2,be)})(H,ie.x,H.transform.height-ie.y,wc)}(this),this.context.setDefault()}maybeDrawDepthAndCoords(e){if(!this.style||!this.style.map||!this.style.map.terrain)return;const o=this.terrainFacilitator.matrix,f=this.transform.modelViewProjectionMatrix;let y=this.terrainFacilitator.dirty;y||(y=e?!c.bV(o,f):!c.bW(o,f)),y||(y=this.style.map.terrain.sourceCache.anyTilesAfterTime(this.terrainFacilitator.renderTime)),y&&(c.bX(o,f),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(w,S){const I=w.context,P=I.gl,j=w.transform,Z=Ci.unblended,Y=new pn(P.LEQUAL,pn.ReadWrite,[0,1]),H=S.sourceCache.getRenderableTiles(),ee=w.useProgram("terrainDepth");I.bindFramebuffer.set(S.getFramebuffer("depth").framebuffer),I.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),I.clear({color:c.b4.transparent,depth:1});for(const ie of H){const me=S.getTerrainMesh(ie.tileID),pe=S.getTerrainData(ie.tileID),ge=j.getProjectionData({overscaledTileID:ie.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0}),be={u_ele_delta:S.getMeshFrameDelta(j.zoom)};ee.draw(I,P.TRIANGLES,Y,Vn.disabled,Z,Tn.backCCW,be,pe,ge,"terrain",me.vertexBuffer,me.indexBuffer,me.segments)}I.bindFramebuffer.set(null),I.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain),function(w,S){const I=w.context,P=I.gl,j=w.transform,Z=Ci.unblended,Y=new pn(P.LEQUAL,pn.ReadWrite,[0,1]),H=S.getCoordsTexture(),ee=S.sourceCache.getRenderableTiles(),ie=w.useProgram("terrainCoords");I.bindFramebuffer.set(S.getFramebuffer("coords").framebuffer),I.viewport.set([0,0,w.width/devicePixelRatio,w.height/devicePixelRatio]),I.clear({color:c.b4.transparent,depth:1}),S.coordsIndex=[];for(const me of ee){const pe=S.getTerrainMesh(me.tileID),ge=S.getTerrainData(me.tileID);I.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,H.texture);const be={u_terrain_coords_id:(255-S.coordsIndex.length)/255,u_texture:0,u_ele_delta:S.getMeshFrameDelta(j.zoom)},Se=j.getProjectionData({overscaledTileID:me.tileID,applyTerrainMatrix:!1,applyGlobeMatrix:!0});ie.draw(I,P.TRIANGLES,Y,Vn.disabled,Z,Tn.backCCW,be,ge,Se,"terrain",pe.vertexBuffer,pe.indexBuffer,pe.segments),S.coordsIndex.push(me.tileID.key)}I.bindFramebuffer.set(null),I.viewport.set([0,0,w.width,w.height])}(this,this.style.map.terrain))}renderLayer(e,o,f,y,w){f.isHidden(this.transform.zoom)||(f.type==="background"||f.type==="custom"||(y||[]).length)&&(this.id=f.id,c.bY(f)?function(S,I,P,j,Z,Y){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:H}=Y,ee=Vn.disabled,ie=S.colorModeForRenderPass();(P._unevaluatedLayout.hasValue("text-variable-anchor")||P._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(me,pe,ge,be,Se,ke,Re,Oe,Pe){const He=pe.transform,Ke=pe.style.map.terrain,st=Se==="map",ht=ke==="map";for(const nt of me){const kt=be.getTile(nt),Mt=kt.getBucket(ge);if(!Mt||!Mt.text||!Mt.text.segments.get().length)continue;const gt=c.ah(Mt.textSizeData,He.zoom),zt=c.at(kt,1,pe.transform.zoom),gn=We(st,pe.transform,zt),qn=ge.layout.get("icon-text-fit")!=="none"&&Mt.hasIconData();{const Ui=Math.pow(2,He.zoom-kt.tileID.overscaledZ),yi=Ke?(Ti,hi)=>Ke.getElevation(nt,Ti,hi):null;Cl(Mt,st,ht,Pe,He,gn,Ui,gt,qn,c.au(He,kt,Re,Oe),nt.toUnwrapped(),yi)}}}(j,S,P,I,P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),Z),P.paint.get("icon-opacity").constantOr(1)!==0&&bc(S,I,P,j,!1,P.paint.get("icon-translate"),P.paint.get("icon-translate-anchor"),P.layout.get("icon-rotation-alignment"),P.layout.get("icon-pitch-alignment"),P.layout.get("icon-keep-upright"),ee,ie,H),P.paint.get("text-opacity").constantOr(1)!==0&&bc(S,I,P,j,!0,P.paint.get("text-translate"),P.paint.get("text-translate-anchor"),P.layout.get("text-rotation-alignment"),P.layout.get("text-pitch-alignment"),P.layout.get("text-keep-upright"),ee,ie,H),I.map.showCollisionBoxes&&(Qs(S,I,P,j,!0),Qs(S,I,P,j,!1))}(e,o,f,y,this.style.placement.variableOffsets,w):c.bZ(f)?function(S,I,P,j,Z){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:Y}=Z,H=P.paint.get("circle-opacity"),ee=P.paint.get("circle-stroke-width"),ie=P.paint.get("circle-stroke-opacity"),me=!P.layout.get("circle-sort-key").isConstant();if(H.constantOr(1)===0&&(ee.constantOr(1)===0||ie.constantOr(1)===0))return;const pe=S.context,ge=pe.gl,be=S.transform,Se=S.getDepthModeForSublayer(0,pn.ReadOnly),ke=Vn.disabled,Re=S.colorModeForRenderPass(),Oe=[],Pe=be.getCircleRadiusCorrection();for(let He=0;He<j.length;He++){const Ke=j[He],st=I.getTile(Ke),ht=st.getBucket(P);if(!ht)continue;const nt=P.paint.get("circle-translate"),kt=P.paint.get("circle-translate-anchor"),Mt=c.au(be,st,nt,kt),gt=ht.programConfigurations.get(P.id),zt=S.useProgram("circle",gt),gn=ht.layoutVertexBuffer,qn=ht.indexBuffer,Ui=S.style.map.terrain&&S.style.map.terrain.getTerrainData(Ke),yi={programConfiguration:gt,program:zt,layoutVertexBuffer:gn,indexBuffer:qn,uniformValues:pc(S,st,P,Mt,Pe),terrainData:Ui,projectionData:be.getProjectionData({overscaledTileID:Ke,applyGlobeMatrix:!Y,applyTerrainMatrix:!0})};if(me){const Ti=ht.segments.get();for(const hi of Ti)Oe.push({segments:new c.aD([hi]),sortKey:hi.sortKey,state:yi})}else Oe.push({segments:ht.segments,sortKey:0,state:yi})}me&&Oe.sort((He,Ke)=>He.sortKey-Ke.sortKey);for(const He of Oe){const{programConfiguration:Ke,program:st,layoutVertexBuffer:ht,indexBuffer:nt,uniformValues:kt,terrainData:Mt,projectionData:gt}=He.state;st.draw(pe,ge.TRIANGLES,Se,ke,Re,Tn.backCCW,kt,Mt,gt,P.id,ht,nt,He.segments,P.paint,S.transform.zoom,Ke)}}(e,o,f,y,w):c.b_(f)?function(S,I,P,j,Z){if(P.paint.get("heatmap-opacity")===0)return;const Y=S.context,{isRenderingToTexture:H,isRenderingGlobe:ee}=Z;if(S.style.map.terrain){for(const ie of j){const me=I.getTile(ie);I.hasRenderableParent(ie)||(S.renderPass==="offscreen"?so(S,me,P,ie,ee):S.renderPass==="translucent"&&Is(S,P,ie,H,ee))}Y.viewport.set([0,0,S.width,S.height])}else S.renderPass==="offscreen"?function(ie,me,pe,ge){const be=ie.context,Se=be.gl,ke=ie.transform,Re=Vn.disabled,Oe=new Ci([Se.ONE,Se.ONE],c.b4.transparent,[!0,!0,!0,!0]);(function(Pe,He,Ke){const st=Pe.gl;Pe.activeTexture.set(st.TEXTURE1),Pe.viewport.set([0,0,He.width/4,He.height/4]);let ht=Ke.heatmapFbos.get(c.bP);ht?(st.bindTexture(st.TEXTURE_2D,ht.colorAttachment.get()),Pe.bindFramebuffer.set(ht.framebuffer)):(ht=Oo(Pe,He.width/4,He.height/4),Ke.heatmapFbos.set(c.bP,ht))})(be,ie,pe),be.clear({color:c.b4.transparent});for(let Pe=0;Pe<ge.length;Pe++){const He=ge[Pe];if(me.hasRenderableParent(He))continue;const Ke=me.getTile(He),st=Ke.getBucket(pe);if(!st)continue;const ht=st.programConfigurations.get(pe.id),nt=ie.useProgram("heatmap",ht),kt=ke.getProjectionData({overscaledTileID:He,applyGlobeMatrix:!0,applyTerrainMatrix:!1}),Mt=ke.getCircleRadiusCorrection();nt.draw(be,Se.TRIANGLES,pn.disabled,Re,Oe,Tn.backCCW,Dd(Ke,ke.zoom,pe.paint.get("heatmap-intensity"),Mt),null,kt,pe.id,st.layoutVertexBuffer,st.indexBuffer,st.segments,pe.paint,ke.zoom,ht)}be.viewport.set([0,0,ie.width,ie.height])}(S,I,P,j):S.renderPass==="translucent"&&function(ie,me){const pe=ie.context,ge=pe.gl;pe.setColorMode(ie.colorModeForRenderPass());const be=me.heatmapFbos.get(c.bP);be&&(pe.activeTexture.set(ge.TEXTURE0),ge.bindTexture(ge.TEXTURE_2D,be.colorAttachment.get()),pe.activeTexture.set(ge.TEXTURE1),rs(pe,me).bind(ge.LINEAR,ge.CLAMP_TO_EDGE),ie.useProgram("heatmapTexture").draw(pe,ge.TRIANGLES,pn.disabled,Vn.disabled,ie.colorModeForRenderPass(),Tn.disabled,Hs(ie,me,0,1),null,null,me.id,ie.viewportBuffer,ie.quadTriangleIndexBuffer,ie.viewportSegments,me.paint,ie.transform.zoom))}(S,P)}(e,o,f,y,w):c.b$(f)?function(S,I,P,j,Z){if(S.renderPass!=="translucent")return;const{isRenderingToTexture:Y}=Z,H=P.paint.get("line-opacity"),ee=P.paint.get("line-width");if(H.constantOr(1)===0||ee.constantOr(1)===0)return;const ie=S.getDepthModeForSublayer(0,pn.ReadOnly),me=S.colorModeForRenderPass(),pe=P.paint.get("line-dasharray"),ge=P.paint.get("line-pattern"),be=ge.constantOr(1),Se=P.paint.get("line-gradient"),ke=P.getCrossfadeParameters(),Re=be?"linePattern":pe?"lineSDF":Se?"lineGradient":"line",Oe=S.context,Pe=Oe.gl,He=S.transform;let Ke=!0;for(const st of j){const ht=I.getTile(st);if(be&&!ht.patternsLoaded())continue;const nt=ht.getBucket(P);if(!nt)continue;const kt=nt.programConfigurations.get(P.id),Mt=S.context.program.get(),gt=S.useProgram(Re,kt),zt=Ke||gt.program!==Mt,gn=S.style.map.terrain&&S.style.map.terrain.getTerrainData(st),qn=ge.constantOr(null);if(qn&&ht.imageAtlas){const ii=ht.imageAtlas,_i=ii.patternPositions[qn.to.toString()],na=ii.patternPositions[qn.from.toString()];_i&&na&&kt.setConstantPatternPositions(_i,na)}const Ui=He.getProjectionData({overscaledTileID:st,applyGlobeMatrix:!Y,applyTerrainMatrix:!0}),yi=He.getPixelScale(),Ti=be?Em(S,ht,P,yi,ke):pe?Sm(S,ht,P,yi,pe,ke):Se?Id(S,ht,P,yi,nt.lineClipsArray.length):Qf(S,ht,P,yi);if(be)Oe.activeTexture.set(Pe.TEXTURE0),ht.imageAtlasTexture.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE),kt.updatePaintBuffers(ke);else if(pe&&(zt||S.lineAtlas.dirty))Oe.activeTexture.set(Pe.TEXTURE0),S.lineAtlas.bind(Oe);else if(Se){const ii=nt.gradients[P.id];let _i=ii.texture;if(P.gradientVersion!==ii.version){let na=256;if(P.stepInterpolant){const Ei=I.getSource().maxzoom,Pi=st.canonical.z===Ei?Math.ceil(1<<S.transform.maxZoom-st.canonical.z):1;na=c.ab(c.bQ(nt.maxLineLength/c.X*1024*Pi),256,Oe.maxTextureSize)}ii.gradient=c.bR({expression:P.gradientExpression(),evaluationKey:"lineProgress",resolution:na,image:ii.gradient||void 0,clips:nt.lineClipsArray}),ii.texture?ii.texture.update(ii.gradient):ii.texture=new je(Oe,ii.gradient,Pe.RGBA),ii.version=P.gradientVersion,_i=ii.texture}Oe.activeTexture.set(Pe.TEXTURE0),_i.bind(P.stepInterpolant?Pe.NEAREST:Pe.LINEAR,Pe.CLAMP_TO_EDGE)}let hi;if(Y){const[ii]=S.getStencilConfigForOverlapAndUpdateStencilID(j);hi=ii[st.overscaledZ]}else hi=S.stencilModeForClipping(st);gt.draw(Oe,Pe.TRIANGLES,ie,hi,me,Tn.disabled,Ti,gn,Ui,P.id,nt.layoutVertexBuffer,nt.indexBuffer,nt.segments,P.paint,S.transform.zoom,kt,nt.layoutVertexBuffer2),Ke=!1}}(e,o,f,y,w):c.c0(f)?function(S,I,P,j,Z){const Y=P.paint.get("fill-color"),H=P.paint.get("fill-opacity");if(H.constantOr(1)===0)return;const{isRenderingToTexture:ee}=Z,ie=S.colorModeForRenderPass(),me=P.paint.get("fill-pattern"),pe=S.opaquePassEnabledForLayer()&&!me.constantOr(1)&&Y.constantOr(c.b4.transparent).a===1&&H.constantOr(0)===1?"opaque":"translucent";if(S.renderPass===pe){const ge=S.getDepthModeForSublayer(1,S.renderPass==="opaque"?pn.ReadWrite:pn.ReadOnly);mu(S,I,P,j,ge,ie,!1,ee)}if(S.renderPass==="translucent"&&P.paint.get("fill-antialias")){const ge=S.getDepthModeForSublayer(P.getPaintProperty("fill-outline-color")?2:0,pn.ReadOnly);mu(S,I,P,j,ge,ie,!0,ee)}}(e,o,f,y,w):c.c1(f)?function(S,I,P,j,Z){const Y=P.paint.get("fill-extrusion-opacity");if(Y===0)return;const{isRenderingToTexture:H}=Z;if(S.renderPass==="translucent"){const ee=new pn(S.context.gl.LEQUAL,pn.ReadWrite,S.depthRangeFor3D);if(Y!==1||P.paint.get("fill-extrusion-pattern").constantOr(1))xc(S,I,P,j,ee,Vn.disabled,Ci.disabled,H),xc(S,I,P,j,ee,S.stencilModeFor3D(),S.colorModeForRenderPass(),H);else{const ie=S.colorModeForRenderPass();xc(S,I,P,j,ee,Vn.disabled,ie,H)}}}(e,o,f,y,w):c.c2(f)?function(S,I,P,j,Z){if(S.renderPass!=="offscreen"&&S.renderPass!=="translucent")return;const{isRenderingToTexture:Y}=Z,H=S.context,ee=S.style.projection.useSubdivision,ie=S.getDepthModeForSublayer(0,pn.ReadOnly),me=S.colorModeForRenderPass();if(S.renderPass==="offscreen")(function(pe,ge,be,Se,ke,Re,Oe){const Pe=pe.context,He=Pe.gl;for(const Ke of be){const st=ge.getTile(Ke),ht=st.dem;if(!ht||!ht.data||!st.needsHillshadePrepare)continue;const nt=ht.dim,kt=ht.stride,Mt=ht.getPixels();if(Pe.activeTexture.set(He.TEXTURE1),Pe.pixelStoreUnpackPremultiplyAlpha.set(!1),st.demTexture=st.demTexture||pe.getTileTexture(kt),st.demTexture){const zt=st.demTexture;zt.update(Mt,{premultiply:!1}),zt.bind(He.NEAREST,He.CLAMP_TO_EDGE)}else st.demTexture=new je(Pe,Mt,He.RGBA,{premultiply:!1}),st.demTexture.bind(He.NEAREST,He.CLAMP_TO_EDGE);Pe.activeTexture.set(He.TEXTURE0);let gt=st.fbo;if(!gt){const zt=new je(Pe,{width:nt,height:nt,data:null},He.RGBA);zt.bind(He.LINEAR,He.CLAMP_TO_EDGE),gt=st.fbo=Pe.createFramebuffer(nt,nt,!0,!1),gt.colorAttachment.set(zt.texture)}Pe.bindFramebuffer.set(gt.framebuffer),Pe.viewport.set([0,0,nt,nt]),pe.useProgram("hillshadePrepare").draw(Pe,He.TRIANGLES,ke,Re,Oe,Tn.disabled,mc(st.tileID,ht),null,null,Se.id,pe.rasterBoundsBuffer,pe.quadTriangleIndexBuffer,pe.rasterBoundsSegments),st.needsHillshadePrepare=!1}})(S,I,j,P,ie,Vn.disabled,me),H.viewport.set([0,0,S.width,S.height]);else if(S.renderPass==="translucent")if(ee){const[pe,ge,be]=S.stencilConfigForOverlapTwoPass(j);wh(S,I,P,be,pe,ie,me,!1,Y),wh(S,I,P,be,ge,ie,me,!0,Y)}else{const[pe,ge]=S.getStencilConfigForOverlapAndUpdateStencilID(j);wh(S,I,P,ge,pe,ie,me,!1,Y)}}(e,o,f,y,w):c.c3(f)?function(S,I,P,j,Z){if(S.renderPass!=="translucent"||P.paint.get("raster-opacity")===0||!j.length)return;const{isRenderingToTexture:Y}=Z,H=I.getSource(),ee=S.style.projection.useSubdivision;if(H instanceof ar)Rn(S,I,P,j,null,!1,!1,H.tileCoords,H.flippedWindingOrder,Y);else if(ee){const[ie,me,pe]=S.stencilConfigForOverlapTwoPass(j);Rn(S,I,P,pe,ie,!1,!0,ea,!1,Y),Rn(S,I,P,pe,me,!0,!0,ea,!1,Y)}else{const[ie,me]=S.getStencilConfigForOverlapAndUpdateStencilID(j);Rn(S,I,P,me,ie,!1,!0,ea,!1,Y)}}(e,o,f,y,w):c.c4(f)?function(S,I,P,j,Z){const Y=P.paint.get("background-color"),H=P.paint.get("background-opacity");if(H===0)return;const{isRenderingToTexture:ee}=Z,ie=S.context,me=ie.gl,pe=S.style.projection,ge=S.transform,be=ge.tileSize,Se=P.paint.get("background-pattern");if(S.isPatternMissing(Se))return;const ke=!Se&&Y.a===1&&H===1&&S.opaquePassEnabledForLayer()?"opaque":"translucent";if(S.renderPass!==ke)return;const Re=Vn.disabled,Oe=S.getDepthModeForSublayer(0,ke==="opaque"?pn.ReadWrite:pn.ReadOnly),Pe=S.colorModeForRenderPass(),He=S.useProgram(Se?"backgroundPattern":"background"),Ke=j||de(ge,{tileSize:be,terrain:S.style.map.terrain});Se&&(ie.activeTexture.set(me.TEXTURE0),S.imageManager.bind(S.context));const st=P.getCrossfadeParameters();for(const ht of Ke){const nt=ge.getProjectionData({overscaledTileID:ht,applyGlobeMatrix:!ee,applyTerrainMatrix:!0}),kt=Se?Rd(H,S,Se,{tileID:ht,tileSize:be},st):fh(H,Y),Mt=S.style.map.terrain&&S.style.map.terrain.getTerrainData(ht),gt=pe.getMeshFromTileID(ie,ht.canonical,!1,!0,"raster");He.draw(ie,me.TRIANGLES,Oe,Re,Pe,Tn.backCCW,kt,Mt,nt,P.id,gt.vertexBuffer,gt.indexBuffer,gt.segments)}}(e,0,f,y,w):c.c5(f)&&function(S,I,P,j){const{isRenderingGlobe:Z}=j,Y=S.context,H=P.implementation,ee=S.style.projection,ie=S.transform,me=ie.getProjectionDataForCustomLayer(Z),pe={farZ:ie.farZ,nearZ:ie.nearZ,fov:ie.fov*Math.PI/180,modelViewProjectionMatrix:ie.modelViewProjectionMatrix,projectionMatrix:ie.projectionMatrix,shaderData:{variantName:ee.shaderVariantName,vertexShaderPrelude:`const float PI = 3.141592653589793;
uniform mat4 u_projection_matrix;
${ee.shaderPreludeCode.vertexSource}`,define:ee.shaderDefine},defaultProjectionData:me},ge=H.renderingMode?H.renderingMode:"2d";if(S.renderPass==="offscreen"){const be=H.prerender;be&&(S.setCustomLayerDefaults(),Y.setColorMode(S.colorModeForRenderPass()),be.call(H,Y.gl,pe),Y.setDirty(),S.setBaseState())}else if(S.renderPass==="translucent"){S.setCustomLayerDefaults(),Y.setColorMode(S.colorModeForRenderPass()),Y.setStencilMode(Vn.disabled);const be=ge==="3d"?S.getDepthModeFor3D():S.getDepthModeForSublayer(0,pn.ReadOnly);Y.setDepthMode(be),H.render(Y.gl,pe),Y.setDirty(),S.setBaseState(),Y.bindFramebuffer.set(null)}}(e,0,f,w))}saveTileTexture(e){const o=this._tileTextures[e.size[0]];o?o.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const o=this._tileTextures[e];return o&&o.length>0?o.pop():null}isPatternMissing(e){if(!e)return!1;if(!e.from||!e.to)return!0;const o=this.imageManager.getPattern(e.from.toString()),f=this.imageManager.getPattern(e.to.toString());return!o||!f}useProgram(e,o,f=!1){this.cache=this.cache||{};const y=!!this.style.map.terrain,w=this.style.projection,S=e+(o?o.cacheKey:"")+`/${f?lc:w.shaderVariantName}`+(this._showOverdrawInspector?"/overdraw":"")+(y?"/terrain":"");return this.cache[S]||(this.cache[S]=new Ad(this.context,Ss[e],o,Kf[e],this._showOverdrawInspector,y,f?Ss.projectionMercator:w.shaderPreludeCode,f?au:w.shaderDefine)),this.cache[S]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new je(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:e,drawingBufferHeight:o}=this.context.gl;return this.width!==e||this.height!==o}}function tl(b,e){let o,f=!1,y=null,w=null;const S=()=>{y=null,f&&(b.apply(w,o),y=setTimeout(S,e),f=!1)};return(...I)=>(f=!0,w=this,o=I,y||S(),y)}class yu{constructor(e){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let f;return o.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(f=y)}),(f&&f[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(!this._isValidHash(o))return!1;const f=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:f,pitch:+(o[4]||0)}),!0},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.*)?$/,this.getHashString());window.history.replaceState(window.history.state,null,o)},this._removeHash=()=>{const o=this._getCurrentHash();if(o.length===0)return;const f=o.join("/");let y=f;y.split("&").length>0&&(y=y.split("&")[0]),this._hashName&&(y=`${this._hashName}=${f}`);let w=window.location.hash.replace(y,"");w.startsWith("#&")?w=w.slice(0,1)+w.slice(2):w==="#"&&(w="");let S=window.location.href.replace(/(#.+)?$/,w);S=S.replace("&&","&"),window.history.replaceState(window.history.state,null,S)},this._updateHash=tl(this._updateHashUnthrottled,300),this._hashName=e&&encodeURIComponent(e)}addTo(e){return this._map=e,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),this._removeHash(),delete this._map,this}getHashString(e){const o=this._map.getCenter(),f=Math.round(100*this._map.getZoom())/100,y=Math.ceil((f*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,y),S=Math.round(o.lng*w)/w,I=Math.round(o.lat*w)/w,P=this._map.getBearing(),j=this._map.getPitch();let Z="";if(Z+=e?`/${S}/${I}/${f}`:`${f}/${I}/${S}`,(P||j)&&(Z+="/"+Math.round(10*P)/10),j&&(Z+=`/${Math.round(j)}`),this._hashName){const Y=this._hashName;let H=!1;const ee=window.location.hash.slice(1).split("&").map(ie=>{const me=ie.split("=")[0];return me===Y?(H=!0,`${me}=${Z}`):ie}).filter(ie=>ie);return H||ee.push(`${Y}=${Z}`),`#${ee.join("&")}`}return`#${Z}`}_isValidHash(e){if(e.length<3||e.some(isNaN))return!1;try{new c.N(+e[2],+e[1])}catch{return!1}const o=+e[0],f=+(e[3]||0),y=+(e[4]||0);return o>=this._map.getMinZoom()&&o<=this._map.getMaxZoom()&&f>=0&&f<=180&&y>=this._map.getMinPitch()&&y<=this._map.getMaxPitch()}}const Sc={linearity:.3,easing:c.c6(0,0,.3,1)},_u=c.e({deceleration:2500,maxSpeed:1400},Sc),cp=c.e({deceleration:20,maxSpeed:1400},Sc),Ac=c.e({deceleration:1e3,maxSpeed:360},Sc),vu=c.e({deceleration:1e3,maxSpeed:90},Sc),Eh=c.e({deceleration:1e3,maxSpeed:360},Sc);class Il{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:F.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,o=F.now();for(;e.length>0&&o-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,roll:0,pan:new c.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)o.zoom+=w.zoomDelta||0,o.bearing+=w.bearingDelta||0,o.pitch+=w.pitchDelta||0,o.roll+=w.rollDelta||0,w.panDelta&&o.pan._add(w.panDelta),w.around&&(o.around=w.around),w.pinchAround&&(o.pinchAround=w.pinchAround);const f=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(o.pan.mag()){const w=ma(o.pan.mag(),f,c.e({},_u,e||{})),S=o.pan.mult(w.amount/o.pan.mag()),I=this._map.cameraHelper.handlePanInertia(S,this._map.transform);y.center=I.easingCenter,y.offset=I.easingOffset,nl(y,w)}if(o.zoom){const w=ma(o.zoom,f,cp);y.zoom=this._map.transform.zoom+w.amount,nl(y,w)}if(o.bearing){const w=ma(o.bearing,f,Ac);y.bearing=this._map.transform.bearing+c.ab(w.amount,-179,179),nl(y,w)}if(o.pitch){const w=ma(o.pitch,f,vu);y.pitch=this._map.transform.pitch+w.amount,nl(y,w)}if(o.roll){const w=ma(o.roll,f,Eh);y.roll=this._map.transform.roll+c.ab(w.amount,-179,179),nl(y,w)}if(y.zoom||y.bearing){const w=o.pinchAround===void 0?o.around:o.pinchAround;y.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),c.e(y,{noMoveStart:!0})}}function nl(b,e){(!b.duration||b.duration<e.duration)&&(b.duration=e.duration,b.easing=e.easing)}function ma(b,e,o){const{maxSpeed:f,linearity:y,deceleration:w}=o,S=c.ab(b*y/(e/1e3),-f,f),I=Math.abs(S)/(w*y);return{easing:o.easing,duration:1e3*I,amount:S*(I/2)}}class sr extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,f,y={}){const w=V.mousePos(o.getCanvas(),f),S=o.unproject(w);super(e,c.e({point:w,lngLat:S,originalEvent:f},y)),this._defaultPrevented=!1,this.target=o}}class Bo extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,f){const y=e==="touchend"?f.changedTouches:f.touches,w=V.touchPos(o.getCanvasContainer(),y),S=w.map(P=>o.unproject(P)),I=w.reduce((P,j,Z,Y)=>P.add(j.div(Y.length)),new c.P(0,0));super(e,{points:w,point:I,lngLats:S,lngLat:o.unproject(I),originalEvent:f}),this._defaultPrevented=!1}}class jo extends c.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,o,f){super(e,{originalEvent:f}),this._defaultPrevented=!1}}class as{constructor(e,o){this._map=e,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(e){return this._firePreventable(new jo(e.type,this._map,e))}mousedown(e,o){return this._mousedownPos=o,this._firePreventable(new sr(e.type,this._map,e))}mouseup(e){this._map.fire(new sr(e.type,this._map,e))}click(e,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new sr(e.type,this._map,e))}dblclick(e){return this._firePreventable(new sr(e.type,this._map,e))}mouseover(e){this._map.fire(new sr(e.type,this._map,e))}mouseout(e){this._map.fire(new sr(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Bo(e.type,this._map,e))}touchmove(e){this._map.fire(new Bo(e.type,this._map,e))}touchend(e){this._map.fire(new Bo(e.type,this._map,e))}touchcancel(e){this._map.fire(new Bo(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class jd{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(e){this._map.fire(new sr(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new sr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._ignoreContextMenu||this._map.fire(new sr(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bu{constructor(e){this._map=e}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(e){return this.transform.screenPointToLocation(c.P.convert(e),this._map.terrain)}}class Fd{constructor(e,o){this._map=e,this._tr=new bu(e),this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,o){this.isEnabled()&&e.shiftKey&&e.button===0&&(V.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(e,o){if(!this._active)return;const f=o;if(this._lastPos.equals(f)||!this._box&&f.dist(this._startPos)<this._clickTolerance)return;const y=this._startPos;this._lastPos=f,this._box||(this._box=V.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",e));const w=Math.min(y.x,f.x),S=Math.max(y.x,f.x),I=Math.min(y.y,f.y),P=Math.max(y.y,f.y);V.setTransform(this._box,`translate(${w}px,${I}px)`),this._box.style.width=S-w+"px",this._box.style.height=P-I+"px"}mouseupWindow(e,o){if(!this._active||e.button!==0)return;const f=this._startPos,y=o;if(this.reset(),V.suppressClick(),f.x!==y.x||f.y!==y.y)return this._map.fire(new c.k("boxzoomend",{originalEvent:e})),{cameraAnimation:w=>w.fitScreenCoordinates(f,y,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",e)}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(V.remove(this._box),this._box=null),V.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(e,o){return this._map.fire(new c.k(e,{originalEvent:o}))}}function Sh(b,e){if(b.length!==e.length)throw new Error(`The number of touches and points are not equal - touches ${b.length}, points ${e.length}`);const o={};for(let f=0;f<b.length;f++)o[b[f].identifier]=e[f];return o}class lo{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(e,o,f){(this.centroid||f.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=e.timeStamp),f.length===this.numTouches&&(this.centroid=function(y){const w=new c.P(0,0);for(const S of y)w._add(S);return w.div(y.length)}(o),this.touches=Sh(f,o)))}touchmove(e,o,f){if(this.aborted||!this.centroid)return;const y=Sh(f,o);for(const w in this.touches){const S=y[w];(!S||S.dist(this.touches[w])>30)&&(this.aborted=!0)}}touchend(e,o,f){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),f.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class ga{constructor(e){this.singleTap=new lo(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(e,o,f){this.singleTap.touchstart(e,o,f)}touchmove(e,o,f){this.singleTap.touchmove(e,o,f)}touchend(e,o,f){const y=this.singleTap.touchend(e,o,f);if(y){const w=e.timeStamp-this.lastTime<500,S=!this.lastTap||this.lastTap.dist(y)<30;if(w&&S||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class ya{constructor(e){this._tr=new bu(e),this._zoomIn=new ga({numTouches:1,numTaps:2}),this._zoomOut=new ga({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,o,f){this._zoomIn.touchstart(e,o,f),this._zoomOut.touchstart(e,o,f)}touchmove(e,o,f){this._zoomIn.touchmove(e,o,f),this._zoomOut.touchmove(e,o,f)}touchend(e,o,f){const y=this._zoomIn.touchend(e,o,f),w=this._zoomOut.touchend(e,o,f),S=this._tr;return y?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:S.zoom+1,around:S.unproject(y)},{originalEvent:e})}):w?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:S.zoom-1,around:S.unproject(w)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ft{constructor(e){this._enabled=!!e.enable,this._moveStateManager=e.moveStateManager,this._clickTolerance=e.clickTolerance||1,this._moveFunction=e.move,this._activateOnStart=!!e.activateOnStart,e.assignEvents(this),this.reset()}reset(e){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(e)}_move(...e){const o=this._moveFunction(...e);if(o.bearingDelta||o.pitchDelta||o.rollDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(e,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(e)&&(this._moveStateManager.startMove(e),this._lastPoint=Array.isArray(o)?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(e,o){if(!this.isEnabled())return;const f=this._lastPoint;if(!f)return;if(e.preventDefault(),!this._moveStateManager.isValidMoveEvent(e))return void this.reset(e);const y=Array.isArray(o)?o[0]:o;return!this._moved&&y.dist(f)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=y,this._move(f,y))}dragEnd(e){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(e)&&(this._moved&&V.suppressClick(),this.reset(e))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const il={0:1,2:2};class Ca{constructor(e){this._correctEvent=e.checkCorrectEvent}startMove(e){const o=V.mouseButton(e);this._eventButton=o}endMove(e){delete this._eventButton}isValidStartEvent(e){return this._correctEvent(e)}isValidMoveEvent(e){return!function(o,f){const y=il[f];return o.buttons===void 0||(o.buttons&y)!==y}(e,this._eventButton)}isValidEndEvent(e){return V.mouseButton(e)===this._eventButton}}class Pr{constructor(){this._firstTouch=void 0}_isOneFingerTouch(e){return e.targetTouches.length===1}_isSameTouchEvent(e){return e.targetTouches[0].identifier===this._firstTouch}startMove(e){this._firstTouch=e.targetTouches[0].identifier}endMove(e){delete this._firstTouch}isValidStartEvent(e){return this._isOneFingerTouch(e)}isValidMoveEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}isValidEndEvent(e){return this._isOneFingerTouch(e)&&this._isSameTouchEvent(e)}}class kl{constructor(e=new Ca({checkCorrectEvent:()=>!0}),o=new Pr){this.mouseMoveStateManager=e,this.oneFingerTouchMoveStateManager=o}_executeRelevantHandler(e,o,f){return e instanceof MouseEvent?o(e):typeof TouchEvent<"u"&&e instanceof TouchEvent?f(e):void 0}startMove(e){this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.startMove(o),o=>this.oneFingerTouchMoveStateManager.startMove(o))}endMove(e){this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.endMove(o),o=>this.oneFingerTouchMoveStateManager.endMove(o))}isValidStartEvent(e){return this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.isValidStartEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidStartEvent(o))}isValidMoveEvent(e){return this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.isValidMoveEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidMoveEvent(o))}isValidEndEvent(e){return this._executeRelevantHandler(e,o=>this.mouseMoveStateManager.isValidEndEvent(o),o=>this.oneFingerTouchMoveStateManager.isValidEndEvent(o))}}const Rl=b=>{b.mousedown=b.dragStart,b.mousemoveWindow=b.dragMove,b.mouseup=b.dragEnd,b.contextmenu=e=>{e.preventDefault()}};class Im{constructor(e,o){this._clickTolerance=e.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new c.P(0,0)}_shouldBePrevented(e){return e<(this._map.cooperativeGestures.isEnabled()?2:1)}touchstart(e,o,f){return this._calculateTransform(e,o,f)}touchmove(e,o,f){if(this._active){if(!this._shouldBePrevented(f.length))return e.preventDefault(),this._calculateTransform(e,o,f);this._map.cooperativeGestures.notifyGestureBlocked("touch_pan",e)}}touchend(e,o,f){this._calculateTransform(e,o,f),this._active&&this._shouldBePrevented(f.length)&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,o,f){f.length>0&&(this._active=!0);const y=Sh(f,o),w=new c.P(0,0),S=new c.P(0,0);let I=0;for(const j in y){const Z=y[j],Y=this._touches[j];Y&&(w._add(Z),S._add(Z.sub(Y)),I++,y[j]=Z)}if(this._touches=y,this._shouldBePrevented(I)||!S.mag())return;const P=S.div(I);return this._sum._add(P),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(I),panDelta:P}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zn{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(e,o,f){this._firstTwoTouches||f.length<2||(this._firstTwoTouches=[f[0].identifier,f[1].identifier],this._start([o[0],o[1]]))}touchmove(e,o,f){if(!this._firstTwoTouches)return;e.preventDefault();const[y,w]=this._firstTwoTouches,S=Xi(f,o,y),I=Xi(f,o,w);if(!S||!I)return;const P=this._aroundCenter?null:S.add(I).div(2);return this._move([S,I],P,e)}touchend(e,o,f){if(!this._firstTwoTouches)return;const[y,w]=this._firstTwoTouches,S=Xi(f,o,y),I=Xi(f,o,w);S&&I||(this._active&&V.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}}function Xi(b,e,o){for(let f=0;f<b.length;f++)if(b[f].identifier===o)return e[f]}function Ud(b,e){return Math.log(b/e)/Math.LN2}class Nl extends zn{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,o){const f=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Ud(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ud(this._distance,f),pinchAround:o}}}function xu(b,e){return 180*b.angleWith(e)/Math.PI}class Vd extends zn{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,o,f){const y=this._vector;if(this._vector=e[0].sub(e[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:xu(this._vector,y),pinchAround:o}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const o=25/(Math.PI*this._minDiameter)*360,f=xu(e,this._startVector);return Math.abs(f)<o}}function rl(b){return Math.abs(b.y)>Math.abs(b.x)}class al extends zn{constructor(e){super(),this._currentTouchCount=0,this._map=e}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(e,o,f){super.touchstart(e,o,f),this._currentTouchCount=f.length}_start(e){this._lastPoints=e,rl(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,o,f){if(this._map.cooperativeGestures.isEnabled()&&this._currentTouchCount<3)return;const y=e[0].sub(this._lastPoints[0]),w=e[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(y,w,f.timeStamp),this._valid?(this._lastPoints=e,this._active=!0,{pitchDelta:(y.y+w.y)/2*-.5}):void 0}gestureBeginsVertically(e,o,f){if(this._valid!==void 0)return this._valid;const y=e.mag()>=2,w=o.mag()>=2;if(!y&&!w)return;if(!y||!w)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;const S=e.y>0==o.y>0;return rl(e)&&rl(o)&&S}}const km={panStep:100,bearingStep:15,pitchStep:10};class up{constructor(e){this._tr=new bu(e);const o=km;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let o=0,f=0,y=0,w=0,S=0;switch(e.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:e.shiftKey?f=-1:(e.preventDefault(),w=-1);break;case 39:e.shiftKey?f=1:(e.preventDefault(),w=1);break;case 38:e.shiftKey?y=1:(e.preventDefault(),S=-1);break;case 40:e.shiftKey?y=-1:(e.preventDefault(),S=1);break;default:return}return this._rotationDisabled&&(f=0,y=0),{cameraAnimation:I=>{const P=this._tr;I.easeTo({duration:300,easeId:"keyboardHandler",easing:Rm,zoom:o?Math.round(P.zoom)+o*(e.shiftKey?2:1):P.zoom,bearing:P.bearing+f*this._bearingStep,pitch:P.pitch+y*this._pitchStep,offset:[-w*this._panStep,-S*this._panStep],center:P.center},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Rm(b){return b*(2-b)}const hp=4.000244140625;class Pl{constructor(e,o){this._onTimeout=f=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(f)},this._map=e,this._tr=new bu(e),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}_shouldBePrevented(e){return!!this._map.cooperativeGestures.isEnabled()&&!(e.ctrlKey||this._map.cooperativeGestures.isBypassed(e))}wheel(e){if(!this.isEnabled())return;if(this._shouldBePrevented(e))return void this._map.cooperativeGestures.notifyGestureBlocked("wheel_zoom",e);let o=e.deltaMode===WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const f=F.now(),y=f-(this._lastWheelEventTime||0);this._lastWheelEventTime=f,o!==0&&o%hp==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(y*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),e.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=e,this._delta-=o,this._active||this._start(e)),e.preventDefault()}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=V.mousePos(this._map.getCanvas(),e),f=this._tr;this._aroundPoint=this._aroundCenter?f.transform.locationToScreenPoint(c.N.convert(f.center)):o,this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._tr.transform;if(typeof this._lastExpectedZoom=="number"){const I=e.zoom-this._lastExpectedZoom;typeof this._startZoom=="number"&&(this._startZoom+=I),typeof this._targetZoom=="number"&&(this._targetZoom+=I)}if(this._delta!==0){const I=this._type==="wheel"&&Math.abs(this._delta)>hp?this._wheelZoomRate:this._defaultZoomRate;let P=2/(1+Math.exp(-Math.abs(this._delta*I)));this._delta<0&&P!==0&&(P=1/P);const j=typeof this._targetZoom!="number"?e.scale:c.aG(this._targetZoom);this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,c.a8(j*P))),this._type==="wheel"&&(this._startZoom=e.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom!="number"?e.zoom:this._targetZoom,f=this._startZoom,y=this._easing;let w,S=!1;if(this._type==="wheel"&&f&&y){const I=F.now()-this._lastWheelEventTime,P=Math.min((I+5)/200,1),j=y(P);w=c.y.number(f,o,j),P<1?this._frameId||(this._frameId=!0):S=!0}else w=o,S=!0;return this._active=!0,S&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._lastExpectedZoom,delete this._finishTimeout},200)),this._lastExpectedZoom=w,{noInertia:!0,needsRenderFrame:!S,zoomDelta:w-e.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let o=c.c8;if(this._prevEase){const f=this._prevEase,y=(F.now()-f.start)/f.duration,w=f.easing(y+.01)-f.easing(y),S=.27/Math.sqrt(w*w+1e-4)*.01,I=Math.sqrt(.0729-S*S);o=c.c6(S,I,.25,1)}return this._prevEase={start:F.now(),duration:e,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,delete this._lastExpectedZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class os{constructor(e,o){this._clickZoom=e,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Mi{constructor(e){this._tr=new bu(e),this.reset()}reset(){this._active=!1}dblclick(e,o){return e.preventDefault(),{cameraAnimation:f=>{f.easeTo({duration:300,zoom:this._tr.zoom+(e.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ah{constructor(){this._tap=new ga({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(e,o,f){if(!this._swipePoint)if(this._tapTime){const y=o[0],w=e.timeStamp-this._tapTime<500,S=this._tapPoint.dist(y)<30;w&&S?f.length>0&&(this._swipePoint=y,this._swipeTouch=f[0].identifier):this.reset()}else this._tap.touchstart(e,o,f)}touchmove(e,o,f){if(this._tapTime){if(this._swipePoint){if(f[0].identifier!==this._swipeTouch)return;const y=o[0],w=y.y-this._swipePoint.y;return this._swipePoint=y,e.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(e,o,f)}touchend(e,o,f){if(this._tapTime)this._swipePoint&&f.length===0&&this.reset();else{const y=this._tap.touchend(e,o,f);y&&(this._tapTime=e.timeStamp,this._tapPoint=y)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ss{constructor(e,o,f){this._el=e,this._mousePan=o,this._touchPan=f}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Nn{constructor(e,o,f,y){this._pitchWithRotate=e.pitchWithRotate,this._rollEnabled=e.rollEnabled,this._mouseRotate=o,this._mousePitch=f,this._mouseRoll=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable(),this._rollEnabled&&this._mouseRoll.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable(),this._mouseRoll.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())&&(!this._rollEnabled||this._mouseRoll.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()||this._mouseRoll.isActive()}}class mi{constructor(e,o,f,y){this._el=e,this._touchZoom=o,this._touchRotate=f,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}class pr{constructor(e,o){this._bypassKey=navigator.userAgent.indexOf("Mac")!==-1?"metaKey":"ctrlKey",this._map=e,this._options=o,this._enabled=!1}isActive(){return!1}reset(){}_setupUI(){if(this._container)return;const e=this._map.getCanvasContainer();e.classList.add("maplibregl-cooperative-gestures"),this._container=V.create("div","maplibregl-cooperative-gesture-screen",e);let o=this._map._getUIString("CooperativeGesturesHandler.WindowsHelpText");this._bypassKey==="metaKey"&&(o=this._map._getUIString("CooperativeGesturesHandler.MacHelpText"));const f=this._map._getUIString("CooperativeGesturesHandler.MobileHelpText"),y=document.createElement("div");y.className="maplibregl-desktop-message",y.textContent=o,this._container.appendChild(y);const w=document.createElement("div");w.className="maplibregl-mobile-message",w.textContent=f,this._container.appendChild(w),this._container.setAttribute("aria-hidden","true")}_destroyUI(){this._container&&(V.remove(this._container),this._map.getCanvasContainer().classList.remove("maplibregl-cooperative-gestures")),delete this._container}enable(){this._setupUI(),this._enabled=!0}disable(){this._enabled=!1,this._destroyUI()}isEnabled(){return this._enabled}isBypassed(e){return e[this._bypassKey]}notifyGestureBlocked(e,o){this._enabled&&(this._map.fire(new c.k("cooperativegestureprevented",{gestureType:e,originalEvent:o})),this._container.classList.add("maplibregl-show"),setTimeout(()=>{this._container.classList.remove("maplibregl-show")},100))}}const Cc=b=>b.zoom||b.drag||b.roll||b.pitch||b.rotate;class Ma extends c.k{}function Fo(b){return b.panDelta&&b.panDelta.mag()||b.zoomDelta||b.bearingDelta||b.pitchDelta||b.rollDelta}class Wt{constructor(e,o){this.handleWindowEvent=y=>{this.handleEvent(y,`${y.type}Window`)},this.handleEvent=(y,w)=>{if(y.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const S=y.type==="renderFrame"?void 0:y,I={needsRenderFrame:!1},P={},j={},Z=y.touches,Y=Z?this._getMapTouches(Z):void 0,H=Y?V.touchPos(this._map.getCanvas(),Y):V.mousePos(this._map.getCanvas(),y);for(const{handlerName:me,handler:pe,allowed:ge}of this._handlers){if(!pe.isEnabled())continue;let be;this._blockedByActive(j,ge,me)?pe.reset():pe[w||y.type]&&(be=pe[w||y.type](y,H,Y),this.mergeHandlerResult(I,P,be,me,S),be&&be.needsRenderFrame&&this._triggerRenderFrame()),(be||pe.isActive())&&(j[me]=pe)}const ee={};for(const me in this._previousActiveHandlers)j[me]||(ee[me]=S);this._previousActiveHandlers=j,(Object.keys(ee).length||Fo(I))&&(this._changes.push([I,P,ee]),this._triggerRenderFrame()),(Object.keys(j).length||Fo(I))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ie}=I;ie&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ie(this._map))},this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Il(e),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const f=this._el;this._listeners=[[f,"touchstart",{passive:!0}],[f,"touchmove",{passive:!1}],[f,"touchend",void 0],[f,"touchcancel",void 0],[f,"mousedown",void 0],[f,"mousemove",void 0],[f,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[f,"mouseover",void 0],[f,"mouseout",void 0],[f,"dblclick",void 0],[f,"click",void 0],[f,"keydown",{capture:!1}],[f,"keyup",void 0],[f,"wheel",{passive:!1}],[f,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,w,S]of this._listeners)V.addEventListener(y,w,y===document?this.handleWindowEvent:this.handleEvent,S)}destroy(){for(const[e,o,f]of this._listeners)V.removeEventListener(e,o,e===document?this.handleWindowEvent:this.handleEvent,f)}_addDefaultHandlers(e){const o=this._map,f=o.getCanvasContainer();this._add("mapEvent",new as(o,e));const y=o.boxZoom=new Fd(o,e);this._add("boxZoom",y),e.interactive&&e.boxZoom&&y.enable();const w=o.cooperativeGestures=new pr(o,e.cooperativeGestures);this._add("cooperativeGestures",w),e.cooperativeGestures&&w.enable();const S=new ya(o),I=new Mi(o);o.doubleClickZoom=new os(I,S),this._add("tapZoom",S),this._add("clickZoom",I),e.interactive&&e.doubleClickZoom&&o.doubleClickZoom.enable();const P=new Ah;this._add("tapDragZoom",P);const j=o.touchPitch=new al(o);this._add("touchPitch",j),e.interactive&&e.touchPitch&&o.touchPitch.enable(e.touchPitch);const Z=()=>o.project(o.getCenter()),Y=function({enable:ke,clickTolerance:Re,aroundCenter:Oe=!0,minPixelCenterThreshold:Pe=100,rotateDegreesPerPixelMoved:He=.8},Ke){const st=new Ca({checkCorrectEvent:ht=>V.mouseButton(ht)===0&&ht.ctrlKey||V.mouseButton(ht)===2&&!ht.ctrlKey});return new Ft({clickTolerance:Re,move:(ht,nt)=>{const kt=Ke();if(Oe&&Math.abs(kt.y-ht.y)>Pe)return{bearingDelta:c.c7(new c.P(ht.x,nt.y),nt,kt)};let Mt=(nt.x-ht.x)*He;return Oe&&nt.y<kt.y&&(Mt=-Mt),{bearingDelta:Mt}},moveStateManager:st,enable:ke,assignEvents:Rl})}(e,Z),H=function({enable:ke,clickTolerance:Re,pitchDegreesPerPixelMoved:Oe=-.5}){const Pe=new Ca({checkCorrectEvent:He=>V.mouseButton(He)===0&&He.ctrlKey||V.mouseButton(He)===2});return new Ft({clickTolerance:Re,move:(He,Ke)=>({pitchDelta:(Ke.y-He.y)*Oe}),moveStateManager:Pe,enable:ke,assignEvents:Rl})}(e),ee=function({enable:ke,clickTolerance:Re,rollDegreesPerPixelMoved:Oe=.3},Pe){const He=new Ca({checkCorrectEvent:Ke=>V.mouseButton(Ke)===2&&Ke.ctrlKey});return new Ft({clickTolerance:Re,move:(Ke,st)=>{const ht=Pe();let nt=(st.x-Ke.x)*Oe;return st.y<ht.y&&(nt=-nt),{rollDelta:nt}},moveStateManager:He,enable:ke,assignEvents:Rl})}(e,Z);o.dragRotate=new Nn(e,Y,H,ee),this._add("mouseRotate",Y,["mousePitch"]),this._add("mousePitch",H,["mouseRotate","mouseRoll"]),this._add("mouseRoll",ee,["mousePitch"]),e.interactive&&e.dragRotate&&o.dragRotate.enable();const ie=function({enable:ke,clickTolerance:Re}){const Oe=new Ca({checkCorrectEvent:Pe=>V.mouseButton(Pe)===0&&!Pe.ctrlKey});return new Ft({clickTolerance:Re,move:(Pe,He)=>({around:He,panDelta:He.sub(Pe)}),activateOnStart:!0,moveStateManager:Oe,enable:ke,assignEvents:Rl})}(e),me=new Im(e,o);o.dragPan=new ss(f,ie,me),this._add("mousePan",ie),this._add("touchPan",me,["touchZoom","touchRotate"]),e.interactive&&e.dragPan&&o.dragPan.enable(e.dragPan);const pe=new Vd,ge=new Nl;o.touchZoomRotate=new mi(f,ge,pe,P),this._add("touchRotate",pe,["touchPan","touchZoom"]),this._add("touchZoom",ge,["touchPan","touchRotate"]),e.interactive&&e.touchZoomRotate&&o.touchZoomRotate.enable(e.touchZoomRotate);const be=o.scrollZoom=new Pl(o,()=>this._triggerRenderFrame());this._add("scrollZoom",be,["mousePan"]),e.interactive&&e.scrollZoom&&o.scrollZoom.enable(e.scrollZoom);const Se=o.keyboard=new up(o);this._add("keyboard",Se),e.interactive&&e.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new jd(o))}_add(e,o,f){this._handlers.push({handlerName:e,handler:o,allowed:f}),this._handlersById[e]=o}stop(e){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Cc(this._eventsInProgress)||this.isZooming()}_blockedByActive(e,o,f){for(const y in e)if(y!==f&&(!o||o.indexOf(y)<0))return!0;return!1}_getMapTouches(e){const o=[];for(const f of e)this._el.contains(f.target)&&o.push(f);return o}mergeHandlerResult(e,o,f,y,w){if(!f)return;c.e(e,f);const S={handlerName:y,originalEvent:f.originalEvent||w};f.zoomDelta!==void 0&&(o.zoom=S),f.panDelta!==void 0&&(o.drag=S),f.rollDelta!==void 0&&(o.roll=S),f.pitchDelta!==void 0&&(o.pitch=S),f.bearingDelta!==void 0&&(o.rotate=S)}_applyChanges(){const e={},o={},f={};for(const[y,w,S]of this._changes)y.panDelta&&(e.panDelta=(e.panDelta||new c.P(0,0))._add(y.panDelta)),y.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+y.pitchDelta),y.rollDelta&&(e.rollDelta=(e.rollDelta||0)+y.rollDelta),y.around!==void 0&&(e.around=y.around),y.pinchAround!==void 0&&(e.pinchAround=y.pinchAround),y.noInertia&&(e.noInertia=y.noInertia),c.e(o,w),c.e(f,S);this._updateMapTransform(e,o,f),this._changes=[]}_updateMapTransform(e,o,f){const y=this._map,w=y._getTransformForUpdate(),S=y.terrain;if(!(Fo(e)||S&&this._terrainMovement))return this._fireEvents(o,f,!0);y._stop(!0);let{panDelta:I,zoomDelta:P,bearingDelta:j,pitchDelta:Z,rollDelta:Y,around:H,pinchAround:ee}=e;ee!==void 0&&(H=ee),H=H||y.transform.centerPoint,S&&!w.isPointOnMapSurface(H)&&(H=w.centerPoint);const ie={panDelta:I,zoomDelta:P,rollDelta:Y,pitchDelta:Z,bearingDelta:j,around:H};this._map.cameraHelper.useGlobeControls&&!w.isPointOnMapSurface(H)&&(H=w.centerPoint);const me=H.distSqr(w.centerPoint)<.01?w.center:w.screenPointToLocation(I?H.sub(I):H);S?(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ie,w),this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?w.setCenter(w.screenPointToLocation(w.centerPoint.sub(I))):this._map.cameraHelper.handleMapControlsPan(ie,w,me):(this._terrainMovement=!0,this._map._elevationFreeze=!0,this._map.cameraHelper.handleMapControlsPan(ie,w,me))):(this._map.cameraHelper.handleMapControlsRollPitchBearingZoom(ie,w),this._map.cameraHelper.handleMapControlsPan(ie,w,me)),y._applyUpdatedTransform(w),this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(o,f,!0)}_fireEvents(e,o,f){const y=Cc(this._eventsInProgress),w=Cc(e),S={};for(const Y in e){const{originalEvent:H}=e[Y];this._eventsInProgress[Y]||(S[`${Y}start`]=H),this._eventsInProgress[Y]=e[Y]}!y&&w&&this._fireEvent("movestart",w.originalEvent);for(const Y in S)this._fireEvent(Y,S[Y]);w&&this._fireEvent("move",w.originalEvent);for(const Y in e){const{originalEvent:H}=e[Y];this._fireEvent(Y,H)}const I={};let P;for(const Y in this._eventsInProgress){const{handlerName:H,originalEvent:ee}=this._eventsInProgress[Y];this._handlersById[H].isActive()||(delete this._eventsInProgress[Y],P=o[H]||ee,I[`${Y}end`]=P)}for(const Y in I)this._fireEvent(Y,I[Y]);const j=Cc(this._eventsInProgress),Z=(y||w)&&!j;if(Z&&this._terrainMovement){this._map._elevationFreeze=!1,this._terrainMovement=!1;const Y=this._map._getTransformForUpdate();this._map.getCenterClampedToGround()&&Y.recalculateZoomAndCenter(this._map.terrain),this._map._applyUpdatedTransform(Y)}if(f&&Z){this._updatingCamera=!0;const Y=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),H=ee=>ee!==0&&-this._bearingSnap<ee&&ee<this._bearingSnap;!Y||!Y.essential&&F.prefersReducedMotion?(this._map.fire(new c.k("moveend",{originalEvent:P})),H(this._map.getBearing())&&this._map.resetNorth()):(H(Y.bearing||this._map.getBearing())&&(Y.bearing=0),Y.freezeElevation=!0,this._map.easeTo(Y,{originalEvent:P})),this._updatingCamera=!1}}_fireEvent(e,o){this._map.fire(new c.k(e,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{delete this._frameId,this.handleEvent(new Ma("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class rn extends c.E{constructor(e,o,f){super(),this._renderFrameCallback=()=>{const y=Math.min((F.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(y)),y<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=f.bearingSnap,this.cameraHelper=o,this.on("moveend",()=>{delete this._requestedCameraState})}migrateProjection(e,o){e.apply(this.transform),this.transform=e,this.cameraHelper=o}getCenter(){return new c.N(this.transform.center.lng,this.transform.center.lat)}setCenter(e,o){return this.jumpTo({center:e},o)}getCenterElevation(){return this.transform.elevation}setCenterElevation(e,o){return this.jumpTo({elevation:e},o),this}getCenterClampedToGround(){return this._centerClampedToGround}setCenterClampedToGround(e){this._centerClampedToGround=e}panBy(e,o,f){return e=c.P.convert(e).mult(-1),this.panTo(this.transform.center,c.e({offset:e},o),f)}panTo(e,o,f){return this.easeTo(c.e({center:e},o),f)}getZoom(){return this.transform.zoom}setZoom(e,o){return this.jumpTo({zoom:e},o),this}zoomTo(e,o,f){return this.easeTo(c.e({zoom:e},o),f)}zoomIn(e,o){return this.zoomTo(this.getZoom()+1,e,o),this}zoomOut(e,o){return this.zoomTo(this.getZoom()-1,e,o),this}getVerticalFieldOfView(){return this.transform.fov}setVerticalFieldOfView(e,o){return e!=this.transform.fov&&(this.transform.setFov(e),this.fire(new c.k("movestart",o)).fire(new c.k("move",o)).fire(new c.k("moveend",o))),this}getBearing(){return this.transform.bearing}setBearing(e,o){return this.jumpTo({bearing:e},o),this}getPadding(){return this.transform.padding}setPadding(e,o){return this.jumpTo({padding:e},o),this}rotateTo(e,o,f){return this.easeTo(c.e({bearing:e},o),f)}resetNorth(e,o){return this.rotateTo(0,c.e({duration:1e3},e),o),this}resetNorthPitch(e,o){return this.easeTo(c.e({bearing:0,pitch:0,roll:0,duration:1e3},e),o),this}snapToNorth(e,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,o):this}getPitch(){return this.transform.pitch}setPitch(e,o){return this.jumpTo({pitch:e},o),this}getRoll(){return this.transform.roll}setRoll(e,o){return this.jumpTo({roll:e},o),this}cameraForBounds(e,o){e=ci.convert(e).adjustAntiMeridian();const f=o&&o.bearing||0;return this._cameraForBoxAndBearing(e.getNorthWest(),e.getSouthEast(),f,o)}_cameraForBoxAndBearing(e,o,f,y){const w={top:0,bottom:0,right:0,left:0};if(typeof(y=c.e({padding:w,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){const j=y.padding;y.padding={top:j,bottom:j,right:j,left:j}}const S=c.e(w,y.padding);y.padding=S;const I=this.transform,P=new ci(e,o);return this.cameraHelper.cameraForBoxAndBearing(y,S,P,f,I)}fitBounds(e,o,f){return this._fitInternal(this.cameraForBounds(e,o),o,f)}fitScreenCoordinates(e,o,f,y,w){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.screenPointToLocation(c.P.convert(e)),this.transform.screenPointToLocation(c.P.convert(o)),f,y),y,w)}_fitInternal(e,o,f){return e?(delete(o=c.e(e,o)).padding,o.linear?this.easeTo(o,f):this.flyTo(o,f)):this}jumpTo(e,o){this.stop();const f=this._getTransformForUpdate();let y=!1,w=!1,S=!1;const I=f.zoom;this.cameraHelper.handleJumpToCenterZoom(f,e);const P=f.zoom!==I;return"elevation"in e&&f.elevation!==+e.elevation&&f.setElevation(+e.elevation),"bearing"in e&&f.bearing!==+e.bearing&&(y=!0,f.setBearing(+e.bearing)),"pitch"in e&&f.pitch!==+e.pitch&&(w=!0,f.setPitch(+e.pitch)),"roll"in e&&f.roll!==+e.roll&&(S=!0,f.setRoll(+e.roll)),e.padding==null||f.isPaddingEqual(e.padding)||f.setPadding(e.padding),this._applyUpdatedTransform(f),this.fire(new c.k("movestart",o)).fire(new c.k("move",o)),P&&this.fire(new c.k("zoomstart",o)).fire(new c.k("zoom",o)).fire(new c.k("zoomend",o)),y&&this.fire(new c.k("rotatestart",o)).fire(new c.k("rotate",o)).fire(new c.k("rotateend",o)),w&&this.fire(new c.k("pitchstart",o)).fire(new c.k("pitch",o)).fire(new c.k("pitchend",o)),S&&this.fire(new c.k("rollstart",o)).fire(new c.k("roll",o)).fire(new c.k("rollend",o)),this.fire(new c.k("moveend",o))}calculateCameraOptionsFromTo(e,o,f,y=0){const w=c.Y.fromLngLat(e,o),S=c.Y.fromLngLat(f,y),I=S.x-w.x,P=S.y-w.y,j=S.z-w.z,Z=Math.hypot(I,P,j);if(Z===0)throw new Error("Can't calculate camera options with same From and To");const Y=Math.hypot(I,P),H=c.a8(this.transform.cameraToCenterDistance/Z/this.transform.tileSize),ee=180*Math.atan2(I,-P)/Math.PI;let ie=180*Math.acos(Y/Z)/Math.PI;return ie=j<0?90-ie:90+ie,{center:S.toLngLat(),elevation:y,zoom:H,pitch:ie,bearing:ee}}calculateCameraOptionsFromCameraLngLatAltRotation(e,o,f,y,w){const S=this.transform.calculateCenterFromCameraLngLatAlt(e,o,f,y);return{center:S.center,elevation:S.elevation,zoom:S.zoom,bearing:f,pitch:y,roll:w}}easeTo(e,o){this._stop(!1,e.easeId),((e=c.e({offset:[0,0],duration:500,easing:c.c8},e)).animate===!1||!e.essential&&F.prefersReducedMotion)&&(e.duration=0);const f=this._getTransformForUpdate(),y=this.getBearing(),w=f.pitch,S=f.roll,I="bearing"in e?this._normalizeBearing(e.bearing,y):y,P="pitch"in e?+e.pitch:w,j="roll"in e?this._normalizeBearing(e.roll,S):S,Z="padding"in e?e.padding:f.padding,Y=c.P.convert(e.offset);let H,ee;e.around&&(H=c.N.convert(e.around),ee=f.locationToScreenPoint(H));const ie={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching,rolling:this._rolling},me=this.cameraHelper.handleEaseTo(f,{bearing:I,pitch:P,roll:j,padding:Z,around:H,aroundPoint:ee,offsetAsPoint:Y,offset:e.offset,zoom:e.zoom,center:e.center});return this._rotating=this._rotating||y!==I,this._pitching=this._pitching||P!==w,this._rolling=this._rolling||j!==S,this._padding=!f.isPaddingEqual(Z),this._zooming=this._zooming||me.isZooming,this._easeId=e.easeId,this._prepareEase(o,e.noMoveStart,ie),this.terrain&&this._prepareElevation(me.elevationCenter),this._ease(pe=>{me.easeFunc(pe),this.terrain&&!e.freezeElevation&&this._updateElevation(pe),this._applyUpdatedTransform(f),this._fireMoveEvents(o)},pe=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(o,pe)},e),this}_prepareEase(e,o,f={}){this._moving=!0,o||f.moving||this.fire(new c.k("movestart",e)),this._zooming&&!f.zooming&&this.fire(new c.k("zoomstart",e)),this._rotating&&!f.rotating&&this.fire(new c.k("rotatestart",e)),this._pitching&&!f.pitching&&this.fire(new c.k("pitchstart",e)),this._rolling&&!f.rolling&&this.fire(new c.k("rollstart",e))}_prepareElevation(e){this._elevationCenter=e,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(e,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(e){this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom));const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(e<1&&o!==this._elevationTarget){const f=this._elevationTarget-this._elevationStart;this._elevationStart+=e*(f-(o-(f*e+this._elevationStart))/(1-e)),this._elevationTarget=o}this.transform.setElevation(c.y.number(this._elevationStart,this._elevationTarget,e))}_finalizeElevation(){this._elevationFreeze=!1,this.getCenterClampedToGround()&&this.transform.recalculateZoomAndCenter(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate||this.terrain?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_elevateCameraIfInsideTerrain(e){if(!this.terrain&&e.elevation>=0&&e.pitch<=90)return{};const o=e.getCameraLngLat(),f=e.getCameraAltitude(),y=this.terrain?this.terrain.getElevationForLngLatZoom(o,e.zoom):0;if(f<y){const w=this.calculateCameraOptionsFromTo(o,y,e.center,e.elevation);return{pitch:w.pitch,zoom:w.zoom}}return{}}_applyUpdatedTransform(e){const o=[];if(o.push(y=>this._elevateCameraIfInsideTerrain(y)),this.transformCameraUpdate&&o.push(y=>this.transformCameraUpdate(y)),!o.length)return;const f=e.clone();for(const y of o){const w=f.clone(),{center:S,zoom:I,roll:P,pitch:j,bearing:Z,elevation:Y}=y(w);S&&w.setCenter(S),Y!==void 0&&w.setElevation(Y),I!==void 0&&w.setZoom(I),P!==void 0&&w.setRoll(P),j!==void 0&&w.setPitch(j),Z!==void 0&&w.setBearing(Z),f.apply(w)}this.transform.apply(f)}_fireMoveEvents(e){this.fire(new c.k("move",e)),this._zooming&&this.fire(new c.k("zoom",e)),this._rotating&&this.fire(new c.k("rotate",e)),this._pitching&&this.fire(new c.k("pitch",e)),this._rolling&&this.fire(new c.k("roll",e))}_afterEase(e,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const f=this._zooming,y=this._rotating,w=this._pitching,S=this._rolling;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._rolling=!1,this._padding=!1,f&&this.fire(new c.k("zoomend",e)),y&&this.fire(new c.k("rotateend",e)),w&&this.fire(new c.k("pitchend",e)),S&&this.fire(new c.k("rollend",e)),this.fire(new c.k("moveend",e))}flyTo(e,o){if(!e.essential&&F.prefersReducedMotion){const nt=c.M(e,["center","zoom","bearing","pitch","roll","elevation"]);return this.jumpTo(nt,o)}this.stop(),e=c.e({offset:[0,0],speed:1.2,curve:1.42,easing:c.c8},e);const f=this._getTransformForUpdate(),y=f.bearing,w=f.pitch,S=f.roll,I=f.padding,P="bearing"in e?this._normalizeBearing(e.bearing,y):y,j="pitch"in e?+e.pitch:w,Z="roll"in e?this._normalizeBearing(e.roll,S):S,Y="padding"in e?e.padding:f.padding,H=c.P.convert(e.offset);let ee=f.centerPoint.add(H);const ie=f.screenPointToLocation(ee),me=this.cameraHelper.handleFlyTo(f,{bearing:P,pitch:j,roll:Z,padding:Y,locationAtOffset:ie,offsetAsPoint:H,center:e.center,minZoom:e.minZoom,zoom:e.zoom});let pe=e.curve;const ge=Math.max(f.width,f.height),be=ge/me.scaleOfZoom,Se=me.pixelPathLength;typeof me.scaleOfMinZoom=="number"&&(pe=Math.sqrt(ge/me.scaleOfMinZoom/Se*2));const ke=pe*pe;function Re(nt){const kt=(be*be-ge*ge+(nt?-1:1)*ke*ke*Se*Se)/(2*(nt?be:ge)*ke*Se);return Math.log(Math.sqrt(kt*kt+1)-kt)}function Oe(nt){return(Math.exp(nt)-Math.exp(-nt))/2}function Pe(nt){return(Math.exp(nt)+Math.exp(-nt))/2}const He=Re(!1);let Ke=function(nt){return Pe(He)/Pe(He+pe*nt)},st=function(nt){return ge*((Pe(He)*(Oe(kt=He+pe*nt)/Pe(kt))-Oe(He))/ke)/Se;var kt},ht=(Re(!0)-He)/pe;if(Math.abs(Se)<2e-6||!isFinite(ht)){if(Math.abs(ge-be)<1e-6)return this.easeTo(e,o);const nt=be<ge?-1:1;ht=Math.abs(Math.log(be/ge))/pe,st=()=>0,Ke=kt=>Math.exp(nt*pe*kt)}return e.duration="duration"in e?+e.duration:1e3*ht/("screenSpeed"in e?+e.screenSpeed/pe:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0),this._zooming=!0,this._rotating=y!==P,this._pitching=j!==w,this._rolling=Z!==S,this._padding=!f.isPaddingEqual(Y),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(me.targetCenter),this._ease(nt=>{const kt=nt*ht,Mt=1/Ke(kt),gt=st(kt);this._rotating&&f.setBearing(c.y.number(y,P,nt)),this._pitching&&f.setPitch(c.y.number(w,j,nt)),this._rolling&&f.setRoll(c.y.number(S,Z,nt)),this._padding&&(f.interpolatePadding(I,Y,nt),ee=f.centerPoint.add(H)),me.easeFunc(nt,Mt,gt,ee),this.terrain&&!e.freezeElevation&&this._updateElevation(nt),this._applyUpdatedTransform(f),this._fireMoveEvents(o)},()=>{this.terrain&&e.freezeElevation&&this._finalizeElevation(),this._afterEase(o)},e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,o){var f;if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,o)}return e||(f=this.handlers)===null||f===void 0||f.stop(!1),this}_ease(e,o,f){f.animate===!1||f.duration===0?(e(1),o()):(this._easeStart=F.now(),this._easeOptions=f,this._onEaseFrame=e,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(e,o){e=c.aI(e,-180,180);const f=Math.abs(e-o);return Math.abs(e-360-o)<f&&(e-=360),Math.abs(e+360-o)<f&&(e+=360),e}queryTerrainElevation(e){return this.terrain?this.terrain.getElevationForLngLatZoom(c.N.convert(e),this.transform.tileZoom):null}}const ks={compact:!0,customAttribution:'<a href="https://maplibre.org/" target="_blank">MapLibre</a>'};class Gd{constructor(e=ks){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=e}getDefaultPosition(){return"bottom-right"}onAdd(e){return this._map=e,this._compact=this.options.compact,this._container=V.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=V.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=V.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){V.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._sanitizedAttributionHTML=void 0}_setElementTitle(e,o){const f=this._map._getUIString(`AttributionControl.${o}`);e.title=f,e.setAttribute("aria-label",f)}_updateAttributions(){if(!this._map.style)return;let e=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=e.concat(this.options.customAttribution.map(y=>typeof y!="string"?"":y)):typeof this.options.customAttribution=="string"&&e.push(this.options.customAttribution)),this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const o=this._map.style.sourceCaches;for(const y in o){const w=o[y];if(w.used||w.usedForTerrain){const S=w.getSource();S.attribution&&e.indexOf(S.attribution)<0&&e.push(S.attribution)}}e=e.filter(y=>String(y).trim()),e.sort((y,w)=>y.length-w.length),e=e.filter((y,w)=>{for(let S=w+1;S<e.length;S++)if(e[S].indexOf(y)>=0)return!1;return!0});const f=e.join(" | ");f!==this._sanitizedAttributionHTML&&(this._sanitizedAttributionHTML=V.sanitize(f),e.length?(this._innerContainer.innerHTML=this._sanitizedAttributionHTML,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class Wi{constructor(e={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const f=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&f.classList.add("maplibregl-compact"):f.classList.remove("maplibregl-compact")}},this.options=e}getDefaultPosition(){return"bottom-left"}onAdd(e){this._map=e,this._compact=this.options&&this.options.compact,this._container=V.create("div","maplibregl-ctrl");const o=V.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){V.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class _a{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const o=++this._id;return this._queue.push({callback:e,id:o,cancelled:!1}),o}remove(e){const o=this._currentlyRunning,f=o?this._queue.concat(o):this._queue;for(const y of f)if(y.id===e)return void(y.cancelled=!0)}run(e=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const f of o)if(!f.cancelled&&(f.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}var Zd=c.aA([{name:"a_pos3d",type:"Int16",components:3}]);class ls extends c.E{constructor(e){super(),this._lastTilesetChange=F.now(),this.sourceCache=e,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.deltaZoom=1,this.tileSize=e._source.tileSize*2**this.deltaZoom,e.usedForTerrain=!0,e.tileSize=this.tileSize}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(e,o){this.sourceCache.update(e,o),this._renderableTilesKeys=[];const f={};for(const y of de(e,{tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o,calculateTileZoom:this.sourceCache._source.calculateTileZoom}))f[y.key]=!0,this._renderableTilesKeys.push(y.key),this._tiles[y.key]||(y.terrainRttPosMatrix32f=new Float64Array(16),c.bL(y.terrainRttPosMatrix32f,0,c.X,c.X,0,0,1),this._tiles[y.key]=new ac(y,this.tileSize),this._lastTilesetChange=F.now());for(const y in this._tiles)f[y]||delete this._tiles[y]}freeRtt(e){for(const o in this._tiles){const f=this._tiles[o];(!e||f.tileID.equals(e)||f.tileID.isChildOf(e)||e.isChildOf(f.tileID))&&(f.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(e=>this.getTileByID(e))}getTileByID(e){return this._tiles[e]}getTerrainCoords(e){const o={};for(const f of this._renderableTilesKeys){const y=this._tiles[f].tileID,w=e.clone(),S=c.a$();if(y.canonical.equals(e.canonical))c.bL(S,0,c.X,c.X,0,0,1);else if(y.canonical.isChildOf(e.canonical)){const I=y.canonical.z-e.canonical.z,P=y.canonical.x-(y.canonical.x>>I<<I),j=y.canonical.y-(y.canonical.y>>I<<I),Z=c.X>>I;c.bL(S,0,Z,Z,0,0,1),c.J(S,S,[-P*Z,-j*Z,0])}else{if(!e.canonical.isChildOf(y.canonical))continue;{const I=e.canonical.z-y.canonical.z,P=e.canonical.x-(e.canonical.x>>I<<I),j=e.canonical.y-(e.canonical.y>>I<<I),Z=c.X>>I;c.bL(S,0,c.X,c.X,0,0,1),c.J(S,S,[P*Z,j*Z,0]),c.K(S,S,[1/2**I,1/2**I,0])}}w.terrainRttPosMatrix32f=new Float32Array(S),o[f]=w}return o}getSourceTile(e,o){const f=this.sourceCache._source;let y=e.overscaledZ-this.deltaZoom;if(y>f.maxzoom&&(y=f.maxzoom),y<f.minzoom)return null;this._sourceTileCache[e.key]||(this._sourceTileCache[e.key]=e.scaledTo(y).key);let w=this.sourceCache.getTileByID(this._sourceTileCache[e.key]);if((!w||!w.dem)&&o)for(;y>=f.minzoom&&(!w||!w.dem);)w=this.sourceCache.getTileByID(e.scaledTo(y--).key);return w}anyTilesAfterTime(e=Date.now()){return this._lastTilesetChange>=e}}class Nm{constructor(e,o,f){this._meshCache={},this.painter=e,this.sourceCache=new ls(o),this.options=f,this.exaggeration=typeof f.exaggeration=="number"?f.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(e,o,f,y=c.X){var w;if(!(o>=0&&o<y&&f>=0&&f<y))return 0;const S=this.getTerrainData(e),I=(w=S.tile)===null||w===void 0?void 0:w.dem;if(!I)return 0;const P=c.c9([],[o/y*c.X,f/y*c.X],S.u_terrain_matrix),j=[P[0]*I.dim,P[1]*I.dim],Z=Math.floor(j[0]),Y=Math.floor(j[1]),H=j[0]-Z,ee=j[1]-Y;return I.get(Z,Y)*(1-H)*(1-ee)+I.get(Z+1,Y)*H*(1-ee)+I.get(Z,Y+1)*(1-H)*ee+I.get(Z+1,Y+1)*H*ee}getElevationForLngLatZoom(e,o){if(!c.ca(o,e.wrap()))return 0;const{tileID:f,mercatorX:y,mercatorY:w}=this._getOverscaledTileIDFromLngLatZoom(e,o);return this.getElevation(f,y%c.X,w%c.X,c.X)}getElevation(e,o,f,y=c.X){return this.getDEMElevation(e,o,f,y)*this.exaggeration}getTerrainData(e){if(!this._emptyDemTexture){const y=this.painter.context,w=new c.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new je(y,w,y.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new je(y,new c.R({width:1,height:1}),y.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=c.aq([])}const o=this.sourceCache.getSourceTile(e,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const y=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new je(y,o.dem.getPixels(),y.gl.RGBA,{premultiply:!1}),o.demTexture.bind(y.gl.NEAREST,y.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const f=o&&o+o.tileID.key+e.key;if(f&&!this._demMatrixCache[f]){const y=this.sourceCache.sourceCache._source.maxzoom;let w=e.canonical.z-o.tileID.canonical.z;e.overscaledZ>e.canonical.z&&(e.canonical.z>=y?w=e.canonical.z-y:c.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const S=e.canonical.x-(e.canonical.x>>w<<w),I=e.canonical.y-(e.canonical.y>>w<<w),P=c.cb(new Float64Array(16),[1/(c.X<<w),1/(c.X<<w),0]);c.J(P,P,[S*c.X,I*c.X,0]),this._demMatrixCache[e.key]={matrix:P,coord:e}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:f?this._demMatrixCache[e.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(e){const o=this.painter,f=o.width/devicePixelRatio,y=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===f&&this._fbo.height===y||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new je(o.context,{width:f,height:y,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new je(o.context,{width:f,height:y,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(f,y,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,f,y))),this._fbo.colorAttachment.set(e==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const e=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let w=0,S=0;w<this._coordsTextureSize;w++)for(let I=0;I<this._coordsTextureSize;I++,S+=4)o[S+0]=255&I,o[S+1]=255&w,o[S+2]=I>>8<<4|w>>8,o[S+3]=0;const f=new c.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),y=new je(e,f,e.gl.RGBA,{premultiply:!1});return y.bind(e.gl.NEAREST,e.gl.CLAMP_TO_EDGE),this._coordsTexture=y,y}pointCoordinate(e){this.painter.maybeDrawDepthAndCoords(!0);const o=new Uint8Array(4),f=this.painter.context,y=f.gl,w=Math.round(e.x*this.painter.pixelRatio/devicePixelRatio),S=Math.round(e.y*this.painter.pixelRatio/devicePixelRatio),I=Math.round(this.painter.height/devicePixelRatio);f.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),y.readPixels(w,I-S-1,1,1,y.RGBA,y.UNSIGNED_BYTE,o),f.bindFramebuffer.set(null);const P=o[0]+(o[2]>>4<<8),j=o[1]+((15&o[2])<<8),Z=this.coordsIndex[255-o[3]],Y=Z&&this.sourceCache.getTileByID(Z);if(!Y)return null;const H=this._coordsTextureSize,ee=(1<<Y.tileID.canonical.z)*H;return new c.Y((Y.tileID.canonical.x*H+P)/ee+Y.tileID.wrap,(Y.tileID.canonical.y*H+j)/ee,this.getElevation(Y.tileID,P,j,H))}depthAtPoint(e){const o=new Uint8Array(4),f=this.painter.context,y=f.gl;return f.bindFramebuffer.set(this.getFramebuffer("depth").framebuffer),y.readPixels(e.x,this.painter.height/devicePixelRatio-e.y-1,1,1,y.RGBA,y.UNSIGNED_BYTE,o),f.bindFramebuffer.set(null),(o[0]/16777216+o[1]/65536+o[2]/256+o[3])/256}getTerrainMesh(e){var o;const f=((o=this.painter.style.projection)===null||o===void 0?void 0:o.transitionState)>0,y=f&&e.canonical.y===0,w=f&&e.canonical.y===(1<<e.canonical.z)-1,S=`m_${y?"n":""}_${w?"s":""}`;if(this._meshCache[S])return this._meshCache[S];const I=this.painter.context,P=new c.cc,j=new c.aE,Z=this.meshSize,Y=c.X/Z,H=Z*Z;for(let Pe=0;Pe<=Z;Pe++)for(let He=0;He<=Z;He++)P.emplaceBack(He*Y,Pe*Y,0);for(let Pe=0;Pe<H;Pe+=Z+1)for(let He=0;He<Z;He++)j.emplaceBack(He+Pe,Z+He+Pe+1,Z+He+Pe+2),j.emplaceBack(He+Pe,Z+He+Pe+2,He+Pe+1);const ee=P.length,ie=ee+(Z+1),me=(Z+1)*Z,pe=y?c.b6:0,ge=y?0:1,be=w?c.b7:c.X,Se=w?0:1;for(let Pe=0;Pe<=Z;Pe++)P.emplaceBack(Pe*Y,pe,ge);for(let Pe=0;Pe<=Z;Pe++)P.emplaceBack(Pe*Y,be,Se);for(let Pe=0;Pe<Z;Pe++)j.emplaceBack(me+Pe,ie+Pe,ie+Pe+1),j.emplaceBack(me+Pe,ie+Pe+1,me+Pe+1),j.emplaceBack(0+Pe,ee+Pe+1,ee+Pe),j.emplaceBack(0+Pe,0+Pe+1,ee+Pe+1);const ke=P.length,Re=ke+2*(Z+1);for(const Pe of[0,1])for(let He=0;He<=Z;He++)for(const Ke of[0,1])P.emplaceBack(Pe*c.X,He*Y,Ke);for(let Pe=0;Pe<2*Z;Pe+=2)j.emplaceBack(ke+Pe,ke+Pe+1,ke+Pe+3),j.emplaceBack(ke+Pe,ke+Pe+3,ke+Pe+2),j.emplaceBack(Re+Pe,Re+Pe+3,Re+Pe+1),j.emplaceBack(Re+Pe,Re+Pe+2,Re+Pe+3);const Oe=new ko(I.createVertexBuffer(P,Zd.members),I.createIndexBuffer(j),c.aD.simpleSegment(0,0,P.length,j.length));return this._meshCache[S]=Oe,Oe}getMeshFrameDelta(e){return 2*Math.PI*c.bo/Math.pow(2,Math.max(e,0))/5}getMinTileElevationForLngLatZoom(e,o){var f;const{tileID:y}=this._getOverscaledTileIDFromLngLatZoom(e,o);return(f=this.getMinMaxElevation(y).minElevation)!==null&&f!==void 0?f:0}getMinMaxElevation(e){const o=this.getTerrainData(e).tile,f={minElevation:null,maxElevation:null};return o&&o.dem&&(f.minElevation=o.dem.min*this.exaggeration,f.maxElevation=o.dem.max*this.exaggeration),f}_getOverscaledTileIDFromLngLatZoom(e,o){const f=c.Y.fromLngLat(e.wrap()),y=(1<<o)*c.X,w=f.x*y,S=f.y*y,I=Math.floor(w/c.X),P=Math.floor(S/c.X);return{tileID:new c.S(o,0,o,I,P),mercatorX:w,mercatorY:S}}}class Ch{constructor(e,o,f){this._context=e,this._size=o,this._tileSize=f,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const e of this._objects)e.texture.destroy(),e.fbo.destroy()}_createObject(e){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),f=new je(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return f.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),this._context.extTextureFilterAnisotropic&&this._context.gl.texParameterf(this._context.gl.TEXTURE_2D,this._context.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,this._context.extTextureFilterAnisotropicMax),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(f.texture),{id:e,fbo:o,texture:f,stamp:-1,inUse:!1}}getObjectForId(e){return this._objects[e]}useObject(e){e.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(o=>e.id!==o),this._recentlyUsed.push(e.id)}stampObject(e){e.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const e=this._createObject(this._objects.length);return this._objects.push(e),e}freeObject(e){e.inUse=!1}freeAllObjects(){for(const e of this._objects)this.freeObject(e)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(e=>!e.inUse)===!1}}const gi={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class lr{constructor(e,o){this.painter=e,this.terrain=o,this.pool=new Ch(e.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(e){return this.pool.getObjectForId(e.rtt[this._stacks.length-1].id).texture}prepareForRender(e,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=e._order.filter(f=>!e._layers[f].isHidden(o)),this._coordsAscending={};for(const f in e.sourceCaches){this._coordsAscending[f]={};const y=e.sourceCaches[f].getVisibleCoordinates();for(const w of y){const S=this.terrain.sourceCache.getTerrainCoords(w);for(const I in S)this._coordsAscending[f][I]||(this._coordsAscending[f][I]=[]),this._coordsAscending[f][I].push(S[I])}}this._coordsAscendingStr={};for(const f of e._order){const y=e._layers[f],w=y.source;if(gi[y.type]&&!this._coordsAscendingStr[w]){this._coordsAscendingStr[w]={};for(const S in this._coordsAscending[w])this._coordsAscendingStr[w][S]=this._coordsAscending[w][S].map(I=>I.key).sort().join()}}for(const f of this._renderableTiles)for(const y in this._coordsAscendingStr){const w=this._coordsAscendingStr[y][f.tileID.key];w&&w!==f.rttCoords[y]&&(f.rtt=[])}}renderLayer(e,o){if(e.isHidden(this.painter.transform.zoom))return!1;const f=Object.assign(Object.assign({},o),{isRenderingToTexture:!0}),y=e.type,w=this.painter,S=this._renderableLayerIds[this._renderableLayerIds.length-1]===e.id;if(gi[y]&&(this._prevType&&gi[this._prevType]||this._stacks.push([]),this._prevType=y,this._stacks[this._stacks.length-1].push(e.id),!S))return!0;if(gi[this._prevType]||gi[y]&&S){this._prevType=y;const I=this._stacks.length-1,P=this._stacks[I]||[];for(const j of this._renderableTiles){if(this.pool.isFull()&&(Ec(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(j),j.rtt[I]){const Y=this.pool.getObjectForId(j.rtt[I].id);if(Y.stamp===j.rtt[I].stamp){this.pool.useObject(Y);continue}}const Z=this.pool.getOrCreateFreeObject();this.pool.useObject(Z),this.pool.stampObject(Z),j.rtt[I]={id:Z.id,stamp:Z.stamp},w.context.bindFramebuffer.set(Z.fbo.framebuffer),w.context.clear({color:c.b4.transparent,stencil:0}),w.currentStencilSource=void 0;for(let Y=0;Y<P.length;Y++){const H=w.style._layers[P[Y]],ee=H.source?this._coordsAscending[H.source][j.tileID.key]:[j.tileID];w.context.viewport.set([0,0,Z.fbo.width,Z.fbo.height]),w._renderTileClippingMasks(H,ee,!0),w.renderLayer(w,w.style.sourceCaches[H.source],H,ee,f),H.source&&(j.rttCoords[H.source]=this._coordsAscendingStr[H.source][j.tileID.key])}}return Ec(this.painter,this.terrain,this._rttTiles,f),this._rttTiles=[],this.pool.freeAllObjects(),gi[y]}return!1}}const $d={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"MapLibre logo","Map.Title":"Map","Marker.Title":"Map marker","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","Popup.Close":"Close popup","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","GlobeControl.Enable":"Enable globe","GlobeControl.Disable":"Disable globe","TerrainControl.Enable":"Enable terrain","TerrainControl.Disable":"Disable terrain","CooperativeGesturesHandler.WindowsHelpText":"Use Ctrl + scroll to zoom the map","CooperativeGesturesHandler.MacHelpText":"Use  + scroll to zoom the map","CooperativeGesturesHandler.MobileHelpText":"Use two fingers to move the map"},ta=A,Qi={hash:!1,interactive:!0,bearingSnap:7,attributionControl:ks,maplibreLogo:!1,refreshExpiredTiles:!0,canvasContextAttributes:{antialias:!1,preserveDrawingBuffer:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,desynchronized:!1,contextType:void 0},scrollZoom:!0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,trackResize:!0,center:[0,0],elevation:0,zoom:0,bearing:0,pitch:0,roll:0,renderWorldCopies:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:c.a.MAX_TILE_CACHE_ZOOM_LEVELS,transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,clickTolerance:3,localIdeographFontFamily:"sans-serif",pitchWithRotate:!0,rollEnabled:!1,validateStyle:!0,maxCanvasSize:[4096,4096],cancelPendingTileRequestsWhileZooming:!0,centerClampedToGround:!0},wu={showCompass:!0,showZoom:!0,visualizePitch:!1,visualizeRoll:!0};class Mc{constructor(e,o,f=!1){this.mousedown=w=>{this.startMove(w,V.mousePos(this.element,w)),V.addEventListener(window,"mousemove",this.mousemove),V.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=w=>{this.move(w,V.mousePos(this.element,w))},this.mouseup=w=>{this._rotatePitchHanlder.dragEnd(w),this.offTemp()},this.touchstart=w=>{w.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=V.touchPos(this.element,w.targetTouches)[0],this.startMove(w,this._startPos),V.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.addEventListener(window,"touchend",this.touchend))},this.touchmove=w=>{w.targetTouches.length!==1?this.reset():(this._lastPos=V.touchPos(this.element,w.targetTouches)[0],this.move(w,this._lastPos))},this.touchend=w=>{w.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this._rotatePitchHanlder.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10,this.element=o;const y=new kl;this._rotatePitchHanlder=new Ft({clickTolerance:3,move:(w,S)=>{const I=o.getBoundingClientRect(),P=new c.P((I.bottom-I.top)/2,(I.right-I.left)/2);return{bearingDelta:c.c7(new c.P(w.x,S.y),S,P),pitchDelta:f?-.5*(S.y-w.y):void 0}},moveStateManager:y,enable:!0,assignEvents:()=>{}}),this.map=e,V.addEventListener(o,"mousedown",this.mousedown),V.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),V.addEventListener(o,"touchcancel",this.reset)}startMove(e,o){this._rotatePitchHanlder.dragStart(e,o),V.disableDrag()}move(e,o){const f=this.map,{bearingDelta:y,pitchDelta:w}=this._rotatePitchHanlder.dragMove(e,o)||{};y&&f.setBearing(f.getBearing()+y),w&&f.setPitch(f.getPitch()+w)}off(){const e=this.element;V.removeEventListener(e,"mousedown",this.mousedown),V.removeEventListener(e,"touchstart",this.touchstart,{passive:!1}),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend),V.removeEventListener(e,"touchcancel",this.reset),this.offTemp()}offTemp(){V.enableDrag(),V.removeEventListener(window,"mousemove",this.mousemove),V.removeEventListener(window,"mouseup",this.mouseup),V.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),V.removeEventListener(window,"touchend",this.touchend)}}let Uo;function zl(b,e,o){const f=new c.N(b.lng,b.lat);if(b=new c.N(b.lng,b.lat),e){const y=new c.N(b.lng-360,b.lat),w=new c.N(b.lng+360,b.lat),S=o.locationToScreenPoint(b).distSqr(e);o.locationToScreenPoint(y).distSqr(e)<S?b=y:o.locationToScreenPoint(w).distSqr(e)<S&&(b=w)}for(;Math.abs(b.lng-o.center.lng)>180;){const y=o.locationToScreenPoint(b);if(y.x>=0&&y.y>=0&&y.x<=o.width&&y.y<=o.height)break;b.lng>o.center.lng?b.lng-=360:b.lng+=360}return b.lng!==f.lng&&o.isPointOnMapSurface(o.locationToScreenPoint(b))?b:f}const co={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Dc(b,e,o){const f=b.classList;for(const y in co)f.remove(`maplibregl-${o}-anchor-${y}`);f.add(`maplibregl-${o}-anchor-${e}`)}class Ic extends c.E{constructor(e){if(super(),this._onKeyPress=o=>{const f=o.code,y=o.charCode||o.keyCode;f!=="Space"&&f!=="Enter"&&y!==32&&y!==13||this.togglePopup()},this._onMapClick=o=>{const f=o.originalEvent.target,y=this._element;this._popup&&(f===y||y.contains(f))&&this.togglePopup()},this._update=o=>{var f;if(!this._map)return;const y=this._map.loaded()&&!this._map.isMoving();((o==null?void 0:o.type)==="terrain"||(o==null?void 0:o.type)==="render"&&!y)&&this._map.once("render",this._update),this._lngLat=this._map.transform.renderWorldCopies?zl(this._lngLat,this._flatPos,this._map.transform):(f=this._lngLat)===null||f===void 0?void 0:f.wrap(),this._flatPos=this._pos=this._map.project(this._lngLat)._add(this._offset),this._map.terrain&&(this._flatPos=this._map.transform.locationToScreenPoint(this._lngLat)._add(this._offset));let w="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?w=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(w=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let S="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?S="rotateX(0deg)":this._pitchAlignment==="map"&&(S=`rotateX(${this._map.getPitch()}deg)`),this._subpixelPositioning||o&&o.type!=="moveend"||(this._pos=this._pos.round()),V.setTransform(this._element,`${co[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${S} ${w}`),F.frameAsync(new AbortController).then(()=>{this._updateOpacity(o&&o.type==="moveend")}).catch(()=>{})},this._onMove=o=>{if(!this._isDragging){const f=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=f}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new c.k("dragstart"))),this.fire(new c.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new c.k("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._subpixelPositioning=e&&e.subpixelPositioning||!1,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment!=="auto"?e.pitchAlignment:this._rotationAlignment,this.setOpacity(),this.setOpacity(e==null?void 0:e.opacity,e==null?void 0:e.opacityWhenCovered),e&&e.element)this._element=e.element,this._offset=c.P.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=V.create("div");const o=V.createNS("http://www.w3.org/2000/svg","svg"),f=41,y=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${f}px`),o.setAttributeNS(null,"width",`${y}px`),o.setAttributeNS(null,"viewBox",`0 0 ${y} ${f}`);const w=V.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"stroke","none"),w.setAttributeNS(null,"stroke-width","1"),w.setAttributeNS(null,"fill","none"),w.setAttributeNS(null,"fill-rule","evenodd");const S=V.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"fill-rule","nonzero");const I=V.createNS("http://www.w3.org/2000/svg","g");I.setAttributeNS(null,"transform","translate(3.0, 29.0)"),I.setAttributeNS(null,"fill","#000000");const P=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const ge of P){const be=V.createNS("http://www.w3.org/2000/svg","ellipse");be.setAttributeNS(null,"opacity","0.04"),be.setAttributeNS(null,"cx","10.5"),be.setAttributeNS(null,"cy","5.80029008"),be.setAttributeNS(null,"rx",ge.rx),be.setAttributeNS(null,"ry",ge.ry),I.appendChild(be)}const j=V.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill",this._color);const Z=V.createNS("http://www.w3.org/2000/svg","path");Z.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),j.appendChild(Z);const Y=V.createNS("http://www.w3.org/2000/svg","g");Y.setAttributeNS(null,"opacity","0.25"),Y.setAttributeNS(null,"fill","#000000");const H=V.createNS("http://www.w3.org/2000/svg","path");H.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Y.appendChild(H);const ee=V.createNS("http://www.w3.org/2000/svg","g");ee.setAttributeNS(null,"transform","translate(6.0, 7.0)"),ee.setAttributeNS(null,"fill","#FFFFFF");const ie=V.createNS("http://www.w3.org/2000/svg","g");ie.setAttributeNS(null,"transform","translate(8.0, 8.0)");const me=V.createNS("http://www.w3.org/2000/svg","circle");me.setAttributeNS(null,"fill","#000000"),me.setAttributeNS(null,"opacity","0.25"),me.setAttributeNS(null,"cx","5.5"),me.setAttributeNS(null,"cy","5.5"),me.setAttributeNS(null,"r","5.4999962");const pe=V.createNS("http://www.w3.org/2000/svg","circle");pe.setAttributeNS(null,"fill","#FFFFFF"),pe.setAttributeNS(null,"cx","5.5"),pe.setAttributeNS(null,"cy","5.5"),pe.setAttributeNS(null,"r","5.4999962"),ie.appendChild(me),ie.appendChild(pe),S.appendChild(I),S.appendChild(j),S.appendChild(Y),S.appendChild(ee),S.appendChild(ie),o.appendChild(S),o.setAttributeNS(null,"height",f*this._scale+"px"),o.setAttributeNS(null,"width",y*this._scale+"px"),this._element.appendChild(o),this._offset=c.P.convert(e&&e.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",o=>{o.preventDefault()}),this._element.addEventListener("mousedown",o=>{o.preventDefault()}),Dc(this._element,this._anchor,"marker"),e&&e.className)for(const o of e.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(e){return this.remove(),this._map=e,this._element.setAttribute("aria-label",e._getUIString("Marker.Title")),e.getCanvasContainer().appendChild(this._element),e.on("move",this._update),e.on("moveend",this._update),e.on("terrain",this._update),e.on("projectiontransition",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("terrain",this._update),this._map.off("projectiontransition",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),V.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=c.N.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const y=Math.abs(13.5)/Math.SQRT2;e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}setSubpixelPositioning(e){return this._subpixelPositioning=e,this}getPopup(){return this._popup}togglePopup(){const e=this._popup;return this._element.style.opacity===this._opacityWhenCovered?this:e?(e.isOpen()?e.remove():(e.setLngLat(this._lngLat),e.addTo(this._map)),this):this}_updateOpacity(e=!1){var o,f;if(!(!((o=this._map)===null||o===void 0)&&o.terrain)){const Y=this._map.transform.isLocationOccluded(this._lngLat)?this._opacityWhenCovered:this._opacity;return void(this._element.style.opacity!==Y&&(this._element.style.opacity=Y))}if(e)this._opacityTimeout=null;else{if(this._opacityTimeout)return;this._opacityTimeout=setTimeout(()=>{this._opacityTimeout=null},100)}const y=this._map,w=y.terrain.depthAtPoint(this._pos),S=y.terrain.getElevationForLngLatZoom(this._lngLat,y.transform.tileZoom);if(y.transform.lngLatToCameraDepth(this._lngLat,S)-w<.006)return void(this._element.style.opacity=this._opacity);const I=-this._offset.y/y.transform.pixelsPerMeter,P=Math.sin(y.getPitch()*Math.PI/180)*I,j=y.terrain.depthAtPoint(new c.P(this._pos.x,this._pos.y-this._offset.y)),Z=y.transform.lngLatToCameraDepth(this._lngLat,S+P)-j>.006;!((f=this._popup)===null||f===void 0)&&f.isOpen()&&Z&&this._popup.remove(),this._element.style.opacity=Z?this._opacityWhenCovered:this._opacity}getOffset(){return this._offset}setOffset(e){return this._offset=c.P.convert(e),this._update(),this}addClassName(e){this._element.classList.add(e)}removeClassName(e){this._element.classList.remove(e)}toggleClassName(e){return this._element.classList.toggle(e)}setDraggable(e){return this._draggable=!!e,this._map&&(e?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e&&e!=="auto"?e:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}setOpacity(e,o){return e===void 0&&o===void 0&&(this._opacity="1",this._opacityWhenCovered="0.2"),e!==void 0&&(this._opacity=e),o!==void 0&&(this._opacityWhenCovered=o),this._map&&this._updateOpacity(!0),this}}const Mh={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let kc=0,Ol=!1;const Yd={maxWidth:100,unit:"metric"};function Dh(b,e,o){const f=o&&o.maxWidth||100,y=b._container.clientHeight/2,w=b._container.clientWidth/2,S=b.unproject([w-f/2,y]),I=b.unproject([w+f/2,y]),P=Math.round(b.project(I).x-b.project(S).x),j=Math.min(f,P,b._container.clientWidth),Z=S.distanceTo(I);if(o&&o.unit==="imperial"){const Y=3.2808*Z;Y>5280?ol(e,j,Y/5280,b._getUIString("ScaleControl.Miles")):ol(e,j,Y,b._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?ol(e,j,Z/1852,b._getUIString("ScaleControl.NauticalMiles")):Z>=1e3?ol(e,j,Z/1e3,b._getUIString("ScaleControl.Kilometers")):ol(e,j,Z,b._getUIString("ScaleControl.Meters"))}function ol(b,e,o,f){const y=function(w){const S=Math.pow(10,`${Math.floor(w)}`.length-1);let I=w/S;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(P){const j=Math.pow(10,Math.ceil(-Math.log(P)/Math.LN10));return Math.round(P*j)/j}(I),S*I}(o);b.style.width=e*(y/o)+"px",b.innerHTML=`${y}&nbsp;${f}`}const qd={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",subpixelPositioning:!1},Ih=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Tu(b){if(b){if(typeof b=="number"){const e=Math.round(Math.abs(b)/Math.SQRT2);return{center:new c.P(0,0),top:new c.P(0,b),"top-left":new c.P(e,e),"top-right":new c.P(-e,e),bottom:new c.P(0,-b),"bottom-left":new c.P(e,-e),"bottom-right":new c.P(-e,-e),left:new c.P(b,0),right:new c.P(-b,0)}}if(b instanceof c.P||Array.isArray(b)){const e=c.P.convert(b);return{center:e,top:e,"top-left":e,"top-right":e,bottom:e,"bottom-left":e,"bottom-right":e,left:e,right:e}}return{center:c.P.convert(b.center||[0,0]),top:c.P.convert(b.top||[0,0]),"top-left":c.P.convert(b["top-left"]||[0,0]),"top-right":c.P.convert(b["top-right"]||[0,0]),bottom:c.P.convert(b.bottom||[0,0]),"bottom-left":c.P.convert(b["bottom-left"]||[0,0]),"bottom-right":c.P.convert(b["bottom-right"]||[0,0]),left:c.P.convert(b.left||[0,0]),right:c.P.convert(b.right||[0,0])}}return Tu(new c.P(0,0))}const dp=A;g.AJAXError=c.cg,g.Event=c.k,g.Evented=c.E,g.LngLat=c.N,g.MercatorCoordinate=c.Y,g.Point=c.P,g.addProtocol=c.ch,g.config=c.a,g.removeProtocol=c.ci,g.AttributionControl=Gd,g.BoxZoomHandler=Fd,g.CanvasSource=xs,g.CooperativeGesturesHandler=pr,g.DoubleClickZoomHandler=os,g.DragPanHandler=ss,g.DragRotateHandler=Nn,g.EdgeInsets=Kr,g.FullscreenControl=class extends c.E{constructor(b={}){super(),this._onFullscreenChange=()=>{var e;let o=window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement;for(;!((e=o==null?void 0:o.shadowRoot)===null||e===void 0)&&e.fullscreenElement;)o=o.shadowRoot.fullscreenElement;o===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,b&&b.container&&(b.container instanceof HTMLElement?this._container=b.container:c.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(b){return this._map=b,this._container||(this._container=this._map.getContainer()),this._controlContainer=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){V.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const b=this._fullscreenButton=V.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);V.create("span","maplibregl-ctrl-icon",b).setAttribute("aria-hidden","true"),b.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const b=this._getTitle();this._fullscreenButton.setAttribute("aria-label",b),this._fullscreenButton.title=b}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new c.k("fullscreenstart")),this._prevCooperativeGesturesEnabled=this._map.cooperativeGestures.isEnabled(),this._map.cooperativeGestures.disable()):(this.fire(new c.k("fullscreenend")),this._prevCooperativeGesturesEnabled&&this._map.cooperativeGestures.enable())}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},g.GeoJSONSource=Co,g.GeolocateControl=class extends c.E{constructor(b){super(),this._onSuccess=e=>{if(this._map){if(this._isOutOfMapMaxBounds(e))return this._setErrorState(),this.fire(new c.k("outofmaxbounds",e)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=e,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(e),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(e),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new c.k("geolocate",e)),this._finish()}},this._updateCamera=e=>{const o=new c.N(e.coords.longitude,e.coords.latitude),f=e.coords.accuracy,y=this._map.getBearing(),w=c.e({bearing:y},this.options.fitBoundsOptions),S=ci.fromLngLat(o,f);this._map.fitBounds(S,w,{geolocateSource:!0})},this._updateMarker=e=>{if(e){const o=new c.N(e.coords.longitude,e.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=e.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=e=>{if(this._map){if(this.options.trackUserLocation)if(e.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(e.code===3&&Ol)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new c.k("error",e)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=()=>{this._map&&(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=V.create("button","maplibregl-ctrl-geolocate",this._container),V.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",this._geolocateButton.disabled=!0)},this._finishSetupUI=e=>{if(this._map){if(e===!1){c.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.disabled=!1,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=V.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ic({element:this._dotElement}),this._circleElement=V.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ic({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",()=>this.trigger()),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new c.k("trackuserlocationend")),this.fire(new c.k("userlocationlostfocus")))})}},this.options=c.e({},Mh,b)}onAdd(b){return this._map=b,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),function(){return c._(this,arguments,void 0,function*(e=!1){if(Uo!==void 0&&!e)return Uo;if(window.navigator.permissions===void 0)return Uo=!!window.navigator.geolocation,Uo;try{Uo=(yield window.navigator.permissions.query({name:"geolocation"})).state!=="denied"}catch{Uo=!!window.navigator.geolocation}return Uo})}().then(e=>this._finishSetupUI(e)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),V.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,kc=0,Ol=!1}_isOutOfMapMaxBounds(b){const e=this._map.getMaxBounds(),o=b.coords;return e&&(o.longitude<e.getWest()||o.longitude>e.getEast()||o.latitude<e.getSouth()||o.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const b=this._map.getBounds(),e=b.getSouthEast(),o=b.getNorthEast(),f=e.distanceTo(o),y=Math.ceil(this._accuracy/(f/this._map._container.clientHeight)*2);this._circleElement.style.width=`${y}px`,this._circleElement.style.height=`${y}px`}trigger(){if(!this._setup)return c.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new c.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":kc--,Ol=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new c.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new c.k("trackuserlocationstart")),this.fire(new c.k("userlocationfocus"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let b;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),kc++,kc>1?(b={maximumAge:6e5,timeout:0},Ol=!0):(b=this.options.positionOptions,Ol=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,b)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},g.GlobeControl=class{constructor(){this._toggleProjection=()=>{var b;const e=(b=this._map.getProjection())===null||b===void 0?void 0:b.type;this._map.setProjection(e!=="mercator"&&e?{type:"mercator"}:{type:"globe"}),this._updateGlobeIcon()},this._updateGlobeIcon=()=>{var b;this._globeButton.classList.remove("maplibregl-ctrl-globe"),this._globeButton.classList.remove("maplibregl-ctrl-globe-enabled"),((b=this._map.getProjection())===null||b===void 0?void 0:b.type)==="globe"?(this._globeButton.classList.add("maplibregl-ctrl-globe-enabled"),this._globeButton.title=this._map._getUIString("GlobeControl.Disable")):(this._globeButton.classList.add("maplibregl-ctrl-globe"),this._globeButton.title=this._map._getUIString("GlobeControl.Enable"))}}onAdd(b){return this._map=b,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._globeButton=V.create("button","maplibregl-ctrl-globe",this._container),V.create("span","maplibregl-ctrl-icon",this._globeButton).setAttribute("aria-hidden","true"),this._globeButton.type="button",this._globeButton.addEventListener("click",this._toggleProjection),this._updateGlobeIcon(),this._map.on("styledata",this._updateGlobeIcon),this._container}onRemove(){V.remove(this._container),this._map.off("styledata",this._updateGlobeIcon),this._globeButton.removeEventListener("click",this._toggleProjection),this._map=void 0}},g.Hash=yu,g.ImageSource=ar,g.KeyboardHandler=up,g.LngLatBounds=ci,g.LogoControl=Wi,g.Map=class extends rn{constructor(b){var e,o;c.cd.mark(c.ce.create);const f=Object.assign(Object.assign(Object.assign({},Qi),b),{canvasContextAttributes:Object.assign(Object.assign({},Qi.canvasContextAttributes),b.canvasContextAttributes)});if(f.minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>180)throw new Error("maxPitch must be less than or equal to 180");const y=new Ua,w=new xl;if(f.minZoom!==void 0&&y.setMinZoom(f.minZoom),f.maxZoom!==void 0&&y.setMaxZoom(f.maxZoom),f.minPitch!==void 0&&y.setMinPitch(f.minPitch),f.maxPitch!==void 0&&y.setMaxPitch(f.maxPitch),f.renderWorldCopies!==void 0&&y.setRenderWorldCopies(f.renderWorldCopies),super(y,w,{bearingSnap:f.bearingSnap}),this._idleTriggered=!1,this._crossFadingFactor=1,this._renderTaskQueue=new _a,this._controls=[],this._mapId=c.a1(),this._contextLost=I=>{I.preventDefault(),this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this.fire(new c.k("webglcontextlost",{originalEvent:I}))},this._contextRestored=I=>{this._setupPainter(),this.resize(),this._update(),this.fire(new c.k("webglcontextrestored",{originalEvent:I}))},this._onMapScroll=I=>{if(I.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._canvasContextAttributes=Object.assign({},f.canvasContextAttributes),this._trackResize=f.trackResize===!0,this._bearingSnap=f.bearingSnap,this._centerClampedToGround=f.centerClampedToGround,this._refreshExpiredTiles=f.refreshExpiredTiles===!0,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions===!0,this._collectResourceTiming=f.collectResourceTiming===!0,this._locale=Object.assign(Object.assign({},$d),f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this.cancelPendingTileRequestsWhileZooming=f.cancelPendingTileRequestsWhileZooming===!0,this._imageQueueHandle=Me.addThrottleControl(()=>this.isMoving()),this._requestManager=new Te(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let I=!1;const P=tl(j=>{this._trackResize&&!this._removed&&(this.resize(j),this.redraw())},50);this._resizeObserver=new ResizeObserver(j=>{I?P(j):I=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Wt(this,f),this._hash=f.hash&&new yu(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,elevation:f.elevation,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch,roll:f.roll}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,c.e({},f.fitBoundsOptions,{duration:0}))));const S=typeof f.style=="string"||((o=(e=f.style)===null||e===void 0?void 0:e.projection)===null||o===void 0?void 0:o.type)!=="globe";this.resize(null,S),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new Gd(typeof f.attributionControl=="boolean"?void 0:f.attributionControl)),f.maplibreLogo&&this.addControl(new Wi,f.logoPosition),this.on("style.load",()=>{if(S||this._resizeTransform(),this.transform.unmodified){const I=c.M(this.style.stylesheet,["center","zoom","bearing","pitch","roll"]);this.jumpTo(I)}}),this.on("data",I=>{this._update(I.dataType==="style"),this.fire(new c.k(`${I.dataType}data`,I))}),this.on("dataloading",I=>{this.fire(new c.k(`${I.dataType}dataloading`,I))}),this.on("dataabort",I=>{this.fire(new c.k("sourcedataabort",I))})}_getMapId(){return this._mapId}addControl(b,e){if(e===void 0&&(e=b.getDefaultPosition?b.getDefaultPosition():"top-right"),!b||!b.onAdd)return this.fire(new c.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=b.onAdd(this);this._controls.push(b);const f=this._controlPositions[e];return e.indexOf("bottom")!==-1?f.insertBefore(o,f.firstChild):f.appendChild(o),this}removeControl(b){if(!b||!b.onRemove)return this.fire(new c.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(b);return e>-1&&this._controls.splice(e,1),b.onRemove(this),this}hasControl(b){return this._controls.indexOf(b)>-1}calculateCameraOptionsFromTo(b,e,o,f){return f==null&&this.terrain&&(f=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(b,e,o,f)}resize(b,e=!0){const[o,f]=this._containerDimensions(),y=this._getClampedPixelRatio(o,f);if(this._resizeCanvas(o,f,y),this.painter.resize(o,f,y),this.painter.overLimit()){const S=this.painter.context.gl;this._maxCanvasSize=[S.drawingBufferWidth,S.drawingBufferHeight];const I=this._getClampedPixelRatio(o,f);this._resizeCanvas(o,f,I),this.painter.resize(o,f,I)}this._resizeTransform(e);const w=!this._moving;return w&&(this.stop(),this.fire(new c.k("movestart",b)).fire(new c.k("move",b))),this.fire(new c.k("resize",b)),w&&this.fire(new c.k("moveend",b)),this}_resizeTransform(b=!0){var e;const[o,f]=this._containerDimensions();this.transform.resize(o,f,b),(e=this._requestedCameraState)===null||e===void 0||e.resize(o,f,b)}_getClampedPixelRatio(b,e){const{0:o,1:f}=this._maxCanvasSize,y=this.getPixelRatio(),w=b*y,S=e*y;return Math.min(w>o?o/w:1,S>f?f/S:1)*y}getPixelRatio(){var b;return(b=this._overridePixelRatio)!==null&&b!==void 0?b:devicePixelRatio}setPixelRatio(b){this._overridePixelRatio=b,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(b){return this.transform.setMaxBounds(ci.convert(b)),this._update()}setMinZoom(b){if((b=b??-2)>=-2&&b<=this.transform.maxZoom)return this.transform.setMinZoom(b),this._update(),this.getZoom()<b&&this.setZoom(b),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(b){if((b=b??22)>=this.transform.minZoom)return this.transform.setMaxZoom(b),this._update(),this.getZoom()>b&&this.setZoom(b),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(b){if((b=b??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(b>=0&&b<=this.transform.maxPitch)return this.transform.setMinPitch(b),this._update(),this.getPitch()<b&&this.setPitch(b),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(b){if((b=b??60)>180)throw new Error("maxPitch must be less than or equal to 180");if(b>=this.transform.minPitch)return this.transform.setMaxPitch(b),this._update(),this.getPitch()>b&&this.setPitch(b),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(b){return this.transform.setRenderWorldCopies(b),this._update()}project(b){return this.transform.locationToScreenPoint(c.N.convert(b),this.style&&this.terrain)}unproject(b){return this.transform.screenPointToLocation(c.P.convert(b),this.terrain)}isMoving(){var b;return this._moving||((b=this.handlers)===null||b===void 0?void 0:b.isMoving())}isZooming(){var b;return this._zooming||((b=this.handlers)===null||b===void 0?void 0:b.isZooming())}isRotating(){var b;return this._rotating||((b=this.handlers)===null||b===void 0?void 0:b.isRotating())}_createDelegatedListener(b,e,o){if(b==="mouseenter"||b==="mouseover"){let f=!1;return{layers:e,listener:o,delegates:{mousemove:w=>{const S=e.filter(P=>this.getLayer(P)),I=S.length!==0?this.queryRenderedFeatures(w.point,{layers:S}):[];I.length?f||(f=!0,o.call(this,new sr(b,this,w.originalEvent,{features:I}))):f=!1},mouseout:()=>{f=!1}}}}if(b==="mouseleave"||b==="mouseout"){let f=!1;return{layers:e,listener:o,delegates:{mousemove:S=>{const I=e.filter(P=>this.getLayer(P));(I.length!==0?this.queryRenderedFeatures(S.point,{layers:I}):[]).length?f=!0:f&&(f=!1,o.call(this,new sr(b,this,S.originalEvent)))},mouseout:S=>{f&&(f=!1,o.call(this,new sr(b,this,S.originalEvent)))}}}}{const f=y=>{const w=e.filter(I=>this.getLayer(I)),S=w.length!==0?this.queryRenderedFeatures(y.point,{layers:w}):[];S.length&&(y.features=S,o.call(this,y),delete y.features)};return{layers:e,listener:o,delegates:{[b]:f}}}}_saveDelegatedListener(b,e){this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[b]=this._delegatedListeners[b]||[],this._delegatedListeners[b].push(e)}_removeDelegatedListener(b,e,o){if(!this._delegatedListeners||!this._delegatedListeners[b])return;const f=this._delegatedListeners[b];for(let y=0;y<f.length;y++){const w=f[y];if(w.listener===o&&w.layers.length===e.length&&w.layers.every(S=>e.includes(S))){for(const S in w.delegates)this.off(S,w.delegates[S]);return void f.splice(y,1)}}}on(b,e,o){if(o===void 0)return super.on(b,e);const f=typeof e=="string"?[e]:e,y=this._createDelegatedListener(b,f,o);this._saveDelegatedListener(b,y);for(const w in y.delegates)this.on(w,y.delegates[w]);return{unsubscribe:()=>{this._removeDelegatedListener(b,f,o)}}}once(b,e,o){if(o===void 0)return super.once(b,e);const f=typeof e=="string"?[e]:e,y=this._createDelegatedListener(b,f,o);for(const w in y.delegates){const S=y.delegates[w];y.delegates[w]=(...I)=>{this._removeDelegatedListener(b,f,o),S(...I)}}this._saveDelegatedListener(b,y);for(const w in y.delegates)this.once(w,y.delegates[w]);return this}off(b,e,o){return o===void 0?super.off(b,e):(this._removeDelegatedListener(b,typeof e=="string"?[e]:e,o),this)}queryRenderedFeatures(b,e){if(!this.style)return[];let o;const f=b instanceof c.P||Array.isArray(b),y=f?b:[[0,0],[this.transform.width,this.transform.height]];if(e=e||(f?{}:b)||{},y instanceof c.P||typeof y[0]=="number")o=[c.P.convert(y)];else{const w=c.P.convert(y[0]),S=c.P.convert(y[1]);o=[w,new c.P(S.x,w.y),S,new c.P(w.x,S.y),w]}return this.style.queryRenderedFeatures(o,e,this.transform)}querySourceFeatures(b,e){return this.style.querySourceFeatures(b,e)}setStyle(b,e){return(e=c.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&b?(this._diffStyle(b,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._updateStyle(b,e))}setTransformRequest(b){return this._requestManager.setTransformRequest(b),this}_getUIString(b){const e=this._locale[b];if(e==null)throw new Error(`Missing UI string '${b}'`);return e}_updateStyle(b,e){var o,f;if(e.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(b,e));const y=this.style&&e.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!b)),b?(this.style=new Ro(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof b=="string"?this.style.loadURL(b,e,y):this.style.loadJSON(b,e,y),this):((f=(o=this.style)===null||o===void 0?void 0:o.projection)===null||f===void 0||f.destroy(),delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Ro(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(b,e){if(typeof b=="string"){const o=this._requestManager.transformRequest(b,"Style");c.h(o,new AbortController).then(f=>{this._updateDiff(f.data,e)}).catch(f=>{f&&this.fire(new c.j(f))})}else typeof b=="object"&&this._updateDiff(b,e)}_updateDiff(b,e){try{this.style.setState(b,e)&&this._update(!0)}catch(o){c.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(b,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():c.w("There is no style added to the map.")}addSource(b,e){return this._lazyInitEmptyStyle(),this.style.addSource(b,e),this._update(!0)}isSourceLoaded(b){const e=this.style&&this.style.sourceCaches[b];if(e!==void 0)return e.loaded();this.fire(new c.j(new Error(`There is no source with ID '${b}'`)))}setTerrain(b){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),b){const e=this.style.sourceCaches[b.source];if(!e)throw new Error(`cannot load terrain, because there exists no source with ID: ${b.source}`);this.terrain===null&&e.reload();for(const o in this.style._layers){const f=this.style._layers[o];f.type==="hillshade"&&f.source===b.source&&c.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Nm(this.painter,e,b),this.painter.renderToTexture=new lr(this.painter,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._terrainDataCallback=o=>{o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==b.source||this._elevationFreeze||(this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))),this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0);return this.fire(new c.k("terrain",{terrain:b})),this}getTerrain(){var b,e;return(e=(b=this.terrain)===null||b===void 0?void 0:b.options)!==null&&e!==void 0?e:null}areTilesLoaded(){const b=this.style&&this.style.sourceCaches;for(const e in b){const o=b[e]._tiles;for(const f in o){const y=o[f];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}removeSource(b){return this.style.removeSource(b),this._update(!0)}getSource(b){return this.style.getSource(b)}addImage(b,e,o={}){const{pixelRatio:f=1,sdf:y=!1,stretchX:w,stretchY:S,content:I,textFitWidth:P,textFitHeight:j}=o;if(this._lazyInitEmptyStyle(),!(e instanceof HTMLImageElement||c.b(e))){if(e.width===void 0||e.height===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Z,height:Y,data:H}=e,ee=e;return this.style.addImage(b,{data:new c.R({width:Z,height:Y},new Uint8Array(H)),pixelRatio:f,stretchX:w,stretchY:S,content:I,textFitWidth:P,textFitHeight:j,sdf:y,version:0,userImage:ee}),ee.onAdd&&ee.onAdd(this,b),this}}{const{width:Z,height:Y,data:H}=F.getImageData(e);this.style.addImage(b,{data:new c.R({width:Z,height:Y},H),pixelRatio:f,stretchX:w,stretchY:S,content:I,textFitWidth:P,textFitHeight:j,sdf:y,version:0})}}updateImage(b,e){const o=this.style.getImage(b);if(!o)return this.fire(new c.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const f=e instanceof HTMLImageElement||c.b(e)?F.getImageData(e):e,{width:y,height:w,data:S}=f;if(y===void 0||w===void 0)return this.fire(new c.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(y!==o.data.width||w!==o.data.height)return this.fire(new c.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const I=!(e instanceof HTMLImageElement||c.b(e));return o.data.replace(S,I),this.style.updateImage(b,o),this}getImage(b){return this.style.getImage(b)}hasImage(b){return b?!!this.style.getImage(b):(this.fire(new c.j(new Error("Missing required image id"))),!1)}removeImage(b){this.style.removeImage(b)}loadImage(b){return Me.getImage(this._requestManager.transformRequest(b,"Image"),new AbortController)}listImages(){return this.style.listImages()}addLayer(b,e){return this._lazyInitEmptyStyle(),this.style.addLayer(b,e),this._update(!0)}moveLayer(b,e){return this.style.moveLayer(b,e),this._update(!0)}removeLayer(b){return this.style.removeLayer(b),this._update(!0)}getLayer(b){return this.style.getLayer(b)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(b,e,o){return this.style.setLayerZoomRange(b,e,o),this._update(!0)}setFilter(b,e,o={}){return this.style.setFilter(b,e,o),this._update(!0)}getFilter(b){return this.style.getFilter(b)}setPaintProperty(b,e,o,f={}){return this.style.setPaintProperty(b,e,o,f),this._update(!0)}getPaintProperty(b,e){return this.style.getPaintProperty(b,e)}setLayoutProperty(b,e,o,f={}){return this.style.setLayoutProperty(b,e,o,f),this._update(!0)}getLayoutProperty(b,e){return this.style.getLayoutProperty(b,e)}setGlyphs(b,e={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(b,e),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(b,e,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(b,e,o,f=>{f||this._update(!0)}),this}removeSprite(b){return this._lazyInitEmptyStyle(),this.style.removeSprite(b),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(b,e={}){return this._lazyInitEmptyStyle(),this.style.setSprite(b,e,o=>{o||this._update(!0)}),this}setLight(b,e={}){return this._lazyInitEmptyStyle(),this.style.setLight(b,e),this._update(!0)}getLight(){return this.style.getLight()}setSky(b,e={}){return this._lazyInitEmptyStyle(),this.style.setSky(b,e),this._update(!0)}getSky(){return this.style.getSky()}setFeatureState(b,e){return this.style.setFeatureState(b,e),this._update()}removeFeatureState(b,e){return this.style.removeFeatureState(b,e),this._update()}getFeatureState(b){return this.style.getFeatureState(b)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let b=0,e=0;return this._container&&(b=this._container.clientWidth||400,e=this._container.clientHeight||300),[b,e]}_setupContainer(){const b=this._container;b.classList.add("maplibregl-map");const e=this._canvasContainer=V.create("div","maplibregl-canvas-container",b);this._interactive&&e.classList.add("maplibregl-interactive"),this._canvas=V.create("canvas","maplibregl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex",this._interactive?"0":"-1"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),f=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],f);const y=this._controlContainer=V.create("div","maplibregl-control-container",b),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(S=>{w[S]=V.create("div",`maplibregl-ctrl-${S} `,y)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(b,e,o){this._canvas.width=Math.floor(o*b),this._canvas.height=Math.floor(o*e),this._canvas.style.width=`${b}px`,this._canvas.style.height=`${e}px`}_setupPainter(){const b=Object.assign(Object.assign({},this._canvasContextAttributes),{alpha:!0,depth:!0,stencil:!0,premultipliedAlpha:!0});let e=null;this._canvas.addEventListener("webglcontextcreationerror",f=>{e={requestedAttributes:b},f&&(e.statusMessage=f.statusMessage,e.type=f.type)},{once:!0});let o=null;if(o=this._canvasContextAttributes.contextType?this._canvas.getContext(this._canvasContextAttributes.contextType,b):this._canvas.getContext("webgl2",b)||this._canvas.getContext("webgl",b),!o){const f="Failed to initialize WebGL";throw e?(e.message=f,new Error(JSON.stringify(e))):new Error(f)}this.painter=new Bd(o,this.transform),$.testSupport(o)}migrateProjection(b,e){super.migrateProjection(b,e),this.painter.transform=b,this.fire(new c.k("projectiontransition",{newProjection:this.style.projection.name}))}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(b){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||b,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(b){return this._update(),this._renderTaskQueue.add(b)}_cancelRenderFrame(b){this._renderTaskQueue.remove(b)}_render(b){var e,o,f,y,w;const S=this._idleTriggered?this._fadeDuration:0,I=((e=this.style.projection)===null||e===void 0?void 0:e.transitionState)>0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(b),this._removed)return;let P=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const Y=this.transform.zoom,H=F.now();this.style.zoomHistory.update(Y,H);const ee=new c.z(Y,{now:H,fadeDuration:S,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ie=ee.crossFadingFactor();ie===1&&ie===this._crossFadingFactor||(P=!0,this._crossFadingFactor=ie),this.style.update(ee)}const j=((o=this.style.projection)===null||o===void 0?void 0:o.transitionState)>0!==I;(f=this.style.projection)===null||f===void 0||f.setErrorQueryLatitudeDegrees(this.transform.center.lat),this.transform.setTransitionState((y=this.style.projection)===null||y===void 0?void 0:y.transitionState,(w=this.style.projection)===null||w===void 0?void 0:w.latitudeErrorCorrectionRadians),this.style&&(this._sourcesDirty||j)&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.setMinElevationForCurrentTile(this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),!this._elevationFreeze&&this._centerClampedToGround&&this.transform.setElevation(this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform.setMinElevationForCurrentTile(0),this._centerClampedToGround&&this.transform.setElevation(0)),this._placementDirty=this.style&&this.style._updatePlacement(this.transform,this.showCollisionBoxes,S,this._crossSourceCollisions,j),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:S,showPadding:this.showPadding}),this.fire(new c.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,c.cd.mark(c.ce.load),this.fire(new c.k("load"))),this.style&&(this.style.hasTransitions()||P)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const Z=this._sourcesDirty||this._styleDirty||this._placementDirty;return Z||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new c.k("idle")),!this._loaded||this._fullyLoaded||Z||(this._fullyLoaded=!0,c.cd.mark(c.ce.fullLoad)),this}redraw(){return this.style&&(this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._render(0)),this}remove(){var b;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frameRequest&&(this._frameRequest.abort(),this._frameRequest=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),Me.removeThrottleControl(this._imageQueueHandle),(b=this._resizeObserver)===null||b===void 0||b.disconnect();const e=this.painter.context.gl.getExtension("WEBGL_lose_context");e!=null&&e.loseContext&&e.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),V.remove(this._canvasContainer),V.remove(this._controlContainer),this._container.removeEventListener("scroll",this._onMapScroll,!1),this._container.classList.remove("maplibregl-map"),c.cd.clearMetrics(),this._removed=!0,this.fire(new c.k("remove"))}triggerRepaint(){this.style&&!this._frameRequest&&(this._frameRequest=new AbortController,F.frame(this._frameRequest,b=>{c.cd.frame(b),this._frameRequest=null;try{this._render(b)}catch(e){if(!c.cf(e)&&!function(o){return o.message===pu}(e))throw e}},()=>{}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(b){this._showTileBoundaries!==b&&(this._showTileBoundaries=b,this._update())}get showPadding(){return!!this._showPadding}set showPadding(b){this._showPadding!==b&&(this._showPadding=b,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(b){this._showCollisionBoxes!==b&&(this._showCollisionBoxes=b,b?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(b){this._showOverdrawInspector!==b&&(this._showOverdrawInspector=b,this._update())}get repaint(){return!!this._repaint}set repaint(b){this._repaint!==b&&(this._repaint=b,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(b){this._vertices=b,this._update()}get version(){return ta}getCameraTargetElevation(){return this.transform.elevation}getProjection(){return this.style.getProjection()}setProjection(b){return this._lazyInitEmptyStyle(),this.style.setProjection(b),this._update(!0)}},g.MapMouseEvent=sr,g.MapTouchEvent=Bo,g.MapWheelEvent=jo,g.Marker=Ic,g.NavigationControl=class{constructor(b){this._updateZoomButtons=()=>{const e=this._map.getZoom(),o=e===this._map.getMaxZoom(),f=e===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=f,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",f.toString())},this._rotateCompassArrow=()=>{this._compassIcon.style.transform=this.options.visualizePitch&&this.options.visualizeRoll?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateZ(${-this._map.transform.roll}deg) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitchInRadians),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${-this._map.transform.bearing}deg)`:this.options.visualizeRoll?`rotate(${-this._map.transform.bearing-this._map.transform.roll}deg)`:`rotate(${-this._map.transform.bearing}deg)`},this._setButtonTitle=(e,o)=>{const f=this._map._getUIString(`NavigationControl.${o}`);e.title=f,e.setAttribute("aria-label",f)},this.options=c.e({},wu,b),this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",e=>this._map.zoomIn({},{originalEvent:e})),V.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",e=>this._map.zoomOut({},{originalEvent:e})),V.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",e=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:e}):this._map.resetNorth({},{originalEvent:e})}),this._compassIcon=V.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(b){return this._map=b,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.on("roll",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Mc(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){V.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this.options.visualizeRoll&&this._map.off("roll",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(b,e){const o=V.create("button",b,this._container);return o.type="button",o.addEventListener("click",e),o}},g.Popup=class extends c.E{constructor(b){super(),this.remove=()=>(this._content&&V.remove(this._content),this._container&&(V.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),this._map._canvasContainer.classList.remove("maplibregl-track-pointer"),delete this._map,this.fire(new c.k("close"))),this),this._onMouseUp=e=>{this._update(e.point)},this._onMouseMove=e=>{this._update(e.point)},this._onDrag=e=>{this._update(e.point)},this._update=e=>{var o;if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=V.create("div","maplibregl-popup",this._map.getContainer()),this._tip=V.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const I of this.options.className.split(" "))this._container.classList.add(I);this._closeButton&&this._closeButton.setAttribute("aria-label",this._map._getUIString("Popup.Close")),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._lngLat=this._map.transform.renderWorldCopies&&!this._trackPointer?zl(this._lngLat,this._flatPos,this._map.transform):(o=this._lngLat)===null||o===void 0?void 0:o.wrap(),this._trackPointer&&!e)return;const f=this._flatPos=this._pos=this._trackPointer&&e?e:this._map.project(this._lngLat);this._map.terrain&&(this._flatPos=this._trackPointer&&e?e:this._map.transform.locationToScreenPoint(this._lngLat));let y=this.options.anchor;const w=Tu(this.options.offset);if(!y){const I=this._container.offsetWidth,P=this._container.offsetHeight;let j;j=f.y+w.bottom.y<P?["top"]:f.y>this._map.transform.height-P?["bottom"]:[],f.x<I/2?j.push("left"):f.x>this._map.transform.width-I/2&&j.push("right"),y=j.length===0?"bottom":j.join("-")}let S=f.add(w[y]);this.options.subpixelPositioning||(S=S.round()),V.setTransform(this._container,`${co[y]} translate(${S.x}px,${S.y}px)`),Dc(this._container,y,"popup")},this._onClose=()=>{this.remove()},this.options=c.e(Object.create(qd),b)}addTo(b){return this._map&&this.remove(),this._map=b,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new c.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(b){return this._lngLat=c.N.convert(b),this._pos=null,this._flatPos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._flatPos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(b){return this.setDOMContent(document.createTextNode(b))}setHTML(b){const e=document.createDocumentFragment(),o=document.createElement("body");let f;for(o.innerHTML=b;f=o.firstChild,f;)e.appendChild(f);return this.setDOMContent(e)}getMaxWidth(){var b;return(b=this._container)===null||b===void 0?void 0:b.style.maxWidth}setMaxWidth(b){return this.options.maxWidth=b,this._update(),this}setDOMContent(b){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=V.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(b),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(b){return this._container&&this._container.classList.add(b),this}removeClassName(b){return this._container&&this._container.classList.remove(b),this}setOffset(b){return this.options.offset=b,this._update(),this}toggleClassName(b){if(this._container)return this._container.classList.toggle(b)}setSubpixelPositioning(b){this.options.subpixelPositioning=b}_createCloseButton(){this.options.closeButton&&(this._closeButton=V.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const b=this._container.querySelector(Ih);b&&b.focus()}},g.RasterDEMTileSource=eo,g.RasterTileSource=kr,g.ScaleControl=class{constructor(b){this._onMove=()=>{Dh(this._map,this._container,this.options)},this.setUnit=e=>{this.options.unit=e,Dh(this._map,this._container,this.options)},this.options=Object.assign(Object.assign({},Yd),b)}getDefaultPosition(){return"bottom-left"}onAdd(b){return this._map=b,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-scale",b.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){V.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},g.ScrollZoomHandler=Pl,g.Style=Ro,g.TerrainControl=class{constructor(b){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.Disable")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.Enable"))},this.options=b}onAdd(b){return this._map=b,this._container=V.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=V.create("button","maplibregl-ctrl-terrain",this._container),V.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){V.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},g.TwoFingersTouchPitchHandler=al,g.TwoFingersTouchRotateHandler=Vd,g.TwoFingersTouchZoomHandler=Nl,g.TwoFingersTouchZoomRotateHandler=mi,g.VectorTileSource=Xr,g.VideoSource=ja,g.addSourceType=(b,e)=>c._(void 0,void 0,void 0,function*(){if(Wr(b))throw new Error(`A source type called "${b}" already exists.`);((o,f)=>{Wo[o]=f})(b,e)}),g.clearPrewarmedResources=function(){const b=Tt;b&&(b.isPreloaded()&&b.numActive()===1?(b.release(ut),Tt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},g.createTileMesh=Jo,g.getMaxParallelImageRequests=function(){return c.a.MAX_PARALLEL_IMAGE_REQUESTS},g.getRTLTextPluginStatus=function(){return Ea().getRTLTextPluginStatus()},g.getVersion=function(){return dp},g.getWorkerCount=function(){return Bt.workerCount},g.getWorkerUrl=function(){return c.a.WORKER_URL},g.importScriptInWorkers=function(b){return dn().broadcast("IS",b)},g.prewarm=function(){qt().acquire(ut)},g.setMaxParallelImageRequests=function(b){c.a.MAX_PARALLEL_IMAGE_REQUESTS=b},g.setRTLTextPlugin=function(b,e){return Ea().setRTLTextPlugin(b,e)},g.setWorkerCount=function(b){Bt.workerCount=b},g.setWorkerUrl=function(b){c.a.WORKER_URL=b}});var v=a;return v})}(E0)),E0.exports}var nT=XS();const iT=fm(nT),rT=sS({__proto__:null,default:iT},[nT]),WS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/xJREFUeNrUWn9QFPcV/+zeD1ARz6DmxHRqJs1MUiedE7QxaZJ6UWKgpMIUBeSAAzOmtp0gyV9x0uHMpG2aTsexaU2qyIEx5g9rsLGE2hq5YJoAGrnE5iypoxdFSRDDaUlAudvt2709+mXdgzvYw2Zn3ux397779vPe573ve/sFThRFJOpoPv6BrDx7SSaXqHcYE6W4aP161z2LMyKXroaXt7vieb58409GxuSAqPN4JO5wnew8ERnXJJyBTG5R3A8PPezDtbtooAQIxyljSVJI50DlltaT+2s8Pbtw9/1L9/31ox1r5JgSw5L5VeXNCaEhuw9DdymAxzhOpNT5LMGFmP6oHz0dswvoluSlj6csBwIbfNF/DIUdyR7sNZ+MtXRdlJTrx2A34LccwaOWDa6mjh1r5N/N+hiQkByQwEt5PHc58uf32LB5kRuGGUBP4HSBIRmLdH2X7uCTUCgMoXzu95F/63kbaota0HbqHYjDwDkrsfCdDa6EGzD4oA/9lb74lZlRSHFUaM1BzvzPbWh4vAWp0y0IDQHDVwBTKvDpZ6dkFtambtbfgMEHfPii3IfBO+JXxJlQRDWxZA55Xuiy4HeFjXh+XzX2v1ePF8vdeCTNiaEe4GL6Uay653GX7kl8uSzs8YmUTAk8nUrS7kXuctGJvLxyuA9vw1vn69F8sV6e80KxG5v3AS3Bepw701VwaqB2UQYqP77pOcAZCTx5Pu27yH3Y7MQzP9gK33kvnl27FXdabDDNAp77RwXeaK9H6feq5HC60t+vGwv8pMEDxXMeIvAmAv/YVjhesuNXb1bLRjgyqnB/ap68ZP6iswIbD9kx/H46vkXW5th+XHBzDTCgmGK+OH01fmjqs6D0gapwLaDVJj/TidvSFsrXv3c0oujuTTDPBc63BZpmiHMaB05TkWtrk/odl245EJ/rUQwB6+atRO7VfxJoMYCK3Xa4y1rw2lMt8pTS7XacueZFa/ef0cv50ft3vE239/bwH+29TVgiMj2Sa2oZ4LBOChvrKuSm99nw+tpOZM93YmAogPI/2tF92R+eRpqTbgWOmw+g/ZD3sCjgVXp2r6Jli9To6cFCvAaskxLWuhKPSWGwfOFqzJxmwc9W1eDQprNw3FuFjS/ny0b8wdkIg4mq70E00zMNnAENESXHjHUs6JqpMUCUwTsoYXOsl2xwrXBj97vb5Fgv+a0dFwh0xYpNOPhsJw6fPIDqg/nobcW7lCd7Kdn3aGjUhYXYDBBGwGen99rgLm9Be9c7GDQHsL+tHq893SIzsfLF21H1p3y80bsNxzzeo9Tw1fEmTfC4w2rVhYVxDRBDKCEvOuatQPaCALUHT4TbA+E6PUxLwHbPFpmFn7rzEbIG8EmKB35P4AjFfC31Re5x1E+ahTENEINwkOfLqKvMFs9a8FLx6PYg+5tOXLzqR/u/PSh4sBzm2cCFAzhMjDVQv7M7lq+2ybIw1jLqICm75T5kLRXyUPqjKjS0htuDt/zh9uDXJeRgCpDfeKpxOdmPi39DKxn8qnFGTOBZFmqU7+C4v52jMeCgEHCkPYSsrJlO/LLAje4+P9o+8SCD6EiftRA/b6b2gOLfaa+CH16caQ60Usy74wQ/aRa0GCiVEnb+ajwy0AU88+RWOWwkA15Y58a3v2HD1a8CKNixGM+9X4HZ1HleOoI2yhM39T31E8zFCbOgZqBUVMAPX6ViRD2MtKZL8f7KxkY0tjdgcfVsOYklFpIXAKebAkeFEHZOAvykWGAZKJNCZ0EesoQg/TA9XE2feNOO2w029PcH8K8LXpkFqVH7cMCDS014j9rvenMa6nToy0axEGuLYWQKVal0utBIqwjbOHABA3efd/lfqNKm0lp/qtsrF6m+Vpyg1aaOmjQ9wEdYqIm3RxoxgEIn64YfiYXgAN4eTAqgco8dKbwFH35Jnm9FJ9WHV5LnYZfOn9QjLGQsWxYTC/wY1TdSCwwGMuRTgxddVKR6j6CDWubtBH5nInbz4s0FPhp46ctJHpIBUi5IRercHnTQUlmbbEVtArckR6pzLAwYtTasgl8qO3CfhT9dpJbhbC2OUUbUchx2yve5cJLLZwNNSiZlM4H+E8AXbTe+6JZlAH2IycealM265cJoBmj1Cf5HCZ//iYHAH6dRLSX6DWEjATfPCTPEG6eeBZ4Ff/0K4Q3dILwYBr5jFHXT6INlHgmBl/r+m5ULXKL+wFG0fr0uy6r0NwZakbZkL8l0TdneqB6Hqr2umdLN3USsSM3HP3B97QyIhYX/dwbGZSGerdB4t025kS5rYluuI0dhZWVISWbkLF3CM3rHZYDTEF7elwuLtPKbFDErkqQSWnCRHINozZOeNwuC8HyEhab2DhfrIG4cT/Mq4KwB6ntaczlGHxflHaJqLColNHIOSVWKWAgwLBgj3ZqWUvbFBgawUeV59trAzNUykNMIKzEK4BQF9DDJDIWZaco9L0mvMhagUo4onjYxgM1MuBhVwhrLq3SxHk5hGhUx4mFG+hTw15RzRILK3IjI+oxjxD6vwcBYLLCeVzXlozzdx4AIqkBeVwGOiKAyeiT0jFE3EkfHIBsKESVBBrza25zqRYJKgkyYhFQeDqrAChp5oplMXJQw4jW8zGskrjrGoRHfAuMU9hwJJTYvNAGPteJojfkxViOtHFK/VFAZAgawqGJ7XLDxFCcuyjUXR1ESo5wRq3f1rK4TraSJ+2ck5fivAAMAmdk6fQJV/ZUAAAAASUVORK5CYII=",QS="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAxCAYAAACcXioiAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAB/pJREFUeNrUWnlMFFcY/2b2YLlFvKp44J0YW6vYmoqNq60W22oieF9BShBQa4sH/qGMxkRN1ApRBOQQ1qpNGpOmNcYERVKtCohH69l61pNDFkVgYXem3xtmyHM6y+7CrrQv+fJmd2fe+/2+3/e+d8wygiCAp8rxsoti4xFhYxhP9aH1VMNzY2K4ke+Plj9y+fvSOVeeXxKf0HqNDrB7HwueK9zvl8rl6xRPdcLIIcR+GA/gYjiteHJRNOIFRvIGQ9nq6Ghu1L17KR+bzeA9duyPPfbvn8Xj96QXUidHR3eOAokI+kZZFizHuq2yMy/v+nv378NHsbHgdedOFH41wt0KuEQgHgH/gcATHACXymz09OyIpCQQnjyB3gMGwPPYWK5TBnEcAo6XQsXJIoLvm5oaab19G+OJgcD+/cGruDgK2xhhA7j2VhSIRdBl6PE45zwulzlmgEV9d++ObLp1CwSbDQSeB1tDA4T26wfP3KyCKoEYBHwegce6BlwETzw/cteuLxqvXQPeagUewRMCQl0d6JEAf+NmlAZVGMDz7g+haAQcoxIqvNEIjroLKiqaa2PZuSGbNs2oLC3FqGFAr9eDDk2D12KGQxUGDx4Ed4cN4/oAzHKrAqdLM0UC7SldEDzPsvN6JifPqKisBO2SJaBZvBheBgZCI4IWZG83NoI/jgX+1q2oxyw74q1nIbUSIIHvtXbt9KraWnhnyxZofvUKtD17Qsh338Hrrl2hCUOJDGSiCoOEas018CzmK67TCfgjeIFh5vXfsGF6TX09hGzdCk8LCuC1yQRVHAfVJ05AcGIiNDY1ieAJiZ8OH4bnYWOhIi4uqlMJ+BYVzeMZZn6/9eunV2CqtGGskxI8ZQqAjw94e3nBy5MnQd+rlziQtcHBcD019ZeKoKCjPyOX8vPnyWzLdQoBbwIe12tDN2780owzbY9du4Dp3h1u46RFAPfavBmqm5shaMYMMBcWgk+3bnCF447hM4fHX70aSTWV8tYJGIqK5gssu2DgmjXTn12+DBZMj48QcJ/4ePAZNKiVxPD8fPDCcWBDFf7MzCzEyeswPn5IamYTWei5QwWXCOgRPA7YBYOTkj6vJhkF41w3cybw3t5wd+NGCElIEEn8tXo1NNy5A+YdO+DhgQPFvMVSAEbj93I7R3JyOHep4DQBbQv4haGJidOqLBZoxhj3RrA9kEDvZctgCIYRKf3XroUATJW2rCz422QqttXX57ATJ5pUmnSLCk4RYCXwgxISIipxadATUyXJKHfXrBF/rzh6FK5HRsJjJFF16BAYKirgenb2KWtDQ45OHbzbVHCGwAIEv2jIsmUi+L7btsGj9HRxZjVg5nmYnCyGTtcJE8Dr5k3wLSmBaxkZp21Wa77BaDQ5aLvDKjgisBAzx4JRK1d+9lKrhb7bt4P57Fmox/gOwZjXhYYC8+IFPFi3DgImTwZfnLQupKUV2iyWPJ+JEwuc2bV1VAXWEfiwVasizI8fA//gAdQi+OCpU2Hozp2iCjU4UXXBXVVgeDhY0tKgNDf3V3zG5G80FriAoUMqsG2AX/gBer7m0SPxJoNOB3UImsyuGj8/8aYeq1aB18CBwBcXQ5nJdKYZY76La+A7rIIagUUIftG45cun1uBOCqQlgFajAT9Ml68zMkQSJNuQlFmLy4fygwcvNDc15XabNCm/nWOx3SpoVcAvDE9MnFKHsa3DVNmy9WfE5YAGzR9J1GVmAlRXg/XUKSg/cqQEU2VWH6MxryMnGJT3UxSqOK3AYuL58Pj4KVbM8wZfXzDgmobUeoMBNKgAIaJhWQhAEn5nzsA59LylBXyuG9Zl7VKhVQECXtwX7NtXqLwpPC7uE5COSkgJxLXND2lpv+Hn3MGTJuU4vW9A07lZhVYCuF/6VPmjdH5TSJ8XBQQFwaG0tHN4mYua5NzDMNJKDYlGVMJathVo5fh8En7/rXMqiCRGjxvHOUPCbhrFxRfUY8eNgqBlJAIEfMGePefxNxIydj1/Ge1rtPH4XLlrh2UuZyRVAs1oZgKe7AJbHAm+mDrz9u4tQUVyEVK2vQavoH2Dz15q/6Fx61holwIWtErs3CJdo2k0OAtnp6eXIvhshLVfrSE/DJGBaE/ccKbqigpvECAef4rgm7CmTJOVnl5mD3wAgh6ONoSo5L7jHqdVaCXQgPbw3+CJsXwL8Kw3MgqCfheNHC34e+Bk21kVGE+94JgbE+MOEinkHQNmpE0RYWM4jxyreKooJrMUj50Lebi0joXjZRe5/x0BZ1T4ryvgUAVX3h66+qaRoVYkHXpLOWfpUps0mGHa2DCWatehAoyKsdRSRyutz4jpJfNSmDfZDzlhaveR5/W4lN8iq3DsQglHO4hx4GlWAZwmoPxO7V6Gao+x04eguJbfAco1WZZZUQUzpYJW+k21UbpjDQVYq/A8/VlD3atGkFEJK8EOYD8JdLM0uXtLZpPWiRXSNQ+KxsGOp3UUYD0VLlqF0WSVb15pD/tJncugRQ9TViWBt0i1bFbpXtnE9uwRYBWe1imA6yli8n205xkV4AIF3EYBp0E2KQDLxitIt4ZeWwrQoaGjiGioWqMSLnI7wpv7ojfMSoWJTeFhqwIsrzJOVAcTYyeMWEWM07HeVoyDSnzTCtC1HEr0uFAF3FbGUbtm28hGagoqO+UVRIACLCjCyyFYVyYnxs5nxoVJSbBTg7Pedefs2t6Z1HN/RpLKPwIMAC/3eXOsFYGMAAAAAElFTkSuQmCC";class gg extends Error{constructor(a,h){const p=`${gg.extractMessage(a)}: ${JSON.stringify({response:a,request:h})}`;super(p);qp(this,"response");qp(this,"request");Object.setPrototypeOf(this,gg.prototype),this.response=a,this.request=h,typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,gg)}static extractMessage(a){var h,p;return((p=(h=a.errors)==null?void 0:h[0])==null?void 0:p.message)??`GraphQL Error (Code: ${String(a.status)})`}}const g1=i=>i.toUpperCase(),$v=i=>typeof i=="function"?i():i,aT=(i,n)=>i.map((a,h)=>[a,n[h]]),cg=i=>{let n={};return i instanceof Headers?n=KS(i):Array.isArray(i)?i.forEach(([a,h])=>{a&&h!==void 0&&(n[a]=h)}):i&&(n=i),n},KS=i=>{const n={};return i.forEach((a,h)=>{n[h]=a}),n},JS=i=>{try{const n=i();return eA(n)?n.catch(a=>y1(a)):n}catch(n){return y1(n)}},y1=i=>i instanceof Error?i:new Error(String(i)),eA=i=>typeof i=="object"&&i!==null&&"then"in i&&typeof i.then=="function"&&"catch"in i&&typeof i.catch=="function"&&"finally"in i&&typeof i.finally=="function",Xb=i=>{throw new Error(`Unhandled case: ${String(i)}`)},S0=i=>typeof i=="object"&&i!==null&&!Array.isArray(i),tA=(i,n)=>i.documents?i:{documents:i,requestHeaders:n,signal:void 0},nA=(i,n,a)=>i.query?i:{query:i,variables:n,requestHeaders:a,signal:void 0};function Ri(i,n){if(!!!i)throw new Error(n)}function ld(i){return typeof i=="object"&&i!==null}function tv(i,n){if(!!!i)throw new Error(n??"Unexpected invariant triggered.")}const iA=/\r\n|[\n\r]/g;function gb(i,n){let a=0,h=1;for(const p of i.body.matchAll(iA)){if(typeof p.index=="number"||tv(!1),p.index>=n)break;a=p.index+p[0].length,h+=1}return{line:h,column:n+1-a}}function rA(i){return oT(i.source,gb(i.source,i.start))}function oT(i,n){const a=i.locationOffset.column-1,h="".padStart(a)+i.body,p=n.line-1,v=i.locationOffset.line-1,g=n.line+v,c=n.line===1?a:0,A=n.column+c,D=`${i.name}:${g}:${A}
`,N=h.split(/\r\n|[\n\r]/g),L=N[p];if(L.length>120){const F=Math.floor(A/80),V=A%80,$=[];for(let J=0;J<L.length;J+=80)$.push(L.slice(J,J+80));return D+_1([[`${g} |`,$[0]],...$.slice(1,F+1).map(J=>["|",J]),["|","^".padStart(V)],["|",$[F+1]]])}return D+_1([[`${g-1} |`,N[p-1]],[`${g} |`,L],["|","^".padStart(A)],[`${g+1} |`,N[p+1]]])}function _1(i){const n=i.filter(([h,p])=>p!==void 0),a=Math.max(...n.map(([h])=>h.length));return n.map(([h,p])=>h.padStart(a)+(p?" "+p:"")).join(`
`)}function aA(i){const n=i[0];return n==null||"kind"in n||"length"in n?{nodes:n,source:i[1],positions:i[2],path:i[3],originalError:i[4],extensions:i[5]}:n}class Bi extends Error{constructor(n,...a){var h,p,v;const{nodes:g,source:c,positions:A,path:D,originalError:N,extensions:L}=aA(a);super(n),this.name="GraphQLError",this.path=D??void 0,this.originalError=N??void 0,this.nodes=v1(Array.isArray(g)?g:g?[g]:void 0);const F=v1((h=this.nodes)===null||h===void 0?void 0:h.map($=>$.loc).filter($=>$!=null));this.source=c??(F==null||(p=F[0])===null||p===void 0?void 0:p.source),this.positions=A??(F==null?void 0:F.map($=>$.start)),this.locations=A&&c?A.map($=>gb(c,$)):F==null?void 0:F.map($=>gb($.source,$.start));const V=ld(N==null?void 0:N.extensions)?N==null?void 0:N.extensions:void 0;this.extensions=(v=L??V)!==null&&v!==void 0?v:Object.create(null),Object.defineProperties(this,{message:{writable:!0,enumerable:!0},name:{enumerable:!1},nodes:{enumerable:!1},source:{enumerable:!1},positions:{enumerable:!1},originalError:{enumerable:!1}}),N!=null&&N.stack?Object.defineProperty(this,"stack",{value:N.stack,writable:!0,configurable:!0}):Error.captureStackTrace?Error.captureStackTrace(this,Bi):Object.defineProperty(this,"stack",{value:Error().stack,writable:!0,configurable:!0})}get[Symbol.toStringTag](){return"GraphQLError"}toString(){let n=this.message;if(this.nodes)for(const a of this.nodes)a.loc&&(n+=`

`+rA(a.loc));else if(this.source&&this.locations)for(const a of this.locations)n+=`

`+oT(this.source,a);return n}toJSON(){const n={message:this.message};return this.locations!=null&&(n.locations=this.locations),this.path!=null&&(n.path=this.path),this.extensions!=null&&Object.keys(this.extensions).length>0&&(n.extensions=this.extensions),n}}function v1(i){return i===void 0||i.length===0?void 0:i}function Wa(i,n,a){return new Bi(`Syntax Error: ${a}`,{source:i,positions:[n]})}class oA{constructor(n,a,h){this.start=n.start,this.end=a.end,this.startToken=n,this.endToken=a,this.source=h}get[Symbol.toStringTag](){return"Location"}toJSON(){return{start:this.start,end:this.end}}}class sT{constructor(n,a,h,p,v,g){this.kind=n,this.start=a,this.end=h,this.line=p,this.column=v,this.value=g,this.prev=null,this.next=null}get[Symbol.toStringTag](){return"Token"}toJSON(){return{kind:this.kind,value:this.value,line:this.line,column:this.column}}}const lT={Name:[],Document:["definitions"],OperationDefinition:["name","variableDefinitions","directives","selectionSet"],VariableDefinition:["variable","type","defaultValue","directives"],Variable:["name"],SelectionSet:["selections"],Field:["alias","name","arguments","directives","selectionSet"],Argument:["name","value"],FragmentSpread:["name","directives"],InlineFragment:["typeCondition","directives","selectionSet"],FragmentDefinition:["name","variableDefinitions","typeCondition","directives","selectionSet"],IntValue:[],FloatValue:[],StringValue:[],BooleanValue:[],NullValue:[],EnumValue:[],ListValue:["values"],ObjectValue:["fields"],ObjectField:["name","value"],Directive:["name","arguments"],NamedType:["name"],ListType:["type"],NonNullType:["type"],SchemaDefinition:["description","directives","operationTypes"],OperationTypeDefinition:["type"],ScalarTypeDefinition:["description","name","directives"],ObjectTypeDefinition:["description","name","interfaces","directives","fields"],FieldDefinition:["description","name","arguments","type","directives"],InputValueDefinition:["description","name","type","defaultValue","directives"],InterfaceTypeDefinition:["description","name","interfaces","directives","fields"],UnionTypeDefinition:["description","name","directives","types"],EnumTypeDefinition:["description","name","directives","values"],EnumValueDefinition:["description","name","directives"],InputObjectTypeDefinition:["description","name","directives","fields"],DirectiveDefinition:["description","name","arguments","locations"],SchemaExtension:["directives","operationTypes"],ScalarTypeExtension:["name","directives"],ObjectTypeExtension:["name","interfaces","directives","fields"],InterfaceTypeExtension:["name","interfaces","directives","fields"],UnionTypeExtension:["name","directives","types"],EnumTypeExtension:["name","directives","values"],InputObjectTypeExtension:["name","directives","fields"]},sA=new Set(Object.keys(lT));function b1(i){const n=i==null?void 0:i.kind;return typeof n=="string"&&sA.has(n)}var $u;(function(i){i.QUERY="query",i.MUTATION="mutation",i.SUBSCRIPTION="subscription"})($u||($u={}));var bi;(function(i){i.QUERY="QUERY",i.MUTATION="MUTATION",i.SUBSCRIPTION="SUBSCRIPTION",i.FIELD="FIELD",i.FRAGMENT_DEFINITION="FRAGMENT_DEFINITION",i.FRAGMENT_SPREAD="FRAGMENT_SPREAD",i.INLINE_FRAGMENT="INLINE_FRAGMENT",i.VARIABLE_DEFINITION="VARIABLE_DEFINITION",i.SCHEMA="SCHEMA",i.SCALAR="SCALAR",i.OBJECT="OBJECT",i.FIELD_DEFINITION="FIELD_DEFINITION",i.ARGUMENT_DEFINITION="ARGUMENT_DEFINITION",i.INTERFACE="INTERFACE",i.UNION="UNION",i.ENUM="ENUM",i.ENUM_VALUE="ENUM_VALUE",i.INPUT_OBJECT="INPUT_OBJECT",i.INPUT_FIELD_DEFINITION="INPUT_FIELD_DEFINITION"})(bi||(bi={}));var Vt;(function(i){i.NAME="Name",i.DOCUMENT="Document",i.OPERATION_DEFINITION="OperationDefinition",i.VARIABLE_DEFINITION="VariableDefinition",i.SELECTION_SET="SelectionSet",i.FIELD="Field",i.ARGUMENT="Argument",i.FRAGMENT_SPREAD="FragmentSpread",i.INLINE_FRAGMENT="InlineFragment",i.FRAGMENT_DEFINITION="FragmentDefinition",i.VARIABLE="Variable",i.INT="IntValue",i.FLOAT="FloatValue",i.STRING="StringValue",i.BOOLEAN="BooleanValue",i.NULL="NullValue",i.ENUM="EnumValue",i.LIST="ListValue",i.OBJECT="ObjectValue",i.OBJECT_FIELD="ObjectField",i.DIRECTIVE="Directive",i.NAMED_TYPE="NamedType",i.LIST_TYPE="ListType",i.NON_NULL_TYPE="NonNullType",i.SCHEMA_DEFINITION="SchemaDefinition",i.OPERATION_TYPE_DEFINITION="OperationTypeDefinition",i.SCALAR_TYPE_DEFINITION="ScalarTypeDefinition",i.OBJECT_TYPE_DEFINITION="ObjectTypeDefinition",i.FIELD_DEFINITION="FieldDefinition",i.INPUT_VALUE_DEFINITION="InputValueDefinition",i.INTERFACE_TYPE_DEFINITION="InterfaceTypeDefinition",i.UNION_TYPE_DEFINITION="UnionTypeDefinition",i.ENUM_TYPE_DEFINITION="EnumTypeDefinition",i.ENUM_VALUE_DEFINITION="EnumValueDefinition",i.INPUT_OBJECT_TYPE_DEFINITION="InputObjectTypeDefinition",i.DIRECTIVE_DEFINITION="DirectiveDefinition",i.SCHEMA_EXTENSION="SchemaExtension",i.SCALAR_TYPE_EXTENSION="ScalarTypeExtension",i.OBJECT_TYPE_EXTENSION="ObjectTypeExtension",i.INTERFACE_TYPE_EXTENSION="InterfaceTypeExtension",i.UNION_TYPE_EXTENSION="UnionTypeExtension",i.ENUM_TYPE_EXTENSION="EnumTypeExtension",i.INPUT_OBJECT_TYPE_EXTENSION="InputObjectTypeExtension"})(Vt||(Vt={}));function yb(i){return i===9||i===32}function r_(i){return i>=48&&i<=57}function cT(i){return i>=97&&i<=122||i>=65&&i<=90}function Wb(i){return cT(i)||i===95}function uT(i){return cT(i)||r_(i)||i===95}function lA(i){var n;let a=Number.MAX_SAFE_INTEGER,h=null,p=-1;for(let g=0;g<i.length;++g){var v;const c=i[g],A=cA(c);A!==c.length&&(h=(v=h)!==null&&v!==void 0?v:g,p=g,g!==0&&A<a&&(a=A))}return i.map((g,c)=>c===0?g:g.slice(a)).slice((n=h)!==null&&n!==void 0?n:0,p+1)}function cA(i){let n=0;for(;n<i.length&&yb(i.charCodeAt(n));)++n;return n}function uA(i,n){const a=i.replace(/"""/g,'\\"""'),h=a.split(/\r\n|[\n\r]/g),p=h.length===1,v=h.length>1&&h.slice(1).every(V=>V.length===0||yb(V.charCodeAt(0))),g=a.endsWith('\\"""'),c=i.endsWith('"')&&!g,A=i.endsWith("\\"),D=c||A,N=!p||i.length>70||D||v||g;let L="";const F=p&&yb(i.charCodeAt(0));return(N&&!F||v)&&(L+=`
`),L+=a,(N||D)&&(L+=`
`),'"""'+L+'"""'}var wt;(function(i){i.SOF="<SOF>",i.EOF="<EOF>",i.BANG="!",i.DOLLAR="$",i.AMP="&",i.PAREN_L="(",i.PAREN_R=")",i.SPREAD="...",i.COLON=":",i.EQUALS="=",i.AT="@",i.BRACKET_L="[",i.BRACKET_R="]",i.BRACE_L="{",i.PIPE="|",i.BRACE_R="}",i.NAME="Name",i.INT="Int",i.FLOAT="Float",i.STRING="String",i.BLOCK_STRING="BlockString",i.COMMENT="Comment"})(wt||(wt={}));class hA{constructor(n){const a=new sT(wt.SOF,0,0,0,0);this.source=n,this.lastToken=a,this.token=a,this.line=1,this.lineStart=0}get[Symbol.toStringTag](){return"Lexer"}advance(){return this.lastToken=this.token,this.token=this.lookahead()}lookahead(){let n=this.token;if(n.kind!==wt.EOF)do if(n.next)n=n.next;else{const a=fA(this,n.end);n.next=a,a.prev=n,n=a}while(n.kind===wt.COMMENT);return n}}function dA(i){return i===wt.BANG||i===wt.DOLLAR||i===wt.AMP||i===wt.PAREN_L||i===wt.PAREN_R||i===wt.SPREAD||i===wt.COLON||i===wt.EQUALS||i===wt.AT||i===wt.BRACKET_L||i===wt.BRACKET_R||i===wt.BRACE_L||i===wt.PIPE||i===wt.BRACE_R}function Fg(i){return i>=0&&i<=55295||i>=57344&&i<=1114111}function nv(i,n){return hT(i.charCodeAt(n))&&dT(i.charCodeAt(n+1))}function hT(i){return i>=55296&&i<=56319}function dT(i){return i>=56320&&i<=57343}function rm(i,n){const a=i.source.body.codePointAt(n);if(a===void 0)return wt.EOF;if(a>=32&&a<=126){const h=String.fromCodePoint(a);return h==='"'?`'"'`:`"${h}"`}return"U+"+a.toString(16).toUpperCase().padStart(4,"0")}function wa(i,n,a,h,p){const v=i.line,g=1+a-i.lineStart;return new sT(n,a,h,v,g,p)}function fA(i,n){const a=i.source.body,h=a.length;let p=n;for(;p<h;){const v=a.charCodeAt(p);switch(v){case 65279:case 9:case 32:case 44:++p;continue;case 10:++p,++i.line,i.lineStart=p;continue;case 13:a.charCodeAt(p+1)===10?p+=2:++p,++i.line,i.lineStart=p;continue;case 35:return pA(i,p);case 33:return wa(i,wt.BANG,p,p+1);case 36:return wa(i,wt.DOLLAR,p,p+1);case 38:return wa(i,wt.AMP,p,p+1);case 40:return wa(i,wt.PAREN_L,p,p+1);case 41:return wa(i,wt.PAREN_R,p,p+1);case 46:if(a.charCodeAt(p+1)===46&&a.charCodeAt(p+2)===46)return wa(i,wt.SPREAD,p,p+3);break;case 58:return wa(i,wt.COLON,p,p+1);case 61:return wa(i,wt.EQUALS,p,p+1);case 64:return wa(i,wt.AT,p,p+1);case 91:return wa(i,wt.BRACKET_L,p,p+1);case 93:return wa(i,wt.BRACKET_R,p,p+1);case 123:return wa(i,wt.BRACE_L,p,p+1);case 124:return wa(i,wt.PIPE,p,p+1);case 125:return wa(i,wt.BRACE_R,p,p+1);case 34:return a.charCodeAt(p+1)===34&&a.charCodeAt(p+2)===34?bA(i,p):gA(i,p)}if(r_(v)||v===45)return mA(i,p,v);if(Wb(v))return xA(i,p);throw Wa(i.source,p,v===39?`Unexpected single quote character ('), did you mean to use a double quote (")?`:Fg(v)||nv(a,p)?`Unexpected character: ${rm(i,p)}.`:`Invalid character: ${rm(i,p)}.`)}return wa(i,wt.EOF,h,h)}function pA(i,n){const a=i.source.body,h=a.length;let p=n+1;for(;p<h;){const v=a.charCodeAt(p);if(v===10||v===13)break;if(Fg(v))++p;else if(nv(a,p))p+=2;else break}return wa(i,wt.COMMENT,n,p,a.slice(n+1,p))}function mA(i,n,a){const h=i.source.body;let p=n,v=a,g=!1;if(v===45&&(v=h.charCodeAt(++p)),v===48){if(v=h.charCodeAt(++p),r_(v))throw Wa(i.source,p,`Invalid number, unexpected digit after 0: ${rm(i,p)}.`)}else p=Yv(i,p,v),v=h.charCodeAt(p);if(v===46&&(g=!0,v=h.charCodeAt(++p),p=Yv(i,p,v),v=h.charCodeAt(p)),(v===69||v===101)&&(g=!0,v=h.charCodeAt(++p),(v===43||v===45)&&(v=h.charCodeAt(++p)),p=Yv(i,p,v),v=h.charCodeAt(p)),v===46||Wb(v))throw Wa(i.source,p,`Invalid number, expected digit but got: ${rm(i,p)}.`);return wa(i,g?wt.FLOAT:wt.INT,n,p,h.slice(n,p))}function Yv(i,n,a){if(!r_(a))throw Wa(i.source,n,`Invalid number, expected digit but got: ${rm(i,n)}.`);const h=i.source.body;let p=n+1;for(;r_(h.charCodeAt(p));)++p;return p}function gA(i,n){const a=i.source.body,h=a.length;let p=n+1,v=p,g="";for(;p<h;){const c=a.charCodeAt(p);if(c===34)return g+=a.slice(v,p),wa(i,wt.STRING,n,p+1,g);if(c===92){g+=a.slice(v,p);const A=a.charCodeAt(p+1)===117?a.charCodeAt(p+2)===123?yA(i,p):_A(i,p):vA(i,p);g+=A.value,p+=A.size,v=p;continue}if(c===10||c===13)break;if(Fg(c))++p;else if(nv(a,p))p+=2;else throw Wa(i.source,p,`Invalid character within String: ${rm(i,p)}.`)}throw Wa(i.source,p,"Unterminated string.")}function yA(i,n){const a=i.source.body;let h=0,p=3;for(;p<12;){const v=a.charCodeAt(n+p++);if(v===125){if(p<5||!Fg(h))break;return{value:String.fromCodePoint(h),size:p}}if(h=h<<4|$y(v),h<0)break}throw Wa(i.source,n,`Invalid Unicode escape sequence: "${a.slice(n,n+p)}".`)}function _A(i,n){const a=i.source.body,h=x1(a,n+2);if(Fg(h))return{value:String.fromCodePoint(h),size:6};if(hT(h)&&a.charCodeAt(n+6)===92&&a.charCodeAt(n+7)===117){const p=x1(a,n+8);if(dT(p))return{value:String.fromCodePoint(h,p),size:12}}throw Wa(i.source,n,`Invalid Unicode escape sequence: "${a.slice(n,n+6)}".`)}function x1(i,n){return $y(i.charCodeAt(n))<<12|$y(i.charCodeAt(n+1))<<8|$y(i.charCodeAt(n+2))<<4|$y(i.charCodeAt(n+3))}function $y(i){return i>=48&&i<=57?i-48:i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:-1}function vA(i,n){const a=i.source.body;switch(a.charCodeAt(n+1)){case 34:return{value:'"',size:2};case 92:return{value:"\\",size:2};case 47:return{value:"/",size:2};case 98:return{value:"\b",size:2};case 102:return{value:"\f",size:2};case 110:return{value:`
`,size:2};case 114:return{value:"\r",size:2};case 116:return{value:"	",size:2}}throw Wa(i.source,n,`Invalid character escape sequence: "${a.slice(n,n+2)}".`)}function bA(i,n){const a=i.source.body,h=a.length;let p=i.lineStart,v=n+3,g=v,c="";const A=[];for(;v<h;){const D=a.charCodeAt(v);if(D===34&&a.charCodeAt(v+1)===34&&a.charCodeAt(v+2)===34){c+=a.slice(g,v),A.push(c);const N=wa(i,wt.BLOCK_STRING,n,v+3,lA(A).join(`
`));return i.line+=A.length-1,i.lineStart=p,N}if(D===92&&a.charCodeAt(v+1)===34&&a.charCodeAt(v+2)===34&&a.charCodeAt(v+3)===34){c+=a.slice(g,v),g=v+1,v+=4;continue}if(D===10||D===13){c+=a.slice(g,v),A.push(c),D===13&&a.charCodeAt(v+1)===10?v+=2:++v,c="",g=v,p=v;continue}if(Fg(D))++v;else if(nv(a,v))v+=2;else throw Wa(i.source,v,`Invalid character within String: ${rm(i,v)}.`)}throw Wa(i.source,v,"Unterminated string.")}function xA(i,n){const a=i.source.body,h=a.length;let p=n+1;for(;p<h;){const v=a.charCodeAt(p);if(uT(v))++p;else break}return wa(i,wt.NAME,n,p,a.slice(n,p))}const wA=10,fT=2;function kn(i){return iv(i,[])}function iv(i,n){switch(typeof i){case"string":return JSON.stringify(i);case"function":return i.name?`[function ${i.name}]`:"[function]";case"object":return TA(i,n);default:return String(i)}}function TA(i,n){if(i===null)return"null";if(n.includes(i))return"[Circular]";const a=[...n,i];if(EA(i)){const h=i.toJSON();if(h!==i)return typeof h=="string"?h:iv(h,a)}else if(Array.isArray(i))return AA(i,a);return SA(i,a)}function EA(i){return typeof i.toJSON=="function"}function SA(i,n){const a=Object.entries(i);return a.length===0?"{}":n.length>fT?"["+CA(i)+"]":"{ "+a.map(([p,v])=>p+": "+iv(v,n)).join(", ")+" }"}function AA(i,n){if(i.length===0)return"[]";if(n.length>fT)return"[Array]";const a=Math.min(wA,i.length),h=i.length-a,p=[];for(let v=0;v<a;++v)p.push(iv(i[v],n));return h===1?p.push("... 1 more item"):h>1&&p.push(`... ${h} more items`),"["+p.join(", ")+"]"}function CA(i){const n=Object.prototype.toString.call(i).replace(/^\[object /,"").replace(/]$/,"");if(n==="Object"&&typeof i.constructor=="function"){const a=i.constructor.name;if(typeof a=="string"&&a!=="")return a}return n}const MA=globalThis.process&&!0,th=MA?function(n,a){return n instanceof a}:function(n,a){if(n instanceof a)return!0;if(typeof n=="object"&&n!==null){var h;const p=a.prototype[Symbol.toStringTag],v=Symbol.toStringTag in n?n[Symbol.toStringTag]:(h=n.constructor)===null||h===void 0?void 0:h.name;if(p===v){const g=kn(n);throw new Error(`Cannot use ${p} "${g}" from another module or realm.

Ensure that there is only one instance of "graphql" in the node_modules
directory. If different versions of "graphql" are the dependencies of other
relied on modules, use "resolutions" to ensure only one version is installed.

https://yarnpkg.com/en/docs/selective-version-resolutions

Duplicate "graphql" modules cannot be used at the same time since different
versions may have different capabilities and behavior. The data from one
version used in the function from another could produce confusing and
spurious results.`)}}return!1};class pT{constructor(n,a="GraphQL request",h={line:1,column:1}){typeof n=="string"||Ri(!1,`Body must be a string. Received: ${kn(n)}.`),this.body=n,this.name=a,this.locationOffset=h,this.locationOffset.line>0||Ri(!1,"line in locationOffset is 1-indexed and must be positive."),this.locationOffset.column>0||Ri(!1,"column in locationOffset is 1-indexed and must be positive.")}get[Symbol.toStringTag](){return"Source"}}function DA(i){return th(i,pT)}function IA(i,n){const a=new mT(i,n),h=a.parseDocument();return Object.defineProperty(h,"tokenCount",{enumerable:!1,value:a.tokenCount}),h}function kA(i,n){const a=new mT(i,n);a.expectToken(wt.SOF);const h=a.parseValueLiteral(!1);return a.expectToken(wt.EOF),h}class mT{constructor(n,a={}){const h=DA(n)?n:new pT(n);this._lexer=new hA(h),this._options=a,this._tokenCounter=0}get tokenCount(){return this._tokenCounter}parseName(){const n=this.expectToken(wt.NAME);return this.node(n,{kind:Vt.NAME,value:n.value})}parseDocument(){return this.node(this._lexer.token,{kind:Vt.DOCUMENT,definitions:this.many(wt.SOF,this.parseDefinition,wt.EOF)})}parseDefinition(){if(this.peek(wt.BRACE_L))return this.parseOperationDefinition();const n=this.peekDescription(),a=n?this._lexer.lookahead():this._lexer.token;if(a.kind===wt.NAME){switch(a.value){case"schema":return this.parseSchemaDefinition();case"scalar":return this.parseScalarTypeDefinition();case"type":return this.parseObjectTypeDefinition();case"interface":return this.parseInterfaceTypeDefinition();case"union":return this.parseUnionTypeDefinition();case"enum":return this.parseEnumTypeDefinition();case"input":return this.parseInputObjectTypeDefinition();case"directive":return this.parseDirectiveDefinition()}if(n)throw Wa(this._lexer.source,this._lexer.token.start,"Unexpected description, descriptions are supported only on type definitions.");switch(a.value){case"query":case"mutation":case"subscription":return this.parseOperationDefinition();case"fragment":return this.parseFragmentDefinition();case"extend":return this.parseTypeSystemExtension()}}throw this.unexpected(a)}parseOperationDefinition(){const n=this._lexer.token;if(this.peek(wt.BRACE_L))return this.node(n,{kind:Vt.OPERATION_DEFINITION,operation:$u.QUERY,name:void 0,variableDefinitions:[],directives:[],selectionSet:this.parseSelectionSet()});const a=this.parseOperationType();let h;return this.peek(wt.NAME)&&(h=this.parseName()),this.node(n,{kind:Vt.OPERATION_DEFINITION,operation:a,name:h,variableDefinitions:this.parseVariableDefinitions(),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseOperationType(){const n=this.expectToken(wt.NAME);switch(n.value){case"query":return $u.QUERY;case"mutation":return $u.MUTATION;case"subscription":return $u.SUBSCRIPTION}throw this.unexpected(n)}parseVariableDefinitions(){return this.optionalMany(wt.PAREN_L,this.parseVariableDefinition,wt.PAREN_R)}parseVariableDefinition(){return this.node(this._lexer.token,{kind:Vt.VARIABLE_DEFINITION,variable:this.parseVariable(),type:(this.expectToken(wt.COLON),this.parseTypeReference()),defaultValue:this.expectOptionalToken(wt.EQUALS)?this.parseConstValueLiteral():void 0,directives:this.parseConstDirectives()})}parseVariable(){const n=this._lexer.token;return this.expectToken(wt.DOLLAR),this.node(n,{kind:Vt.VARIABLE,name:this.parseName()})}parseSelectionSet(){return this.node(this._lexer.token,{kind:Vt.SELECTION_SET,selections:this.many(wt.BRACE_L,this.parseSelection,wt.BRACE_R)})}parseSelection(){return this.peek(wt.SPREAD)?this.parseFragment():this.parseField()}parseField(){const n=this._lexer.token,a=this.parseName();let h,p;return this.expectOptionalToken(wt.COLON)?(h=a,p=this.parseName()):p=a,this.node(n,{kind:Vt.FIELD,alias:h,name:p,arguments:this.parseArguments(!1),directives:this.parseDirectives(!1),selectionSet:this.peek(wt.BRACE_L)?this.parseSelectionSet():void 0})}parseArguments(n){const a=n?this.parseConstArgument:this.parseArgument;return this.optionalMany(wt.PAREN_L,a,wt.PAREN_R)}parseArgument(n=!1){const a=this._lexer.token,h=this.parseName();return this.expectToken(wt.COLON),this.node(a,{kind:Vt.ARGUMENT,name:h,value:this.parseValueLiteral(n)})}parseConstArgument(){return this.parseArgument(!0)}parseFragment(){const n=this._lexer.token;this.expectToken(wt.SPREAD);const a=this.expectOptionalKeyword("on");return!a&&this.peek(wt.NAME)?this.node(n,{kind:Vt.FRAGMENT_SPREAD,name:this.parseFragmentName(),directives:this.parseDirectives(!1)}):this.node(n,{kind:Vt.INLINE_FRAGMENT,typeCondition:a?this.parseNamedType():void 0,directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentDefinition(){const n=this._lexer.token;return this.expectKeyword("fragment"),this._options.allowLegacyFragmentVariables===!0?this.node(n,{kind:Vt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),variableDefinitions:this.parseVariableDefinitions(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()}):this.node(n,{kind:Vt.FRAGMENT_DEFINITION,name:this.parseFragmentName(),typeCondition:(this.expectKeyword("on"),this.parseNamedType()),directives:this.parseDirectives(!1),selectionSet:this.parseSelectionSet()})}parseFragmentName(){if(this._lexer.token.value==="on")throw this.unexpected();return this.parseName()}parseValueLiteral(n){const a=this._lexer.token;switch(a.kind){case wt.BRACKET_L:return this.parseList(n);case wt.BRACE_L:return this.parseObject(n);case wt.INT:return this.advanceLexer(),this.node(a,{kind:Vt.INT,value:a.value});case wt.FLOAT:return this.advanceLexer(),this.node(a,{kind:Vt.FLOAT,value:a.value});case wt.STRING:case wt.BLOCK_STRING:return this.parseStringLiteral();case wt.NAME:switch(this.advanceLexer(),a.value){case"true":return this.node(a,{kind:Vt.BOOLEAN,value:!0});case"false":return this.node(a,{kind:Vt.BOOLEAN,value:!1});case"null":return this.node(a,{kind:Vt.NULL});default:return this.node(a,{kind:Vt.ENUM,value:a.value})}case wt.DOLLAR:if(n)if(this.expectToken(wt.DOLLAR),this._lexer.token.kind===wt.NAME){const h=this._lexer.token.value;throw Wa(this._lexer.source,a.start,`Unexpected variable "$${h}" in constant value.`)}else throw this.unexpected(a);return this.parseVariable();default:throw this.unexpected()}}parseConstValueLiteral(){return this.parseValueLiteral(!0)}parseStringLiteral(){const n=this._lexer.token;return this.advanceLexer(),this.node(n,{kind:Vt.STRING,value:n.value,block:n.kind===wt.BLOCK_STRING})}parseList(n){const a=()=>this.parseValueLiteral(n);return this.node(this._lexer.token,{kind:Vt.LIST,values:this.any(wt.BRACKET_L,a,wt.BRACKET_R)})}parseObject(n){const a=()=>this.parseObjectField(n);return this.node(this._lexer.token,{kind:Vt.OBJECT,fields:this.any(wt.BRACE_L,a,wt.BRACE_R)})}parseObjectField(n){const a=this._lexer.token,h=this.parseName();return this.expectToken(wt.COLON),this.node(a,{kind:Vt.OBJECT_FIELD,name:h,value:this.parseValueLiteral(n)})}parseDirectives(n){const a=[];for(;this.peek(wt.AT);)a.push(this.parseDirective(n));return a}parseConstDirectives(){return this.parseDirectives(!0)}parseDirective(n){const a=this._lexer.token;return this.expectToken(wt.AT),this.node(a,{kind:Vt.DIRECTIVE,name:this.parseName(),arguments:this.parseArguments(n)})}parseTypeReference(){const n=this._lexer.token;let a;if(this.expectOptionalToken(wt.BRACKET_L)){const h=this.parseTypeReference();this.expectToken(wt.BRACKET_R),a=this.node(n,{kind:Vt.LIST_TYPE,type:h})}else a=this.parseNamedType();return this.expectOptionalToken(wt.BANG)?this.node(n,{kind:Vt.NON_NULL_TYPE,type:a}):a}parseNamedType(){return this.node(this._lexer.token,{kind:Vt.NAMED_TYPE,name:this.parseName()})}peekDescription(){return this.peek(wt.STRING)||this.peek(wt.BLOCK_STRING)}parseDescription(){if(this.peekDescription())return this.parseStringLiteral()}parseSchemaDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("schema");const h=this.parseConstDirectives(),p=this.many(wt.BRACE_L,this.parseOperationTypeDefinition,wt.BRACE_R);return this.node(n,{kind:Vt.SCHEMA_DEFINITION,description:a,directives:h,operationTypes:p})}parseOperationTypeDefinition(){const n=this._lexer.token,a=this.parseOperationType();this.expectToken(wt.COLON);const h=this.parseNamedType();return this.node(n,{kind:Vt.OPERATION_TYPE_DEFINITION,operation:a,type:h})}parseScalarTypeDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("scalar");const h=this.parseName(),p=this.parseConstDirectives();return this.node(n,{kind:Vt.SCALAR_TYPE_DEFINITION,description:a,name:h,directives:p})}parseObjectTypeDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("type");const h=this.parseName(),p=this.parseImplementsInterfaces(),v=this.parseConstDirectives(),g=this.parseFieldsDefinition();return this.node(n,{kind:Vt.OBJECT_TYPE_DEFINITION,description:a,name:h,interfaces:p,directives:v,fields:g})}parseImplementsInterfaces(){return this.expectOptionalKeyword("implements")?this.delimitedMany(wt.AMP,this.parseNamedType):[]}parseFieldsDefinition(){return this.optionalMany(wt.BRACE_L,this.parseFieldDefinition,wt.BRACE_R)}parseFieldDefinition(){const n=this._lexer.token,a=this.parseDescription(),h=this.parseName(),p=this.parseArgumentDefs();this.expectToken(wt.COLON);const v=this.parseTypeReference(),g=this.parseConstDirectives();return this.node(n,{kind:Vt.FIELD_DEFINITION,description:a,name:h,arguments:p,type:v,directives:g})}parseArgumentDefs(){return this.optionalMany(wt.PAREN_L,this.parseInputValueDef,wt.PAREN_R)}parseInputValueDef(){const n=this._lexer.token,a=this.parseDescription(),h=this.parseName();this.expectToken(wt.COLON);const p=this.parseTypeReference();let v;this.expectOptionalToken(wt.EQUALS)&&(v=this.parseConstValueLiteral());const g=this.parseConstDirectives();return this.node(n,{kind:Vt.INPUT_VALUE_DEFINITION,description:a,name:h,type:p,defaultValue:v,directives:g})}parseInterfaceTypeDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("interface");const h=this.parseName(),p=this.parseImplementsInterfaces(),v=this.parseConstDirectives(),g=this.parseFieldsDefinition();return this.node(n,{kind:Vt.INTERFACE_TYPE_DEFINITION,description:a,name:h,interfaces:p,directives:v,fields:g})}parseUnionTypeDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("union");const h=this.parseName(),p=this.parseConstDirectives(),v=this.parseUnionMemberTypes();return this.node(n,{kind:Vt.UNION_TYPE_DEFINITION,description:a,name:h,directives:p,types:v})}parseUnionMemberTypes(){return this.expectOptionalToken(wt.EQUALS)?this.delimitedMany(wt.PIPE,this.parseNamedType):[]}parseEnumTypeDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("enum");const h=this.parseName(),p=this.parseConstDirectives(),v=this.parseEnumValuesDefinition();return this.node(n,{kind:Vt.ENUM_TYPE_DEFINITION,description:a,name:h,directives:p,values:v})}parseEnumValuesDefinition(){return this.optionalMany(wt.BRACE_L,this.parseEnumValueDefinition,wt.BRACE_R)}parseEnumValueDefinition(){const n=this._lexer.token,a=this.parseDescription(),h=this.parseEnumValueName(),p=this.parseConstDirectives();return this.node(n,{kind:Vt.ENUM_VALUE_DEFINITION,description:a,name:h,directives:p})}parseEnumValueName(){if(this._lexer.token.value==="true"||this._lexer.token.value==="false"||this._lexer.token.value==="null")throw Wa(this._lexer.source,this._lexer.token.start,`${y0(this._lexer.token)} is reserved and cannot be used for an enum value.`);return this.parseName()}parseInputObjectTypeDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("input");const h=this.parseName(),p=this.parseConstDirectives(),v=this.parseInputFieldsDefinition();return this.node(n,{kind:Vt.INPUT_OBJECT_TYPE_DEFINITION,description:a,name:h,directives:p,fields:v})}parseInputFieldsDefinition(){return this.optionalMany(wt.BRACE_L,this.parseInputValueDef,wt.BRACE_R)}parseTypeSystemExtension(){const n=this._lexer.lookahead();if(n.kind===wt.NAME)switch(n.value){case"schema":return this.parseSchemaExtension();case"scalar":return this.parseScalarTypeExtension();case"type":return this.parseObjectTypeExtension();case"interface":return this.parseInterfaceTypeExtension();case"union":return this.parseUnionTypeExtension();case"enum":return this.parseEnumTypeExtension();case"input":return this.parseInputObjectTypeExtension()}throw this.unexpected(n)}parseSchemaExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("schema");const a=this.parseConstDirectives(),h=this.optionalMany(wt.BRACE_L,this.parseOperationTypeDefinition,wt.BRACE_R);if(a.length===0&&h.length===0)throw this.unexpected();return this.node(n,{kind:Vt.SCHEMA_EXTENSION,directives:a,operationTypes:h})}parseScalarTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("scalar");const a=this.parseName(),h=this.parseConstDirectives();if(h.length===0)throw this.unexpected();return this.node(n,{kind:Vt.SCALAR_TYPE_EXTENSION,name:a,directives:h})}parseObjectTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("type");const a=this.parseName(),h=this.parseImplementsInterfaces(),p=this.parseConstDirectives(),v=this.parseFieldsDefinition();if(h.length===0&&p.length===0&&v.length===0)throw this.unexpected();return this.node(n,{kind:Vt.OBJECT_TYPE_EXTENSION,name:a,interfaces:h,directives:p,fields:v})}parseInterfaceTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("interface");const a=this.parseName(),h=this.parseImplementsInterfaces(),p=this.parseConstDirectives(),v=this.parseFieldsDefinition();if(h.length===0&&p.length===0&&v.length===0)throw this.unexpected();return this.node(n,{kind:Vt.INTERFACE_TYPE_EXTENSION,name:a,interfaces:h,directives:p,fields:v})}parseUnionTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("union");const a=this.parseName(),h=this.parseConstDirectives(),p=this.parseUnionMemberTypes();if(h.length===0&&p.length===0)throw this.unexpected();return this.node(n,{kind:Vt.UNION_TYPE_EXTENSION,name:a,directives:h,types:p})}parseEnumTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("enum");const a=this.parseName(),h=this.parseConstDirectives(),p=this.parseEnumValuesDefinition();if(h.length===0&&p.length===0)throw this.unexpected();return this.node(n,{kind:Vt.ENUM_TYPE_EXTENSION,name:a,directives:h,values:p})}parseInputObjectTypeExtension(){const n=this._lexer.token;this.expectKeyword("extend"),this.expectKeyword("input");const a=this.parseName(),h=this.parseConstDirectives(),p=this.parseInputFieldsDefinition();if(h.length===0&&p.length===0)throw this.unexpected();return this.node(n,{kind:Vt.INPUT_OBJECT_TYPE_EXTENSION,name:a,directives:h,fields:p})}parseDirectiveDefinition(){const n=this._lexer.token,a=this.parseDescription();this.expectKeyword("directive"),this.expectToken(wt.AT);const h=this.parseName(),p=this.parseArgumentDefs(),v=this.expectOptionalKeyword("repeatable");this.expectKeyword("on");const g=this.parseDirectiveLocations();return this.node(n,{kind:Vt.DIRECTIVE_DEFINITION,description:a,name:h,arguments:p,repeatable:v,locations:g})}parseDirectiveLocations(){return this.delimitedMany(wt.PIPE,this.parseDirectiveLocation)}parseDirectiveLocation(){const n=this._lexer.token,a=this.parseName();if(Object.prototype.hasOwnProperty.call(bi,a.value))return a;throw this.unexpected(n)}node(n,a){return this._options.noLocation!==!0&&(a.loc=new oA(n,this._lexer.lastToken,this._lexer.source)),a}peek(n){return this._lexer.token.kind===n}expectToken(n){const a=this._lexer.token;if(a.kind===n)return this.advanceLexer(),a;throw Wa(this._lexer.source,a.start,`Expected ${gT(n)}, found ${y0(a)}.`)}expectOptionalToken(n){return this._lexer.token.kind===n?(this.advanceLexer(),!0):!1}expectKeyword(n){const a=this._lexer.token;if(a.kind===wt.NAME&&a.value===n)this.advanceLexer();else throw Wa(this._lexer.source,a.start,`Expected "${n}", found ${y0(a)}.`)}expectOptionalKeyword(n){const a=this._lexer.token;return a.kind===wt.NAME&&a.value===n?(this.advanceLexer(),!0):!1}unexpected(n){const a=n??this._lexer.token;return Wa(this._lexer.source,a.start,`Unexpected ${y0(a)}.`)}any(n,a,h){this.expectToken(n);const p=[];for(;!this.expectOptionalToken(h);)p.push(a.call(this));return p}optionalMany(n,a,h){if(this.expectOptionalToken(n)){const p=[];do p.push(a.call(this));while(!this.expectOptionalToken(h));return p}return[]}many(n,a,h){this.expectToken(n);const p=[];do p.push(a.call(this));while(!this.expectOptionalToken(h));return p}delimitedMany(n,a){this.expectOptionalToken(n);const h=[];do h.push(a.call(this));while(this.expectOptionalToken(n));return h}advanceLexer(){const{maxTokens:n}=this._options,a=this._lexer.advance();if(a.kind!==wt.EOF&&(++this._tokenCounter,n!==void 0&&this._tokenCounter>n))throw Wa(this._lexer.source,a.start,`Document contains more that ${n} tokens. Parsing aborted.`)}}function y0(i){const n=i.value;return gT(i.kind)+(n!=null?` "${n}"`:"")}function gT(i){return dA(i)?`"${i}"`:i}const RA=5;function NA(i,n){const[a,h]=n?[i,n]:[void 0,i];let p=" Did you mean ";a&&(p+=a+" ");const v=h.map(A=>`"${A}"`);switch(v.length){case 0:return"";case 1:return p+v[0]+"?";case 2:return p+v[0]+" or "+v[1]+"?"}const g=v.slice(0,RA),c=g.pop();return p+g.join(", ")+", or "+c+"?"}function w1(i){return i}function yT(i,n){const a=Object.create(null);for(const h of i)a[n(h)]=h;return a}function Qp(i,n,a){const h=Object.create(null);for(const p of i)h[n(p)]=a(p);return h}function rv(i,n){const a=Object.create(null);for(const h of Object.keys(i))a[h]=n(i[h],h);return a}function PA(i,n){let a=0,h=0;for(;a<i.length&&h<n.length;){let p=i.charCodeAt(a),v=n.charCodeAt(h);if(_0(p)&&_0(v)){let g=0;do++a,g=g*10+p-_b,p=i.charCodeAt(a);while(_0(p)&&g>0);let c=0;do++h,c=c*10+v-_b,v=n.charCodeAt(h);while(_0(v)&&c>0);if(g<c)return-1;if(g>c)return 1}else{if(p<v)return-1;if(p>v)return 1;++a,++h}}return i.length-n.length}const _b=48,zA=57;function _0(i){return!isNaN(i)&&_b<=i&&i<=zA}function OA(i,n){const a=Object.create(null),h=new LA(i),p=Math.floor(i.length*.4)+1;for(const v of n){const g=h.measure(v,p);g!==void 0&&(a[v]=g)}return Object.keys(a).sort((v,g)=>{const c=a[v]-a[g];return c!==0?c:PA(v,g)})}class LA{constructor(n){this._input=n,this._inputLowerCase=n.toLowerCase(),this._inputArray=T1(this._inputLowerCase),this._rows=[new Array(n.length+1).fill(0),new Array(n.length+1).fill(0),new Array(n.length+1).fill(0)]}measure(n,a){if(this._input===n)return 0;const h=n.toLowerCase();if(this._inputLowerCase===h)return 1;let p=T1(h),v=this._inputArray;if(p.length<v.length){const N=p;p=v,v=N}const g=p.length,c=v.length;if(g-c>a)return;const A=this._rows;for(let N=0;N<=c;N++)A[0][N]=N;for(let N=1;N<=g;N++){const L=A[(N-1)%3],F=A[N%3];let V=F[0]=N;for(let $=1;$<=c;$++){const J=p[N-1]===v[$-1]?0:1;let ae=Math.min(L[$]+1,F[$-1]+1,L[$-1]+J);if(N>1&&$>1&&p[N-1]===v[$-2]&&p[N-2]===v[$-1]){const fe=A[(N-2)%3][$-2];ae=Math.min(ae,fe+1)}ae<V&&(V=ae),F[$]=ae}if(V>a)return}const D=A[g%3][c];return D<=a?D:void 0}}function T1(i){const n=i.length,a=new Array(n);for(let h=0;h<n;++h)a[h]=i.charCodeAt(h);return a}function rc(i){if(i==null)return Object.create(null);if(Object.getPrototypeOf(i)===null)return i;const n=Object.create(null);for(const[a,h]of Object.entries(i))n[a]=h;return n}function BA(i){return`"${i.replace(jA,FA)}"`}const jA=/[\x00-\x1f\x22\x5c\x7f-\x9f]/g;function FA(i){return UA[i.charCodeAt(0)]}const UA=["\\u0000","\\u0001","\\u0002","\\u0003","\\u0004","\\u0005","\\u0006","\\u0007","\\b","\\t","\\n","\\u000B","\\f","\\r","\\u000E","\\u000F","\\u0010","\\u0011","\\u0012","\\u0013","\\u0014","\\u0015","\\u0016","\\u0017","\\u0018","\\u0019","\\u001A","\\u001B","\\u001C","\\u001D","\\u001E","\\u001F","","",'\\"',"","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\\\","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","\\u007F","\\u0080","\\u0081","\\u0082","\\u0083","\\u0084","\\u0085","\\u0086","\\u0087","\\u0088","\\u0089","\\u008A","\\u008B","\\u008C","\\u008D","\\u008E","\\u008F","\\u0090","\\u0091","\\u0092","\\u0093","\\u0094","\\u0095","\\u0096","\\u0097","\\u0098","\\u0099","\\u009A","\\u009B","\\u009C","\\u009D","\\u009E","\\u009F"],VA=Object.freeze({});function GA(i,n,a=lT){const h=new Map;for(const fe of Object.values(Vt))h.set(fe,ZA(n,fe));let p,v=Array.isArray(i),g=[i],c=-1,A=[],D=i,N,L;const F=[],V=[];do{c++;const fe=c===g.length,ve=fe&&A.length!==0;if(fe){if(N=V.length===0?void 0:F[F.length-1],D=L,L=V.pop(),ve)if(v){D=D.slice();let Me=0;for(const[Te,De]of A){const Ne=Te-Me;De===null?(D.splice(Ne,1),Me++):D[Ne]=De}}else{D=Object.defineProperties({},Object.getOwnPropertyDescriptors(D));for(const[Me,Te]of A)D[Me]=Te}c=p.index,g=p.keys,A=p.edits,v=p.inArray,p=p.prev}else if(L){if(N=v?c:g[c],D=L[N],D==null)continue;F.push(N)}let Ce;if(!Array.isArray(D)){var $,J;b1(D)||Ri(!1,`Invalid AST Node: ${kn(D)}.`);const Me=fe?($=h.get(D.kind))===null||$===void 0?void 0:$.leave:(J=h.get(D.kind))===null||J===void 0?void 0:J.enter;if(Ce=Me==null?void 0:Me.call(n,D,N,L,F,V),Ce===VA)break;if(Ce===!1){if(!fe){F.pop();continue}}else if(Ce!==void 0&&(A.push([N,Ce]),!fe))if(b1(Ce))D=Ce;else{F.pop();continue}}if(Ce===void 0&&ve&&A.push([N,D]),fe)F.pop();else{var ae;p={inArray:v,index:c,keys:g,edits:A,prev:p},v=Array.isArray(D),g=v?D:(ae=a[D.kind])!==null&&ae!==void 0?ae:[],c=-1,A=[],L&&V.push(L),L=D}}while(p!==void 0);return A.length!==0?A[A.length-1][1]:i}function ZA(i,n){const a=i[n];return typeof a=="object"?a:typeof a=="function"?{enter:a,leave:void 0}:{enter:i.enter,leave:i.leave}}function gl(i){return GA(i,YA)}const $A=80,YA={Name:{leave:i=>i.value},Variable:{leave:i=>"$"+i.name},Document:{leave:i=>sn(i.definitions,`

`)},OperationDefinition:{leave(i){const n=li("(",sn(i.variableDefinitions,", "),")"),a=sn([i.operation,sn([i.name,n]),sn(i.directives," ")]," ");return(a==="query"?"":a+" ")+i.selectionSet}},VariableDefinition:{leave:({variable:i,type:n,defaultValue:a,directives:h})=>i+": "+n+li(" = ",a)+li(" ",sn(h," "))},SelectionSet:{leave:({selections:i})=>$c(i)},Field:{leave({alias:i,name:n,arguments:a,directives:h,selectionSet:p}){const v=li("",i,": ")+n;let g=v+li("(",sn(a,", "),")");return g.length>$A&&(g=v+li(`(
`,A0(sn(a,`
`)),`
)`)),sn([g,sn(h," "),p]," ")}},Argument:{leave:({name:i,value:n})=>i+": "+n},FragmentSpread:{leave:({name:i,directives:n})=>"..."+i+li(" ",sn(n," "))},InlineFragment:{leave:({typeCondition:i,directives:n,selectionSet:a})=>sn(["...",li("on ",i),sn(n," "),a]," ")},FragmentDefinition:{leave:({name:i,typeCondition:n,variableDefinitions:a,directives:h,selectionSet:p})=>`fragment ${i}${li("(",sn(a,", "),")")} on ${n} ${li("",sn(h," ")," ")}`+p},IntValue:{leave:({value:i})=>i},FloatValue:{leave:({value:i})=>i},StringValue:{leave:({value:i,block:n})=>n?uA(i):BA(i)},BooleanValue:{leave:({value:i})=>i?"true":"false"},NullValue:{leave:()=>"null"},EnumValue:{leave:({value:i})=>i},ListValue:{leave:({values:i})=>"["+sn(i,", ")+"]"},ObjectValue:{leave:({fields:i})=>"{"+sn(i,", ")+"}"},ObjectField:{leave:({name:i,value:n})=>i+": "+n},Directive:{leave:({name:i,arguments:n})=>"@"+i+li("(",sn(n,", "),")")},NamedType:{leave:({name:i})=>i},ListType:{leave:({type:i})=>"["+i+"]"},NonNullType:{leave:({type:i})=>i+"!"},SchemaDefinition:{leave:({description:i,directives:n,operationTypes:a})=>li("",i,`
`)+sn(["schema",sn(n," "),$c(a)]," ")},OperationTypeDefinition:{leave:({operation:i,type:n})=>i+": "+n},ScalarTypeDefinition:{leave:({description:i,name:n,directives:a})=>li("",i,`
`)+sn(["scalar",n,sn(a," ")]," ")},ObjectTypeDefinition:{leave:({description:i,name:n,interfaces:a,directives:h,fields:p})=>li("",i,`
`)+sn(["type",n,li("implements ",sn(a," & ")),sn(h," "),$c(p)]," ")},FieldDefinition:{leave:({description:i,name:n,arguments:a,type:h,directives:p})=>li("",i,`
`)+n+(E1(a)?li(`(
`,A0(sn(a,`
`)),`
)`):li("(",sn(a,", "),")"))+": "+h+li(" ",sn(p," "))},InputValueDefinition:{leave:({description:i,name:n,type:a,defaultValue:h,directives:p})=>li("",i,`
`)+sn([n+": "+a,li("= ",h),sn(p," ")]," ")},InterfaceTypeDefinition:{leave:({description:i,name:n,interfaces:a,directives:h,fields:p})=>li("",i,`
`)+sn(["interface",n,li("implements ",sn(a," & ")),sn(h," "),$c(p)]," ")},UnionTypeDefinition:{leave:({description:i,name:n,directives:a,types:h})=>li("",i,`
`)+sn(["union",n,sn(a," "),li("= ",sn(h," | "))]," ")},EnumTypeDefinition:{leave:({description:i,name:n,directives:a,values:h})=>li("",i,`
`)+sn(["enum",n,sn(a," "),$c(h)]," ")},EnumValueDefinition:{leave:({description:i,name:n,directives:a})=>li("",i,`
`)+sn([n,sn(a," ")]," ")},InputObjectTypeDefinition:{leave:({description:i,name:n,directives:a,fields:h})=>li("",i,`
`)+sn(["input",n,sn(a," "),$c(h)]," ")},DirectiveDefinition:{leave:({description:i,name:n,arguments:a,repeatable:h,locations:p})=>li("",i,`
`)+"directive @"+n+(E1(a)?li(`(
`,A0(sn(a,`
`)),`
)`):li("(",sn(a,", "),")"))+(h?" repeatable":"")+" on "+sn(p," | ")},SchemaExtension:{leave:({directives:i,operationTypes:n})=>sn(["extend schema",sn(i," "),$c(n)]," ")},ScalarTypeExtension:{leave:({name:i,directives:n})=>sn(["extend scalar",i,sn(n," ")]," ")},ObjectTypeExtension:{leave:({name:i,interfaces:n,directives:a,fields:h})=>sn(["extend type",i,li("implements ",sn(n," & ")),sn(a," "),$c(h)]," ")},InterfaceTypeExtension:{leave:({name:i,interfaces:n,directives:a,fields:h})=>sn(["extend interface",i,li("implements ",sn(n," & ")),sn(a," "),$c(h)]," ")},UnionTypeExtension:{leave:({name:i,directives:n,types:a})=>sn(["extend union",i,sn(n," "),li("= ",sn(a," | "))]," ")},EnumTypeExtension:{leave:({name:i,directives:n,values:a})=>sn(["extend enum",i,sn(n," "),$c(a)]," ")},InputObjectTypeExtension:{leave:({name:i,directives:n,fields:a})=>sn(["extend input",i,sn(n," "),$c(a)]," ")}};function sn(i,n=""){var a;return(a=i==null?void 0:i.filter(h=>h).join(n))!==null&&a!==void 0?a:""}function $c(i){return li(`{
`,A0(sn(i,`
`)),`
}`)}function li(i,n,a=""){return n!=null&&n!==""?i+n+a:""}function A0(i){return li("  ",i.replace(/\n/g,`
  `))}function E1(i){var n;return(n=i==null?void 0:i.some(a=>a.includes(`
`)))!==null&&n!==void 0?n:!1}function vb(i,n){switch(i.kind){case Vt.NULL:return null;case Vt.INT:return parseInt(i.value,10);case Vt.FLOAT:return parseFloat(i.value);case Vt.STRING:case Vt.ENUM:case Vt.BOOLEAN:return i.value;case Vt.LIST:return i.values.map(a=>vb(a,n));case Vt.OBJECT:return Qp(i.fields,a=>a.name.value,a=>vb(a.value,n));case Vt.VARIABLE:return n==null?void 0:n[i.name.value]}}function eu(i){if(i!=null||Ri(!1,"Must provide name."),typeof i=="string"||Ri(!1,"Expected name to be a string."),i.length===0)throw new Bi("Expected name to be a non-empty string.");for(let n=1;n<i.length;++n)if(!uT(i.charCodeAt(n)))throw new Bi(`Names must only contain [_a-zA-Z0-9] but "${i}" does not.`);if(!Wb(i.charCodeAt(0)))throw new Bi(`Names must start with [_a-zA-Z] but "${i}" does not.`);return i}function qA(i){if(i==="true"||i==="false"||i==="null")throw new Bi(`Enum values cannot be named: ${i}`);return eu(i)}function _T(i){return Ug(i)||Cf(i)||Qc(i)||am(i)||Mf(i)||td(i)||zf(i)||nd(i)}function Ug(i){return th(i,mm)}function Cf(i){return th(i,Of)}function HA(i){if(!Cf(i))throw new Error(`Expected ${kn(i)} to be a GraphQL Object type.`);return i}function Qc(i){return th(i,IT)}function XA(i){if(!Qc(i))throw new Error(`Expected ${kn(i)} to be a GraphQL Interface type.`);return i}function am(i){return th(i,kT)}function Mf(i){return th(i,av)}function td(i){return th(i,RT)}function zf(i){return th(i,Jl)}function nd(i){return th(i,pi)}function vT(i){return Ug(i)||Mf(i)||td(i)||Qb(i)&&vT(i.ofType)}function bT(i){return Ug(i)||Cf(i)||Qc(i)||am(i)||Mf(i)||Qb(i)&&bT(i.ofType)}function xT(i){return Ug(i)||Mf(i)}function WA(i){return Qc(i)||am(i)}class Jl{constructor(n){_T(n)||Ri(!1,`Expected ${kn(n)} to be a GraphQL type.`),this.ofType=n}get[Symbol.toStringTag](){return"GraphQLList"}toString(){return"["+String(this.ofType)+"]"}toJSON(){return this.toString()}}class pi{constructor(n){wT(n)||Ri(!1,`Expected ${kn(n)} to be a GraphQL nullable type.`),this.ofType=n}get[Symbol.toStringTag](){return"GraphQLNonNull"}toString(){return String(this.ofType)+"!"}toJSON(){return this.toString()}}function Qb(i){return zf(i)||nd(i)}function wT(i){return _T(i)&&!nd(i)}function QA(i){if(!wT(i))throw new Error(`Expected ${kn(i)} to be a GraphQL nullable type.`);return i}function KA(i){if(i){let n=i;for(;Qb(n);)n=n.ofType;return n}}function TT(i){return typeof i=="function"?i():i}function ET(i){return typeof i=="function"?i():i}class mm{constructor(n){var a,h,p,v;const g=(a=n.parseValue)!==null&&a!==void 0?a:w1;this.name=eu(n.name),this.description=n.description,this.specifiedByURL=n.specifiedByURL,this.serialize=(h=n.serialize)!==null&&h!==void 0?h:w1,this.parseValue=g,this.parseLiteral=(p=n.parseLiteral)!==null&&p!==void 0?p:(c,A)=>g(vb(c,A)),this.extensions=rc(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(v=n.extensionASTNodes)!==null&&v!==void 0?v:[],n.specifiedByURL==null||typeof n.specifiedByURL=="string"||Ri(!1,`${this.name} must provide "specifiedByURL" as a string, but got: ${kn(n.specifiedByURL)}.`),n.serialize==null||typeof n.serialize=="function"||Ri(!1,`${this.name} must provide "serialize" function. If this custom Scalar is also used as an input type, ensure "parseValue" and "parseLiteral" functions are also provided.`),n.parseLiteral&&(typeof n.parseValue=="function"&&typeof n.parseLiteral=="function"||Ri(!1,`${this.name} must provide both "parseValue" and "parseLiteral" functions.`))}get[Symbol.toStringTag](){return"GraphQLScalarType"}toConfig(){return{name:this.name,description:this.description,specifiedByURL:this.specifiedByURL,serialize:this.serialize,parseValue:this.parseValue,parseLiteral:this.parseLiteral,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class Of{constructor(n){var a;this.name=eu(n.name),this.description=n.description,this.isTypeOf=n.isTypeOf,this.extensions=rc(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(a=n.extensionASTNodes)!==null&&a!==void 0?a:[],this._fields=()=>AT(n),this._interfaces=()=>ST(n),n.isTypeOf==null||typeof n.isTypeOf=="function"||Ri(!1,`${this.name} must provide "isTypeOf" as a function, but got: ${kn(n.isTypeOf)}.`)}get[Symbol.toStringTag](){return"GraphQLObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:MT(this.getFields()),isTypeOf:this.isTypeOf,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function ST(i){var n;const a=TT((n=i.interfaces)!==null&&n!==void 0?n:[]);return Array.isArray(a)||Ri(!1,`${i.name} interfaces must be an Array or a function which returns an Array.`),a}function AT(i){const n=ET(i.fields);return yg(n)||Ri(!1,`${i.name} fields must be an object with field names as keys or a function which returns such an object.`),rv(n,(a,h)=>{var p;yg(a)||Ri(!1,`${i.name}.${h} field config must be an object.`),a.resolve==null||typeof a.resolve=="function"||Ri(!1,`${i.name}.${h} field resolver must be a function if provided, but got: ${kn(a.resolve)}.`);const v=(p=a.args)!==null&&p!==void 0?p:{};return yg(v)||Ri(!1,`${i.name}.${h} args must be an object with argument names as keys.`),{name:eu(h),description:a.description,type:a.type,args:CT(v),resolve:a.resolve,subscribe:a.subscribe,deprecationReason:a.deprecationReason,extensions:rc(a.extensions),astNode:a.astNode}})}function CT(i){return Object.entries(i).map(([n,a])=>({name:eu(n),description:a.description,type:a.type,defaultValue:a.defaultValue,deprecationReason:a.deprecationReason,extensions:rc(a.extensions),astNode:a.astNode}))}function yg(i){return ld(i)&&!Array.isArray(i)}function MT(i){return rv(i,n=>({description:n.description,type:n.type,args:DT(n.args),resolve:n.resolve,subscribe:n.subscribe,deprecationReason:n.deprecationReason,extensions:n.extensions,astNode:n.astNode}))}function DT(i){return Qp(i,n=>n.name,n=>({description:n.description,type:n.type,defaultValue:n.defaultValue,deprecationReason:n.deprecationReason,extensions:n.extensions,astNode:n.astNode}))}class IT{constructor(n){var a;this.name=eu(n.name),this.description=n.description,this.resolveType=n.resolveType,this.extensions=rc(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(a=n.extensionASTNodes)!==null&&a!==void 0?a:[],this._fields=AT.bind(void 0,n),this._interfaces=ST.bind(void 0,n),n.resolveType==null||typeof n.resolveType=="function"||Ri(!1,`${this.name} must provide "resolveType" as a function, but got: ${kn(n.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLInterfaceType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}getInterfaces(){return typeof this._interfaces=="function"&&(this._interfaces=this._interfaces()),this._interfaces}toConfig(){return{name:this.name,description:this.description,interfaces:this.getInterfaces(),fields:MT(this.getFields()),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}class kT{constructor(n){var a;this.name=eu(n.name),this.description=n.description,this.resolveType=n.resolveType,this.extensions=rc(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(a=n.extensionASTNodes)!==null&&a!==void 0?a:[],this._types=JA.bind(void 0,n),n.resolveType==null||typeof n.resolveType=="function"||Ri(!1,`${this.name} must provide "resolveType" as a function, but got: ${kn(n.resolveType)}.`)}get[Symbol.toStringTag](){return"GraphQLUnionType"}getTypes(){return typeof this._types=="function"&&(this._types=this._types()),this._types}toConfig(){return{name:this.name,description:this.description,types:this.getTypes(),resolveType:this.resolveType,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function JA(i){const n=TT(i.types);return Array.isArray(n)||Ri(!1,`Must provide Array of types or a function which returns such an array for Union ${i.name}.`),n}class av{constructor(n){var a;this.name=eu(n.name),this.description=n.description,this.extensions=rc(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(a=n.extensionASTNodes)!==null&&a!==void 0?a:[],this._values=typeof n.values=="function"?n.values:S1(this.name,n.values),this._valueLookup=null,this._nameLookup=null}get[Symbol.toStringTag](){return"GraphQLEnumType"}getValues(){return typeof this._values=="function"&&(this._values=S1(this.name,this._values())),this._values}getValue(n){return this._nameLookup===null&&(this._nameLookup=yT(this.getValues(),a=>a.name)),this._nameLookup[n]}serialize(n){this._valueLookup===null&&(this._valueLookup=new Map(this.getValues().map(h=>[h.value,h])));const a=this._valueLookup.get(n);if(a===void 0)throw new Bi(`Enum "${this.name}" cannot represent value: ${kn(n)}`);return a.name}parseValue(n){if(typeof n!="string"){const h=kn(n);throw new Bi(`Enum "${this.name}" cannot represent non-string value: ${h}.`+v0(this,h))}const a=this.getValue(n);if(a==null)throw new Bi(`Value "${n}" does not exist in "${this.name}" enum.`+v0(this,n));return a.value}parseLiteral(n,a){if(n.kind!==Vt.ENUM){const p=gl(n);throw new Bi(`Enum "${this.name}" cannot represent non-enum value: ${p}.`+v0(this,p),{nodes:n})}const h=this.getValue(n.value);if(h==null){const p=gl(n);throw new Bi(`Value "${p}" does not exist in "${this.name}" enum.`+v0(this,p),{nodes:n})}return h.value}toConfig(){const n=Qp(this.getValues(),a=>a.name,a=>({description:a.description,value:a.value,deprecationReason:a.deprecationReason,extensions:a.extensions,astNode:a.astNode}));return{name:this.name,description:this.description,values:n,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes}}toString(){return this.name}toJSON(){return this.toString()}}function v0(i,n){const a=i.getValues().map(p=>p.name),h=OA(n,a);return NA("the enum value",h)}function S1(i,n){return yg(n)||Ri(!1,`${i} values must be an object with value names as keys.`),Object.entries(n).map(([a,h])=>(yg(h)||Ri(!1,`${i}.${a} must refer to an object with a "value" key representing an internal value but got: ${kn(h)}.`),{name:qA(a),description:h.description,value:h.value!==void 0?h.value:a,deprecationReason:h.deprecationReason,extensions:rc(h.extensions),astNode:h.astNode}))}class RT{constructor(n){var a,h;this.name=eu(n.name),this.description=n.description,this.extensions=rc(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(a=n.extensionASTNodes)!==null&&a!==void 0?a:[],this.isOneOf=(h=n.isOneOf)!==null&&h!==void 0?h:!1,this._fields=eC.bind(void 0,n)}get[Symbol.toStringTag](){return"GraphQLInputObjectType"}getFields(){return typeof this._fields=="function"&&(this._fields=this._fields()),this._fields}toConfig(){const n=rv(this.getFields(),a=>({description:a.description,type:a.type,defaultValue:a.defaultValue,deprecationReason:a.deprecationReason,extensions:a.extensions,astNode:a.astNode}));return{name:this.name,description:this.description,fields:n,extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,isOneOf:this.isOneOf}}toString(){return this.name}toJSON(){return this.toString()}}function eC(i){const n=ET(i.fields);return yg(n)||Ri(!1,`${i.name} fields must be an object with field names as keys or a function which returns such an object.`),rv(n,(a,h)=>(!("resolve"in a)||Ri(!1,`${i.name}.${h} field has a resolve property, but Input Types cannot define resolvers.`),{name:eu(h),description:a.description,type:a.type,defaultValue:a.defaultValue,deprecationReason:a.deprecationReason,extensions:rc(a.extensions),astNode:a.astNode}))}const qv=2147483647,Hv=-2147483648,tC=new mm({name:"Int",description:"The `Int` scalar type represents non-fractional signed whole numeric values. Int can represent values between -(2^31) and 2^31 - 1.",serialize(i){const n=f_(i);if(typeof n=="boolean")return n?1:0;let a=n;if(typeof n=="string"&&n!==""&&(a=Number(n)),typeof a!="number"||!Number.isInteger(a))throw new Bi(`Int cannot represent non-integer value: ${kn(n)}`);if(a>qv||a<Hv)throw new Bi("Int cannot represent non 32-bit signed integer value: "+kn(n));return a},parseValue(i){if(typeof i!="number"||!Number.isInteger(i))throw new Bi(`Int cannot represent non-integer value: ${kn(i)}`);if(i>qv||i<Hv)throw new Bi(`Int cannot represent non 32-bit signed integer value: ${i}`);return i},parseLiteral(i){if(i.kind!==Vt.INT)throw new Bi(`Int cannot represent non-integer value: ${gl(i)}`,{nodes:i});const n=parseInt(i.value,10);if(n>qv||n<Hv)throw new Bi(`Int cannot represent non 32-bit signed integer value: ${i.value}`,{nodes:i});return n}}),nC=new mm({name:"Float",description:"The `Float` scalar type represents signed double-precision fractional values as specified by [IEEE 754](https://en.wikipedia.org/wiki/IEEE_floating_point).",serialize(i){const n=f_(i);if(typeof n=="boolean")return n?1:0;let a=n;if(typeof n=="string"&&n!==""&&(a=Number(n)),typeof a!="number"||!Number.isFinite(a))throw new Bi(`Float cannot represent non numeric value: ${kn(n)}`);return a},parseValue(i){if(typeof i!="number"||!Number.isFinite(i))throw new Bi(`Float cannot represent non numeric value: ${kn(i)}`);return i},parseLiteral(i){if(i.kind!==Vt.FLOAT&&i.kind!==Vt.INT)throw new Bi(`Float cannot represent non numeric value: ${gl(i)}`,i);return parseFloat(i.value)}}),ua=new mm({name:"String",description:"The `String` scalar type represents textual data, represented as UTF-8 character sequences. The String type is most often used by GraphQL to represent free-form human-readable text.",serialize(i){const n=f_(i);if(typeof n=="string")return n;if(typeof n=="boolean")return n?"true":"false";if(typeof n=="number"&&Number.isFinite(n))return n.toString();throw new Bi(`String cannot represent value: ${kn(i)}`)},parseValue(i){if(typeof i!="string")throw new Bi(`String cannot represent a non string value: ${kn(i)}`);return i},parseLiteral(i){if(i.kind!==Vt.STRING)throw new Bi(`String cannot represent a non string value: ${gl(i)}`,{nodes:i});return i.value}}),fl=new mm({name:"Boolean",description:"The `Boolean` scalar type represents `true` or `false`.",serialize(i){const n=f_(i);if(typeof n=="boolean")return n;if(Number.isFinite(n))return n!==0;throw new Bi(`Boolean cannot represent a non boolean value: ${kn(n)}`)},parseValue(i){if(typeof i!="boolean")throw new Bi(`Boolean cannot represent a non boolean value: ${kn(i)}`);return i},parseLiteral(i){if(i.kind!==Vt.BOOLEAN)throw new Bi(`Boolean cannot represent a non boolean value: ${gl(i)}`,{nodes:i});return i.value}}),NT=new mm({name:"ID",description:'The `ID` scalar type represents a unique identifier, often used to refetch an object or as key for a cache. The ID type appears in a JSON response as a String; however, it is not intended to be human-readable. When expected as an input type, any string (such as `"4"`) or integer (such as `4`) input value will be accepted as an ID.',serialize(i){const n=f_(i);if(typeof n=="string")return n;if(Number.isInteger(n))return String(n);throw new Bi(`ID cannot represent value: ${kn(i)}`)},parseValue(i){if(typeof i=="string")return i;if(typeof i=="number"&&Number.isInteger(i))return i.toString();throw new Bi(`ID cannot represent value: ${kn(i)}`)},parseLiteral(i){if(i.kind!==Vt.STRING&&i.kind!==Vt.INT)throw new Bi("ID cannot represent a non-string and non-integer value: "+gl(i),{nodes:i});return i.value}}),iC=Object.freeze([ua,tC,nC,fl,NT]);function f_(i){if(ld(i)){if(typeof i.valueOf=="function"){const n=i.valueOf();if(!ld(n))return n}if(typeof i.toJSON=="function")return i.toJSON()}return i}function rC(i){return th(i,gm)}class gm{constructor(n){var a,h;this.name=eu(n.name),this.description=n.description,this.locations=n.locations,this.isRepeatable=(a=n.isRepeatable)!==null&&a!==void 0?a:!1,this.extensions=rc(n.extensions),this.astNode=n.astNode,Array.isArray(n.locations)||Ri(!1,`@${n.name} locations must be an Array.`);const p=(h=n.args)!==null&&h!==void 0?h:{};ld(p)&&!Array.isArray(p)||Ri(!1,`@${n.name} args must be an object with argument names as keys.`),this.args=CT(p)}get[Symbol.toStringTag](){return"GraphQLDirective"}toConfig(){return{name:this.name,description:this.description,locations:this.locations,args:DT(this.args),isRepeatable:this.isRepeatable,extensions:this.extensions,astNode:this.astNode}}toString(){return"@"+this.name}toJSON(){return this.toString()}}const aC=new gm({name:"include",description:"Directs the executor to include this field or fragment only when the `if` argument is true.",locations:[bi.FIELD,bi.FRAGMENT_SPREAD,bi.INLINE_FRAGMENT],args:{if:{type:new pi(fl),description:"Included when true."}}}),oC=new gm({name:"skip",description:"Directs the executor to skip this field or fragment when the `if` argument is true.",locations:[bi.FIELD,bi.FRAGMENT_SPREAD,bi.INLINE_FRAGMENT],args:{if:{type:new pi(fl),description:"Skipped when true."}}}),sC="No longer supported",lC=new gm({name:"deprecated",description:"Marks an element of a GraphQL schema as no longer supported.",locations:[bi.FIELD_DEFINITION,bi.ARGUMENT_DEFINITION,bi.INPUT_FIELD_DEFINITION,bi.ENUM_VALUE],args:{reason:{type:ua,description:"Explains why this element was deprecated, usually also including a suggestion for how to access supported similar data. Formatted using the Markdown syntax, as specified by [CommonMark](https://commonmark.org/).",defaultValue:sC}}}),cC=new gm({name:"specifiedBy",description:"Exposes a URL that specifies the behavior of this scalar.",locations:[bi.SCALAR],args:{url:{type:new pi(ua),description:"The URL that specifies the behavior of this scalar."}}}),uC=new gm({name:"oneOf",description:"Indicates exactly one field must be supplied and this field must not be `null`.",locations:[bi.INPUT_OBJECT],args:{}}),hC=Object.freeze([aC,oC,lC,cC,uC]);function dC(i){return typeof i=="object"&&typeof(i==null?void 0:i[Symbol.iterator])=="function"}function Yy(i,n){if(nd(n)){const a=Yy(i,n.ofType);return(a==null?void 0:a.kind)===Vt.NULL?null:a}if(i===null)return{kind:Vt.NULL};if(i===void 0)return null;if(zf(n)){const a=n.ofType;if(dC(i)){const h=[];for(const p of i){const v=Yy(p,a);v!=null&&h.push(v)}return{kind:Vt.LIST,values:h}}return Yy(i,a)}if(td(n)){if(!ld(i))return null;const a=[];for(const h of Object.values(n.getFields())){const p=Yy(i[h.name],h.type);p&&a.push({kind:Vt.OBJECT_FIELD,name:{kind:Vt.NAME,value:h.name},value:p})}return{kind:Vt.OBJECT,fields:a}}if(xT(n)){const a=n.serialize(i);if(a==null)return null;if(typeof a=="boolean")return{kind:Vt.BOOLEAN,value:a};if(typeof a=="number"&&Number.isFinite(a)){const h=String(a);return A1.test(h)?{kind:Vt.INT,value:h}:{kind:Vt.FLOAT,value:h}}if(typeof a=="string")return Mf(n)?{kind:Vt.ENUM,value:a}:n===NT&&A1.test(a)?{kind:Vt.INT,value:a}:{kind:Vt.STRING,value:a};throw new TypeError(`Cannot convert value to AST: ${kn(a)}.`)}tv(!1,"Unexpected input type: "+kn(n))}const A1=/^-?(?:0|[1-9][0-9]*)$/,Kb=new Of({name:"__Schema",description:"A GraphQL Schema defines the capabilities of a GraphQL server. It exposes all available types and directives on the server, as well as the entry points for query, mutation, and subscription operations.",fields:()=>({description:{type:ua,resolve:i=>i.description},types:{description:"A list of all types supported by this server.",type:new pi(new Jl(new pi(Yu))),resolve(i){return Object.values(i.getTypeMap())}},queryType:{description:"The type that query operations will be rooted at.",type:new pi(Yu),resolve:i=>i.getQueryType()},mutationType:{description:"If this server supports mutation, the type that mutation operations will be rooted at.",type:Yu,resolve:i=>i.getMutationType()},subscriptionType:{description:"If this server support subscription, the type that subscription operations will be rooted at.",type:Yu,resolve:i=>i.getSubscriptionType()},directives:{description:"A list of all directives supported by this server.",type:new pi(new Jl(new pi(PT))),resolve:i=>i.getDirectives()}})}),PT=new Of({name:"__Directive",description:`A Directive provides a way to describe alternate runtime execution and type validation behavior in a GraphQL document.

In some cases, you need to provide options to alter GraphQL's execution behavior in ways field arguments will not suffice, such as conditionally including or skipping a field. Directives provide this by describing additional information to the executor.`,fields:()=>({name:{type:new pi(ua),resolve:i=>i.name},description:{type:ua,resolve:i=>i.description},isRepeatable:{type:new pi(fl),resolve:i=>i.isRepeatable},locations:{type:new pi(new Jl(new pi(zT))),resolve:i=>i.locations},args:{type:new pi(new Jl(new pi(ov))),args:{includeDeprecated:{type:fl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){return n?i.args:i.args.filter(a=>a.deprecationReason==null)}}})}),zT=new av({name:"__DirectiveLocation",description:"A Directive can be adjacent to many parts of the GraphQL language, a __DirectiveLocation describes one such possible adjacencies.",values:{QUERY:{value:bi.QUERY,description:"Location adjacent to a query operation."},MUTATION:{value:bi.MUTATION,description:"Location adjacent to a mutation operation."},SUBSCRIPTION:{value:bi.SUBSCRIPTION,description:"Location adjacent to a subscription operation."},FIELD:{value:bi.FIELD,description:"Location adjacent to a field."},FRAGMENT_DEFINITION:{value:bi.FRAGMENT_DEFINITION,description:"Location adjacent to a fragment definition."},FRAGMENT_SPREAD:{value:bi.FRAGMENT_SPREAD,description:"Location adjacent to a fragment spread."},INLINE_FRAGMENT:{value:bi.INLINE_FRAGMENT,description:"Location adjacent to an inline fragment."},VARIABLE_DEFINITION:{value:bi.VARIABLE_DEFINITION,description:"Location adjacent to a variable definition."},SCHEMA:{value:bi.SCHEMA,description:"Location adjacent to a schema definition."},SCALAR:{value:bi.SCALAR,description:"Location adjacent to a scalar definition."},OBJECT:{value:bi.OBJECT,description:"Location adjacent to an object type definition."},FIELD_DEFINITION:{value:bi.FIELD_DEFINITION,description:"Location adjacent to a field definition."},ARGUMENT_DEFINITION:{value:bi.ARGUMENT_DEFINITION,description:"Location adjacent to an argument definition."},INTERFACE:{value:bi.INTERFACE,description:"Location adjacent to an interface definition."},UNION:{value:bi.UNION,description:"Location adjacent to a union definition."},ENUM:{value:bi.ENUM,description:"Location adjacent to an enum definition."},ENUM_VALUE:{value:bi.ENUM_VALUE,description:"Location adjacent to an enum value definition."},INPUT_OBJECT:{value:bi.INPUT_OBJECT,description:"Location adjacent to an input object type definition."},INPUT_FIELD_DEFINITION:{value:bi.INPUT_FIELD_DEFINITION,description:"Location adjacent to an input object field definition."}}}),Yu=new Of({name:"__Type",description:"The fundamental unit of any GraphQL Schema is the type. There are many kinds of types in GraphQL as represented by the `__TypeKind` enum.\n\nDepending on the kind of a type, certain fields describe information about that type. Scalar types provide no information beyond a name, description and optional `specifiedByURL`, while Enum types provide their values. Object and Interface types provide the fields they describe. Abstract types, Union and Interface, provide the Object types possible at runtime. List and NonNull types compose other types.",fields:()=>({kind:{type:new pi(BT),resolve(i){if(Ug(i))return dr.SCALAR;if(Cf(i))return dr.OBJECT;if(Qc(i))return dr.INTERFACE;if(am(i))return dr.UNION;if(Mf(i))return dr.ENUM;if(td(i))return dr.INPUT_OBJECT;if(zf(i))return dr.LIST;if(nd(i))return dr.NON_NULL;tv(!1,`Unexpected type: "${kn(i)}".`)}},name:{type:ua,resolve:i=>"name"in i?i.name:void 0},description:{type:ua,resolve:i=>"description"in i?i.description:void 0},specifiedByURL:{type:ua,resolve:i=>"specifiedByURL"in i?i.specifiedByURL:void 0},fields:{type:new Jl(new pi(OT)),args:{includeDeprecated:{type:fl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(Cf(i)||Qc(i)){const a=Object.values(i.getFields());return n?a:a.filter(h=>h.deprecationReason==null)}}},interfaces:{type:new Jl(new pi(Yu)),resolve(i){if(Cf(i)||Qc(i))return i.getInterfaces()}},possibleTypes:{type:new Jl(new pi(Yu)),resolve(i,n,a,{schema:h}){if(WA(i))return h.getPossibleTypes(i)}},enumValues:{type:new Jl(new pi(LT)),args:{includeDeprecated:{type:fl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(Mf(i)){const a=i.getValues();return n?a:a.filter(h=>h.deprecationReason==null)}}},inputFields:{type:new Jl(new pi(ov)),args:{includeDeprecated:{type:fl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){if(td(i)){const a=Object.values(i.getFields());return n?a:a.filter(h=>h.deprecationReason==null)}}},ofType:{type:Yu,resolve:i=>"ofType"in i?i.ofType:void 0},isOneOf:{type:fl,resolve:i=>{if(td(i))return i.isOneOf}}})}),OT=new Of({name:"__Field",description:"Object and Interface types are described by a list of Fields, each of which has a name, potentially a list of arguments, and a return type.",fields:()=>({name:{type:new pi(ua),resolve:i=>i.name},description:{type:ua,resolve:i=>i.description},args:{type:new pi(new Jl(new pi(ov))),args:{includeDeprecated:{type:fl,defaultValue:!1}},resolve(i,{includeDeprecated:n}){return n?i.args:i.args.filter(a=>a.deprecationReason==null)}},type:{type:new pi(Yu),resolve:i=>i.type},isDeprecated:{type:new pi(fl),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:ua,resolve:i=>i.deprecationReason}})}),ov=new Of({name:"__InputValue",description:"Arguments provided to Fields or Directives and the input fields of an InputObject are represented as Input Values which describe their type and optionally a default value.",fields:()=>({name:{type:new pi(ua),resolve:i=>i.name},description:{type:ua,resolve:i=>i.description},type:{type:new pi(Yu),resolve:i=>i.type},defaultValue:{type:ua,description:"A GraphQL-formatted string representing the default value for this input value.",resolve(i){const{type:n,defaultValue:a}=i,h=Yy(a,n);return h?gl(h):null}},isDeprecated:{type:new pi(fl),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:ua,resolve:i=>i.deprecationReason}})}),LT=new Of({name:"__EnumValue",description:"One possible value for a given Enum. Enum values are unique values, not a placeholder for a string or numeric value. However an Enum value is returned in a JSON response as a string.",fields:()=>({name:{type:new pi(ua),resolve:i=>i.name},description:{type:ua,resolve:i=>i.description},isDeprecated:{type:new pi(fl),resolve:i=>i.deprecationReason!=null},deprecationReason:{type:ua,resolve:i=>i.deprecationReason}})});var dr;(function(i){i.SCALAR="SCALAR",i.OBJECT="OBJECT",i.INTERFACE="INTERFACE",i.UNION="UNION",i.ENUM="ENUM",i.INPUT_OBJECT="INPUT_OBJECT",i.LIST="LIST",i.NON_NULL="NON_NULL"})(dr||(dr={}));const BT=new av({name:"__TypeKind",description:"An enum describing what kind of type a given `__Type` is.",values:{SCALAR:{value:dr.SCALAR,description:"Indicates this type is a scalar."},OBJECT:{value:dr.OBJECT,description:"Indicates this type is an object. `fields` and `interfaces` are valid fields."},INTERFACE:{value:dr.INTERFACE,description:"Indicates this type is an interface. `fields`, `interfaces`, and `possibleTypes` are valid fields."},UNION:{value:dr.UNION,description:"Indicates this type is a union. `possibleTypes` is a valid field."},ENUM:{value:dr.ENUM,description:"Indicates this type is an enum. `enumValues` is a valid field."},INPUT_OBJECT:{value:dr.INPUT_OBJECT,description:"Indicates this type is an input object. `inputFields` is a valid field."},LIST:{value:dr.LIST,description:"Indicates this type is a list. `ofType` is a valid field."},NON_NULL:{value:dr.NON_NULL,description:"Indicates this type is a non-null. `ofType` is a valid field."}}});new pi(Kb);new pi(ua);new pi(ua);const fC=Object.freeze([Kb,PT,zT,Yu,OT,ov,LT,BT]);class pC{constructor(n){var a,h;this.__validationErrors=n.assumeValid===!0?[]:void 0,ld(n)||Ri(!1,"Must provide configuration object."),!n.types||Array.isArray(n.types)||Ri(!1,`"types" must be Array if provided but got: ${kn(n.types)}.`),!n.directives||Array.isArray(n.directives)||Ri(!1,`"directives" must be Array if provided but got: ${kn(n.directives)}.`),this.description=n.description,this.extensions=rc(n.extensions),this.astNode=n.astNode,this.extensionASTNodes=(a=n.extensionASTNodes)!==null&&a!==void 0?a:[],this._queryType=n.query,this._mutationType=n.mutation,this._subscriptionType=n.subscription,this._directives=(h=n.directives)!==null&&h!==void 0?h:hC;const p=new Set(n.types);if(n.types!=null)for(const v of n.types)p.delete(v),qc(v,p);this._queryType!=null&&qc(this._queryType,p),this._mutationType!=null&&qc(this._mutationType,p),this._subscriptionType!=null&&qc(this._subscriptionType,p);for(const v of this._directives)if(rC(v))for(const g of v.args)qc(g.type,p);qc(Kb,p),this._typeMap=Object.create(null),this._subTypeMap=Object.create(null),this._implementationsMap=Object.create(null);for(const v of p){if(v==null)continue;const g=v.name;if(g||Ri(!1,"One of the provided types for building the Schema is missing a name."),this._typeMap[g]!==void 0)throw new Error(`Schema must contain uniquely named types but contains multiple types named "${g}".`);if(this._typeMap[g]=v,Qc(v)){for(const c of v.getInterfaces())if(Qc(c)){let A=this._implementationsMap[c.name];A===void 0&&(A=this._implementationsMap[c.name]={objects:[],interfaces:[]}),A.interfaces.push(v)}}else if(Cf(v)){for(const c of v.getInterfaces())if(Qc(c)){let A=this._implementationsMap[c.name];A===void 0&&(A=this._implementationsMap[c.name]={objects:[],interfaces:[]}),A.objects.push(v)}}}}get[Symbol.toStringTag](){return"GraphQLSchema"}getQueryType(){return this._queryType}getMutationType(){return this._mutationType}getSubscriptionType(){return this._subscriptionType}getRootType(n){switch(n){case $u.QUERY:return this.getQueryType();case $u.MUTATION:return this.getMutationType();case $u.SUBSCRIPTION:return this.getSubscriptionType()}}getTypeMap(){return this._typeMap}getType(n){return this.getTypeMap()[n]}getPossibleTypes(n){return am(n)?n.getTypes():this.getImplementations(n).objects}getImplementations(n){const a=this._implementationsMap[n.name];return a??{objects:[],interfaces:[]}}isSubType(n,a){let h=this._subTypeMap[n.name];if(h===void 0){if(h=Object.create(null),am(n))for(const p of n.getTypes())h[p.name]=!0;else{const p=this.getImplementations(n);for(const v of p.objects)h[v.name]=!0;for(const v of p.interfaces)h[v.name]=!0}this._subTypeMap[n.name]=h}return h[a.name]!==void 0}getDirectives(){return this._directives}getDirective(n){return this.getDirectives().find(a=>a.name===n)}toConfig(){return{description:this.description,query:this.getQueryType(),mutation:this.getMutationType(),subscription:this.getSubscriptionType(),types:Object.values(this.getTypeMap()),directives:this.getDirectives(),extensions:this.extensions,astNode:this.astNode,extensionASTNodes:this.extensionASTNodes,assumeValid:this.__validationErrors!==void 0}}}function qc(i,n){const a=KA(i);if(!n.has(a)){if(n.add(a),am(a))for(const h of a.getTypes())qc(h,n);else if(Cf(a)||Qc(a)){for(const h of a.getInterfaces())qc(h,n);for(const h of Object.values(a.getFields())){qc(h.type,n);for(const p of h.args)qc(p.type,n)}}else if(td(a))for(const h of Object.values(a.getFields()))qc(h.type,n)}return n}function qy(i,n,a){if(i){if(i.kind===Vt.VARIABLE){i.name.value;return}if(nd(n))return i.kind===Vt.NULL?void 0:qy(i,n.ofType,a);if(i.kind===Vt.NULL)return null;if(zf(n)){const h=n.ofType;if(i.kind===Vt.LIST){const v=[];for(const g of i.values)if(C1(g,a)){if(nd(h))return;v.push(null)}else{const c=qy(g,h,a);if(c===void 0)return;v.push(c)}return v}const p=qy(i,h,a);return p===void 0?void 0:[p]}if(td(n)){if(i.kind!==Vt.OBJECT)return;const h=Object.create(null),p=yT(i.fields,v=>v.name.value);for(const v of Object.values(n.getFields())){const g=p[v.name];if(!g||C1(g.value,a)){if(v.defaultValue!==void 0)h[v.name]=v.defaultValue;else if(nd(v.type))return;continue}const c=qy(g.value,v.type,a);if(c===void 0)return;h[v.name]=c}if(n.isOneOf){const v=Object.keys(h);if(v.length!==1||h[v[0]]===null)return}return h}if(xT(n)){let h;try{h=n.parseLiteral(i,a)}catch{return}return h===void 0?void 0:h}tv(!1,"Unexpected input type: "+kn(n))}}function C1(i,n){return i.kind===Vt.VARIABLE&&n==null}function mC(i){const n={descriptions:!0,specifiedByUrl:!1,directiveIsRepeatable:!1,schemaDescription:!1,inputValueDeprecation:!1,oneOf:!1,...i},a=n.descriptions?"description":"",h=n.specifiedByUrl?"specifiedByURL":"",p=n.directiveIsRepeatable?"isRepeatable":"",v=n.schemaDescription?a:"";function g(A){return n.inputValueDeprecation?A:""}const c=n.oneOf?"isOneOf":"";return`
    query IntrospectionQuery {
      __schema {
        ${v}
        queryType { name kind }
        mutationType { name kind }
        subscriptionType { name kind }
        types {
          ...FullType
        }
        directives {
          name
          ${a}
          ${p}
          locations
          args${g("(includeDeprecated: true)")} {
            ...InputValue
          }
        }
      }
    }

    fragment FullType on __Type {
      kind
      name
      ${a}
      ${h}
      ${c}
      fields(includeDeprecated: true) {
        name
        ${a}
        args${g("(includeDeprecated: true)")} {
          ...InputValue
        }
        type {
          ...TypeRef
        }
        isDeprecated
        deprecationReason
      }
      inputFields${g("(includeDeprecated: true)")} {
        ...InputValue
      }
      interfaces {
        ...TypeRef
      }
      enumValues(includeDeprecated: true) {
        name
        ${a}
        isDeprecated
        deprecationReason
      }
      possibleTypes {
        ...TypeRef
      }
    }

    fragment InputValue on __InputValue {
      name
      ${a}
      type { ...TypeRef }
      defaultValue
      ${g("isDeprecated")}
      ${g("deprecationReason")}
    }

    fragment TypeRef on __Type {
      kind
      name
      ofType {
        kind
        name
        ofType {
          kind
          name
          ofType {
            kind
            name
            ofType {
              kind
              name
              ofType {
                kind
                name
                ofType {
                  kind
                  name
                  ofType {
                    kind
                    name
                    ofType {
                      kind
                      name
                      ofType {
                        kind
                        name
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  `}function gC(i,n){ld(i)&&ld(i.__schema)||Ri(!1,`Invalid or incomplete introspection result. Ensure that you are passing "data" property of introspection response and no "errors" was returned alongside: ${kn(i)}.`);const a=i.__schema,h=Qp(a.types,ye=>ye.name,ye=>F(ye));for(const ye of[...iC,...fC])h[ye.name]&&(h[ye.name]=ye);const p=a.queryType?N(a.queryType):null,v=a.mutationType?N(a.mutationType):null,g=a.subscriptionType?N(a.subscriptionType):null,c=a.directives?a.directives.map(je):[];return new pC({description:a.description,query:p,mutation:v,subscription:g,types:Object.values(h),directives:c,assumeValid:void 0});function A(ye){if(ye.kind===dr.LIST){const Qe=ye.ofType;if(!Qe)throw new Error("Decorated type deeper than introspection query.");return new Jl(A(Qe))}if(ye.kind===dr.NON_NULL){const Qe=ye.ofType;if(!Qe)throw new Error("Decorated type deeper than introspection query.");const bt=A(Qe);return new pi(QA(bt))}return D(ye)}function D(ye){const Qe=ye.name;if(!Qe)throw new Error(`Unknown type reference: ${kn(ye)}.`);const bt=h[Qe];if(!bt)throw new Error(`Invalid or incomplete schema, unknown type: ${Qe}. Ensure that a full introspection query is used in order to build a client schema.`);return bt}function N(ye){return HA(D(ye))}function L(ye){return XA(D(ye))}function F(ye){if(ye!=null&&ye.name!=null&&ye.kind!=null)switch(ye.kind){case dr.SCALAR:return V(ye);case dr.OBJECT:return J(ye);case dr.INTERFACE:return ae(ye);case dr.UNION:return fe(ye);case dr.ENUM:return ve(ye);case dr.INPUT_OBJECT:return Ce(ye)}const Qe=kn(ye);throw new Error(`Invalid or incomplete introspection result. Ensure that a full introspection query is used in order to build a client schema: ${Qe}.`)}function V(ye){return new mm({name:ye.name,description:ye.description,specifiedByURL:ye.specifiedByURL})}function $(ye){if(ye.interfaces===null&&ye.kind===dr.INTERFACE)return[];if(!ye.interfaces){const Qe=kn(ye);throw new Error(`Introspection result missing interfaces: ${Qe}.`)}return ye.interfaces.map(L)}function J(ye){return new Of({name:ye.name,description:ye.description,interfaces:()=>$(ye),fields:()=>Me(ye)})}function ae(ye){return new IT({name:ye.name,description:ye.description,interfaces:()=>$(ye),fields:()=>Me(ye)})}function fe(ye){if(!ye.possibleTypes){const Qe=kn(ye);throw new Error(`Introspection result missing possibleTypes: ${Qe}.`)}return new kT({name:ye.name,description:ye.description,types:()=>ye.possibleTypes.map(N)})}function ve(ye){if(!ye.enumValues){const Qe=kn(ye);throw new Error(`Introspection result missing enumValues: ${Qe}.`)}return new av({name:ye.name,description:ye.description,values:Qp(ye.enumValues,Qe=>Qe.name,Qe=>({description:Qe.description,deprecationReason:Qe.deprecationReason}))})}function Ce(ye){if(!ye.inputFields){const Qe=kn(ye);throw new Error(`Introspection result missing inputFields: ${Qe}.`)}return new RT({name:ye.name,description:ye.description,fields:()=>De(ye.inputFields),isOneOf:ye.isOneOf})}function Me(ye){if(!ye.fields)throw new Error(`Introspection result missing fields: ${kn(ye)}.`);return Qp(ye.fields,Qe=>Qe.name,Te)}function Te(ye){const Qe=A(ye.type);if(!bT(Qe)){const bt=kn(Qe);throw new Error(`Introspection must provide output type for fields, but received: ${bt}.`)}if(!ye.args){const bt=kn(ye);throw new Error(`Introspection result missing field args: ${bt}.`)}return{description:ye.description,deprecationReason:ye.deprecationReason,type:Qe,args:De(ye.args)}}function De(ye){return Qp(ye,Qe=>Qe.name,Ne)}function Ne(ye){const Qe=A(ye.type);if(!vT(Qe)){const Ot=kn(Qe);throw new Error(`Introspection must provide input type for arguments, but received: ${Ot}.`)}const bt=ye.defaultValue!=null?qy(kA(ye.defaultValue),Qe):void 0;return{description:ye.description,type:Qe,defaultValue:bt,deprecationReason:ye.deprecationReason}}function je(ye){if(!ye.args){const Qe=kn(ye);throw new Error(`Introspection result missing directive args: ${Qe}.`)}if(!ye.locations){const Qe=kn(ye);throw new Error(`Introspection result missing directive locations: ${Qe}.`)}return new gm({name:ye.name,description:ye.description,isRepeatable:ye.isRepeatable,locations:ye.locations.slice(),args:De(ye.args)})}}const M1="Accept",bb="Content-Type",xb="application/json",jT="application/graphql-response+json",D1=i=>i.replace(/([\s,]|#[^\n\r]+)+/g," ").trim(),yC=i=>{const n=i.toLowerCase();return n.includes(jT)||n.includes(xb)},I1=i=>{try{if(Array.isArray(i))return{_tag:"Batch",executionResults:i.map(k1)};if(S0(i))return{_tag:"Single",executionResult:k1(i)};throw new Error(`Invalid execution result: result is not object or array. 
Got:
${String(i)}`)}catch(n){return n}},k1=i=>{if(typeof i!="object"||i===null)throw new Error("Invalid execution result: result is not object");let n,a,h;if("errors"in i){if(!S0(i.errors)&&!Array.isArray(i.errors))throw new Error("Invalid execution result: errors is not plain object OR array");n=i.errors}if("data"in i){if(!S0(i.data)&&i.data!==null)throw new Error("Invalid execution result: data is not plain object");a=i.data}if("extensions"in i){if(!S0(i.extensions))throw new Error("Invalid execution result: extensions is not plain object");h=i.extensions}return{data:a,errors:n,extensions:h}},_C=i=>i._tag==="Batch"?i.executionResults.some(R1):R1(i.executionResult),R1=i=>Array.isArray(i.errors)?i.errors.length>0:!!i.errors,FT=i=>typeof i=="object"&&i!==null&&"kind"in i&&i.kind===Vt.OPERATION_DEFINITION,vC=i=>{var h;let n;const a=i.definitions.filter(FT);return a.length===1&&(n=(h=a[0].name)==null?void 0:h.value),n},bC=i=>{let n=!1;const a=i.definitions.filter(FT);return a.length===1&&(n=a[0].operation===$u.MUTATION),n},Xv=(i,n)=>{const a=typeof i=="string"?i:gl(i);let h=!1,p;if(n)return{expression:a,isMutation:h,operationName:p};const v=JS(()=>typeof i=="string"?IA(i):i);return v instanceof Error?{expression:a,isMutation:h,operationName:p}:(p=vC(v),h=bC(v),{expression:a,operationName:p,isMutation:h})},Jb=JSON,Wv=async i=>{const n={...i,method:i.request._tag==="Single"?i.request.document.isMutation?"POST":g1(i.method??"post"):i.request.hasMutations?"POST":g1(i.method??"post"),fetchOptions:{...i.fetchOptions,errorPolicy:i.fetchOptions.errorPolicy??"none"}},h=await wC(n.method)(n);if(!h.ok)return new gg({status:h.status,headers:h.headers},{query:i.request._tag==="Single"?i.request.document.expression:i.request.query,variables:i.request.variables});const p=await xC(h,i.fetchOptions.jsonSerializer??Jb);if(p instanceof Error)throw p;const v={status:h.status,headers:h.headers};if(_C(p)&&n.fetchOptions.errorPolicy==="none"){const g=p._tag==="Batch"?{...p.executionResults,...v}:{...p.executionResult,...v};return new gg(g,{query:i.request._tag==="Single"?i.request.document.expression:i.request.query,variables:i.request.variables})}switch(p._tag){case"Single":return{...v,...N1(n)(p.executionResult)};case"Batch":return{...v,data:p.executionResults.map(N1(n))};default:Xb(p)}},N1=i=>n=>({extensions:n.extensions,data:n.data,errors:i.fetchOptions.errorPolicy==="all"?n.errors:void 0}),xC=async(i,n)=>{const a=i.headers.get(bb),h=await i.text();return a&&yC(a)?I1(n.parse(h)):I1(h)},wC=i=>async n=>{const a=new Headers(n.headers);let h=null,p;a.has(M1)||a.set(M1,[jT,xb].join(", ")),i==="POST"?(p=(n.fetchOptions.jsonSerializer??Jb).stringify(TC(n)),typeof p=="string"&&!a.has(bb)&&a.set(bb,xb)):h=EC(n);const v={method:i,headers:a,body:p,...n.fetchOptions};let g=new URL(n.url),c=v;if(n.middleware){const D=await Promise.resolve(n.middleware({...v,url:n.url,operationName:n.request._tag==="Single"?n.request.document.operationName:void 0,variables:n.request.variables})),{url:N,...L}=D;g=new URL(N),c=L}return h&&h.forEach((D,N)=>{g.searchParams.append(N,D)}),await(n.fetch??fetch)(g,c)},TC=i=>{switch(i.request._tag){case"Single":return{query:i.request.document.expression,variables:i.request.variables,operationName:i.request.document.operationName};case"Batch":return aT(i.request.query,i.request.variables??[]).map(([n,a])=>({query:n,variables:a}));default:throw Xb(i.request)}},EC=i=>{var h;const n=i.fetchOptions.jsonSerializer??Jb,a=new URLSearchParams;switch(i.request._tag){case"Single":return a.append("query",D1(i.request.document.expression)),i.request.variables&&a.append("variables",n.stringify(i.request.variables)),i.request.document.operationName&&a.append("operationName",i.request.document.operationName),a;case"Batch":{const p=((h=i.request.variables)==null?void 0:h.map(c=>n.stringify(c)))??[],v=i.request.query.map(D1),g=aT(v,p).map(([c,A])=>({query:c,variables:A}));return a.append("query",n.stringify(g)),a}default:throw Xb(i.request)}};class SC{constructor(n,a={}){qp(this,"url");qp(this,"requestConfig");qp(this,"rawRequest",async(...n)=>{const[a,h,p]=n,v=nA(a,h,p),{headers:g,fetch:c=globalThis.fetch,method:A="POST",requestMiddleware:D,responseMiddleware:N,excludeOperationName:L,...F}=this.requestConfig,{url:V}=this;v.signal!==void 0&&(F.signal=v.signal);const $=Xv(v.query,L),J=await Wv({url:V,request:{_tag:"Single",document:$,variables:v.variables},headers:{...cg($v(g)),...cg(v.requestHeaders)},fetch:c,method:A,fetchOptions:F,middleware:D});if(N&&await N(J,{operationName:$.operationName,variables:h,url:this.url}),J instanceof Error)throw J;return J});this.url=n,this.requestConfig=a}async request(n,...a){const[h,p]=a,v=AC(n,h,p),{headers:g,fetch:c=globalThis.fetch,method:A="POST",requestMiddleware:D,responseMiddleware:N,excludeOperationName:L,...F}=this.requestConfig,{url:V}=this;v.signal!==void 0&&(F.signal=v.signal);const $=Xv(v.document,L),J=await Wv({url:V,request:{_tag:"Single",document:$,variables:v.variables},headers:{...cg($v(g)),...cg(v.requestHeaders)},fetch:c,method:A,fetchOptions:F,middleware:D});if(N&&await N(J,{operationName:$.operationName,variables:v.variables,url:this.url}),J instanceof Error)throw J;return J.data}async batchRequests(n,a){const h=tA(n,a),{headers:p,excludeOperationName:v,...g}=this.requestConfig;h.signal!==void 0&&(g.signal=h.signal);const c=h.documents.map(({document:F})=>Xv(F,v)),A=c.map(({expression:F})=>F),D=c.some(({isMutation:F})=>F),N=h.documents.map(({variables:F})=>F),L=await Wv({url:this.url,request:{_tag:"Batch",operationName:void 0,query:A,hasMutations:D,variables:N},headers:{...cg($v(p)),...cg(h.requestHeaders)},fetch:this.requestConfig.fetch??globalThis.fetch,method:this.requestConfig.method||"POST",fetchOptions:g,middleware:this.requestConfig.requestMiddleware});if(this.requestConfig.responseMiddleware&&await this.requestConfig.responseMiddleware(L,{operationName:void 0,variables:N,url:this.url}),L instanceof Error)throw L;return L.data}setHeaders(n){return this.requestConfig.headers=n,this}setHeader(n,a){const{headers:h}=this.requestConfig;return h?h[n]=a:this.requestConfig.headers={[n]:a},this}setEndpoint(n){return this.url=n,this}}async function z0(i,n,...a){const h=CC(i,n,...a);return new SC(h.url).request({...h})}const AC=(i,n,a)=>i.document?i:{document:i,variables:n,requestHeaders:a,signal:void 0},CC=(i,n,...a)=>{const[h,p]=a;return typeof i=="string"?{url:i,document:n,variables:h,requestHeaders:p,signal:void 0}:i},Qv="/otp/transmodel/v3",a_=()=>{try{return new URL(Qv),Qv}catch{return`${window.location.origin}${Qv}`}};var UT=(i=>(i.LimitToNumOfItineraries="limitToNumOfItineraries",i.LimitToSearchWindow="limitToSearchWindow",i.ListAll="listAll",i.Off="off",i))(UT||{}),Li=(i=>(i.Air="air",i.Bicycle="bicycle",i.Bus="bus",i.Cableway="cableway",i.Car="car",i.Coach="coach",i.Foot="foot",i.Funicular="funicular",i.Lift="lift",i.Metro="metro",i.Monorail="monorail",i.Rail="rail",i.Scooter="scooter",i.Taxi="taxi",i.Tram="tram",i.Trolleybus="trolleybus",i.Water="water",i))(Li||{}),sv=(i=>(i.Bicycle="bicycle",i.BikePark="bike_park",i.BikeRental="bike_rental",i.Car="car",i.CarPark="car_park",i.CarPickup="car_pickup",i.CarRental="car_rental",i.Flexible="flexible",i.Foot="foot",i.ScooterRental="scooter_rental",i))(sv||{}),VT=(i=>(i.Air="air",i.Bus="bus",i.Cableway="cableway",i.Coach="coach",i.Funicular="funicular",i.Lift="lift",i.Metro="metro",i.Monorail="monorail",i.Rail="rail",i.Taxi="taxi",i.Tram="tram",i.Trolleybus="trolleybus",i.Unknown="unknown",i.Water="water",i))(VT||{});const MC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quayCoordinate"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"latitude"}},{kind:"Field",name:{kind:"Name",value:"longitude"}}]}}]}}]},DC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"serverInfo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"version"}},{kind:"Field",name:{kind:"Name",value:"otpSerializationVersionId"}},{kind:"Field",name:{kind:"Name",value:"buildConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"routerConfigVersion"}},{kind:"Field",name:{kind:"Name",value:"gitCommit"}},{kind:"Field",name:{kind:"Name",value:"gitBranch"}},{kind:"Field",name:{kind:"Name",value:"internalTransitModelTimeZone"}}]}}]}}]},IC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"authority"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"authority"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}}]},kC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"line"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"ID"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"line"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"publicCode"}}]}}]}}]},RC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"quay"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"id"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"String"}}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"quay"},arguments:[{kind:"Argument",name:{kind:"Name",value:"id"},value:{kind:"Variable",name:{kind:"Name",value:"id"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"stopPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"name"}}]}}]}}]}}]},NC={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"trip"},variableDefinitions:[{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"PenaltyForStreetMode"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"banned"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputBanned"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}},type:{kind:"NamedType",name:{kind:"Name",value:"BicycleOptimisationMethod"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}},type:{kind:"ListType",type:{kind:"NamedType",name:{kind:"Name",value:"TransportModeSlack"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"dateTime"}},type:{kind:"NamedType",name:{kind:"Name",value:"DateTime"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"filters"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripFilterInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"from"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}},type:{kind:"NamedType",name:{kind:"Name",value:"ItineraryFilters"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"locale"}},type:{kind:"NamedType",name:{kind:"Name",value:"Locale"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"StreetModeDurationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"modes"}},type:{kind:"NamedType",name:{kind:"Name",value:"Modes"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}},type:{kind:"NamedType",name:{kind:"Name",value:"String"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}},type:{kind:"NamedType",name:{kind:"Name",value:"RelaxCostInput"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"timetableView"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"to"}},type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"Location"}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}},type:{kind:"NamedType",name:{kind:"Name",value:"Int"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}},type:{kind:"NamedType",name:{kind:"Name",value:"TriangleFactors"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"via"}},type:{kind:"ListType",type:{kind:"NonNullType",type:{kind:"NamedType",name:{kind:"Name",value:"TripViaLocationInput"}}}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}},type:{kind:"NamedType",name:{kind:"Name",value:"Float"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}},type:{kind:"NamedType",name:{kind:"Name",value:"Boolean"}}},{kind:"VariableDefinition",variable:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}},type:{kind:"NamedType",name:{kind:"Name",value:"InputWhiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"trip"},arguments:[{kind:"Argument",name:{kind:"Name",value:"accessEgressPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"accessEgressPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"alightSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"alightSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"arriveBy"},value:{kind:"Variable",name:{kind:"Name",value:"arriveBy"}}},{kind:"Argument",name:{kind:"Name",value:"banned"},value:{kind:"Variable",name:{kind:"Name",value:"banned"}}},{kind:"Argument",name:{kind:"Name",value:"bicycleOptimisationMethod"},value:{kind:"Variable",name:{kind:"Name",value:"bicycleOptimisationMethod"}}},{kind:"Argument",name:{kind:"Name",value:"bikeSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"bikeSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackDefault"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackDefault"}}},{kind:"Argument",name:{kind:"Name",value:"boardSlackList"},value:{kind:"Variable",name:{kind:"Name",value:"boardSlackList"}}},{kind:"Argument",name:{kind:"Name",value:"bookingTime"},value:{kind:"Variable",name:{kind:"Name",value:"bookingTime"}}},{kind:"Argument",name:{kind:"Name",value:"dateTime"},value:{kind:"Variable",name:{kind:"Name",value:"dateTime"}}},{kind:"Argument",name:{kind:"Name",value:"filters"},value:{kind:"Variable",name:{kind:"Name",value:"filters"}}},{kind:"Argument",name:{kind:"Name",value:"from"},value:{kind:"Variable",name:{kind:"Name",value:"from"}}},{kind:"Argument",name:{kind:"Name",value:"ignoreRealtimeUpdates"},value:{kind:"Variable",name:{kind:"Name",value:"ignoreRealtimeUpdates"}}},{kind:"Argument",name:{kind:"Name",value:"includePlannedCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includePlannedCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"includeRealtimeCancellations"},value:{kind:"Variable",name:{kind:"Name",value:"includeRealtimeCancellations"}}},{kind:"Argument",name:{kind:"Name",value:"itineraryFilters"},value:{kind:"Variable",name:{kind:"Name",value:"itineraryFilters"}}},{kind:"Argument",name:{kind:"Name",value:"locale"},value:{kind:"Variable",name:{kind:"Name",value:"locale"}}},{kind:"Argument",name:{kind:"Name",value:"maxAccessEgressDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxAccessEgressDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maxDirectDurationForMode"},value:{kind:"Variable",name:{kind:"Name",value:"maxDirectDurationForMode"}}},{kind:"Argument",name:{kind:"Name",value:"maximumAdditionalTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumAdditionalTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"maximumTransfers"},value:{kind:"Variable",name:{kind:"Name",value:"maximumTransfers"}}},{kind:"Argument",name:{kind:"Name",value:"modes"},value:{kind:"Variable",name:{kind:"Name",value:"modes"}}},{kind:"Argument",name:{kind:"Name",value:"numTripPatterns"},value:{kind:"Variable",name:{kind:"Name",value:"numTripPatterns"}}},{kind:"Argument",name:{kind:"Name",value:"pageCursor"},value:{kind:"Variable",name:{kind:"Name",value:"pageCursor"}}},{kind:"Argument",name:{kind:"Name",value:"relaxTransitGroupPriority"},value:{kind:"Variable",name:{kind:"Name",value:"relaxTransitGroupPriority"}}},{kind:"Argument",name:{kind:"Name",value:"searchWindow"},value:{kind:"Variable",name:{kind:"Name",value:"searchWindow"}}},{kind:"Argument",name:{kind:"Name",value:"timetableView"},value:{kind:"Variable",name:{kind:"Name",value:"timetableView"}}},{kind:"Argument",name:{kind:"Name",value:"to"},value:{kind:"Variable",name:{kind:"Name",value:"to"}}},{kind:"Argument",name:{kind:"Name",value:"transferPenalty"},value:{kind:"Variable",name:{kind:"Name",value:"transferPenalty"}}},{kind:"Argument",name:{kind:"Name",value:"transferSlack"},value:{kind:"Variable",name:{kind:"Name",value:"transferSlack"}}},{kind:"Argument",name:{kind:"Name",value:"triangleFactors"},value:{kind:"Variable",name:{kind:"Name",value:"triangleFactors"}}},{kind:"Argument",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"},value:{kind:"Variable",name:{kind:"Name",value:"useBikeRentalAvailabilityInformation"}}},{kind:"Argument",name:{kind:"Name",value:"via"},value:{kind:"Variable",name:{kind:"Name",value:"via"}}},{kind:"Argument",name:{kind:"Name",value:"waitReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"waitReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkReluctance"},value:{kind:"Variable",name:{kind:"Name",value:"walkReluctance"}}},{kind:"Argument",name:{kind:"Name",value:"walkSpeed"},value:{kind:"Variable",name:{kind:"Name",value:"walkSpeed"}}},{kind:"Argument",name:{kind:"Name",value:"wheelchairAccessible"},value:{kind:"Variable",name:{kind:"Name",value:"wheelchairAccessible"}}},{kind:"Argument",name:{kind:"Name",value:"whiteListed"},value:{kind:"Variable",name:{kind:"Name",value:"whiteListed"}}}],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"previousPageCursor"}},{kind:"Field",name:{kind:"Name",value:"nextPageCursor"}},{kind:"Field",name:{kind:"Name",value:"tripPatterns"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"legs"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"mode"}},{kind:"Field",name:{kind:"Name",value:"aimedStartTime"}},{kind:"Field",name:{kind:"Name",value:"aimedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedEndTime"}},{kind:"Field",name:{kind:"Name",value:"expectedStartTime"}},{kind:"Field",name:{kind:"Name",value:"realtime"}},{kind:"Field",name:{kind:"Name",value:"distance"}},{kind:"Field",name:{kind:"Name",value:"duration"}},{kind:"Field",name:{kind:"Name",value:"fromPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"toPlace"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"quay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"toEstimatedCall"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"destinationDisplay"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"frontText"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"line"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"publicCode"}},{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}},{kind:"Field",name:{kind:"Name",value:"presentation"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"colour"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"authority"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"name"}},{kind:"Field",name:{kind:"Name",value:"id"}}]}},{kind:"Field",name:{kind:"Name",value:"pointsOnLink"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"points"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeTo"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}},{kind:"Field",name:{kind:"Name",value:"interchangeFrom"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"staySeated"}}]}}]}},{kind:"Field",name:{kind:"Name",value:"systemNotices"},selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"tag"}}]}}]}}]}}]}}]},PC={"\n  query quayCoordinate($id: String!) {\n    quay(id: $id) {\n      latitude\n      longitude\n    }\n  }\n":MC,"\n  query serverInfo {\n    serverInfo {\n      version\n      otpSerializationVersionId\n      buildConfigVersion\n      routerConfigVersion\n      gitCommit\n      gitBranch\n      internalTransitModelTimeZone\n    }\n  }\n":DC,"\n  query authority($id: String!) {\n    authority(id: $id) {\n      name\n      id\n    }\n  }\n":IC,"\n  query line($id: ID!) {\n    line(id: $id) {\n      name\n      publicCode\n    }\n  }\n":kC,"\n  query quay($id: String!) {\n    quay(id: $id) {\n      stopPlace {\n        id\n        name\n      }\n    }\n  }\n":RC,"\nquery trip(\n  $accessEgressPenalty: [PenaltyForStreetMode!]\n  $alightSlackDefault: Int\n  $alightSlackList: [TransportModeSlack]\n  $arriveBy: Boolean\n  $banned: InputBanned\n  $bicycleOptimisationMethod: BicycleOptimisationMethod\n  $bikeSpeed: Float\n  $boardSlackDefault: Int\n  $boardSlackList: [TransportModeSlack]\n  $bookingTime: DateTime\n  $dateTime: DateTime\n  $filters: [TripFilterInput!]\n  $from: Location!\n  $ignoreRealtimeUpdates: Boolean\n  $includePlannedCancellations: Boolean\n  $includeRealtimeCancellations: Boolean\n  $itineraryFilters: ItineraryFilters\n  $locale: Locale\n  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]\n  $maxDirectDurationForMode: [StreetModeDurationInput!]\n  $maximumAdditionalTransfers: Int\n  $maximumTransfers: Int\n  $modes: Modes\n  $numTripPatterns: Int\n  $pageCursor: String\n  $relaxTransitGroupPriority: RelaxCostInput\n  $searchWindow: Int\n  $timetableView: Boolean\n  $to: Location!\n  $transferPenalty: Int\n  $transferSlack: Int\n  $triangleFactors: TriangleFactors\n  $useBikeRentalAvailabilityInformation: Boolean\n  $via: [TripViaLocationInput!]\n  $waitReluctance: Float\n  $walkReluctance: Float\n  $walkSpeed: Float\n  $wheelchairAccessible: Boolean\n  $whiteListed: InputWhiteListed\n) {\n  trip(\n    accessEgressPenalty: $accessEgressPenalty\n    alightSlackDefault: $alightSlackDefault\n    alightSlackList: $alightSlackList\n    arriveBy: $arriveBy\n    banned: $banned\n    bicycleOptimisationMethod: $bicycleOptimisationMethod\n    bikeSpeed: $bikeSpeed\n    boardSlackDefault: $boardSlackDefault\n    boardSlackList: $boardSlackList\n    bookingTime: $bookingTime\n    dateTime: $dateTime\n    filters: $filters\n    from: $from\n    ignoreRealtimeUpdates: $ignoreRealtimeUpdates\n    includePlannedCancellations: $includePlannedCancellations\n    includeRealtimeCancellations: $includeRealtimeCancellations\n    itineraryFilters: $itineraryFilters\n    locale: $locale\n    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode\n    maxDirectDurationForMode: $maxDirectDurationForMode\n    maximumAdditionalTransfers: $maximumAdditionalTransfers\n    maximumTransfers: $maximumTransfers\n    modes: $modes\n    numTripPatterns: $numTripPatterns\n    pageCursor: $pageCursor\n    relaxTransitGroupPriority: $relaxTransitGroupPriority\n    searchWindow: $searchWindow\n    timetableView: $timetableView\n    to: $to\n    transferPenalty: $transferPenalty\n    transferSlack: $transferSlack\n    triangleFactors: $triangleFactors\n    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation\n    via: $via\n    waitReluctance: $waitReluctance\n    walkReluctance: $walkReluctance\n    walkSpeed: $walkSpeed\n    wheelchairAccessible: $wheelchairAccessible\n    whiteListed: $whiteListed\n  ) \n    {\n    previousPageCursor\n    nextPageCursor\n    tripPatterns {\n        aimedStartTime\n        aimedEndTime\n        expectedEndTime\n        expectedStartTime\n        duration\n        distance\n        legs {\n            id\n            mode\n            aimedStartTime\n            aimedEndTime\n            expectedEndTime\n            expectedStartTime\n            realtime\n            distance\n            duration\n            fromPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            toPlace {\n                name\n                quay {\n                    id\n                }\n            }\n            toEstimatedCall {\n                destinationDisplay {\n                    frontText\n                }\n            }\n            line {\n                publicCode\n                name\n                id\n                presentation {\n                    colour\n                }\n            }\n            authority {\n                name\n                id\n            }\n            pointsOnLink {\n                points\n            }\n            interchangeTo {\n                staySeated\n            }\n            interchangeFrom {\n                staySeated\n            }\n        }\n        systemNotices {\n            tag\n        }\n    }\n  }\n}":NC};function Vg(i){return PC[i]??{}}const zC=Vg(`
  query quayCoordinate($id: String!) {
    quay(id: $id) {
      latitude
      longitude
    }
  }
`),OC=i=>{const[n,a]=he.useState(null);return he.useEffect(()=>{(async()=>{if(i.place){const p={id:i.place};try{a(await z0(a_(),zC,p))}catch(v){console.error("Error at useQuayCoordinateQuery",v)}}else a(null)})()},[i]),n==null?void 0:n.quay};function P1(i){const n=OC(i);if(n){const{latitude:a,longitude:h}=n;if(a&&h)return{latitude:a,longitude:h}}if(i.coordinates)return{...i.coordinates}}function LC({setCursor:i,tripQueryVariables:n,setTripQueryVariables:a,loading:h}){const p=P1(n.from),v=P1(n.to);return se.jsxs(se.Fragment,{children:[p&&se.jsx(d1,{draggable:!0,latitude:p.latitude,longitude:p.longitude,onDragStart:()=>i("grabbing"),onDragEnd:g=>{i("auto"),h||a({...n,from:{coordinates:{latitude:g.lngLat.lat,longitude:g.lngLat.lng}}})},anchor:"bottom-right",children:se.jsx("img",{alt:"",src:WS,height:48,width:49})}),v&&se.jsx(d1,{draggable:!0,latitude:v.latitude,longitude:v.longitude,onDragStart:()=>i("grabbing"),onDragEnd:g=>{i("auto"),h||a({...n,to:{coordinates:{latitude:g.lngLat.lat,longitude:g.lngLat.lng}}})},anchor:"bottom-right",children:se.jsx("img",{alt:"",src:QS,height:48,width:49})})]})}var BC=function(i,n){for(var a=Math.pow(10,n),h=i.length,p=new Array(Math.floor(i.length/2)),v=0,g=0,c=0,A=0;v<h;++A){var D=1,N=0,L=void 0;do L=i.charCodeAt(v++)-63-1,D+=L<<N,N+=5;while(L>=31);g+=D&1?~(D>>1):D>>1,D=1,N=0;do L=i.charCodeAt(v++)-63-1,D+=L<<N,N+=5;while(L>=31);c+=D&1?~(D>>1):D>>1,p[A]=[g/a,c/a]}return p.length=A,p};const jC=function(i){return i===Li.Foot?"#191616":i===Li.Bicycle?"#5076D9":i===Li.Scooter?"#253664":i===Li.Car?"#7e7e7e":i===Li.Rail?"#86BF8B":i===Li.Coach?"#25642A":i===Li.Metro?"#D9B250":i===Li.Bus?"#fe0000":i===Li.Tram?"#D9B250":i===Li.Trolleybus?"#25642A":i===Li.Water||i===Li.Air||i===Li.Cableway||i===Li.Funicular||i===Li.Monorail||i===Li.Taxi?"#81304C":"#aaa"},GT=function(i){var n,a;return(a=(n=i.line)==null?void 0:n.presentation)!=null&&a.colour?`#${i.line.presentation.colour}`:jC(i.mode)};function FC({tripPattern:i}){return se.jsx(se.Fragment,{children:i==null?void 0:i.legs.map((n,a)=>n.pointsOnLink&&se.jsxs(ZS,{type:"geojson",data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:BC(n.pointsOnLink.points,5).map(h=>h.reverse())}},children:[se.jsx(p1,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#000","line-width":5}}),se.jsx(p1,{type:"line",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":GT(n),"line-width":4}})]},n.id||`footleg_${a}`))})}const ZT=(i,n,a)=>({...i,[a]:{coordinates:{latitude:n.lat,longitude:n.lng}}}),UC=(i,n)=>ZT(i,n,"from"),VC=(i,n)=>ZT(i,n,"to");function GC({tripQueryVariables:i,setTripQueryVariables:n}){return he.useCallback(a=>{a.preventDefault(),i.from.coordinates?n(VC(i,a.lngLat)):n(UC(i,a.lngLat))},[i,n])}var Kv={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var z1;function ZC(){return z1||(z1=1,function(i){(function(){var n={}.hasOwnProperty;function a(){for(var v="",g=0;g<arguments.length;g++){var c=arguments[g];c&&(v=p(v,h(c)))}return v}function h(v){if(typeof v=="string"||typeof v=="number")return v;if(typeof v!="object")return"";if(Array.isArray(v))return a.apply(null,v);if(v.toString!==Object.prototype.toString&&!v.toString.toString().includes("[native code]"))return v.toString();var g="";for(var c in v)n.call(v,c)&&v[c]&&(g=p(g,c));return g}function p(v,g){return g?v?v+" "+g:v+g:v}i.exports?(a.default=a,i.exports=a):window.classNames=a})()}(Kv)),Kv.exports}var $C=ZC();const Ln=fm($C);function wb(){return wb=Object.assign?Object.assign.bind():function(i){for(var n=1;n<arguments.length;n++){var a=arguments[n];for(var h in a)({}).hasOwnProperty.call(a,h)&&(i[h]=a[h])}return i},wb.apply(null,arguments)}function $T(i,n){if(i==null)return{};var a={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.includes(h))continue;a[h]=i[h]}return a}function O1(i){return"default"+i.charAt(0).toUpperCase()+i.substr(1)}function YC(i){var n=qC(i,"string");return typeof n=="symbol"?n:String(n)}function qC(i,n){if(typeof i!="object"||i===null)return i;var a=i[Symbol.toPrimitive];if(a!==void 0){var h=a.call(i,n);if(typeof h!="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(i)}function HC(i,n,a){var h=he.useRef(i!==void 0),p=he.useState(n),v=p[0],g=p[1],c=i!==void 0,A=h.current;return h.current=c,!c&&A&&v!==n&&g(n),[c?i:v,he.useCallback(function(D){for(var N=arguments.length,L=new Array(N>1?N-1:0),F=1;F<N;F++)L[F-1]=arguments[F];a&&a.apply(void 0,[D].concat(L)),g(D)},[a])]}function YT(i,n){return Object.keys(n).reduce(function(a,h){var p,v=a,g=v[O1(h)],c=v[h],A=$T(v,[O1(h),h].map(YC)),D=n[h],N=HC(c,g,i[D]),L=N[0],F=N[1];return wb({},A,(p={},p[h]=L,p[D]=F,p))},i)}function Tb(i,n){return Tb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,h){return a.__proto__=h,a},Tb(i,n)}function XC(i,n){i.prototype=Object.create(n.prototype),i.prototype.constructor=i,Tb(i,n)}const WC=["xxl","xl","lg","md","sm","xs"],QC="xs",p_=he.createContext({prefixes:{},breakpoints:WC,minBreakpoint:QC}),{Consumer:K3,Provider:J3}=p_;function ni(i,n){const{prefixes:a}=he.useContext(p_);return i||a[n]||n}function KC(){const{breakpoints:i}=he.useContext(p_);return i}function JC(){const{minBreakpoint:i}=he.useContext(p_);return i}function qT(){const{dir:i}=he.useContext(p_);return i==="rtl"}function m_(i){return i&&i.ownerDocument||document}function eM(i){var n=m_(i);return n&&n.defaultView||window}function tM(i,n){return eM(i).getComputedStyle(i,n)}var nM=/([A-Z])/g;function iM(i){return i.replace(nM,"-$1").toLowerCase()}var rM=/^ms-/;function b0(i){return iM(i).replace(rM,"-ms-")}var aM=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function oM(i){return!!(i&&aM.test(i))}function id(i,n){var a="",h="";if(typeof n=="string")return i.style.getPropertyValue(b0(n))||tM(i).getPropertyValue(b0(n));Object.keys(n).forEach(function(p){var v=n[p];!v&&v!==0?i.style.removeProperty(b0(p)):oM(p)?h+=p+"("+v+") ":a+=b0(p)+": "+v+";"}),h&&(a+="transform: "+h+";"),i.style.cssText+=";"+a}var Jv={exports:{}},eb,L1;function sM(){if(L1)return eb;L1=1;var i="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return eb=i,eb}var tb,B1;function lM(){if(B1)return tb;B1=1;var i=sM();function n(){}function a(){}return a.resetWarningCache=n,tb=function(){function h(g,c,A,D,N,L){if(L!==i){var F=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw F.name="Invariant Violation",F}}h.isRequired=h;function p(){return h}var v={array:h,bigint:h,bool:h,func:h,number:h,object:h,string:h,symbol:h,any:h,arrayOf:p,element:h,elementType:h,instanceOf:p,node:h,objectOf:p,oneOf:p,oneOfType:p,shape:p,exact:p,checkPropTypes:a,resetWarningCache:n};return v.PropTypes=v,v},tb}var j1;function cM(){return j1||(j1=1,Jv.exports=lM()()),Jv.exports}var uM=cM();const rd=fm(uM),F1={disabled:!1},HT=ec.createContext(null);var hM=function(n){return n.scrollTop},Hy="unmounted",Tf="exited",Hc="entering",Kh="entered",o_="exiting",gd=function(i){XC(n,i);function n(h,p){var v;v=i.call(this,h,p)||this;var g=p,c=g&&!g.isMounting?h.enter:h.appear,A;return v.appearStatus=null,h.in?c?(A=Tf,v.appearStatus=Hc):A=Kh:h.unmountOnExit||h.mountOnEnter?A=Hy:A=Tf,v.state={status:A},v.nextCallback=null,v}n.getDerivedStateFromProps=function(p,v){var g=p.in;return g&&v.status===Hy?{status:Tf}:null};var a=n.prototype;return a.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},a.componentDidUpdate=function(p){var v=null;if(p!==this.props){var g=this.state.status;this.props.in?g!==Hc&&g!==Kh&&(v=Hc):(g===Hc||g===Kh)&&(v=o_)}this.updateStatus(!1,v)},a.componentWillUnmount=function(){this.cancelNextCallback()},a.getTimeouts=function(){var p=this.props.timeout,v,g,c;return v=g=c=p,p!=null&&typeof p!="number"&&(v=p.exit,g=p.enter,c=p.appear!==void 0?p.appear:g),{exit:v,enter:g,appear:c}},a.updateStatus=function(p,v){if(p===void 0&&(p=!1),v!==null)if(this.cancelNextCallback(),v===Hc){if(this.props.unmountOnExit||this.props.mountOnEnter){var g=this.props.nodeRef?this.props.nodeRef.current:Wp.findDOMNode(this);g&&hM(g)}this.performEnter(p)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Tf&&this.setState({status:Hy})},a.performEnter=function(p){var v=this,g=this.props.enter,c=this.context?this.context.isMounting:p,A=this.props.nodeRef?[c]:[Wp.findDOMNode(this),c],D=A[0],N=A[1],L=this.getTimeouts(),F=c?L.appear:L.enter;if(!p&&!g||F1.disabled){this.safeSetState({status:Kh},function(){v.props.onEntered(D)});return}this.props.onEnter(D,N),this.safeSetState({status:Hc},function(){v.props.onEntering(D,N),v.onTransitionEnd(F,function(){v.safeSetState({status:Kh},function(){v.props.onEntered(D,N)})})})},a.performExit=function(){var p=this,v=this.props.exit,g=this.getTimeouts(),c=this.props.nodeRef?void 0:Wp.findDOMNode(this);if(!v||F1.disabled){this.safeSetState({status:Tf},function(){p.props.onExited(c)});return}this.props.onExit(c),this.safeSetState({status:o_},function(){p.props.onExiting(c),p.onTransitionEnd(g.exit,function(){p.safeSetState({status:Tf},function(){p.props.onExited(c)})})})},a.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},a.safeSetState=function(p,v){v=this.setNextCallback(v),this.setState(p,v)},a.setNextCallback=function(p){var v=this,g=!0;return this.nextCallback=function(c){g&&(g=!1,v.nextCallback=null,p(c))},this.nextCallback.cancel=function(){g=!1},this.nextCallback},a.onTransitionEnd=function(p,v){this.setNextCallback(v);var g=this.props.nodeRef?this.props.nodeRef.current:Wp.findDOMNode(this),c=p==null&&!this.props.addEndListener;if(!g||c){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var A=this.props.nodeRef?[this.nextCallback]:[g,this.nextCallback],D=A[0],N=A[1];this.props.addEndListener(D,N)}p!=null&&setTimeout(this.nextCallback,p)},a.render=function(){var p=this.state.status;if(p===Hy)return null;var v=this.props,g=v.children;v.in,v.mountOnEnter,v.unmountOnExit,v.appear,v.enter,v.exit,v.timeout,v.addEndListener,v.onEnter,v.onEntering,v.onEntered,v.onExit,v.onExiting,v.onExited,v.nodeRef;var c=$T(v,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return ec.createElement(HT.Provider,{value:null},typeof g=="function"?g(p,c):ec.cloneElement(ec.Children.only(g),c))},n}(ec.Component);gd.contextType=HT;gd.propTypes={};function ug(){}gd.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:ug,onEntering:ug,onEntered:ug,onExit:ug,onExiting:ug,onExited:ug};gd.UNMOUNTED=Hy;gd.EXITED=Tf;gd.ENTERING=Hc;gd.ENTERED=Kh;gd.EXITING=o_;function XT(i){return i.code==="Escape"||i.keyCode===27}function dM(){const i=he.version.split(".");return{major:+i[0],minor:+i[1],patch:+i[2]}}function Gg(i){if(!i||typeof i=="function")return null;const{major:n}=dM();return n>=19?i.props.ref:i.ref}const lv=!!(typeof window<"u"&&window.document&&window.document.createElement);var Eb=!1,Sb=!1;try{var nb={get passive(){return Eb=!0},get once(){return Sb=Eb=!0}};lv&&(window.addEventListener("test",nb,nb),window.removeEventListener("test",nb,!0))}catch{}function fM(i,n,a,h){if(h&&typeof h!="boolean"&&!Sb){var p=h.once,v=h.capture,g=a;!Sb&&p&&(g=a.__once||function c(A){this.removeEventListener(n,c,v),a.call(this,A)},a.__once=g),i.addEventListener(n,g,Eb?h:v)}i.addEventListener(n,a,h)}function pM(i,n,a,h){var p=h&&typeof h!="boolean"?h.capture:h;i.removeEventListener(n,a,p),a.__once&&i.removeEventListener(n,a.__once,p)}function Jh(i,n,a,h){return fM(i,n,a,h),function(){pM(i,n,a,h)}}function mM(i,n,a,h){if(h===void 0&&(h=!0),i){var p=document.createEvent("HTMLEvents");p.initEvent(n,a,h),i.dispatchEvent(p)}}function gM(i){var n=id(i,"transitionDuration")||"",a=n.indexOf("ms")===-1?1e3:1;return parseFloat(n)*a}function yM(i,n,a){a===void 0&&(a=5);var h=!1,p=setTimeout(function(){h||mM(i,"transitionend",!0)},n+a),v=Jh(i,"transitionend",function(){h=!0},{once:!0});return function(){clearTimeout(p),v()}}function _M(i,n,a,h){a==null&&(a=gM(i)||0);var p=yM(i,a,h),v=Jh(i,"transitionend",n);return function(){p(),v()}}function U1(i,n){const a=id(i,n)||"",h=a.indexOf("ms")===-1?1e3:1;return parseFloat(a)*h}function ex(i,n){const a=U1(i,"transitionDuration"),h=U1(i,"transitionDelay"),p=_M(i,v=>{v.target===i&&(p(),n(v))},a+h)}function Gy(...i){return i.filter(n=>n!=null).reduce((n,a)=>{if(typeof a!="function")throw new Error("Invalid Argument Type, must only provide functions, undefined, or null.");return n===null?a:function(...p){n.apply(this,p),a.apply(this,p)}},null)}function WT(i){i.offsetHeight}const V1=i=>!i||typeof i=="function"?i:n=>{i.current=n};function vM(i,n){const a=V1(i),h=V1(n);return p=>{a&&a(p),h&&h(p)}}function QT(i,n){return he.useMemo(()=>vM(i,n),[i,n])}function Ab(i){return i&&"setState"in i?Wp.findDOMNode(i):i??null}const tx=ec.forwardRef(({onEnter:i,onEntering:n,onEntered:a,onExit:h,onExiting:p,onExited:v,addEndListener:g,children:c,childRef:A,...D},N)=>{const L=he.useRef(null),F=QT(L,A),V=De=>{F(Ab(De))},$=De=>Ne=>{De&&L.current&&De(L.current,Ne)},J=he.useCallback($(i),[i]),ae=he.useCallback($(n),[n]),fe=he.useCallback($(a),[a]),ve=he.useCallback($(h),[h]),Ce=he.useCallback($(p),[p]),Me=he.useCallback($(v),[v]),Te=he.useCallback($(g),[g]);return se.jsx(gd,{ref:N,...D,onEnter:J,onEntered:fe,onEntering:ae,onExit:ve,onExited:Me,onExiting:Ce,addEndListener:Te,nodeRef:L,children:typeof c=="function"?(De,Ne)=>c(De,{...Ne,ref:V}):ec.cloneElement(c,{ref:V})})}),bM={height:["marginTop","marginBottom"],width:["marginLeft","marginRight"]};function xM(i,n){const a=`offset${i[0].toUpperCase()}${i.slice(1)}`,h=n[a],p=bM[i];return h+parseInt(id(n,p[0]),10)+parseInt(id(n,p[1]),10)}const wM={[Tf]:"collapse",[o_]:"collapsing",[Hc]:"collapsing",[Kh]:"collapse show"},KT=ec.forwardRef(({onEnter:i,onEntering:n,onEntered:a,onExit:h,onExiting:p,className:v,children:g,dimension:c="height",in:A=!1,timeout:D=300,mountOnEnter:N=!1,unmountOnExit:L=!1,appear:F=!1,getDimensionValue:V=xM,...$},J)=>{const ae=typeof c=="function"?c():c,fe=he.useMemo(()=>Gy(De=>{De.style[ae]="0"},i),[ae,i]),ve=he.useMemo(()=>Gy(De=>{const Ne=`scroll${ae[0].toUpperCase()}${ae.slice(1)}`;De.style[ae]=`${De[Ne]}px`},n),[ae,n]),Ce=he.useMemo(()=>Gy(De=>{De.style[ae]=null},a),[ae,a]),Me=he.useMemo(()=>Gy(De=>{De.style[ae]=`${V(ae,De)}px`,WT(De)},h),[h,V,ae]),Te=he.useMemo(()=>Gy(De=>{De.style[ae]=null},p),[ae,p]);return se.jsx(tx,{ref:J,addEndListener:ex,...$,"aria-expanded":$.role?A:null,onEnter:fe,onEntering:ve,onEntered:Ce,onExit:Me,onExiting:Te,childRef:Gg(g),in:A,timeout:D,mountOnEnter:N,unmountOnExit:L,appear:F,children:(De,Ne)=>ec.cloneElement(g,{...Ne,className:Ln(v,g.props.className,wM[De],ae==="width"&&"collapse-horizontal")})})});function JT(i,n){return Array.isArray(i)?i.includes(n):i===n}const g_=he.createContext({});g_.displayName="AccordionContext";const nx=he.forwardRef(({as:i="div",bsPrefix:n,className:a,children:h,eventKey:p,...v},g)=>{const{activeEventKey:c}=he.useContext(g_);return n=ni(n,"accordion-collapse"),se.jsx(KT,{ref:g,in:JT(c,p),...v,className:Ln(a,n),children:se.jsx(i,{children:he.Children.only(h)})})});nx.displayName="AccordionCollapse";const cv=he.createContext({eventKey:""});cv.displayName="AccordionItemContext";const e2=he.forwardRef(({as:i="div",bsPrefix:n,className:a,onEnter:h,onEntering:p,onEntered:v,onExit:g,onExiting:c,onExited:A,...D},N)=>{n=ni(n,"accordion-body");const{eventKey:L}=he.useContext(cv);return se.jsx(nx,{eventKey:L,onEnter:h,onEntering:p,onEntered:v,onExit:g,onExiting:c,onExited:A,children:se.jsx(i,{ref:N,...D,className:Ln(a,n)})})});e2.displayName="AccordionBody";function TM(i,n){const{activeEventKey:a,onSelect:h,alwaysOpen:p}=he.useContext(g_);return v=>{let g=i===a?null:i;p&&(Array.isArray(a)?a.includes(i)?g=a.filter(c=>c!==i):g=[...a,i]:g=[i]),h==null||h(g,v),n==null||n(v)}}const ix=he.forwardRef(({as:i="button",bsPrefix:n,className:a,onClick:h,...p},v)=>{n=ni(n,"accordion-button");const{eventKey:g}=he.useContext(cv),c=TM(g,h),{activeEventKey:A}=he.useContext(g_);return i==="button"&&(p.type="button"),se.jsx(i,{ref:v,onClick:c,...p,"aria-expanded":Array.isArray(A)?A.includes(g):g===A,className:Ln(a,n,!JT(A,g)&&"collapsed")})});ix.displayName="AccordionButton";const t2=he.forwardRef(({as:i="h2","aria-controls":n,bsPrefix:a,className:h,children:p,onClick:v,...g},c)=>(a=ni(a,"accordion-header"),se.jsx(i,{ref:c,...g,className:Ln(h,a),children:se.jsx(ix,{onClick:v,"aria-controls":n,children:p})})));t2.displayName="AccordionHeader";const n2=he.forwardRef(({as:i="div",bsPrefix:n,className:a,eventKey:h,...p},v)=>{n=ni(n,"accordion-item");const g=he.useMemo(()=>({eventKey:h}),[h]);return se.jsx(cv.Provider,{value:g,children:se.jsx(i,{ref:v,...p,className:Ln(a,n)})})});n2.displayName="AccordionItem";const i2=he.forwardRef((i,n)=>{const{as:a="div",activeKey:h,bsPrefix:p,className:v,onSelect:g,flush:c,alwaysOpen:A,...D}=YT(i,{activeKey:"onSelect"}),N=ni(p,"accordion"),L=he.useMemo(()=>({activeEventKey:h,onSelect:g,alwaysOpen:A}),[h,g,A]);return se.jsx(g_.Provider,{value:L,children:se.jsx(a,{ref:n,...D,className:Ln(v,N,c&&`${N}-flush`)})})});i2.displayName="Accordion";const x0=Object.assign(i2,{Button:ix,Collapse:nx,Item:n2,Header:t2,Body:e2});function EM(i){const n=he.useRef(i);return he.useEffect(()=>{n.current=i},[i]),n}function y_(i){const n=EM(i);return he.useCallback(function(...a){return n.current&&n.current(...a)},[n])}const SM=i=>he.forwardRef((n,a)=>se.jsx("div",{...n,ref:a,className:Ln(n.className,i)}));function G1(){return he.useState(null)}function AM(i){const n=he.useRef(i);return he.useEffect(()=>{n.current=i},[i]),n}function Zu(i){const n=AM(i);return he.useCallback(function(...a){return n.current&&n.current(...a)},[n])}function r2(){const i=he.useRef(!0),n=he.useRef(()=>i.current);return he.useEffect(()=>(i.current=!0,()=>{i.current=!1}),[]),n.current}function CM(i){const n=he.useRef(null);return he.useEffect(()=>{n.current=i}),n.current}const MM=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",DM=typeof document<"u",Z1=DM||MM?he.useLayoutEffect:he.useEffect,IM=["as","disabled"];function kM(i,n){if(i==null)return{};var a={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;a[h]=i[h]}return a}function RM(i){return!i||i.trim()==="#"}function a2({tagName:i,disabled:n,href:a,target:h,rel:p,role:v,onClick:g,tabIndex:c=0,type:A}){i||(a!=null||h!=null||p!=null?i="a":i="button");const D={tagName:i};if(i==="button")return[{type:A||"button",disabled:n},D];const N=F=>{if((n||i==="a"&&RM(a))&&F.preventDefault(),n){F.stopPropagation();return}g==null||g(F)},L=F=>{F.key===" "&&(F.preventDefault(),N(F))};return i==="a"&&(a||(a="#"),n&&(a=void 0)),[{role:v??"button",disabled:void 0,tabIndex:n?void 0:c,href:a,target:i==="a"?h:void 0,"aria-disabled":n||void 0,rel:i==="a"?p:void 0,onClick:N,onKeyDown:L},D]}const NM=he.forwardRef((i,n)=>{let{as:a,disabled:h}=i,p=kM(i,IM);const[v,{tagName:g}]=a2(Object.assign({tagName:a,disabled:h},p));return se.jsx(g,Object.assign({},p,v,{ref:n}))});NM.displayName="Button";const PM={[Hc]:"show",[Kh]:"show"},O0=he.forwardRef(({className:i,children:n,transitionClasses:a={},onEnter:h,...p},v)=>{const g={in:!1,timeout:300,mountOnEnter:!1,unmountOnExit:!1,appear:!1,...p},c=he.useCallback((A,D)=>{WT(A),h==null||h(A,D)},[h]);return se.jsx(tx,{ref:v,addEndListener:ex,...g,onEnter:c,childRef:Gg(n),children:(A,D)=>he.cloneElement(n,{...D,className:Ln("fade",i,n.props.className,PM[A],a[A])})})});O0.displayName="Fade";const zM={"aria-label":rd.string,onClick:rd.func,variant:rd.oneOf(["white"])},rx=he.forwardRef(({className:i,variant:n,"aria-label":a="Close",...h},p)=>se.jsx("button",{ref:p,type:"button",className:Ln("btn-close",n&&`btn-close-${n}`,i),"aria-label":a,...h}));rx.displayName="CloseButton";rx.propTypes=zM;const om=he.forwardRef(({as:i,bsPrefix:n,variant:a="primary",size:h,active:p=!1,disabled:v=!1,className:g,...c},A)=>{const D=ni(n,"btn"),[N,{tagName:L}]=a2({tagName:i,disabled:v,...c}),F=L;return se.jsx(F,{...N,...c,ref:A,disabled:v,className:Ln(g,D,p&&"active",a&&`${D}-${a}`,h&&`${D}-${h}`,c.href&&v&&"disabled")})});om.displayName="Button";const ax=he.forwardRef(({bsPrefix:i,size:n,vertical:a=!1,className:h,role:p="group",as:v="div",...g},c)=>{const A=ni(i,"btn-group");let D=A;return a&&(D=`${A}-vertical`),se.jsx(v,{...g,ref:c,role:p,className:Ln(h,D,n&&`${A}-${n}`)})});ax.displayName="ButtonGroup";function OM(i,n){return he.Children.toArray(i).some(a=>he.isValidElement(a)&&a.type===n)}function LM({as:i,bsPrefix:n,className:a,...h}){n=ni(n,"col");const p=KC(),v=JC(),g=[],c=[];return p.forEach(A=>{const D=h[A];delete h[A];let N,L,F;typeof D=="object"&&D!=null?{span:N,offset:L,order:F}=D:N=D;const V=A!==v?`-${A}`:"";N&&g.push(N===!0?`${n}${V}`:`${n}${V}-${N}`),F!=null&&c.push(`order${V}-${F}`),L!=null&&c.push(`offset${V}-${L}`)}),[{...h,className:Ln(a,...g,...c)},{as:i,bsPrefix:n,spans:g}]}const o2=he.forwardRef((i,n)=>{const[{className:a,...h},{as:p="div",bsPrefix:v,spans:g}]=LM(i);return se.jsx(p,{...h,ref:n,className:Ln(a,!g.length&&v)})});o2.displayName="Col";var BM=Function.prototype.bind.call(Function.prototype.call,[].slice);function hg(i,n){return BM(i.querySelectorAll(n))}var $1=Object.prototype.hasOwnProperty;function Y1(i,n,a){for(a of i.keys())if(Qy(a,n))return a}function Qy(i,n){var a,h,p;if(i===n)return!0;if(i&&n&&(a=i.constructor)===n.constructor){if(a===Date)return i.getTime()===n.getTime();if(a===RegExp)return i.toString()===n.toString();if(a===Array){if((h=i.length)===n.length)for(;h--&&Qy(i[h],n[h]););return h===-1}if(a===Set){if(i.size!==n.size)return!1;for(h of i)if(p=h,p&&typeof p=="object"&&(p=Y1(n,p),!p)||!n.has(p))return!1;return!0}if(a===Map){if(i.size!==n.size)return!1;for(h of i)if(p=h[0],p&&typeof p=="object"&&(p=Y1(n,p),!p)||!Qy(h[1],n.get(p)))return!1;return!0}if(a===ArrayBuffer)i=new Uint8Array(i),n=new Uint8Array(n);else if(a===DataView){if((h=i.byteLength)===n.byteLength)for(;h--&&i.getInt8(h)===n.getInt8(h););return h===-1}if(ArrayBuffer.isView(i)){if((h=i.byteLength)===n.byteLength)for(;h--&&i[h]===n[h];);return h===-1}if(!a||typeof i=="object"){h=0;for(a in i)if($1.call(i,a)&&++h&&!$1.call(n,a)||!(a in n)||!Qy(i[a],n[a]))return!1;return Object.keys(n).length===h}}return i!==i&&n!==n}function jM(i){const n=r2();return[i[0],he.useCallback(a=>{if(n())return i[1](a)},[n,i[1]])]}var js="top",tc="bottom",nc="right",Fs="left",ox="auto",__=[js,tc,nc,Fs],Ag="start",s_="end",FM="clippingParents",s2="viewport",Zy="popper",UM="reference",q1=__.reduce(function(i,n){return i.concat([n+"-"+Ag,n+"-"+s_])},[]),l2=[].concat(__,[ox]).reduce(function(i,n){return i.concat([n,n+"-"+Ag,n+"-"+s_])},[]),VM="beforeRead",GM="read",ZM="afterRead",$M="beforeMain",YM="main",qM="afterMain",HM="beforeWrite",XM="write",WM="afterWrite",QM=[VM,GM,ZM,$M,YM,qM,HM,XM,WM];function qu(i){return i.split("-")[0]}function yl(i){if(i==null)return window;if(i.toString()!=="[object Window]"){var n=i.ownerDocument;return n&&n.defaultView||window}return i}function sm(i){var n=yl(i).Element;return i instanceof n||i instanceof Element}function Hu(i){var n=yl(i).HTMLElement;return i instanceof n||i instanceof HTMLElement}function sx(i){if(typeof ShadowRoot>"u")return!1;var n=yl(i).ShadowRoot;return i instanceof n||i instanceof ShadowRoot}var em=Math.max,L0=Math.min,Cg=Math.round;function Cb(){var i=navigator.userAgentData;return i!=null&&i.brands&&Array.isArray(i.brands)?i.brands.map(function(n){return n.brand+"/"+n.version}).join(" "):navigator.userAgent}function c2(){return!/^((?!chrome|android).)*safari/i.test(Cb())}function Mg(i,n,a){n===void 0&&(n=!1),a===void 0&&(a=!1);var h=i.getBoundingClientRect(),p=1,v=1;n&&Hu(i)&&(p=i.offsetWidth>0&&Cg(h.width)/i.offsetWidth||1,v=i.offsetHeight>0&&Cg(h.height)/i.offsetHeight||1);var g=sm(i)?yl(i):window,c=g.visualViewport,A=!c2()&&a,D=(h.left+(A&&c?c.offsetLeft:0))/p,N=(h.top+(A&&c?c.offsetTop:0))/v,L=h.width/p,F=h.height/v;return{width:L,height:F,top:N,right:D+L,bottom:N+F,left:D,x:D,y:N}}function lx(i){var n=Mg(i),a=i.offsetWidth,h=i.offsetHeight;return Math.abs(n.width-a)<=1&&(a=n.width),Math.abs(n.height-h)<=1&&(h=n.height),{x:i.offsetLeft,y:i.offsetTop,width:a,height:h}}function u2(i,n){var a=n.getRootNode&&n.getRootNode();if(i.contains(n))return!0;if(a&&sx(a)){var h=n;do{if(h&&i.isSameNode(h))return!0;h=h.parentNode||h.host}while(h)}return!1}function Df(i){return i?(i.nodeName||"").toLowerCase():null}function cd(i){return yl(i).getComputedStyle(i)}function KM(i){return["table","td","th"].indexOf(Df(i))>=0}function Lf(i){return((sm(i)?i.ownerDocument:i.document)||window.document).documentElement}function uv(i){return Df(i)==="html"?i:i.assignedSlot||i.parentNode||(sx(i)?i.host:null)||Lf(i)}function H1(i){return!Hu(i)||cd(i).position==="fixed"?null:i.offsetParent}function JM(i){var n=/firefox/i.test(Cb()),a=/Trident/i.test(Cb());if(a&&Hu(i)){var h=cd(i);if(h.position==="fixed")return null}var p=uv(i);for(sx(p)&&(p=p.host);Hu(p)&&["html","body"].indexOf(Df(p))<0;){var v=cd(p);if(v.transform!=="none"||v.perspective!=="none"||v.contain==="paint"||["transform","perspective"].indexOf(v.willChange)!==-1||n&&v.willChange==="filter"||n&&v.filter&&v.filter!=="none")return p;p=p.parentNode}return null}function v_(i){for(var n=yl(i),a=H1(i);a&&KM(a)&&cd(a).position==="static";)a=H1(a);return a&&(Df(a)==="html"||Df(a)==="body"&&cd(a).position==="static")?n:a||JM(i)||n}function cx(i){return["top","bottom"].indexOf(i)>=0?"x":"y"}function Ky(i,n,a){return em(i,L0(n,a))}function eD(i,n,a){var h=Ky(i,n,a);return h>a?a:h}function h2(){return{top:0,right:0,bottom:0,left:0}}function d2(i){return Object.assign({},h2(),i)}function f2(i,n){return n.reduce(function(a,h){return a[h]=i,a},{})}var tD=function(n,a){return n=typeof n=="function"?n(Object.assign({},a.rects,{placement:a.placement})):n,d2(typeof n!="number"?n:f2(n,__))};function nD(i){var n,a=i.state,h=i.name,p=i.options,v=a.elements.arrow,g=a.modifiersData.popperOffsets,c=qu(a.placement),A=cx(c),D=[Fs,nc].indexOf(c)>=0,N=D?"height":"width";if(!(!v||!g)){var L=tD(p.padding,a),F=lx(v),V=A==="y"?js:Fs,$=A==="y"?tc:nc,J=a.rects.reference[N]+a.rects.reference[A]-g[A]-a.rects.popper[N],ae=g[A]-a.rects.reference[A],fe=v_(v),ve=fe?A==="y"?fe.clientHeight||0:fe.clientWidth||0:0,Ce=J/2-ae/2,Me=L[V],Te=ve-F[N]-L[$],De=ve/2-F[N]/2+Ce,Ne=Ky(Me,De,Te),je=A;a.modifiersData[h]=(n={},n[je]=Ne,n.centerOffset=Ne-De,n)}}function iD(i){var n=i.state,a=i.options,h=a.element,p=h===void 0?"[data-popper-arrow]":h;p!=null&&(typeof p=="string"&&(p=n.elements.popper.querySelector(p),!p)||u2(n.elements.popper,p)&&(n.elements.arrow=p))}const rD={name:"arrow",enabled:!0,phase:"main",fn:nD,effect:iD,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Dg(i){return i.split("-")[1]}var aD={top:"auto",right:"auto",bottom:"auto",left:"auto"};function oD(i,n){var a=i.x,h=i.y,p=n.devicePixelRatio||1;return{x:Cg(a*p)/p||0,y:Cg(h*p)/p||0}}function X1(i){var n,a=i.popper,h=i.popperRect,p=i.placement,v=i.variation,g=i.offsets,c=i.position,A=i.gpuAcceleration,D=i.adaptive,N=i.roundOffsets,L=i.isFixed,F=g.x,V=F===void 0?0:F,$=g.y,J=$===void 0?0:$,ae=typeof N=="function"?N({x:V,y:J}):{x:V,y:J};V=ae.x,J=ae.y;var fe=g.hasOwnProperty("x"),ve=g.hasOwnProperty("y"),Ce=Fs,Me=js,Te=window;if(D){var De=v_(a),Ne="clientHeight",je="clientWidth";if(De===yl(a)&&(De=Lf(a),cd(De).position!=="static"&&c==="absolute"&&(Ne="scrollHeight",je="scrollWidth")),De=De,p===js||(p===Fs||p===nc)&&v===s_){Me=tc;var ye=L&&De===Te&&Te.visualViewport?Te.visualViewport.height:De[Ne];J-=ye-h.height,J*=A?1:-1}if(p===Fs||(p===js||p===tc)&&v===s_){Ce=nc;var Qe=L&&De===Te&&Te.visualViewport?Te.visualViewport.width:De[je];V-=Qe-h.width,V*=A?1:-1}}var bt=Object.assign({position:c},D&&aD),Ot=N===!0?oD({x:V,y:J},yl(a)):{x:V,y:J};if(V=Ot.x,J=Ot.y,A){var mt;return Object.assign({},bt,(mt={},mt[Me]=ve?"0":"",mt[Ce]=fe?"0":"",mt.transform=(Te.devicePixelRatio||1)<=1?"translate("+V+"px, "+J+"px)":"translate3d("+V+"px, "+J+"px, 0)",mt))}return Object.assign({},bt,(n={},n[Me]=ve?J+"px":"",n[Ce]=fe?V+"px":"",n.transform="",n))}function sD(i){var n=i.state,a=i.options,h=a.gpuAcceleration,p=h===void 0?!0:h,v=a.adaptive,g=v===void 0?!0:v,c=a.roundOffsets,A=c===void 0?!0:c,D={placement:qu(n.placement),variation:Dg(n.placement),popper:n.elements.popper,popperRect:n.rects.popper,gpuAcceleration:p,isFixed:n.options.strategy==="fixed"};n.modifiersData.popperOffsets!=null&&(n.styles.popper=Object.assign({},n.styles.popper,X1(Object.assign({},D,{offsets:n.modifiersData.popperOffsets,position:n.options.strategy,adaptive:g,roundOffsets:A})))),n.modifiersData.arrow!=null&&(n.styles.arrow=Object.assign({},n.styles.arrow,X1(Object.assign({},D,{offsets:n.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:A})))),n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-placement":n.placement})}const lD={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:sD,data:{}};var w0={passive:!0};function cD(i){var n=i.state,a=i.instance,h=i.options,p=h.scroll,v=p===void 0?!0:p,g=h.resize,c=g===void 0?!0:g,A=yl(n.elements.popper),D=[].concat(n.scrollParents.reference,n.scrollParents.popper);return v&&D.forEach(function(N){N.addEventListener("scroll",a.update,w0)}),c&&A.addEventListener("resize",a.update,w0),function(){v&&D.forEach(function(N){N.removeEventListener("scroll",a.update,w0)}),c&&A.removeEventListener("resize",a.update,w0)}}const uD={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:cD,data:{}};var hD={left:"right",right:"left",bottom:"top",top:"bottom"};function C0(i){return i.replace(/left|right|bottom|top/g,function(n){return hD[n]})}var dD={start:"end",end:"start"};function W1(i){return i.replace(/start|end/g,function(n){return dD[n]})}function ux(i){var n=yl(i),a=n.pageXOffset,h=n.pageYOffset;return{scrollLeft:a,scrollTop:h}}function hx(i){return Mg(Lf(i)).left+ux(i).scrollLeft}function fD(i,n){var a=yl(i),h=Lf(i),p=a.visualViewport,v=h.clientWidth,g=h.clientHeight,c=0,A=0;if(p){v=p.width,g=p.height;var D=c2();(D||!D&&n==="fixed")&&(c=p.offsetLeft,A=p.offsetTop)}return{width:v,height:g,x:c+hx(i),y:A}}function pD(i){var n,a=Lf(i),h=ux(i),p=(n=i.ownerDocument)==null?void 0:n.body,v=em(a.scrollWidth,a.clientWidth,p?p.scrollWidth:0,p?p.clientWidth:0),g=em(a.scrollHeight,a.clientHeight,p?p.scrollHeight:0,p?p.clientHeight:0),c=-h.scrollLeft+hx(i),A=-h.scrollTop;return cd(p||a).direction==="rtl"&&(c+=em(a.clientWidth,p?p.clientWidth:0)-v),{width:v,height:g,x:c,y:A}}function dx(i){var n=cd(i),a=n.overflow,h=n.overflowX,p=n.overflowY;return/auto|scroll|overlay|hidden/.test(a+p+h)}function p2(i){return["html","body","#document"].indexOf(Df(i))>=0?i.ownerDocument.body:Hu(i)&&dx(i)?i:p2(uv(i))}function Jy(i,n){var a;n===void 0&&(n=[]);var h=p2(i),p=h===((a=i.ownerDocument)==null?void 0:a.body),v=yl(h),g=p?[v].concat(v.visualViewport||[],dx(h)?h:[]):h,c=n.concat(g);return p?c:c.concat(Jy(uv(g)))}function Mb(i){return Object.assign({},i,{left:i.x,top:i.y,right:i.x+i.width,bottom:i.y+i.height})}function mD(i,n){var a=Mg(i,!1,n==="fixed");return a.top=a.top+i.clientTop,a.left=a.left+i.clientLeft,a.bottom=a.top+i.clientHeight,a.right=a.left+i.clientWidth,a.width=i.clientWidth,a.height=i.clientHeight,a.x=a.left,a.y=a.top,a}function Q1(i,n,a){return n===s2?Mb(fD(i,a)):sm(n)?mD(n,a):Mb(pD(Lf(i)))}function gD(i){var n=Jy(uv(i)),a=["absolute","fixed"].indexOf(cd(i).position)>=0,h=a&&Hu(i)?v_(i):i;return sm(h)?n.filter(function(p){return sm(p)&&u2(p,h)&&Df(p)!=="body"}):[]}function yD(i,n,a,h){var p=n==="clippingParents"?gD(i):[].concat(n),v=[].concat(p,[a]),g=v[0],c=v.reduce(function(A,D){var N=Q1(i,D,h);return A.top=em(N.top,A.top),A.right=L0(N.right,A.right),A.bottom=L0(N.bottom,A.bottom),A.left=em(N.left,A.left),A},Q1(i,g,h));return c.width=c.right-c.left,c.height=c.bottom-c.top,c.x=c.left,c.y=c.top,c}function m2(i){var n=i.reference,a=i.element,h=i.placement,p=h?qu(h):null,v=h?Dg(h):null,g=n.x+n.width/2-a.width/2,c=n.y+n.height/2-a.height/2,A;switch(p){case js:A={x:g,y:n.y-a.height};break;case tc:A={x:g,y:n.y+n.height};break;case nc:A={x:n.x+n.width,y:c};break;case Fs:A={x:n.x-a.width,y:c};break;default:A={x:n.x,y:n.y}}var D=p?cx(p):null;if(D!=null){var N=D==="y"?"height":"width";switch(v){case Ag:A[D]=A[D]-(n[N]/2-a[N]/2);break;case s_:A[D]=A[D]+(n[N]/2-a[N]/2);break}}return A}function l_(i,n){n===void 0&&(n={});var a=n,h=a.placement,p=h===void 0?i.placement:h,v=a.strategy,g=v===void 0?i.strategy:v,c=a.boundary,A=c===void 0?FM:c,D=a.rootBoundary,N=D===void 0?s2:D,L=a.elementContext,F=L===void 0?Zy:L,V=a.altBoundary,$=V===void 0?!1:V,J=a.padding,ae=J===void 0?0:J,fe=d2(typeof ae!="number"?ae:f2(ae,__)),ve=F===Zy?UM:Zy,Ce=i.rects.popper,Me=i.elements[$?ve:F],Te=yD(sm(Me)?Me:Me.contextElement||Lf(i.elements.popper),A,N,g),De=Mg(i.elements.reference),Ne=m2({reference:De,element:Ce,placement:p}),je=Mb(Object.assign({},Ce,Ne)),ye=F===Zy?je:De,Qe={top:Te.top-ye.top+fe.top,bottom:ye.bottom-Te.bottom+fe.bottom,left:Te.left-ye.left+fe.left,right:ye.right-Te.right+fe.right},bt=i.modifiersData.offset;if(F===Zy&&bt){var Ot=bt[p];Object.keys(Qe).forEach(function(mt){var Dt=[nc,tc].indexOf(mt)>=0?1:-1,vt=[js,tc].indexOf(mt)>=0?"y":"x";Qe[mt]+=Ot[vt]*Dt})}return Qe}function _D(i,n){n===void 0&&(n={});var a=n,h=a.placement,p=a.boundary,v=a.rootBoundary,g=a.padding,c=a.flipVariations,A=a.allowedAutoPlacements,D=A===void 0?l2:A,N=Dg(h),L=N?c?q1:q1.filter(function($){return Dg($)===N}):__,F=L.filter(function($){return D.indexOf($)>=0});F.length===0&&(F=L);var V=F.reduce(function($,J){return $[J]=l_(i,{placement:J,boundary:p,rootBoundary:v,padding:g})[qu(J)],$},{});return Object.keys(V).sort(function($,J){return V[$]-V[J]})}function vD(i){if(qu(i)===ox)return[];var n=C0(i);return[W1(i),n,W1(n)]}function bD(i){var n=i.state,a=i.options,h=i.name;if(!n.modifiersData[h]._skip){for(var p=a.mainAxis,v=p===void 0?!0:p,g=a.altAxis,c=g===void 0?!0:g,A=a.fallbackPlacements,D=a.padding,N=a.boundary,L=a.rootBoundary,F=a.altBoundary,V=a.flipVariations,$=V===void 0?!0:V,J=a.allowedAutoPlacements,ae=n.options.placement,fe=qu(ae),ve=fe===ae,Ce=A||(ve||!$?[C0(ae)]:vD(ae)),Me=[ae].concat(Ce).reduce(function(Tt,jt){return Tt.concat(qu(jt)===ox?_D(n,{placement:jt,boundary:N,rootBoundary:L,padding:D,flipVariations:$,allowedAutoPlacements:J}):jt)},[]),Te=n.rects.reference,De=n.rects.popper,Ne=new Map,je=!0,ye=Me[0],Qe=0;Qe<Me.length;Qe++){var bt=Me[Qe],Ot=qu(bt),mt=Dg(bt)===Ag,Dt=[js,tc].indexOf(Ot)>=0,vt=Dt?"width":"height",Ge=l_(n,{placement:bt,boundary:N,rootBoundary:L,altBoundary:F,padding:D}),dt=Dt?mt?nc:Fs:mt?tc:js;Te[vt]>De[vt]&&(dt=C0(dt));var ot=C0(dt),Ut=[];if(v&&Ut.push(Ge[Ot]<=0),c&&Ut.push(Ge[dt]<=0,Ge[ot]<=0),Ut.every(function(Tt){return Tt})){ye=bt,je=!1;break}Ne.set(bt,Ut)}if(je)for(var Ie=$?3:1,ut=function(jt){var qt=Me.find(function(Sn){var dn=Ne.get(Sn);if(dn)return dn.slice(0,jt).every(function(An){return An})});if(qt)return ye=qt,"break"},Bt=Ie;Bt>0;Bt--){var Lt=ut(Bt);if(Lt==="break")break}n.placement!==ye&&(n.modifiersData[h]._skip=!0,n.placement=ye,n.reset=!0)}}const xD={name:"flip",enabled:!0,phase:"main",fn:bD,requiresIfExists:["offset"],data:{_skip:!1}};function K1(i,n,a){return a===void 0&&(a={x:0,y:0}),{top:i.top-n.height-a.y,right:i.right-n.width+a.x,bottom:i.bottom-n.height+a.y,left:i.left-n.width-a.x}}function J1(i){return[js,nc,tc,Fs].some(function(n){return i[n]>=0})}function wD(i){var n=i.state,a=i.name,h=n.rects.reference,p=n.rects.popper,v=n.modifiersData.preventOverflow,g=l_(n,{elementContext:"reference"}),c=l_(n,{altBoundary:!0}),A=K1(g,h),D=K1(c,p,v),N=J1(A),L=J1(D);n.modifiersData[a]={referenceClippingOffsets:A,popperEscapeOffsets:D,isReferenceHidden:N,hasPopperEscaped:L},n.attributes.popper=Object.assign({},n.attributes.popper,{"data-popper-reference-hidden":N,"data-popper-escaped":L})}const TD={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:wD};function ED(i,n,a){var h=qu(i),p=[Fs,js].indexOf(h)>=0?-1:1,v=typeof a=="function"?a(Object.assign({},n,{placement:i})):a,g=v[0],c=v[1];return g=g||0,c=(c||0)*p,[Fs,nc].indexOf(h)>=0?{x:c,y:g}:{x:g,y:c}}function SD(i){var n=i.state,a=i.options,h=i.name,p=a.offset,v=p===void 0?[0,0]:p,g=l2.reduce(function(N,L){return N[L]=ED(L,n.rects,v),N},{}),c=g[n.placement],A=c.x,D=c.y;n.modifiersData.popperOffsets!=null&&(n.modifiersData.popperOffsets.x+=A,n.modifiersData.popperOffsets.y+=D),n.modifiersData[h]=g}const AD={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:SD};function CD(i){var n=i.state,a=i.name;n.modifiersData[a]=m2({reference:n.rects.reference,element:n.rects.popper,placement:n.placement})}const MD={name:"popperOffsets",enabled:!0,phase:"read",fn:CD,data:{}};function DD(i){return i==="x"?"y":"x"}function ID(i){var n=i.state,a=i.options,h=i.name,p=a.mainAxis,v=p===void 0?!0:p,g=a.altAxis,c=g===void 0?!1:g,A=a.boundary,D=a.rootBoundary,N=a.altBoundary,L=a.padding,F=a.tether,V=F===void 0?!0:F,$=a.tetherOffset,J=$===void 0?0:$,ae=l_(n,{boundary:A,rootBoundary:D,padding:L,altBoundary:N}),fe=qu(n.placement),ve=Dg(n.placement),Ce=!ve,Me=cx(fe),Te=DD(Me),De=n.modifiersData.popperOffsets,Ne=n.rects.reference,je=n.rects.popper,ye=typeof J=="function"?J(Object.assign({},n.rects,{placement:n.placement})):J,Qe=typeof ye=="number"?{mainAxis:ye,altAxis:ye}:Object.assign({mainAxis:0,altAxis:0},ye),bt=n.modifiersData.offset?n.modifiersData.offset[n.placement]:null,Ot={x:0,y:0};if(De){if(v){var mt,Dt=Me==="y"?js:Fs,vt=Me==="y"?tc:nc,Ge=Me==="y"?"height":"width",dt=De[Me],ot=dt+ae[Dt],Ut=dt-ae[vt],Ie=V?-je[Ge]/2:0,ut=ve===Ag?Ne[Ge]:je[Ge],Bt=ve===Ag?-je[Ge]:-Ne[Ge],Lt=n.elements.arrow,Tt=V&&Lt?lx(Lt):{width:0,height:0},jt=n.modifiersData["arrow#persistent"]?n.modifiersData["arrow#persistent"].padding:h2(),qt=jt[Dt],Sn=jt[vt],dn=Ky(0,Ne[Ge],Tt[Ge]),An=Ce?Ne[Ge]/2-Ie-dn-qt-Qe.mainAxis:ut-dn-qt-Qe.mainAxis,Un=Ce?-Ne[Ge]/2+Ie+dn+Sn+Qe.mainAxis:Bt+dn+Sn+Qe.mainAxis,Wn=n.elements.arrow&&v_(n.elements.arrow),ai=Wn?Me==="y"?Wn.clientTop||0:Wn.clientLeft||0:0,Ni=(mt=bt==null?void 0:bt[Me])!=null?mt:0,ci=dt+An-Ni-ai,Jn=dt+Un-Ni,Xr=Ky(V?L0(ot,ci):ot,dt,V?em(Ut,Jn):Ut);De[Me]=Xr,Ot[Me]=Xr-dt}if(c){var kr,eo=Me==="x"?js:Fs,Co=Me==="x"?tc:nc,ar=De[Te],ja=Te==="y"?"height":"width",xs=ar+ae[eo],Wo=ar-ae[Co],Wr=[js,Fs].indexOf(fe)!==-1,ws=(kr=bt==null?void 0:bt[Te])!=null?kr:0,to=Wr?xs:ar-Ne[ja]-je[ja]-ws+Qe.altAxis,Qo=Wr?ar+Ne[ja]+je[ja]-ws-Qe.altAxis:Wo,Ea=V&&Wr?eD(to,ar,Qo):Ky(V?to:xs,ar,V?Qo:Wo);De[Te]=Ea,Ot[Te]=Ea-ar}n.modifiersData[h]=Ot}}const kD={name:"preventOverflow",enabled:!0,phase:"main",fn:ID,requiresIfExists:["offset"]};function RD(i){return{scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}}function ND(i){return i===yl(i)||!Hu(i)?ux(i):RD(i)}function PD(i){var n=i.getBoundingClientRect(),a=Cg(n.width)/i.offsetWidth||1,h=Cg(n.height)/i.offsetHeight||1;return a!==1||h!==1}function zD(i,n,a){a===void 0&&(a=!1);var h=Hu(n),p=Hu(n)&&PD(n),v=Lf(n),g=Mg(i,p,a),c={scrollLeft:0,scrollTop:0},A={x:0,y:0};return(h||!h&&!a)&&((Df(n)!=="body"||dx(v))&&(c=ND(n)),Hu(n)?(A=Mg(n,!0),A.x+=n.clientLeft,A.y+=n.clientTop):v&&(A.x=hx(v))),{x:g.left+c.scrollLeft-A.x,y:g.top+c.scrollTop-A.y,width:g.width,height:g.height}}function OD(i){var n=new Map,a=new Set,h=[];i.forEach(function(v){n.set(v.name,v)});function p(v){a.add(v.name);var g=[].concat(v.requires||[],v.requiresIfExists||[]);g.forEach(function(c){if(!a.has(c)){var A=n.get(c);A&&p(A)}}),h.push(v)}return i.forEach(function(v){a.has(v.name)||p(v)}),h}function LD(i){var n=OD(i);return QM.reduce(function(a,h){return a.concat(n.filter(function(p){return p.phase===h}))},[])}function BD(i){var n;return function(){return n||(n=new Promise(function(a){Promise.resolve().then(function(){n=void 0,a(i())})})),n}}function jD(i){var n=i.reduce(function(a,h){var p=a[h.name];return a[h.name]=p?Object.assign({},p,h,{options:Object.assign({},p.options,h.options),data:Object.assign({},p.data,h.data)}):h,a},{});return Object.keys(n).map(function(a){return n[a]})}var ew={placement:"bottom",modifiers:[],strategy:"absolute"};function tw(){for(var i=arguments.length,n=new Array(i),a=0;a<i;a++)n[a]=arguments[a];return!n.some(function(h){return!(h&&typeof h.getBoundingClientRect=="function")})}function FD(i){i===void 0&&(i={});var n=i,a=n.defaultModifiers,h=a===void 0?[]:a,p=n.defaultOptions,v=p===void 0?ew:p;return function(c,A,D){D===void 0&&(D=v);var N={placement:"bottom",orderedModifiers:[],options:Object.assign({},ew,v),modifiersData:{},elements:{reference:c,popper:A},attributes:{},styles:{}},L=[],F=!1,V={state:N,setOptions:function(fe){var ve=typeof fe=="function"?fe(N.options):fe;J(),N.options=Object.assign({},v,N.options,ve),N.scrollParents={reference:sm(c)?Jy(c):c.contextElement?Jy(c.contextElement):[],popper:Jy(A)};var Ce=LD(jD([].concat(h,N.options.modifiers)));return N.orderedModifiers=Ce.filter(function(Me){return Me.enabled}),$(),V.update()},forceUpdate:function(){if(!F){var fe=N.elements,ve=fe.reference,Ce=fe.popper;if(tw(ve,Ce)){N.rects={reference:zD(ve,v_(Ce),N.options.strategy==="fixed"),popper:lx(Ce)},N.reset=!1,N.placement=N.options.placement,N.orderedModifiers.forEach(function(Qe){return N.modifiersData[Qe.name]=Object.assign({},Qe.data)});for(var Me=0;Me<N.orderedModifiers.length;Me++){if(N.reset===!0){N.reset=!1,Me=-1;continue}var Te=N.orderedModifiers[Me],De=Te.fn,Ne=Te.options,je=Ne===void 0?{}:Ne,ye=Te.name;typeof De=="function"&&(N=De({state:N,options:je,name:ye,instance:V})||N)}}}},update:BD(function(){return new Promise(function(ae){V.forceUpdate(),ae(N)})}),destroy:function(){J(),F=!0}};if(!tw(c,A))return V;V.setOptions(D).then(function(ae){!F&&D.onFirstUpdate&&D.onFirstUpdate(ae)});function $(){N.orderedModifiers.forEach(function(ae){var fe=ae.name,ve=ae.options,Ce=ve===void 0?{}:ve,Me=ae.effect;if(typeof Me=="function"){var Te=Me({state:N,name:fe,instance:V,options:Ce}),De=function(){};L.push(Te||De)}})}function J(){L.forEach(function(ae){return ae()}),L=[]}return V}}const UD=FD({defaultModifiers:[TD,MD,lD,uD,AD,xD,kD,rD]}),VD=["enabled","placement","strategy","modifiers"];function GD(i,n){if(i==null)return{};var a={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;a[h]=i[h]}return a}const ZD={name:"applyStyles",enabled:!1,phase:"afterWrite",fn:()=>{}},$D={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:({state:i})=>()=>{const{reference:n,popper:a}=i.elements;if("removeAttribute"in n){const h=(n.getAttribute("aria-describedby")||"").split(",").filter(p=>p.trim()!==a.id);h.length?n.setAttribute("aria-describedby",h.join(",")):n.removeAttribute("aria-describedby")}},fn:({state:i})=>{var n;const{popper:a,reference:h}=i.elements,p=(n=a.getAttribute("role"))==null?void 0:n.toLowerCase();if(a.id&&p==="tooltip"&&"setAttribute"in h){const v=h.getAttribute("aria-describedby");if(v&&v.split(",").indexOf(a.id)!==-1)return;h.setAttribute("aria-describedby",v?`${v},${a.id}`:a.id)}}},YD=[];function qD(i,n,a={}){let{enabled:h=!0,placement:p="bottom",strategy:v="absolute",modifiers:g=YD}=a,c=GD(a,VD);const A=he.useRef(g),D=he.useRef(),N=he.useCallback(()=>{var ae;(ae=D.current)==null||ae.update()},[]),L=he.useCallback(()=>{var ae;(ae=D.current)==null||ae.forceUpdate()},[]),[F,V]=jM(he.useState({placement:p,update:N,forceUpdate:L,attributes:{},styles:{popper:{},arrow:{}}})),$=he.useMemo(()=>({name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:({state:ae})=>{const fe={},ve={};Object.keys(ae.elements).forEach(Ce=>{fe[Ce]=ae.styles[Ce],ve[Ce]=ae.attributes[Ce]}),V({state:ae,styles:fe,attributes:ve,update:N,forceUpdate:L,placement:ae.placement})}}),[N,L,V]),J=he.useMemo(()=>(Qy(A.current,g)||(A.current=g),A.current),[g]);return he.useEffect(()=>{!D.current||!h||D.current.setOptions({placement:p,strategy:v,modifiers:[...J,$,ZD]})},[v,p,$,h,J]),he.useEffect(()=>{if(!(!h||i==null||n==null))return D.current=UD(i,n,Object.assign({},c,{placement:p,strategy:v,modifiers:[...J,$D,$]})),()=>{D.current!=null&&(D.current.destroy(),D.current=void 0,V(ae=>Object.assign({},ae,{attributes:{},styles:{popper:{}}})))}},[h,i,n]),F}function B0(i,n){if(i.contains)return i.contains(n);if(i.compareDocumentPosition)return i===n||!!(i.compareDocumentPosition(n)&16)}var ib,nw;function HD(){if(nw)return ib;nw=1;var i=function(){};return ib=i,ib}var XD=HD();const WD=fm(XD),iw=()=>{};function QD(i){return i.button===0}function KD(i){return!!(i.metaKey||i.altKey||i.ctrlKey||i.shiftKey)}const M0=i=>i&&("current"in i?i.current:i),rw={click:"mousedown",mouseup:"mousedown",pointerup:"pointerdown"};function JD(i,n=iw,{disabled:a,clickTrigger:h="click"}={}){const p=he.useRef(!1),v=he.useRef(!1),g=he.useCallback(D=>{const N=M0(i);WD(!!N,"ClickOutside captured a close event but does not have a ref to compare it to. useClickOutside(), should be passed a ref that resolves to a DOM node"),p.current=!N||KD(D)||!QD(D)||!!B0(N,D.target)||v.current,v.current=!1},[i]),c=Zu(D=>{const N=M0(i);N&&B0(N,D.target)?v.current=!0:v.current=!1}),A=Zu(D=>{p.current||n(D)});he.useEffect(()=>{var D,N;if(a||i==null)return;const L=m_(M0(i)),F=L.defaultView||window;let V=(D=F.event)!=null?D:(N=F.parent)==null?void 0:N.event,$=null;rw[h]&&($=Jh(L,rw[h],c,!0));const J=Jh(L,h,g,!0),ae=Jh(L,h,ve=>{if(ve===V){V=void 0;return}A(ve)});let fe=[];return"ontouchstart"in L.documentElement&&(fe=[].slice.call(L.body.children).map(ve=>Jh(ve,"mousemove",iw))),()=>{$==null||$(),J(),ae(),fe.forEach(ve=>ve())}},[i,a,h,g,c,A])}function eI(i){const n={};return Array.isArray(i)?(i==null||i.forEach(a=>{n[a.name]=a}),n):i||n}function tI(i={}){return Array.isArray(i)?i:Object.keys(i).map(n=>(i[n].name=n,i[n]))}function nI({enabled:i,enableEvents:n,placement:a,flip:h,offset:p,fixed:v,containerPadding:g,arrowElement:c,popperConfig:A={}}){var D,N,L,F;const V=eI(A.modifiers);return Object.assign({},A,{placement:a,enabled:i,strategy:v?"fixed":A.strategy,modifiers:tI(Object.assign({},V,{eventListeners:{enabled:n,options:(D=V.eventListeners)==null?void 0:D.options},preventOverflow:Object.assign({},V.preventOverflow,{options:Object.assign({padding:g},(N=V.preventOverflow)==null?void 0:N.options)}),offset:{options:Object.assign({offset:p},(L=V.offset)==null?void 0:L.options)},arrow:Object.assign({},V.arrow,{enabled:!!c,options:Object.assign({},(F=V.arrow)==null?void 0:F.options,{element:c})}),flip:Object.assign({enabled:!!h},V.flip)}))})}const iI=he.createContext(null),rI="data-rr-ui-";function aI(i){return`${rI}${i}`}const g2=he.createContext(lv?window:void 0);g2.Provider;function fx(){return he.useContext(g2)}const oI=typeof global<"u"&&global.navigator&&global.navigator.product==="ReactNative",sI=typeof document<"u",y2=sI||oI?he.useLayoutEffect:he.useEffect,b_=he.createContext(null);b_.displayName="NavbarContext";const lI={type:rd.string,tooltip:rd.bool,as:rd.elementType},hv=he.forwardRef(({as:i="div",className:n,type:a="valid",tooltip:h=!1,...p},v)=>se.jsx(i,{...p,ref:v,className:Ln(n,`${a}-${h?"tooltip":"feedback"}`)}));hv.displayName="Feedback";hv.propTypes=lI;const ud=he.createContext({}),px=he.forwardRef(({id:i,bsPrefix:n,className:a,type:h="checkbox",isValid:p=!1,isInvalid:v=!1,as:g="input",...c},A)=>{const{controlId:D}=he.useContext(ud);return n=ni(n,"form-check-input"),se.jsx(g,{...c,ref:A,type:h,id:i||D,className:Ln(a,n,p&&"is-valid",v&&"is-invalid")})});px.displayName="FormCheckInput";const j0=he.forwardRef(({bsPrefix:i,className:n,htmlFor:a,...h},p)=>{const{controlId:v}=he.useContext(ud);return i=ni(i,"form-check-label"),se.jsx("label",{...h,ref:p,htmlFor:a||v,className:Ln(n,i)})});j0.displayName="FormCheckLabel";const _2=he.forwardRef(({id:i,bsPrefix:n,bsSwitchPrefix:a,inline:h=!1,reverse:p=!1,disabled:v=!1,isValid:g=!1,isInvalid:c=!1,feedbackTooltip:A=!1,feedback:D,feedbackType:N,className:L,style:F,title:V="",type:$="checkbox",label:J,children:ae,as:fe="input",...ve},Ce)=>{n=ni(n,"form-check"),a=ni(a,"form-switch");const{controlId:Me}=he.useContext(ud),Te=he.useMemo(()=>({controlId:i||Me}),[Me,i]),De=!ae&&J!=null&&J!==!1||OM(ae,j0),Ne=se.jsx(px,{...ve,type:$==="switch"?"checkbox":$,ref:Ce,isValid:g,isInvalid:c,disabled:v,as:fe});return se.jsx(ud.Provider,{value:Te,children:se.jsx("div",{style:F,className:Ln(L,De&&n,h&&`${n}-inline`,p&&`${n}-reverse`,$==="switch"&&a),children:ae||se.jsxs(se.Fragment,{children:[Ne,De&&se.jsx(j0,{title:V,children:J}),D&&se.jsx(hv,{type:N,tooltip:A,children:D})]})})})});_2.displayName="FormCheck";const F0=Object.assign(_2,{Input:px,Label:j0}),v2=he.forwardRef(({bsPrefix:i,type:n,size:a,htmlSize:h,id:p,className:v,isValid:g=!1,isInvalid:c=!1,plaintext:A,readOnly:D,as:N="input",...L},F)=>{const{controlId:V}=he.useContext(ud);return i=ni(i,"form-control"),se.jsx(N,{...L,type:n,size:h,ref:F,readOnly:D,id:p||V,className:Ln(v,A?`${i}-plaintext`:i,a&&`${i}-${a}`,n==="color"&&`${i}-color`,g&&"is-valid",c&&"is-invalid")})});v2.displayName="FormControl";const cI=Object.assign(v2,{Feedback:hv}),b2=he.forwardRef(({className:i,bsPrefix:n,as:a="div",...h},p)=>(n=ni(n,"form-floating"),se.jsx(a,{ref:p,className:Ln(i,n),...h})));b2.displayName="FormFloating";const mx=he.forwardRef(({controlId:i,as:n="div",...a},h)=>{const p=he.useMemo(()=>({controlId:i}),[i]);return se.jsx(ud.Provider,{value:p,children:se.jsx(n,{...a,ref:h})})});mx.displayName="FormGroup";const x2=he.forwardRef(({as:i="label",bsPrefix:n,column:a=!1,visuallyHidden:h=!1,className:p,htmlFor:v,...g},c)=>{const{controlId:A}=he.useContext(ud);n=ni(n,"form-label");let D="col-form-label";typeof a=="string"&&(D=`${D} ${D}-${a}`);const N=Ln(p,n,h&&"visually-hidden",a&&D);return v=v||A,a?se.jsx(o2,{ref:c,as:"label",className:N,htmlFor:v,...g}):se.jsx(i,{ref:c,className:N,htmlFor:v,...g})});x2.displayName="FormLabel";const w2=he.forwardRef(({bsPrefix:i,className:n,id:a,...h},p)=>{const{controlId:v}=he.useContext(ud);return i=ni(i,"form-range"),se.jsx("input",{...h,type:"range",ref:p,className:Ln(n,i),id:a||v})});w2.displayName="FormRange";const T2=he.forwardRef(({bsPrefix:i,size:n,htmlSize:a,className:h,isValid:p=!1,isInvalid:v=!1,id:g,...c},A)=>{const{controlId:D}=he.useContext(ud);return i=ni(i,"form-select"),se.jsx("select",{...c,size:a,ref:A,className:Ln(h,i,n&&`${i}-${n}`,p&&"is-valid",v&&"is-invalid"),id:g||D})});T2.displayName="FormSelect";const E2=he.forwardRef(({bsPrefix:i,className:n,as:a="small",muted:h,...p},v)=>(i=ni(i,"form-text"),se.jsx(a,{...p,ref:v,className:Ln(n,i,h&&"text-muted")})));E2.displayName="FormText";const S2=he.forwardRef((i,n)=>se.jsx(F0,{...i,ref:n,type:"switch"}));S2.displayName="Switch";const uI=Object.assign(S2,{Input:F0.Input,Label:F0.Label}),A2=he.forwardRef(({bsPrefix:i,className:n,children:a,controlId:h,label:p,...v},g)=>(i=ni(i,"form-floating"),se.jsxs(mx,{ref:g,className:Ln(n,i),controlId:h,...v,children:[a,se.jsx("label",{htmlFor:h,children:p})]})));A2.displayName="FloatingLabel";const hI={_ref:rd.any,validated:rd.bool,as:rd.elementType},gx=he.forwardRef(({className:i,validated:n,as:a="form",...h},p)=>se.jsx(a,{...h,ref:p,className:Ln(i,n&&"was-validated")}));gx.displayName="Form";gx.propTypes=hI;const ji=Object.assign(gx,{Group:mx,Control:cI,Floating:b2,Check:F0,Switch:uI,Label:x2,Text:E2,Range:w2,Select:T2,FloatingLabel:A2}),aw=i=>!i||typeof i=="function"?i:n=>{i.current=n};function dI(i,n){const a=aw(i),h=aw(n);return p=>{a&&a(p),h&&h(p)}}function dv(i,n){return he.useMemo(()=>dI(i,n),[i,n])}function rb(i){i===void 0&&(i=m_());try{var n=i.activeElement;return!n||!n.nodeName?null:n}catch{return i.body}}function fI(i){const n=he.useRef(i);return n.current=i,n}function pI(i){const n=fI(i);he.useEffect(()=>()=>n.current(),[])}function mI(i=document){const n=i.defaultView;return Math.abs(n.innerWidth-i.documentElement.clientWidth)}const ow=aI("modal-open");class yx{constructor({ownerDocument:n,handleContainerOverflow:a=!0,isRTL:h=!1}={}){this.handleContainerOverflow=a,this.isRTL=h,this.modals=[],this.ownerDocument=n}getScrollbarWidth(){return mI(this.ownerDocument)}getElement(){return(this.ownerDocument||document).body}setModalAttributes(n){}removeModalAttributes(n){}setContainerStyle(n){const a={overflow:"hidden"},h=this.isRTL?"paddingLeft":"paddingRight",p=this.getElement();n.style={overflow:p.style.overflow,[h]:p.style[h]},n.scrollBarWidth&&(a[h]=`${parseInt(id(p,h)||"0",10)+n.scrollBarWidth}px`),p.setAttribute(ow,""),id(p,a)}reset(){[...this.modals].forEach(n=>this.remove(n))}removeContainerStyle(n){const a=this.getElement();a.removeAttribute(ow),Object.assign(a.style,n.style)}add(n){let a=this.modals.indexOf(n);return a!==-1||(a=this.modals.length,this.modals.push(n),this.setModalAttributes(n),a!==0)||(this.state={scrollBarWidth:this.getScrollbarWidth(),style:{}},this.handleContainerOverflow&&this.setContainerStyle(this.state)),a}remove(n){const a=this.modals.indexOf(n);a!==-1&&(this.modals.splice(a,1),!this.modals.length&&this.handleContainerOverflow&&this.removeContainerStyle(this.state),this.removeModalAttributes(n))}isTopModal(n){return!!this.modals.length&&this.modals[this.modals.length-1]===n}}const ab=(i,n)=>lv?i==null?(n||m_()).body:(typeof i=="function"&&(i=i()),i&&"current"in i&&(i=i.current),i&&("nodeType"in i||i.getBoundingClientRect)?i:null):null;function Db(i,n){const a=fx(),[h,p]=he.useState(()=>ab(i,a==null?void 0:a.document));if(!h){const v=ab(i);v&&p(v)}return he.useEffect(()=>{},[n,h]),he.useEffect(()=>{const v=ab(i);v!==h&&p(v)},[i,h]),h}function gI({children:i,in:n,onExited:a,mountOnEnter:h,unmountOnExit:p}){const v=he.useRef(null),g=he.useRef(n),c=Zu(a);he.useEffect(()=>{n?g.current=!0:c(v.current)},[n,c]);const A=dv(v,Gg(i)),D=he.cloneElement(i,{ref:A});return n?D:p||!g.current&&h?null:D}const yI=["onEnter","onEntering","onEntered","onExit","onExiting","onExited","addEndListener","children"];function _I(i,n){if(i==null)return{};var a={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;a[h]=i[h]}return a}function vI(i){let{onEnter:n,onEntering:a,onEntered:h,onExit:p,onExiting:v,onExited:g,addEndListener:c,children:A}=i,D=_I(i,yI);const N=he.useRef(null),L=dv(N,Gg(A)),F=Me=>Te=>{Me&&N.current&&Me(N.current,Te)},V=he.useCallback(F(n),[n]),$=he.useCallback(F(a),[a]),J=he.useCallback(F(h),[h]),ae=he.useCallback(F(p),[p]),fe=he.useCallback(F(v),[v]),ve=he.useCallback(F(g),[g]),Ce=he.useCallback(F(c),[c]);return Object.assign({},D,{nodeRef:N},n&&{onEnter:V},a&&{onEntering:$},h&&{onEntered:J},p&&{onExit:ae},v&&{onExiting:fe},g&&{onExited:ve},c&&{addEndListener:Ce},{children:typeof A=="function"?(Me,Te)=>A(Me,Object.assign({},Te,{ref:L})):he.cloneElement(A,{ref:L})})}const bI=["component"];function xI(i,n){if(i==null)return{};var a={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;a[h]=i[h]}return a}const wI=he.forwardRef((i,n)=>{let{component:a}=i,h=xI(i,bI);const p=vI(h);return se.jsx(a,Object.assign({ref:n},p))});function TI({in:i,onTransition:n}){const a=he.useRef(null),h=he.useRef(!0),p=Zu(n);return Z1(()=>{if(!a.current)return;let v=!1;return p({in:i,element:a.current,initial:h.current,isStale:()=>v}),()=>{v=!0}},[i,p]),Z1(()=>(h.current=!1,()=>{h.current=!0}),[]),a}function EI({children:i,in:n,onExited:a,onEntered:h,transition:p}){const[v,g]=he.useState(!n);n&&v&&g(!1);const c=TI({in:!!n,onTransition:D=>{const N=()=>{D.isStale()||(D.in?h==null||h(D.element,D.initial):(g(!0),a==null||a(D.element)))};Promise.resolve(p(D)).then(N,L=>{throw D.in||g(!0),L})}}),A=dv(c,Gg(i));return v&&!n?null:he.cloneElement(i,{ref:A})}function Ib(i,n,a){return i?se.jsx(wI,Object.assign({},a,{component:i})):n?se.jsx(EI,Object.assign({},a,{transition:n})):se.jsx(gI,Object.assign({},a))}const SI=["show","role","className","style","children","backdrop","keyboard","onBackdropClick","onEscapeKeyDown","transition","runTransition","backdropTransition","runBackdropTransition","autoFocus","enforceFocus","restoreFocus","restoreFocusOptions","renderDialog","renderBackdrop","manager","container","onShow","onHide","onExit","onExited","onExiting","onEnter","onEntering","onEntered"];function AI(i,n){if(i==null)return{};var a={};for(var h in i)if({}.hasOwnProperty.call(i,h)){if(n.indexOf(h)>=0)continue;a[h]=i[h]}return a}let ob;function CI(i){return ob||(ob=new yx({ownerDocument:i==null?void 0:i.document})),ob}function MI(i){const n=fx(),a=i||CI(n),h=he.useRef({dialog:null,backdrop:null});return Object.assign(h.current,{add:()=>a.add(h.current),remove:()=>a.remove(h.current),isTopModal:()=>a.isTopModal(h.current),setDialogRef:he.useCallback(p=>{h.current.dialog=p},[]),setBackdropRef:he.useCallback(p=>{h.current.backdrop=p},[])})}const C2=he.forwardRef((i,n)=>{let{show:a=!1,role:h="dialog",className:p,style:v,children:g,backdrop:c=!0,keyboard:A=!0,onBackdropClick:D,onEscapeKeyDown:N,transition:L,runTransition:F,backdropTransition:V,runBackdropTransition:$,autoFocus:J=!0,enforceFocus:ae=!0,restoreFocus:fe=!0,restoreFocusOptions:ve,renderDialog:Ce,renderBackdrop:Me=Jn=>se.jsx("div",Object.assign({},Jn)),manager:Te,container:De,onShow:Ne,onHide:je=()=>{},onExit:ye,onExited:Qe,onExiting:bt,onEnter:Ot,onEntering:mt,onEntered:Dt}=i,vt=AI(i,SI);const Ge=fx(),dt=Db(De),ot=MI(Te),Ut=r2(),Ie=CM(a),[ut,Bt]=he.useState(!a),Lt=he.useRef(null);he.useImperativeHandle(n,()=>ot,[ot]),lv&&!Ie&&a&&(Lt.current=rb(Ge==null?void 0:Ge.document)),a&&ut&&Bt(!1);const Tt=Zu(()=>{if(ot.add(),Un.current=Jh(document,"keydown",dn),An.current=Jh(document,"focus",()=>setTimeout(qt),!0),Ne&&Ne(),J){var Jn,Xr;const kr=rb((Jn=(Xr=ot.dialog)==null?void 0:Xr.ownerDocument)!=null?Jn:Ge==null?void 0:Ge.document);ot.dialog&&kr&&!B0(ot.dialog,kr)&&(Lt.current=kr,ot.dialog.focus())}}),jt=Zu(()=>{if(ot.remove(),Un.current==null||Un.current(),An.current==null||An.current(),fe){var Jn;(Jn=Lt.current)==null||Jn.focus==null||Jn.focus(ve),Lt.current=null}});he.useEffect(()=>{!a||!dt||Tt()},[a,dt,Tt]),he.useEffect(()=>{ut&&jt()},[ut,jt]),pI(()=>{jt()});const qt=Zu(()=>{if(!ae||!Ut()||!ot.isTopModal())return;const Jn=rb(Ge==null?void 0:Ge.document);ot.dialog&&Jn&&!B0(ot.dialog,Jn)&&ot.dialog.focus()}),Sn=Zu(Jn=>{Jn.target===Jn.currentTarget&&(D==null||D(Jn),c===!0&&je())}),dn=Zu(Jn=>{A&&XT(Jn)&&ot.isTopModal()&&(N==null||N(Jn),Jn.defaultPrevented||je())}),An=he.useRef(),Un=he.useRef(),Wn=(...Jn)=>{Bt(!0),Qe==null||Qe(...Jn)};if(!dt)return null;const ai=Object.assign({role:h,ref:ot.setDialogRef,"aria-modal":h==="dialog"?!0:void 0},vt,{style:v,className:p,tabIndex:-1});let Ni=Ce?Ce(ai):se.jsx("div",Object.assign({},ai,{children:he.cloneElement(g,{role:"document"})}));Ni=Ib(L,F,{unmountOnExit:!0,mountOnEnter:!0,appear:!0,in:!!a,onExit:ye,onExiting:bt,onExited:Wn,onEnter:Ot,onEntering:mt,onEntered:Dt,children:Ni});let ci=null;return c&&(ci=Me({ref:ot.setBackdropRef,onClick:Sn}),ci=Ib(V,$,{in:!!a,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:ci})),se.jsx(se.Fragment,{children:Wp.createPortal(se.jsxs(se.Fragment,{children:[ci,Ni]}),dt)})});C2.displayName="Modal";const DI=Object.assign(C2,{Manager:yx});function kb(i,n){return i.classList?!!n&&i.classList.contains(n):(" "+(i.className.baseVal||i.className)+" ").indexOf(" "+n+" ")!==-1}function II(i,n){i.classList?i.classList.add(n):kb(i,n)||(typeof i.className=="string"?i.className=i.className+" "+n:i.setAttribute("class",(i.className&&i.className.baseVal||"")+" "+n))}function sw(i,n){return i.replace(new RegExp("(^|\\s)"+n+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function kI(i,n){i.classList?i.classList.remove(n):typeof i.className=="string"?i.className=sw(i.className,n):i.setAttribute("class",sw(i.className&&i.className.baseVal||"",n))}const dg={FIXED_CONTENT:".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",STICKY_CONTENT:".sticky-top",NAVBAR_TOGGLER:".navbar-toggler"};class M2 extends yx{adjustAndStore(n,a,h){const p=a.style[n];a.dataset[n]=p,id(a,{[n]:`${parseFloat(id(a,n))+h}px`})}restore(n,a){const h=a.dataset[n];h!==void 0&&(delete a.dataset[n],id(a,{[n]:h}))}setContainerStyle(n){super.setContainerStyle(n);const a=this.getElement();if(II(a,"modal-open"),!n.scrollBarWidth)return;const h=this.isRTL?"paddingLeft":"paddingRight",p=this.isRTL?"marginLeft":"marginRight";hg(a,dg.FIXED_CONTENT).forEach(v=>this.adjustAndStore(h,v,n.scrollBarWidth)),hg(a,dg.STICKY_CONTENT).forEach(v=>this.adjustAndStore(p,v,-n.scrollBarWidth)),hg(a,dg.NAVBAR_TOGGLER).forEach(v=>this.adjustAndStore(p,v,n.scrollBarWidth))}removeContainerStyle(n){super.removeContainerStyle(n);const a=this.getElement();kI(a,"modal-open");const h=this.isRTL?"paddingLeft":"paddingRight",p=this.isRTL?"marginLeft":"marginRight";hg(a,dg.FIXED_CONTENT).forEach(v=>this.restore(h,v)),hg(a,dg.STICKY_CONTENT).forEach(v=>this.restore(p,v)),hg(a,dg.NAVBAR_TOGGLER).forEach(v=>this.restore(p,v))}}let sb;function RI(i){return sb||(sb=new M2(i)),sb}const D2=he.createContext({onHide(){}}),NI=he.forwardRef(({closeLabel:i="Close",closeVariant:n,closeButton:a=!1,onHide:h,children:p,...v},g)=>{const c=he.useContext(D2),A=y_(()=>{c==null||c.onHide(),h==null||h()});return se.jsxs("div",{ref:g,...v,children:[p,a&&se.jsx(rx,{"aria-label":i,variant:n,onClick:A})]})}),I2=he.forwardRef(({bsPrefix:i,className:n,as:a,...h},p)=>{i=ni(i,"navbar-brand");const v=a||(h.href?"a":"span");return se.jsx(v,{...h,ref:p,className:Ln(n,i)})});I2.displayName="NavbarBrand";const k2=he.forwardRef(({children:i,bsPrefix:n,...a},h)=>{n=ni(n,"navbar-collapse");const p=he.useContext(b_);return se.jsx(KT,{in:!!(p&&p.expanded),...a,children:se.jsx("div",{ref:h,className:n,children:i})})});k2.displayName="NavbarCollapse";const R2=he.forwardRef(({bsPrefix:i,className:n,children:a,label:h="Toggle navigation",as:p="button",onClick:v,...g},c)=>{i=ni(i,"navbar-toggler");const{onToggle:A,expanded:D}=he.useContext(b_)||{},N=y_(L=>{v&&v(L),A&&A()});return p==="button"&&(g.type="button"),se.jsx(p,{...g,ref:c,onClick:N,"aria-label":h,className:Ln(n,i,!D&&"collapsed"),children:a||se.jsx("span",{className:`${i}-icon`})})});R2.displayName="NavbarToggle";const Rb=new WeakMap,lw=(i,n)=>{if(!i||!n)return;const a=Rb.get(n)||new Map;Rb.set(n,a);let h=a.get(i);return h||(h=n.matchMedia(i),h.refCount=0,a.set(h.media,h)),h};function PI(i,n=typeof window>"u"?void 0:window){const a=lw(i,n),[h,p]=he.useState(()=>a?a.matches:!1);return y2(()=>{let v=lw(i,n);if(!v)return p(!1);let g=Rb.get(n);const c=()=>{p(v.matches)};return v.refCount++,v.addListener(c),c(),()=>{v.removeListener(c),v.refCount--,v.refCount<=0&&(g==null||g.delete(v.media)),v=void 0}},[i]),h}function zI(i){const n=Object.keys(i);function a(c,A){return c===A?A:c?`${c} and ${A}`:A}function h(c){return n[Math.min(n.indexOf(c)+1,n.length-1)]}function p(c){const A=h(c);let D=i[A];return typeof D=="number"?D=`${D-.2}px`:D=`calc(${D} - 0.2px)`,`(max-width: ${D})`}function v(c){let A=i[c];return typeof A=="number"&&(A=`${A}px`),`(min-width: ${A})`}function g(c,A,D){let N;typeof c=="object"?(N=c,D=A,A=!0):(A=A||!0,N={[c]:A});let L=he.useMemo(()=>Object.entries(N).reduce((F,[V,$])=>(($==="up"||$===!0)&&(F=a(F,v(V))),($==="down"||$===!0)&&(F=a(F,p(V))),F),""),[JSON.stringify(N)]);return PI(L,D)}return g}const OI=zI({xs:0,sm:576,md:768,lg:992,xl:1200,xxl:1400}),N2=he.forwardRef(({className:i,bsPrefix:n,as:a="div",...h},p)=>(n=ni(n,"offcanvas-body"),se.jsx(a,{ref:p,className:Ln(i,n),...h})));N2.displayName="OffcanvasBody";const LI={[Hc]:"show",[Kh]:"show"},P2=he.forwardRef(({bsPrefix:i,className:n,children:a,in:h=!1,mountOnEnter:p=!1,unmountOnExit:v=!1,appear:g=!1,...c},A)=>(i=ni(i,"offcanvas"),se.jsx(tx,{ref:A,addEndListener:ex,in:h,mountOnEnter:p,unmountOnExit:v,appear:g,...c,childRef:Gg(a),children:(D,N)=>he.cloneElement(a,{...N,className:Ln(n,a.props.className,(D===Hc||D===o_)&&`${i}-toggling`,LI[D])})})));P2.displayName="OffcanvasToggling";const z2=he.forwardRef(({bsPrefix:i,className:n,closeLabel:a="Close",closeButton:h=!1,...p},v)=>(i=ni(i,"offcanvas-header"),se.jsx(NI,{ref:v,...p,className:Ln(n,i),closeLabel:a,closeButton:h})));z2.displayName="OffcanvasHeader";const BI=SM("h5"),O2=he.forwardRef(({className:i,bsPrefix:n,as:a=BI,...h},p)=>(n=ni(n,"offcanvas-title"),se.jsx(a,{ref:p,className:Ln(i,n),...h})));O2.displayName="OffcanvasTitle";function jI(i){return se.jsx(P2,{...i})}function FI(i){return se.jsx(O0,{...i})}const L2=he.forwardRef(({bsPrefix:i,className:n,children:a,"aria-labelledby":h,placement:p="start",responsive:v,show:g=!1,backdrop:c=!0,keyboard:A=!0,scroll:D=!1,onEscapeKeyDown:N,onShow:L,onHide:F,container:V,autoFocus:$=!0,enforceFocus:J=!0,restoreFocus:ae=!0,restoreFocusOptions:fe,onEntered:ve,onExit:Ce,onExiting:Me,onEnter:Te,onEntering:De,onExited:Ne,backdropClassName:je,manager:ye,renderStaticNode:Qe=!1,...bt},Ot)=>{const mt=he.useRef();i=ni(i,"offcanvas");const[Dt,vt]=he.useState(!1),Ge=y_(F),dt=OI(v||"xs","up");he.useEffect(()=>{vt(v?g&&!dt:g)},[g,v,dt]);const ot=he.useMemo(()=>({onHide:Ge}),[Ge]);function Ut(){return ye||(D?(mt.current||(mt.current=new M2({handleContainerOverflow:!1})),mt.current):RI())}const Ie=(Tt,...jt)=>{Tt&&(Tt.style.visibility="visible"),Te==null||Te(Tt,...jt)},ut=(Tt,...jt)=>{Tt&&(Tt.style.visibility=""),Ne==null||Ne(...jt)},Bt=he.useCallback(Tt=>se.jsx("div",{...Tt,className:Ln(`${i}-backdrop`,je)}),[je,i]),Lt=Tt=>se.jsx("div",{...Tt,...bt,className:Ln(n,v?`${i}-${v}`:i,`${i}-${p}`),"aria-labelledby":h,children:a});return se.jsxs(se.Fragment,{children:[!Dt&&(v||Qe)&&Lt({}),se.jsx(D2.Provider,{value:ot,children:se.jsx(DI,{show:Dt,ref:Ot,backdrop:c,container:V,keyboard:A,autoFocus:$,enforceFocus:J&&!D,restoreFocus:ae,restoreFocusOptions:fe,onEscapeKeyDown:N,onShow:L,onHide:Ge,onEnter:Ie,onEntering:De,onEntered:ve,onExit:Ce,onExiting:Me,onExited:ut,manager:Ut(),transition:jI,backdropTransition:FI,renderBackdrop:Bt,renderDialog:Lt})})]})});L2.displayName="Offcanvas";const UI=Object.assign(L2,{Body:N2,Header:z2,Title:O2}),B2=he.forwardRef(({onHide:i,...n},a)=>{const h=he.useContext(b_),p=y_(()=>{h==null||h.onToggle==null||h.onToggle(),i==null||i()});return se.jsx(UI,{ref:a,show:!!(h!=null&&h.expanded),...n,renderStaticNode:!0,onHide:p})});B2.displayName="NavbarOffcanvas";const j2=he.forwardRef(({className:i,bsPrefix:n,as:a="span",...h},p)=>(n=ni(n,"navbar-text"),se.jsx(a,{ref:p,className:Ln(i,n),...h})));j2.displayName="NavbarText";const F2=he.forwardRef((i,n)=>{const{bsPrefix:a,expand:h=!0,variant:p="light",bg:v,fixed:g,sticky:c,className:A,as:D="nav",expanded:N,onToggle:L,onSelect:F,collapseOnSelect:V=!1,...$}=YT(i,{expanded:"onToggle"}),J=ni(a,"navbar"),ae=he.useCallback((...Ce)=>{F==null||F(...Ce),V&&N&&(L==null||L(!1))},[F,V,N,L]);$.role===void 0&&D!=="nav"&&($.role="navigation");let fe=`${J}-expand`;typeof h=="string"&&(fe=`${fe}-${h}`);const ve=he.useMemo(()=>({onToggle:()=>L==null?void 0:L(!N),bsPrefix:J,expanded:!!N,expand:h}),[J,N,h,L]);return se.jsx(b_.Provider,{value:ve,children:se.jsx(iI.Provider,{value:ae,children:se.jsx(D,{ref:n,...$,className:Ln(A,J,h&&fe,p&&`${J}-${p}`,v&&`bg-${v}`,c&&`sticky-${c}`,g&&`fixed-${g}`)})})})});F2.displayName="Navbar";const VI=Object.assign(F2,{Brand:I2,Collapse:k2,Offcanvas:B2,Text:j2,Toggle:R2}),GI=()=>{};function ZI(i,n,{disabled:a,clickTrigger:h}={}){const p=n||GI;JD(i,p,{disabled:a,clickTrigger:h});const v=Zu(g=>{XT(g)&&p(g)});he.useEffect(()=>{if(a||i==null)return;const g=m_(M0(i));let c=(g.defaultView||window).event;const A=Jh(g,"keyup",D=>{if(D===c){c=void 0;return}v(D)});return()=>{A()}},[i,a,v])}const U2=he.forwardRef((i,n)=>{const{flip:a,offset:h,placement:p,containerPadding:v,popperConfig:g={},transition:c,runTransition:A}=i,[D,N]=G1(),[L,F]=G1(),V=dv(N,n),$=Db(i.container),J=Db(i.target),[ae,fe]=he.useState(!i.show),ve=qD(J,D,nI({placement:p,enableEvents:!!i.show,containerPadding:v||5,flip:a,offset:h,arrowElement:L,popperConfig:g}));i.show&&ae&&fe(!1);const Ce=(...bt)=>{fe(!0),i.onExited&&i.onExited(...bt)},Me=i.show||!ae;if(ZI(D,i.onHide,{disabled:!i.rootClose||i.rootCloseDisabled,clickTrigger:i.rootCloseEvent}),!Me)return null;const{onExit:Te,onExiting:De,onEnter:Ne,onEntering:je,onEntered:ye}=i;let Qe=i.children(Object.assign({},ve.attributes.popper,{style:ve.styles.popper,ref:V}),{popper:ve,placement:p,show:!!i.show,arrowProps:Object.assign({},ve.attributes.arrow,{style:ve.styles.arrow,ref:F})});return Qe=Ib(c,A,{in:!!i.show,appear:!0,mountOnEnter:!0,unmountOnExit:!0,children:Qe,onExit:Te,onExiting:De,onExited:Ce,onEnter:Ne,onEntering:je,onEntered:ye}),$?Wp.createPortal(Qe,$):null});U2.displayName="Overlay";const V2=he.forwardRef(({className:i,bsPrefix:n,as:a="div",...h},p)=>(n=ni(n,"popover-header"),se.jsx(a,{ref:p,className:Ln(i,n),...h})));V2.displayName="PopoverHeader";const _x=he.forwardRef(({className:i,bsPrefix:n,as:a="div",...h},p)=>(n=ni(n,"popover-body"),se.jsx(a,{ref:p,className:Ln(i,n),...h})));_x.displayName="PopoverBody";function G2(i,n){let a=i;return i==="left"?a=n?"end":"start":i==="right"&&(a=n?"start":"end"),a}function Z2(i="absolute"){return{position:i,top:"0",left:"0",opacity:"0",pointerEvents:"none"}}const $I=he.forwardRef(({bsPrefix:i,placement:n="right",className:a,style:h,children:p,body:v,arrowProps:g,hasDoneInitialMeasure:c,popper:A,show:D,...N},L)=>{const F=ni(i,"popover"),V=qT(),[$]=(n==null?void 0:n.split("-"))||[],J=G2($,V);let ae=h;return D&&!c&&(ae={...h,...Z2(A==null?void 0:A.strategy)}),se.jsxs("div",{ref:L,role:"tooltip",style:ae,"x-placement":$,className:Ln(a,F,$&&`bs-popover-${J}`),...N,children:[se.jsx("div",{className:"popover-arrow",...g}),v?se.jsx(_x,{children:p}):p]})}),YI=Object.assign($I,{Header:V2,Body:_x,POPPER_OFFSET:[0,8]}),$2=he.forwardRef(({bsPrefix:i,placement:n="right",className:a,style:h,children:p,arrowProps:v,hasDoneInitialMeasure:g,popper:c,show:A,...D},N)=>{i=ni(i,"tooltip");const L=qT(),[F]=(n==null?void 0:n.split("-"))||[],V=G2(F,L);let $=h;return A&&!g&&($={...h,...Z2(c==null?void 0:c.strategy)}),se.jsxs("div",{ref:N,style:$,role:"tooltip","x-placement":F,className:Ln(a,i,`bs-tooltip-${V}`),...D,children:[se.jsx("div",{className:"tooltip-arrow",...v}),se.jsx("div",{className:`${i}-inner`,children:p})]})});$2.displayName="Tooltip";const qI=Object.assign($2,{TOOLTIP_OFFSET:[0,6]});function HI(i){const n=he.useRef(null),a=ni(void 0,"popover"),h=ni(void 0,"tooltip"),p=he.useMemo(()=>({name:"offset",options:{offset:()=>{if(i)return i;if(n.current){if(kb(n.current,a))return YI.POPPER_OFFSET;if(kb(n.current,h))return qI.TOOLTIP_OFFSET}return[0,0]}}}),[i,a,h]);return[n,[p]]}function XI(i,n){const{ref:a}=i,{ref:h}=n;i.ref=a.__wrapped||(a.__wrapped=p=>a(Ab(p))),n.ref=h.__wrapped||(h.__wrapped=p=>h(Ab(p)))}const Y2=he.forwardRef(({children:i,transition:n=O0,popperConfig:a={},rootClose:h=!1,placement:p="top",show:v=!1,...g},c)=>{const A=he.useRef({}),[D,N]=he.useState(null),[L,F]=HI(g.offset),V=QT(c,L),$=n===!0?O0:n||void 0,J=y_(ae=>{N(ae),a==null||a.onFirstUpdate==null||a.onFirstUpdate(ae)});return y2(()=>{D&&g.target&&(A.current.scheduleUpdate==null||A.current.scheduleUpdate())},[D,g.target]),he.useEffect(()=>{v||N(null)},[v]),se.jsx(U2,{...g,ref:V,popperConfig:{...a,modifiers:F.concat(a.modifiers||[]),onFirstUpdate:J},transition:$,rootClose:h,placement:p,show:v,children:(ae,{arrowProps:fe,popper:ve,show:Ce})=>{var Me;XI(ae,fe);const Te=ve==null?void 0:ve.placement,De=Object.assign(A.current,{state:ve==null?void 0:ve.state,scheduleUpdate:ve==null?void 0:ve.update,placement:Te,outOfBoundaries:(ve==null||(Me=ve.state)==null||(Me=Me.modifiersData.hide)==null?void 0:Me.isReferenceHidden)||!1,strategy:a.strategy}),Ne=!!D;return typeof i=="function"?i({...ae,placement:Te,show:Ce,...!n&&Ce&&{className:"show"},popper:De,arrowProps:fe,hasDoneInitialMeasure:Ne}):he.cloneElement(i,{...ae,placement:Te,arrowProps:fe,popper:De,hasDoneInitialMeasure:Ne,className:Ln(i.props.className,!n&&Ce&&"show"),style:{...i.props.style,...ae.style}})}})});Y2.displayName="Overlay";const q2=he.forwardRef(({bsPrefix:i,variant:n,animation:a="border",size:h,as:p="div",className:v,...g},c)=>{i=ni(i,"spinner");const A=`${i}-${a}`;return se.jsx(p,{ref:c,...g,className:Ln(v,A,h&&`${A}-${h}`,n&&`text-${n}`)})});q2.displayName="Spinner";const WI=he.forwardRef(({bsPrefix:i,className:n,striped:a,bordered:h,borderless:p,hover:v,size:g,variant:c,responsive:A,...D},N)=>{const L=ni(i,"table"),F=Ln(n,L,c&&`${L}-${c}`,g&&`${L}-${g}`,a&&`${L}-${typeof a=="string"?`striped-${a}`:"striped"}`,h&&`${L}-bordered`,p&&`${L}-borderless`,v&&`${L}-hover`),V=se.jsx("table",{...D,className:F,ref:N});if(A){let $=`${L}-responsive`;return typeof A=="string"&&($=`${$}-${A}`),se.jsx("div",{className:$,children:V})}return V});function QI({tripQueryVariables:i,setTripQueryVariables:n,coordinates:a,onClose:h}){return se.jsx(eT,{longitude:a.lng,latitude:a.lat,anchor:"bottom",onClose:h,children:se.jsxs(ax,{vertical:!0,children:[se.jsx(om,{onClick:()=>{n({...i,from:{coordinates:{latitude:a.lat,longitude:a.lng}}}),h()},children:"Start here"}),se.jsx(om,{onClick:()=>{n({...i,to:{coordinates:{latitude:a.lat,longitude:a.lng}}}),h()},children:"End here"})]})})}function KI({coordinates:i,properties:n,onClose:a}){return se.jsxs(eT,{latitude:i.lat,longitude:i.lng,closeButton:!0,onClose:()=>a(),maxWidth:"350px",children:[se.jsx(WI,{bordered:!0,children:se.jsx("tbody",{children:Object.entries(n).map(([h,p])=>se.jsxs("tr",{children:[se.jsx("th",{scope:"row",children:h}),se.jsx("td",{children:String(p)})]},h))})}),se.jsx("div",{className:"geometry-popup-osm-link",children:se.jsx("a",{href:`https://www.openstreetmap.org/?mlat=${i.lat}&mlon=${i.lng}#map=18/${i.lat}/${i.lng}`,target:"_blank",rel:"noreferrer",children:" osm.org"})})]})}const H2=i=>{const n=i.getStyle();return!n||!n.layers?[]:n.layers.filter(a=>a.type!=="raster"&&!a.id.startsWith("jsx")).filter(a=>i.getLayoutProperty(a.id,"visibility")!=="none").map(a=>a.id)},JI=({mapRef:i,setInteractiveLayerIds:n})=>{const[a,h]=he.useState([]),[p,v]=he.useState({});he.useEffect(()=>{if(!i)return;const A=i.getMap(),D=()=>{const N=A.getStyle();if(!N||!N.layers)return;const L=N.layers.filter(V=>V.type==="raster").map(V=>{var ae;let $=V.id;const J=(ae=V.metadata)==null?void 0:ae.name;return J&&($=J),{id:V.id,name:$}});h(L);const F={};N.layers.filter(V=>V.type!=="raster"&&!V.id.startsWith("jsx")).reverse().forEach(V=>{var J;const $=((J=V.metadata)==null?void 0:J.group)||"Misc";F[$]||(F[$]=[]),F[$].push({id:V.id,name:V.id})}),v(F)};return A.isStyleLoaded()?D():A.on("styledata",D),()=>{A.off("styledata",D)}},[i]);const g=he.useCallback((A,D)=>{if(!i)return;const N=i.getMap();N.setLayoutProperty(A,"visibility",D?"visible":"none");const L=H2(N);n(L)},[i,n]),c=he.useCallback(A=>{if(!i)return;const D=i.getMap();a.forEach(N=>{D.setLayoutProperty(N.id,"visibility",N.id===A?"visible":"none")})},[i,a]);return se.jsxs("div",{style:{display:"flex",flexDirection:"column",padding:"10px",width:"250px",borderRadius:"4px",overflowY:"auto"},children:[se.jsx("h4",{style:{marginTop:0},children:"Background"}),se.jsx("select",{onChange:A=>c(A.target.value),children:a.map(A=>se.jsx("option",{value:A.id,children:A.name},A.id))}),se.jsx("h4",{style:{marginTop:"1rem"},children:"Debug Layers"}),Object.entries(p).map(([A,D])=>{const N=D.every(F=>(i==null?void 0:i.getMap().getLayoutProperty(F.id,"visibility"))!=="none"),L=F=>{D.forEach(V=>{g(V.id,F)})};return se.jsxs("div",{style:{marginBottom:"10px"},children:[se.jsx("h6",{style:{margin:"0 0 5px"},children:se.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer"},children:[se.jsx("input",{type:"checkbox",checked:N,onChange:F=>L(F.target.checked),style:{marginRight:"5px"}}),A]})}),D.map(F=>{const V=(i==null?void 0:i.getMap().getLayoutProperty(F.id,"visibility"))!=="none";return se.jsxs("label",{style:{display:"block",cursor:"pointer",marginBottom:"5px"},children:[se.jsx("input",{type:"checkbox",checked:V,onChange:$=>g(F.id,$.target.checked),style:{marginLeft:"20px",marginRight:"5px"}}),F.name]},F.id)})]},A)})]})},ek="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20512%20512'%3e%3cpath%20fill='var(--ci-primary-color,%20currentColor)'%20d='M432,32a63.973,63.973,0,0,0-34.344,117.963L355.894,296.13c-1.289-.078-2.585-.13-3.894-.13a63.659,63.659,0,0,0-38.193,12.678l-77.154-64.295A64,64,0,1,0,131.259,269.7L85.967,360.288C84,360.105,82.013,360,80,360a64.082,64.082,0,1,0,36.243,11.29l42.8-85.589a63.845,63.845,0,0,0,59.982-14.356l74.7,62.252a64,64,0,1,0,92.621-27.56L428.106,159.87c1.289.078,2.585.13,3.894.13a64,64,0,0,0,0-128ZM80,456a32,32,0,1,1,32-32A32.036,32.036,0,0,1,80,456Zm96-200a32,32,0,1,1,32-32A32.036,32.036,0,0,1,176,256ZM352,392a32,32,0,1,1,32-32A32.036,32.036,0,0,1,352,392Zm80-264a32,32,0,1,1,32-32A32.036,32.036,0,0,1,432,128Z'%20class='ci-primary'/%3e%3c/svg%3e";class tk extends he.Component{constructor(a){super(a);qp(this,"toggleSidebar",a=>{this.setState(h=>({isSidebarOpen:h.activeContent!==a||!h.isSidebarOpen,activeContent:h.activeContent===a?null:a}))});this.state={isSidebarOpen:!1,activeContent:null}}render(){const{isSidebarOpen:a,activeContent:h}=this.state,{position:p,setInteractiveLayerIds:v,mapRef:g}=this.props;return se.jsxs("div",{children:[se.jsx("button",{onClick:()=>this.toggleSidebar("debugLayer"),className:`sidebar-button right ${h==="debugLayer"?"active":""} ${a?"open":""}`,style:{top:"20px"},children:se.jsx("img",{src:ek,alt:"Debug layer",title:"Debug layer",style:{width:"25px",height:"25px"}})}),se.jsx("div",{className:"right-menu-container",style:{position:"absolute",top:0,right:0,width:a?"270px":"0",height:"100%",backgroundColor:"#f4f4f4",overflowX:"hidden",transition:"0.3s",paddingTop:"20px",boxShadow:a?"-2px 0 5px rgba(0, 0, 0, 0.2)":"none"},children:a&&h==="debugLayer"&&se.jsx(JI,{position:p,setInteractiveLayerIds:v,mapRef:g})})]})}}const nk="/otp/routers/default/inspector/vectortile/style.json";function ik({tripQueryVariables:i,setTripQueryVariables:n,tripQueryResult:a,selectedTripPatternIndex:h,loading:p}){var Te,De;const v=GC({tripQueryVariables:i,setTripQueryVariables:n}),[g,c]=he.useState(null),[A,D]=he.useState(null),[N,L]=he.useState([]),[F,V]=he.useState("auto"),$=he.useCallback(()=>V("pointer"),[]),J=he.useCallback(()=>V("auto"),[]),ae=Ne=>{if(Ne.features){const je=Ne.features[0];D({coordinates:Ne.lngLat,feature:je})}},fe=Ne=>{const je=Ne.target;if(je.getZoom()<2){const ye=je.getSource("stops");je.fitBounds(ye.bounds,{animate:!1})}},ve=Ne=>{Ne.target.addControl(new iT.AttributionControl,"bottom-left")};function Ce(Ne){fe(Ne);const je=H2(Ne.target);L(je),ve(Ne)}const Me=he.useRef(null);return se.jsx("div",{className:"map-container below-content",children:se.jsxs(kS,{attributionControl:!1,mapLib:Jw(()=>Promise.resolve().then(()=>rT),void 0),mapStyle:nk,onDblClick:v,onContextMenu:Ne=>{c(Ne.lngLat)},interactiveLayerIds:N,cursor:F,onMouseEnter:$,onMouseLeave:J,onClick:ae,hash:!0,touchPitch:!1,dragRotate:!1,onLoad:Ce,ref:Me,children:[se.jsx(LS,{position:"top-left"}),se.jsx(LC,{setCursor:V,tripQueryVariables:i,setTripQueryVariables:n,loading:p}),se.jsx(tk,{position:"top-right",setInteractiveLayerIds:L,mapRef:Me==null?void 0:Me.current}),(a==null?void 0:a.trip.tripPatterns.length)&&se.jsx(FC,{tripPattern:a.trip.tripPatterns[h]}),g&&se.jsx(QI,{tripQueryVariables:i,setTripQueryVariables:n,coordinates:g,onClose:()=>c(null)}),((Te=A==null?void 0:A.feature)==null?void 0:Te.properties)&&se.jsx(KI,{coordinates:A==null?void 0:A.coordinates,properties:(De=A==null?void 0:A.feature)==null?void 0:De.properties,onClose:()=>D(null)})]})})}function rk(){const[i,n]=he.useState(0),a=he.useRef(null);return he.useLayoutEffect(()=>{a.current&&n(a.current.getBoundingClientRect().width)},[]),he.useEffect(()=>{const h=()=>{a.current&&n(a.current.getBoundingClientRect().width)};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}},[]),{containerRef:a,containerWidth:i}}const ak=70,ok=20,Nb=40;function sk(i,n,a,h){const p=he.useMemo(()=>new Date(h).getTime()-new Date(a).getTime(),[a,h]),v=he.useMemo(()=>(new Date(i.expectedStartTime).getTime()-new Date(a).getTime())/p,[i.expectedStartTime,a,p]),g=he.useMemo(()=>new Date(i.expectedEndTime).getTime()-new Date(i.expectedStartTime).getTime(),[i.expectedStartTime,i.expectedEndTime]),c=ok+Nb,D=n-ak-Nb-c,N=c+v*D,L=D*(g/p);return{maxSpan:p,startPx:c,pxSpan:D,widthPx:L,leftPx:N}}const lk="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAAHu22/pAAAAB3RJTUUH1AsWERgjekHtpwAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAARnQU1BAACxjwv8YQUAAABwSURBVHjanVCBDcAgCLPE/19mYxsEqtNEEiMFCgWoajPD/V7PHIvCUxGJP4OhVJ52gAZwK2UVwKAicFbDtmbGQpQY1XwSI+kBZm0F9cziuZITzCyCeG7ZkzvMRP4SZ+O3W5arbsjSDu1Yal+RVse5AI1+butsyxyOAAAAAElFTkSuQmCC",ck="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QURGRTc0NjUwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QURGRTc0NjYwOEY0MTFFMzlDRjU5Nzk1NzEzMUE2MTMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpBREZFNzQ2MzA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBREZFNzQ2NDA4RjQxMUUzOUNGNTk3OTU3MTMxQTYxMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PqNIu00AAAElSURBVHjatFMxUsMwEESyC0rTpUyZkh/gdOmAF8T5gf0DeAFPAF5A8oKYjs7+gZ0XxOlSBMTuzCqj8ZgwwKCZHUt3q7u9O9k4587+dZ1H8SVwByS/DdAAjkGG/PabzC/Y+sz1T2VvlZnf8VfcaOgyPmtl7oAWmMXWboDxwX20Id8MBKDsGx2nCvIQUIr9+6E+JT+XdC8/O1WuDRsGUPoVcAuUKmMuTuo5wONxrGyQRpUGxEb2tUBbFXBynZMIjclhW6GuJZ1sEmw7bK+BkZSysffglOK8gTPB9sK/g7ZXGs/h6BJ/OViv5FiR5z1nKkIBLMih7B6Hd2qjmiq9tGc5KHmKrJ38bFglfy1OB//CBOPLJLuF42lgvAySaTJHjvnr7/wpwAC3fWYavCrEiwAAAABJRU5ErkJggg==",uk="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",hk="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",dk="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",fk="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NENBOTBGRTMzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NENBOTBGRTQzRTQxMTFFMjhDOTJBRDlBRjYxRDhBQjQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0Q0E5MEZFMTNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0Q0E5MEZFMjNFNDExMUUyOEM5MkFEOUFGNjFEOEFCNCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiA2Kl8AAADnSURBVHjalNK/CwFhHMdx5y4pP0qM8nuwisxKmU3KaJaRP4E/QDEY/Atmk8HkDxCL7LKQRXLe3/oq6Ry+9bq7ej73PN/nnjNs2/b8Wl7PH2XlUmm5Z9BCGQmEcMMWK0yxM7LJVImHBQKYY/+yorxYwwUVi0sDB3Thf1t5jRl6kpNwEROMXdqNoCrLxXUGt5LxuIRjuhG3kvGYtCH6OH74lHdEJSdBA/UfPvNZZjLR1E061UTHTa8uE9Z2HA9Ox+9yKCc9sa9tPDc3wAZD+F4CV3SQl5ylgTaWGDnMWEBQcsY/v+hDgAEA1dErlh2yhgAAAAAASUVORK5CYII=",pk="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAQCAYAAAAvf+5AAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTMxQjUxMkEzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTMxQjUxMkIzRTNEMTFFMjkxQkRFRTAzRUExOUZGRDQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFMzFCNTEyODNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFMzFCNTEyOTNFM0QxMUUyOTFCREVFMDNFQTE5RkZENCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PuptisMAAAEBSURBVHjabNE/S0JhFMdxTZFQJwkRGhKDojEc2vz3CsIlGmpWmosgMMFFBaPBpabcfBGFEOkgODgLIrU3aKvg98h54HS5Bz6ce5/7e54Hzg0eHqQDPnWLOzTRkYWdgH8VsIecW/ALHmGOT7TdYlh7HFVc4ARRTDD2Bl9x6Tk5izze3dVyVVktPOFTe2ILXcTgRvCDD9SQkIwEV6jjzZz0hGd84wYlufoaf/jV0BoDfX5EBvd2PGvtIb3BfVvKRvcSQdFsOvdOwQXPcKyjqOjagx7wL3ilvYEXDHXw+zaY1GBff5tUT3vGBmXQu+aj1Jf2lA3K9EdmJFIzTPUnbGsjwAAGpSpgxyPGdAAAAABJRU5ErkJggg==",mk="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",gk="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAQCAYAAAAmlE46AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NzQ3NjlDM0RGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NzQ3NjlDM0VGOTdBMTFFMkIwM0ZFQ0Y5QUFGNjUyQTkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo3NDc2OUMzQkY5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo3NDc2OUMzQ0Y5N0ExMUUyQjAzRkVDRjlBQUY2NTJBOSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PlF1VygAAAEpSURBVHjalNM9SwNBFIXh2WUNfqTTUggoYqFVijQiKDaCYJFGtLCwEn+QWKWwEStbC0WIGP0BWoi9QkSIED+IS+J75C4MAy7ZgSfc2T2XzEwm0UylsuWca2DcDTc+sRfReEsxiQck9nIVE1Z/4MrqFAt4U7CKXZzaywiPmLP5MzYxsLlWeBzzUcJLsJzon9pZthTb5NUNP/6yauzjvUCjsv3YNvxVoFHZNLE9XuDH28+0F1R9Z7UOaEQ92fFXc75hFLXwoZbac8VHT41tfOMMnZxwxzLKttXYxBPqaOU0tiyjbFNXTuu/sdsy7127cKReZkmNeriONXTtdw1vy8DOo4xLnGeN2TjENU6Cxm0s4yB7kNi/YB+L2MAKdrwla4mzmMIY7nH0K8AAYkc9+sRCXd0AAAAASUVORK5CYII=",yk="https://www.opentripplanner.org/debug-client-assets/2025/02/2025-02-21T08:26/assets/monorail-CEIE-7ZV.png",_k="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUZENDM4N0RGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUZENDM4N0VGOTcyMTFFMkI1M0Q5OUQwRDQyQUY2MzYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkQ0Mzg3QkY5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkQ0Mzg3Q0Y5NzIxMUUyQjUzRDk5RDBENDJBRjYzNiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsxmCRcAAACkSURBVHjaYmBmYCgA4v9E4gJGILGfAQIOMuAH9mASqOE+EDcQUAxS1wBSywRkKwDxBwbCAKRGgQnKuUCEBrAaJgYSAQuUNmAmrNYARIBC6T8pNpDsJCYiQwgeUixQ34OCdiFUMB7KB4EHaOIPQDZsBGIBIkwXAKsFeloAiM8TkY5AagSQoz4BhLEkCRRxFqggKIzzoewHaHpg4hf+AjHJ8QAQYAAazC31vEwRQAAAAABJRU5ErkJggg==",vk="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAQCAYAAADJViUEAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDE5QzczNkYzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDE5QzczNzAzRTNFMTFFMjk5RDJDQTI4Q0FGRjg0MjAiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMTlDNzM2RDNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMTlDNzM2RTNFM0UxMUUyOTlEMkNBMjhDQUZGODQyMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PsXLmU4AAAEXSURBVHjaYvz//z8DuYCJgQLAoqKgCGPLA/FWIAYJ/EBWA8TMUAwSjwLi7TAJGKgAYlYgNgPif1BXgfzEDsVfgLgUiLvRNYsAcSQQFwPxVTwubQHiy0DsDsQ7YZqjoc7aDcRcUBegA5ArHgDxKSDOgWkuAeI2qAaQrX8JhBMP1KKlzEICAjuAjNNQ00D+lQViDhyYEaoOZEkmKFA4gfggEG+BGoIPvALieUC8AsRhVJZXeA/15xUg1sXhX2RwHYh5gViGBRotbEBsRGTa0EROAEuBOAKIRYH4LhCfw2H7H2h4mAPxb5A3QZrzoM51AOLNQFyIx1Z/IN4AxF9hAcYA9S8InCHg5BtA/BqIbwLxR8YBy1UAAQYACBg5UlgYM2QAAAAASUVORK5CYII=",bk="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAAQCAYAAADAvYV+AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RkQyOERBMzVGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RkQyOERBMzZGOTczMTFFMkFDQjZCNkE3RjAwN0ZGREYiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpGRDI4REEzM0Y5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpGRDI4REEzNEY5NzMxMUUyQUNCNkI2QTdGMDA3RkZERiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnfLFegAAAD0SURBVHjaYmBABQJAvB2I9YF4GxCLI0syoSlmA2JlIBYEYiUg5kCWZIRq8AHiaiDmBOJfSPKsQPwbiPuAeC1IIAOIvwPxfzz4LxAXswAJA6h1VUB8DohZkEz+A8TqQDwRiDVBAgugOtkYcINPQLyUiYF48B9k5Q+oJ4uB+CzUU8jO0ABiXpA6FqgTQKCNgMm/SXEGSqTcB+KXaPJvgPguLE5AitmhHEMg9kdTHA7EWlA2JzOQEAViV2jQ2UE1IcegNhDbAvFCmKAV1EpssfcZahgTLLYeQZ1zDS1tMEOD7jEQ/2OAprLdUIwNrADi06BkCxBgAAYGNHBMbk0cAAAAAElFTkSuQmCC",xk="https://www.opentripplanner.org/debug-client-assets/2025/02/2025-02-21T08:26/assets/trolleybus-BefhFtdd.png",wk="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNS4xIFdpbmRvd3MiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MDMzQjkxOEQwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MDMzQjkxOEUwOEY3MTFFMzkyMzE4RDY4NzY0RTRDNEUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDowMzNCOTE4QjA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDowMzNCOTE4QzA4RjcxMUUzOTIzMThENjg3NjRFNEM0RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgA3WlcAAAD7SURBVHjapFLRDYIwEAXlw8/qApI4AG4gTuAIsIIToJMIE+gIuEF//TCWCagT6NU8yIltgHjJy7XQ93r3er7niNUyjCnF2Ob3SinbucBzhyFnWJcEq4BvuTmllBBCwIQkaMKeKpH8/LRDPlDagVgQrsCNYIRnCyHm9VO3IpNOARnIJW5MAIUqYux7PUg7+xMEtdUDKl1QOjPX+6IkL7a8BTGCbGL95QHeOB8hcLGZWIwQOP4IUBUlnB7SfztUARnYDIy0uewYcwEfpHnGB/unBxpY8xYUGxzhmH3F2hM4++H4GN8NRrYRiUCqQIrw/cpEDEcagZf3R7wFGAACCErn0v3YEQAAAABJRU5ErkJggg==";function Tk(i){return i===Li.Rail||i===Li.Coach||i===Li.Metro||i===Li.Bus||i===Li.Tram||i===Li.Water||i===Li.Air||i===Li.Cableway||i===Li.Funicular||i===Li.Trolleybus||i===Li.Monorail||i===Li.Taxi}function Ek(i){const n=Sk(i);function a(c){return c<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}const h=a(n[0]/255),p=a(n[1]/255),v=a(n[2]/255);return .2126*h+.7152*p+.0722*v>.179?"#000":"#fff"}function Sk(i){return Ak(i)}function Ak(i){return i.length===4?Ck(i):[parseInt(i.slice(1,3),16),parseInt(i.slice(3,5),16),parseInt(i.slice(5,7),16)]}function Ck(i){const n=i.slice(1,2),a=i.slice(2,3),h=i.slice(3,4);return[parseInt(n+n,16),parseInt(a+a,16),parseInt(h+h,16)]}function Mk(i,n,a,h,p){var L;const v=he.useMemo(()=>(new Date(i.expectedStartTime).getTime()-new Date(n).getTime())/a,[i.expectedStartTime,n,a]),g=he.useMemo(()=>p*(new Date(i.expectedEndTime).getTime()-new Date(i.expectedStartTime).getTime())/a-1,[p,i,a]),c=h+v*p+1,A=g>40&&Tk(i.mode)&&((L=i.line)==null?void 0:L.publicCode)&&i.line.publicCode.length<=6,D=GT(i),N=he.useMemo(()=>Ek(D),[D]);return{widthPx:g,leftPx:c,legTextColor:N,modeColor:D,showPublicCode:A}}const Dk=Object.assign({"../../static/img/mode/air.png":lk,"../../static/img/mode/bicycle.png":ck,"../../static/img/mode/bus.png":uk,"../../static/img/mode/cableway.png":hk,"../../static/img/mode/car.png":dk,"../../static/img/mode/coach.png":fk,"../../static/img/mode/foot.png":pk,"../../static/img/mode/funicular.png":mk,"../../static/img/mode/metro.png":gk,"../../static/img/mode/monorail.png":yk,"../../static/img/mode/rail.png":_k,"../../static/img/mode/taxi.png":vk,"../../static/img/mode/tram.png":bk,"../../static/img/mode/trolleybus.png":xk,"../../static/img/mode/water.png":wk});function Ik(i){return Dk[`../../static/img/mode/${i.mode.toLowerCase()}.png`]}function kk({leg:i,earliestStartTime:n,maxSpan:a,startPx:h,pxSpan:p}){var L;const{widthPx:v,leftPx:g,legTextColor:c,modeColor:A,showPublicCode:D}=Mk(i,n,a,h,p),N=Ik(i);return se.jsxs("div",{className:"itinerary-header-leg-wrapper",style:{width:`${v}px`,left:g,color:c,background:A},children:[se.jsx("div",{className:"itinerary-header-leg-icon",style:{background:c,maskImage:`url(${N})`,WebkitMaskImage:`url(${N})`}}),D&&se.jsx("span",{className:"itinerary-header-leg-public-code",children:(L=i.line)==null?void 0:L.publicCode})]})}function e_(i,n,a){return new Date(i).toLocaleTimeString("en-US",{timeStyle:a,hourCycle:"h24",timeZone:n})}const x_=he.createContext("UTC");function Rk({tripPattern:i,itineraryIndex:n,containerWidth:a,earliestStartTime:h,latestEndTime:p}){const{maxSpan:v,pxSpan:g,startPx:c,widthPx:A,leftPx:D}=sk(i,a,h,p),N=he.useContext(x_),L=he.useMemo(()=>e_(i.expectedStartTime,N,"short"),[i.expectedStartTime,N]),F=he.useMemo(()=>e_(i.expectedEndTime,N,"short"),[i.expectedEndTime,N]);return se.jsxs("div",{className:"itinerary-header-wrapper",children:[se.jsxs("div",{className:"itinerary-header-itinerary-number",children:[n+1,"."]}),se.jsx("div",{className:"itinerary-header-itinerary-line",style:{width:`${A+5}px`,left:`${D-2}px`}}),se.jsx("div",{title:i.expectedStartTime,className:"itinerary-header-itinerary-time",style:{left:`${D-Nb}px`},children:L}),i.legs.map((V,$)=>se.jsx(kk,{leg:V,earliestStartTime:h,startPx:c,maxSpan:v,pxSpan:g},V.id||`leg_${$}`)),se.jsx("div",{title:i.expectedEndTime,className:"itinerary-header-itinerary-time",style:{left:`${D+A+2}px`},children:F})]})}function Nk(i){const n=he.useMemo(()=>(i==null?void 0:i.trip.tripPatterns.reduce((h,p)=>h===null?p==null?void 0:p.expectedStartTime:new Date(p==null?void 0:p.expectedStartTime)<new Date(h)?p.expectedStartTime:h,null))||null,[i==null?void 0:i.trip]),a=he.useMemo(()=>(i==null?void 0:i.trip.tripPatterns.reduce((h,p)=>h===null?p==null?void 0:p.expectedEndTime:new Date(p==null?void 0:p.expectedEndTime)>new Date(h)?p.expectedEndTime:h,null))||null,[i==null?void 0:i.trip]);return[n,a]}function cw({aimedTime:i,expectedTime:n,hasRealtime:a}){const h=he.useContext(x_);return i!==n?se.jsxs(se.Fragment,{children:[se.jsx("span",{title:n,style:{color:"red"},children:e_(n,h,"short")}),se.jsx("span",{title:i,style:{textDecoration:"line-through"},children:e_(i,h,"short")})]}):se.jsxs("span",{title:n,children:[e_(n,h,"short"),a&&se.jsx("span",{children:" (on time)"})]})}function Pk(i){const n=i/1e3;return n>100?`${n.toFixed(0)} km`:n>1?`${n.toFixed(1)} km`:`${i.toFixed(0)} m`}function zk(i){const n=Math.floor(i/3600),a=Math.floor(i/60)%60,h=i%60;let p="";return n>0&&(p=`${p}${n}h `),a>0&&(p=`${p}${a}min `),h>1&&(p=`${p}${h}s`),p}const Ok="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='1200pt'%20height='1200pt'%20version='1.1'%20viewBox='0%200%201200%201200'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%3e%3cpath%20d='m660%20156c0%2069.586-56.414%20126-126%20126s-126-56.414-126-126%2056.414-126%20126-126%20126%2056.414%20126%20126'/%3e%3cpath%20d='m667.2%20849.6h-168c-43.199%200-80.398-31.199-86.398-74.398l-50.398-322.8c-3.6016-20.398-22.801-34.801-44.398-32.398-20.398%203.6016-34.801%2022.801-32.398%2044.398l50.395%20322.8c12%2080.398%2081.602%20139.2%20163.2%20139.2h168c21.602%200%2038.398-16.801%2038.398-38.398%200.003906-21.602-16.797-38.398-38.398-38.398z'/%3e%3cpath%20d='m913.2%201101.6-66-367.2c-4.8008-27.602-28.801-46.801-56.398-46.801h-116.4l-19.203-267.6c-3.6016-58.801-52.801-104.4-111.6-104.4h-18c-33.602%200-64.801%2014.398-87.602%2039.602-21.602%2025.199-31.199%2058.801-26.398%2092.398l48%20306c4.8008%2027.602%2028.801%2049.199%2056.398%2049.199h226.8l57.602%20320.4c4.8008%2027.602%2028.801%2046.801%2056.398%2046.801%203.6016%200%207.1992%200%2010.801-1.1992%2031.203-6%2051.602-34.801%2045.602-67.199z'/%3e%3c/g%3e%3c/svg%3e";function Lk({leg:i}){var n;return(n=i.interchangeFrom)!=null&&n.staySeated?se.jsx("img",{alt:"Stay-seated transfer",title:"Stay-seated transfer",src:Ok,width:"20",height:"20",className:"d-inline-block align-middle"}):null}const Bk=Vg(`
  query line($id: ID!) {
    line(id: $id) {
      name
      publicCode
    }
  }
`),jk=gl(Bk),Fk="/graphiql?flavor=transmodel";function Uk({legId:i,legName:n}){const a={id:i},h=encodeURIComponent(jk),p=encodeURIComponent(JSON.stringify(a));return se.jsx("a",{href:Fk+"&query="+h+"&variables="+p,target:"_blank",rel:"noreferrer",children:n})}const Vk=Vg(`
  query quay($id: String!) {
    quay(id: $id) {
      stopPlace {
        id
        name
      }
    }
  }
`),Gk=gl(Vk),Zk="/graphiql?flavor=transmodel";function uw({legId:i,legName:n}){const a={id:i},h=encodeURIComponent(Gk),p=encodeURIComponent(JSON.stringify(a));return se.jsx("a",{href:Zk+"&query="+h+"&variables="+p,target:"_blank",rel:"noreferrer",children:n})}const $k=Vg(`
  query authority($id: String!) {
    authority(id: $id) {
      name
      id
    }
  }
`),Yk=gl($k),qk="/graphiql?flavor=transmodel";function Hk({legId:i,legName:n}){const a={id:i},h=encodeURIComponent(Yk),p=encodeURIComponent(JSON.stringify(a));return se.jsx("a",{href:qk+"&query="+h+"&variables="+p,target:"_blank",rel:"noreferrer",children:n})}function Xk(i){var n,a,h,p;return(n=i.line)!=null&&n.publicCode?i.line.publicCode+" "+((h=(a=i.toEstimatedCall)==null?void 0:a.destinationDisplay)==null?void 0:h.frontText):((p=i.line)==null?void 0:p.name)||"unknown"}function Wk({leg:i,isLast:n}){var a,h,p,v,g;return se.jsxs("div",{className:"itinerary-leg-details",children:[se.jsxs("div",{className:"times",children:[Pk(i.distance),", ",zk(i.duration),","," ",se.jsxs("span",{title:"Generalized cost: "+i.generalizedCost,children:["",i.generalizedCost]})]}),se.jsx(Lk,{leg:i}),se.jsx(cw,{aimedTime:i.aimedStartTime,expectedTime:i.expectedStartTime,hasRealtime:i.realtime})," -"," ",se.jsx(cw,{aimedTime:i.aimedEndTime,expectedTime:i.expectedEndTime,hasRealtime:i.realtime}),se.jsxs("div",{className:"mode",children:[se.jsx("b",{children:i.mode})," ",i.line&&se.jsxs(se.Fragment,{children:[se.jsx(Uk,{legId:(a=i.line)==null?void 0:a.id,legName:Xk(i)}),", ",se.jsx(Hk,{legId:(h=i.authority)==null?void 0:h.id,legName:(p=i.authority)==null?void 0:p.name})]})," ",i.mode!==Li.Foot&&se.jsxs(se.Fragment,{children:[se.jsx("br",{}),se.jsx(uw,{legId:(v=i.fromPlace.quay)==null?void 0:v.id,legName:i.fromPlace.name})," "," "]})," ",!n&&se.jsx(uw,{legId:(g=i.toPlace.quay)==null?void 0:g.id,legName:i.toPlace.name})]})]})}function Qk({tripPattern:i}){return se.jsxs("div",{children:[i.systemNotices.length>0&&se.jsxs("p",{children:["System tags: ",i.systemNotices.map(n=>n.tag).join(", ")]}),i.legs.map((n,a)=>se.jsx(Wk,{leg:n,isLast:a===i.legs.length-1},n.id?n.id:`noid_${a}`)),se.jsxs("div",{className:"generalized-cost",children:["Generalized cost: ",i.generalizedCost]})]})}function Kk({previousPageCursor:i,nextPageCursor:n,onPagination:a,loading:h}){return se.jsxs("div",{style:{display:"flex",justifyContent:"space-evenly"},children:[se.jsx(om,{variant:"outline-primary",size:"sm",disabled:!i||h,onClick:()=>{i&&a(i)},children:"Previous page"})," ",se.jsx(om,{variant:"outline-primary",size:"sm",disabled:!n||h,onClick:()=>{n&&a(n)},children:"Next page"})]})}function Jk({tripQueryResult:i,selectedTripPatternIndex:n,setSelectedTripPatternIndex:a,pageResults:h,loading:p}){const[v,g]=Nk(i),{containerRef:c,containerWidth:A}=rk(),D=he.useContext(x_);return se.jsxs("section",{className:"left-pane-container below-content",ref:c,children:[se.jsxs(se.Fragment,{children:[se.jsx("div",{className:"panel-header",children:"Itinerary results"}),se.jsx("div",{className:"pagination-controls",children:se.jsx(Kk,{onPagination:h,previousPageCursor:i==null?void 0:i.trip.previousPageCursor,nextPageCursor:i==null?void 0:i.trip.nextPageCursor,loading:p})}),se.jsx(x0,{activeKey:`${n}`,onSelect:N=>a(parseInt(N)),children:i&&i.trip.tripPatterns.map((N,L)=>se.jsxs(x0.Item,{eventKey:`${L}`,bsPrefix:N.systemNotices.length===0?"":"accordion-item-filtered",children:[se.jsx(x0.Header,{children:se.jsx(Rk,{containerWidth:A,tripPattern:N,itineraryIndex:L,earliestStartTime:v,latestEndTime:g})}),se.jsx(x0.Body,{children:se.jsx(Qk,{tripPattern:N})})]},`${L}`))})]}),se.jsxs("div",{className:"time-zone-info",children:["All times in ",se.jsx("code",{children:D})]})]})}const Pb=Vg(`
query trip(
  $accessEgressPenalty: [PenaltyForStreetMode!]
  $alightSlackDefault: Int
  $alightSlackList: [TransportModeSlack]
  $arriveBy: Boolean
  $banned: InputBanned
  $bicycleOptimisationMethod: BicycleOptimisationMethod
  $bikeSpeed: Float
  $boardSlackDefault: Int
  $boardSlackList: [TransportModeSlack]
  $bookingTime: DateTime
  $dateTime: DateTime
  $filters: [TripFilterInput!]
  $from: Location!
  $ignoreRealtimeUpdates: Boolean
  $includePlannedCancellations: Boolean
  $includeRealtimeCancellations: Boolean
  $itineraryFilters: ItineraryFilters
  $locale: Locale
  $maxAccessEgressDurationForMode: [StreetModeDurationInput!]
  $maxDirectDurationForMode: [StreetModeDurationInput!]
  $maximumAdditionalTransfers: Int
  $maximumTransfers: Int
  $modes: Modes
  $numTripPatterns: Int
  $pageCursor: String
  $relaxTransitGroupPriority: RelaxCostInput
  $searchWindow: Int
  $timetableView: Boolean
  $to: Location!
  $transferPenalty: Int
  $transferSlack: Int
  $triangleFactors: TriangleFactors
  $useBikeRentalAvailabilityInformation: Boolean
  $via: [TripViaLocationInput!]
  $waitReluctance: Float
  $walkReluctance: Float
  $walkSpeed: Float
  $wheelchairAccessible: Boolean
  $whiteListed: InputWhiteListed
) {
  trip(
    accessEgressPenalty: $accessEgressPenalty
    alightSlackDefault: $alightSlackDefault
    alightSlackList: $alightSlackList
    arriveBy: $arriveBy
    banned: $banned
    bicycleOptimisationMethod: $bicycleOptimisationMethod
    bikeSpeed: $bikeSpeed
    boardSlackDefault: $boardSlackDefault
    boardSlackList: $boardSlackList
    bookingTime: $bookingTime
    dateTime: $dateTime
    filters: $filters
    from: $from
    ignoreRealtimeUpdates: $ignoreRealtimeUpdates
    includePlannedCancellations: $includePlannedCancellations
    includeRealtimeCancellations: $includeRealtimeCancellations
    itineraryFilters: $itineraryFilters
    locale: $locale
    maxAccessEgressDurationForMode: $maxAccessEgressDurationForMode
    maxDirectDurationForMode: $maxDirectDurationForMode
    maximumAdditionalTransfers: $maximumAdditionalTransfers
    maximumTransfers: $maximumTransfers
    modes: $modes
    numTripPatterns: $numTripPatterns
    pageCursor: $pageCursor
    relaxTransitGroupPriority: $relaxTransitGroupPriority
    searchWindow: $searchWindow
    timetableView: $timetableView
    to: $to
    transferPenalty: $transferPenalty
    transferSlack: $transferSlack
    triangleFactors: $triangleFactors
    useBikeRentalAvailabilityInformation: $useBikeRentalAvailabilityInformation
    via: $via
    waitReluctance: $waitReluctance
    walkReluctance: $walkReluctance
    walkSpeed: $walkSpeed
    wheelchairAccessible: $wheelchairAccessible
    whiteListed: $whiteListed
  ) 
    {
    previousPageCursor
    nextPageCursor
    tripPatterns {
        aimedStartTime
        aimedEndTime
        expectedEndTime
        expectedStartTime
        duration
        distance
        legs {
            id
            mode
            aimedStartTime
            aimedEndTime
            expectedEndTime
            expectedStartTime
            realtime
            distance
            duration
            fromPlace {
                name
                quay {
                    id
                }
            }
            toPlace {
                name
                quay {
                    id
                }
            }
            toEstimatedCall {
                destinationDisplay {
                    frontText
                }
            }
            line {
                publicCode
                name
                id
                presentation {
                    colour
                }
            }
            authority {
                name
                id
            }
            pointsOnLink {
                points
            }
            interchangeTo {
                staySeated
            }
            interchangeFrom {
                staySeated
            }
        }
        systemNotices {
            tag
        }
    }
  }
}`),eR=gl(Pb),tR=i=>{const[n,a]=he.useState(null),[h,p]=he.useState(!1),v=he.useCallback(async g=>{if(h)console.warn("Wait for previous search to finish");else if(i){p(!0);try{a(g?await z0(a_(),Pb,{...i,pageCursor:g}):await z0(a_(),Pb,i))}catch(c){console.error("Error at useTripQuery",c)}p(!1)}else console.warn("Can't search without variables")},[a,i,h]);return he.useEffect(()=>{hw(i==null?void 0:i.from)&&hw(i==null?void 0:i.to)&&v()},[i==null?void 0:i.from,i==null?void 0:i.to]),[n,h,v]};function hw(i){return i&&(i.coordinates||i.place)}const nR=Vg(`
  query serverInfo {
    serverInfo {
      version
      otpSerializationVersionId
      buildConfigVersion
      routerConfigVersion
      gitCommit
      gitBranch
      internalTransitModelTimeZone
    }
  }
`),iR=()=>{const[i,n]=he.useState(null);return he.useEffect(()=>{(async()=>{n(await z0(a_(),nR))})()},[]),i==null?void 0:i.serverInfo},rR={from:{},to:{},dateTime:new Date().toISOString()},aR=()=>{const n=new URLSearchParams(window.location.search).get("variables");return n?JSON.parse(decodeURIComponent(n)):rR},oR=i=>{const n=new URLSearchParams(window.location.search);n.set("variables",encodeURIComponent(JSON.stringify(i))),history.pushState({},"","?"+n.toString()+window.location.hash)},sR=()=>{const[i,n]=he.useState(aR());return he.useEffect(()=>{oR(i)},[i]),{tripQueryVariables:i,setTripQueryVariables:n}};function lR({target:i,serverInfo:n}){return se.jsx(Y2,{target:i.current,show:!!n,placement:"right",children:se.jsx("div",{style:{position:"absolute",backgroundColor:"rgba(255, 100, 100, 0.85)",padding:"2px 10px",color:"white",borderRadius:3},children:se.jsx("pre",{children:JSON.stringify(n,null,2)})})})}const cR="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='utf-8'?%3e%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3csvg%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20x='0px'%20y='0px'%20width='256px'%20height='256px'%20viewBox='0%200%20125.333%20125.334'%20xml:space='preserve'%3e%3cpath%20fill='%232179BF'%20d='M62.668,0C33.83,0,9.559,19.483,2.258,46l72.681-0.003c4.729-0.011,8.555-3.837,8.561-8.568%20c-0.006-4.729-3.831-8.555-8.561-8.559c-4.731,0.004-8.557,3.83-8.564,8.559v4.592h-13.7v-4.592%20c0-12.294,9.962-22.261,22.265-22.263c12.298,0.002,22.262,9.969,22.266,22.263c-0.003,12.3-9.968,22.264-22.266,22.271H0.074%20C0.028,60.684,0,61.671,0,62.666c0,34.611,28.057,62.668,62.668,62.668c34.609,0,62.665-28.057,62.665-62.668%20C125.333,28.057,97.277,0,62.668,0%20M92.222,85.667v-3.473v-4.86l-47.058,0.003c-4.729,0.011-8.556,3.837-8.561,8.568%20c0.005,4.728,3.831,8.555,8.561,8.559c4.731-0.004,8.558-3.831,8.565-8.559v-4.592h13.699v4.592%20c0,12.294-9.961,22.261-22.265,22.263c-12.298-0.002-22.26-9.969-22.264-22.263c0.002-12.3,9.966-22.264,22.264-22.271h47.058V56.12%20l21.712,14.775L92.222,85.667z'/%3e%3c/svg%3e";function uR({serverInfo:i}){const[n,a]=he.useState(!1),h=he.useRef(null);return se.jsxs("div",{className:"logo-container box",style:{display:"flex"},children:[se.jsx(VI.Brand,{onClick:()=>a(p=>!p),children:se.jsxs("div",{ref:h,children:[se.jsx("img",{alt:"",src:cR,width:"50",height:"50",className:"logo-image"}),"OTP Debug",n&&se.jsx(lR,{serverInfo:i,target:h})]})}),se.jsxs("div",{className:"details",children:[se.jsxs("div",{children:["Version: ",i==null?void 0:i.version]}),se.jsxs("div",{children:["Time zone: ",i==null?void 0:i.internalTransitModelTimeZone]})]})]})}const dw=7,fw="-{0,1}\\d+(\\.\\d+){0,1}",hR="("+fw+")(\\s+)("+fw+")";function dR(i){const n=i.match(hR);return n?{coordinates:{latitude:+n[1],longitude:+n[4]}}:{place:i}}function fR(i){var n,a;return i.coordinates?`${(n=i.coordinates)==null?void 0:n.latitude.toPrecision(dw)} ${(a=i.coordinates)==null?void 0:a.longitude.toPrecision(dw)}`:i.place?i.place:null}function pw({id:i,label:n,tripQueryVariables:a,setTripQueryVariables:h,locationFieldKey:p}){const[v,g]=he.useState("");he.useEffect(()=>{const A=a[p];g(fR(A)||"")},[a,p]);const c=he.useCallback(A=>{const D=dR(A)||{};h({...a,[p]:D})},[a,h,p]);return se.jsxs(ji.Group,{children:[se.jsx(ji.Label,{column:"sm",htmlFor:i,children:n}),se.jsx(ji.Control,{type:"text",id:i,size:"sm",placeholder:"[Click in map]",className:"input-medium",onChange:A=>{g(A.target.value)},onBlur:A=>{c(A.target.value)},value:v})]})}const pR="data:image/svg+xml,%3c?xml%20version='1.0'%20encoding='UTF-8'?%3e%3csvg%20width='100pt'%20height='100pt'%20version='1.1'%20viewBox='0%200%20100%20100'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m92.223%2050.707c-2.5234%200-4.5469%202.0195-4.5469%204.5469v13.938h-51.516l10.203-10.203c1.8164-1.8164%201.8164-4.6445%200-6.4648-1.8164-1.8164-4.6445-1.8164-6.4648%200l-18.082%2018.082c-1.7188%201.7188-1.8164%204.6445%200%206.3633l18.082%2018.383c0.91016%200.91016%202.0195%201.3125%203.2305%201.3125%201.1094%200%202.3242-0.40234%203.2305-1.3125%201.8164-1.7188%201.8164-4.6445%200.10156-6.4648l-10.703-10.605h56.465c2.5234%200%204.5469-2.0195%204.5469-4.5469v-18.48c0-2.5273-2.0234-4.5469-4.5469-4.5469z'/%3e%3cpath%20d='m63.738%2029.695-10.305%2010.406c-1.7188%201.8164-1.7188%204.6445%200.10156%206.4648%200.91016%200.91016%202.0195%201.3125%203.2305%201.3125s2.3242-0.40234%203.2305-1.3125l18.082-18.383c1.7188-1.8164%201.7188-4.6445%200-6.3633l-18.18-18.184c-1.8164-1.8164-4.6445-1.8164-6.4648%200-1.8164%201.8164-1.8164%204.6445%200%206.4648l10.504%2010.504h-56.363c-2.5234%200-4.5469%202.0195-4.5469%204.5469v18.383c0%202.5234%202.0195%204.5469%204.5469%204.5469%202.5234%200%204.5469-2.0195%204.5469-4.5469v-13.84z'/%3e%3c/svg%3e";function mR({tripQueryVariables:i,setTripQueryVariables:n}){const a=()=>{n({...i,from:i.to,to:i.from})};return se.jsx("button",{className:"swap-from-to",onClick:a,title:"Swap from/to",children:se.jsx("img",{alt:"Swap from/to",src:pR})})}function gR({tripQueryVariables:i,setTripQueryVariables:n}){const a=h=>{n({...i,arriveBy:h})};return se.jsxs(ji.Group,{children:[se.jsx(ji.Label,{column:"sm",htmlFor:"departureArrivalSelect",children:"Departure/Arrival"}),se.jsxs(ji.Select,{size:"sm",onChange:h=>h.target.value==="arrival"?a(!0):a(!1),value:i.arriveBy?"arrival":"departure",style:{verticalAlign:"bottom"},children:[se.jsx("option",{value:"arrival",children:"Arrive before"}),se.jsx("option",{value:"departure",children:"Depart after"})]})]})}class z extends Array{constructor(n,a){if(super(n),this.sign=a,Object.setPrototypeOf(this,z.prototype),n>z.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded")}static BigInt(n){var a=Math.floor,h=Number.isFinite;if(typeof n=="number"){if(n===0)return z.__zero();if(z.__isOneDigitInt(n))return 0>n?z.__oneDigit(-n,!0):z.__oneDigit(n,!1);if(!h(n)||a(n)!==n)throw new RangeError("The number "+n+" cannot be converted to BigInt because it is not an integer");return z.__fromDouble(n)}if(typeof n=="string"){const p=z.__fromString(n);if(p===null)throw new SyntaxError("Cannot convert "+n+" to a BigInt");return p}if(typeof n=="boolean")return n===!0?z.__oneDigit(1,!1):z.__zero();if(typeof n=="object"){if(n.constructor===z)return n;const p=z.__toPrimitive(n);return z.BigInt(p)}throw new TypeError("Cannot convert "+n+" to a BigInt")}toDebugString(){const n=["BigInt["];for(const a of this)n.push((a&&(a>>>0).toString(16))+", ");return n.push("]"),n.join("")}toString(n=10){if(2>n||36<n)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":n&n-1?z.__toStringGeneric(this,n,!1):z.__toStringBasePowerOfTwo(this,n)}valueOf(){throw new Error("Convert JSBI instances to native numbers using `toNumber`.")}static toNumber(n){const a=n.length;if(a===0)return 0;if(a===1){const ae=n.__unsignedDigit(0);return n.sign?-ae:ae}const h=n.__digit(a-1),p=z.__clz30(h),v=30*a-p;if(1024<v)return n.sign?-1/0:1/0;let g=v-1,c=h,A=a-1;const D=p+3;let N=D===32?0:c<<D;N>>>=12;const L=D-12;let F=12<=D?0:c<<20+D,V=20+D;for(0<L&&0<A&&(A--,c=n.__digit(A),N|=c>>>30-L,F=c<<L+2,V=L+2);0<V&&0<A;)A--,c=n.__digit(A),F|=30<=V?c<<V-30:c>>>30-V,V-=30;const $=z.__decideRounding(n,V,A,c);if(($===1||$===0&&(1&F)==1)&&(F=F+1>>>0,F===0&&(N++,N>>>20!=0&&(N=0,g++,1023<g))))return n.sign?-1/0:1/0;const J=n.sign?-2147483648:0;return g=g+1023<<20,z.__kBitConversionInts[1]=J|g|N,z.__kBitConversionInts[0]=F,z.__kBitConversionDouble[0]}static unaryMinus(n){if(n.length===0)return n;const a=n.__copy();return a.sign=!n.sign,a}static bitwiseNot(n){return n.sign?z.__absoluteSubOne(n).__trim():z.__absoluteAddOne(n,!0)}static exponentiate(n,a){if(a.sign)throw new RangeError("Exponent must be positive");if(a.length===0)return z.__oneDigit(1,!1);if(n.length===0)return n;if(n.length===1&&n.__digit(0)===1)return n.sign&&!(1&a.__digit(0))?z.unaryMinus(n):n;if(1<a.length)throw new RangeError("BigInt too big");let h=a.__unsignedDigit(0);if(h===1)return n;if(h>=z.__kMaxLengthBits)throw new RangeError("BigInt too big");if(n.length===1&&n.__digit(0)===2){const g=1+(0|h/30),c=n.sign&&(1&h)!=0,A=new z(g,c);A.__initializeDigits();const D=1<<h%30;return A.__setDigit(g-1,D),A}let p=null,v=n;for(1&h&&(p=n),h>>=1;h!==0;h>>=1)v=z.multiply(v,v),1&h&&(p===null?p=v:p=z.multiply(p,v));return p}static multiply(n,a){if(n.length===0)return n;if(a.length===0)return a;let h=n.length+a.length;30<=n.__clzmsd()+a.__clzmsd()&&h--;const p=new z(h,n.sign!==a.sign);p.__initializeDigits();for(let v=0;v<n.length;v++)z.__multiplyAccumulate(a,n.__digit(v),p,v);return p.__trim()}static divide(n,a){if(a.length===0)throw new RangeError("Division by zero");if(0>z.__absoluteCompare(n,a))return z.__zero();const h=n.sign!==a.sign,p=a.__unsignedDigit(0);let v;if(a.length===1&&32767>=p){if(p===1)return h===n.sign?n:z.unaryMinus(n);v=z.__absoluteDivSmall(n,p,null)}else v=z.__absoluteDivLarge(n,a,!0,!1);return v.sign=h,v.__trim()}static remainder(n,a){if(a.length===0)throw new RangeError("Division by zero");if(0>z.__absoluteCompare(n,a))return n;const h=a.__unsignedDigit(0);if(a.length===1&&32767>=h){if(h===1)return z.__zero();const v=z.__absoluteModSmall(n,h);return v===0?z.__zero():z.__oneDigit(v,n.sign)}const p=z.__absoluteDivLarge(n,a,!1,!0);return p.sign=n.sign,p.__trim()}static add(n,a){const h=n.sign;return h===a.sign?z.__absoluteAdd(n,a,h):0<=z.__absoluteCompare(n,a)?z.__absoluteSub(n,a,h):z.__absoluteSub(a,n,!h)}static subtract(n,a){const h=n.sign;return h===a.sign?0<=z.__absoluteCompare(n,a)?z.__absoluteSub(n,a,h):z.__absoluteSub(a,n,!h):z.__absoluteAdd(n,a,h)}static leftShift(n,a){return a.length===0||n.length===0?n:a.sign?z.__rightShiftByAbsolute(n,a):z.__leftShiftByAbsolute(n,a)}static signedRightShift(n,a){return a.length===0||n.length===0?n:a.sign?z.__leftShiftByAbsolute(n,a):z.__rightShiftByAbsolute(n,a)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(n,a){return 0>z.__compareToBigInt(n,a)}static lessThanOrEqual(n,a){return 0>=z.__compareToBigInt(n,a)}static greaterThan(n,a){return 0<z.__compareToBigInt(n,a)}static greaterThanOrEqual(n,a){return 0<=z.__compareToBigInt(n,a)}static equal(n,a){if(n.sign!==a.sign||n.length!==a.length)return!1;for(let h=0;h<n.length;h++)if(n.__digit(h)!==a.__digit(h))return!1;return!0}static notEqual(n,a){return!z.equal(n,a)}static bitwiseAnd(n,a){var h=Math.max;if(!n.sign&&!a.sign)return z.__absoluteAnd(n,a).__trim();if(n.sign&&a.sign){const p=h(n.length,a.length)+1;let v=z.__absoluteSubOne(n,p);const g=z.__absoluteSubOne(a);return v=z.__absoluteOr(v,g,v),z.__absoluteAddOne(v,!0,v).__trim()}return n.sign&&([n,a]=[a,n]),z.__absoluteAndNot(n,z.__absoluteSubOne(a)).__trim()}static bitwiseXor(n,a){var h=Math.max;if(!n.sign&&!a.sign)return z.__absoluteXor(n,a).__trim();if(n.sign&&a.sign){const g=h(n.length,a.length),c=z.__absoluteSubOne(n,g),A=z.__absoluteSubOne(a);return z.__absoluteXor(c,A,c).__trim()}const p=h(n.length,a.length)+1;n.sign&&([n,a]=[a,n]);let v=z.__absoluteSubOne(a,p);return v=z.__absoluteXor(v,n,v),z.__absoluteAddOne(v,!0,v).__trim()}static bitwiseOr(n,a){var h=Math.max;const p=h(n.length,a.length);if(!n.sign&&!a.sign)return z.__absoluteOr(n,a).__trim();if(n.sign&&a.sign){let g=z.__absoluteSubOne(n,p);const c=z.__absoluteSubOne(a);return g=z.__absoluteAnd(g,c,g),z.__absoluteAddOne(g,!0,g).__trim()}n.sign&&([n,a]=[a,n]);let v=z.__absoluteSubOne(a,p);return v=z.__absoluteAndNot(v,n,v),z.__absoluteAddOne(v,!0,v).__trim()}static asIntN(n,a){var h=Math.floor;if(a.length===0)return a;if(n=h(n),0>n)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(n===0)return z.__zero();if(n>=z.__kMaxLengthBits)return a;const p=0|(n+29)/30;if(a.length<p)return a;const v=a.__unsignedDigit(p-1),g=1<<(n-1)%30;if(a.length===p&&v<g)return a;if((v&g)!==g)return z.__truncateToNBits(n,a);if(!a.sign)return z.__truncateAndSubFromPowerOfTwo(n,a,!0);if(!(v&g-1)){for(let c=p-2;0<=c;c--)if(a.__digit(c)!==0)return z.__truncateAndSubFromPowerOfTwo(n,a,!1);return a.length===p&&v===g?a:z.__truncateToNBits(n,a)}return z.__truncateAndSubFromPowerOfTwo(n,a,!1)}static asUintN(n,a){var h=Math.floor;if(a.length===0)return a;if(n=h(n),0>n)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(n===0)return z.__zero();if(a.sign){if(n>z.__kMaxLengthBits)throw new RangeError("BigInt too big");return z.__truncateAndSubFromPowerOfTwo(n,a,!1)}if(n>=z.__kMaxLengthBits)return a;const p=0|(n+29)/30;if(a.length<p)return a;const v=n%30;return a.length==p&&(v===0||!(a.__digit(p-1)>>>v))?a:z.__truncateToNBits(n,a)}static ADD(n,a){if(n=z.__toPrimitive(n),a=z.__toPrimitive(a),typeof n=="string")return typeof a!="string"&&(a=a.toString()),n+a;if(typeof a=="string")return n.toString()+a;if(n=z.__toNumeric(n),a=z.__toNumeric(a),z.__isBigInt(n)&&z.__isBigInt(a))return z.add(n,a);if(typeof n=="number"&&typeof a=="number")return n+a;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(n,a){return z.__compare(n,a,0)}static LE(n,a){return z.__compare(n,a,1)}static GT(n,a){return z.__compare(n,a,2)}static GE(n,a){return z.__compare(n,a,3)}static EQ(n,a){for(;;){if(z.__isBigInt(n))return z.__isBigInt(a)?z.equal(n,a):z.EQ(a,n);if(typeof n=="number"){if(z.__isBigInt(a))return z.__equalToNumber(a,n);if(typeof a!="object")return n==a;a=z.__toPrimitive(a)}else if(typeof n=="string"){if(z.__isBigInt(a))return n=z.__fromString(n),n!==null&&z.equal(n,a);if(typeof a!="object")return n==a;a=z.__toPrimitive(a)}else if(typeof n=="boolean"){if(z.__isBigInt(a))return z.__equalToNumber(a,+n);if(typeof a!="object")return n==a;a=z.__toPrimitive(a)}else if(typeof n=="symbol"){if(z.__isBigInt(a))return!1;if(typeof a!="object")return n==a;a=z.__toPrimitive(a)}else if(typeof n=="object"){if(typeof a=="object"&&a.constructor!==z)return n==a;n=z.__toPrimitive(n)}else return n==a}}static NE(n,a){return!z.EQ(n,a)}static DataViewGetBigInt64(n,a,h=!1){return z.asIntN(64,z.DataViewGetBigUint64(n,a,h))}static DataViewGetBigUint64(n,a,h=!1){const[p,v]=h?[4,0]:[0,4],g=n.getUint32(a+p,h),c=n.getUint32(a+v,h),A=new z(3,!1);return A.__setDigit(0,1073741823&c),A.__setDigit(1,(268435455&g)<<2|c>>>30),A.__setDigit(2,g>>>28),A.__trim()}static DataViewSetBigInt64(n,a,h,p=!1){z.DataViewSetBigUint64(n,a,h,p)}static DataViewSetBigUint64(n,a,h,p=!1){h=z.asUintN(64,h);let v=0,g=0;if(0<h.length&&(g=h.__digit(0),1<h.length)){const D=h.__digit(1);g|=D<<30,v=D>>>2,2<h.length&&(v|=h.__digit(2)<<28)}const[c,A]=p?[4,0]:[0,4];n.setUint32(a+c,v,p),n.setUint32(a+A,g,p)}static __zero(){return new z(0,!1)}static __oneDigit(n,a){const h=new z(1,a);return h.__setDigit(0,n),h}__copy(){const n=new z(this.length,this.sign);for(let a=0;a<this.length;a++)n[a]=this[a];return n}__trim(){let n=this.length,a=this[n-1];for(;a===0;)n--,a=this[n-1],this.pop();return n===0&&(this.sign=!1),this}__initializeDigits(){for(let n=0;n<this.length;n++)this[n]=0}static __decideRounding(n,a,h,p){if(0<a)return-1;let v;if(0>a)v=-a-1;else{if(h===0)return-1;h--,p=n.__digit(h),v=29}let g=1<<v;if(!(p&g))return-1;if(g-=1,(p&g)!=0)return 1;for(;0<h;)if(h--,n.__digit(h)!==0)return 1;return 0}static __fromDouble(n){z.__kBitConversionDouble[0]=n;const a=2047&z.__kBitConversionInts[1]>>>20,h=a-1023,p=(0|h/30)+1,v=new z(p,0>n);let g=1048575&z.__kBitConversionInts[1]|1048576,c=z.__kBitConversionInts[0];const A=20,D=h%30;let N,L=0;if(D<20){const F=A-D;L=F+32,N=g>>>F,g=g<<32-F|c>>>F,c<<=32-F}else if(D===20)L=32,N=g,g=c,c=0;else{const F=D-A;L=32-F,N=g<<F|c>>>32-F,g=c<<F,c=0}v.__setDigit(p-1,N);for(let F=p-2;0<=F;F--)0<L?(L-=30,N=g>>>2,g=g<<30|c>>>2,c<<=30):N=0,v.__setDigit(F,N);return v.__trim()}static __isWhitespace(n){return 13>=n&&9<=n||(159>=n?n==32:131071>=n?n==160||n==5760:196607>=n?(n&=131071,10>=n||n==40||n==41||n==47||n==95||n==4096):n==65279)}static __fromString(n,a=0){let h=0;const p=n.length;let v=0;if(v===p)return z.__zero();let g=n.charCodeAt(v);for(;z.__isWhitespace(g);){if(++v===p)return z.__zero();g=n.charCodeAt(v)}if(g===43){if(++v===p)return null;g=n.charCodeAt(v),h=1}else if(g===45){if(++v===p)return null;g=n.charCodeAt(v),h=-1}if(a===0){if(a=10,g===48){if(++v===p)return z.__zero();if(g=n.charCodeAt(v),g===88||g===120){if(a=16,++v===p)return null;g=n.charCodeAt(v)}else if(g===79||g===111){if(a=8,++v===p)return null;g=n.charCodeAt(v)}else if(g===66||g===98){if(a=2,++v===p)return null;g=n.charCodeAt(v)}}}else if(a===16&&g===48){if(++v===p)return z.__zero();if(g=n.charCodeAt(v),g===88||g===120){if(++v===p)return null;g=n.charCodeAt(v)}}if(h!=0&&a!==10)return null;for(;g===48;){if(++v===p)return z.__zero();g=n.charCodeAt(v)}const c=p-v;let A=z.__kMaxBitsPerChar[a],D=z.__kBitsPerCharTableMultiplier-1;if(c>1073741824/A)return null;const N=A*c+D>>>z.__kBitsPerCharTableShift,L=new z(0|(N+29)/30,!1),F=10>a?a:10,V=10<a?a-10:0;if(a&a-1){L.__initializeDigits();let $=!1,J=0;do{let ae=0,fe=1;for(;;){let Ce;if(g-48>>>0<F)Ce=g-48;else if((32|g)-97>>>0<V)Ce=(32|g)-87;else{$=!0;break}const Me=fe*a;if(1073741823<Me)break;if(fe=Me,ae=ae*a+Ce,J++,++v===p){$=!0;break}g=n.charCodeAt(v)}D=30*z.__kBitsPerCharTableMultiplier-1;const ve=0|(A*J+D>>>z.__kBitsPerCharTableShift)/30;L.__inplaceMultiplyAdd(fe,ae,ve)}while(!$)}else{A>>=z.__kBitsPerCharTableShift;const $=[],J=[];let ae=!1;do{let fe=0,ve=0;for(;;){let Ce;if(g-48>>>0<F)Ce=g-48;else if((32|g)-97>>>0<V)Ce=(32|g)-87;else{ae=!0;break}if(ve+=A,fe=fe<<A|Ce,++v===p){ae=!0;break}if(g=n.charCodeAt(v),30<ve+A)break}$.push(fe),J.push(ve)}while(!ae);z.__fillFromParts(L,$,J)}if(v!==p){if(!z.__isWhitespace(g))return null;for(v++;v<p;v++)if(g=n.charCodeAt(v),!z.__isWhitespace(g))return null}return L.sign=h==-1,L.__trim()}static __fillFromParts(n,a,h){let p=0,v=0,g=0;for(let c=a.length-1;0<=c;c--){const A=a[c],D=h[c];v|=A<<g,g+=D,g===30?(n.__setDigit(p++,v),g=0,v=0):30<g&&(n.__setDigit(p++,1073741823&v),g-=30,v=A>>>D-g)}if(v!==0){if(p>=n.length)throw new Error("implementation bug");n.__setDigit(p++,v)}for(;p<n.length;p++)n.__setDigit(p,0)}static __toStringBasePowerOfTwo(n,a){const h=n.length;let p=a-1;p=(85&p>>>1)+(85&p),p=(51&p>>>2)+(51&p),p=(15&p>>>4)+(15&p);const v=p,g=a-1,c=n.__digit(h-1),A=z.__clz30(c);let D=0|(30*h-A+v-1)/v;if(n.sign&&D++,268435456<D)throw new Error("string too long");const N=Array(D);let L=D-1,F=0,V=0;for(let J=0;J<h-1;J++){const ae=n.__digit(J),fe=(F|ae<<V)&g;N[L--]=z.__kConversionChars[fe];const ve=v-V;for(F=ae>>>ve,V=30-ve;V>=v;)N[L--]=z.__kConversionChars[F&g],F>>>=v,V-=v}const $=(F|c<<V)&g;for(N[L--]=z.__kConversionChars[$],F=c>>>v-V;F!==0;)N[L--]=z.__kConversionChars[F&g],F>>>=v;if(n.sign&&(N[L--]="-"),L!=-1)throw new Error("implementation bug");return N.join("")}static __toStringGeneric(n,a,h){const p=n.length;if(p===0)return"";if(p===1){let J=n.__unsignedDigit(0).toString(a);return h===!1&&n.sign&&(J="-"+J),J}const v=30*p-z.__clz30(n.__digit(p-1)),g=z.__kMaxBitsPerChar[a],c=g-1;let A=v*z.__kBitsPerCharTableMultiplier;A+=c-1,A=0|A/c;const D=A+1>>1,N=z.exponentiate(z.__oneDigit(a,!1),z.__oneDigit(D,!1));let L,F;const V=N.__unsignedDigit(0);if(N.length===1&&32767>=V){L=new z(n.length,!1),L.__initializeDigits();let J=0;for(let ae=2*n.length-1;0<=ae;ae--){const fe=J<<15|n.__halfDigit(ae);L.__setHalfDigit(ae,0|fe/V),J=0|fe%V}F=J.toString(a)}else{const J=z.__absoluteDivLarge(n,N,!0,!0);L=J.quotient;const ae=J.remainder.__trim();F=z.__toStringGeneric(ae,a,!0)}L.__trim();let $=z.__toStringGeneric(L,a,!0);for(;F.length<D;)F="0"+F;return h===!1&&n.sign&&($="-"+$),$+F}static __unequalSign(n){return n?-1:1}static __absoluteGreater(n){return n?-1:1}static __absoluteLess(n){return n?1:-1}static __compareToBigInt(n,a){const h=n.sign;if(h!==a.sign)return z.__unequalSign(h);const p=z.__absoluteCompare(n,a);return 0<p?z.__absoluteGreater(h):0>p?z.__absoluteLess(h):0}static __compareToNumber(n,a){if(z.__isOneDigitInt(a)){const h=n.sign,p=0>a;if(h!==p)return z.__unequalSign(h);if(n.length===0){if(p)throw new Error("implementation bug");return a===0?0:-1}if(1<n.length)return z.__absoluteGreater(h);const v=Math.abs(a),g=n.__unsignedDigit(0);return g>v?z.__absoluteGreater(h):g<v?z.__absoluteLess(h):0}return z.__compareToDouble(n,a)}static __compareToDouble(n,a){if(a!==a)return a;if(a===1/0)return-1;if(a===-1/0)return 1;const h=n.sign;if(h!==0>a)return z.__unequalSign(h);if(a===0)throw new Error("implementation bug: should be handled elsewhere");if(n.length===0)return-1;z.__kBitConversionDouble[0]=a;const p=2047&z.__kBitConversionInts[1]>>>20;if(p==2047)throw new Error("implementation bug: handled elsewhere");const v=p-1023;if(0>v)return z.__absoluteGreater(h);const g=n.length;let c=n.__digit(g-1);const A=z.__clz30(c),D=30*g-A,N=v+1;if(D<N)return z.__absoluteLess(h);if(D>N)return z.__absoluteGreater(h);let L=1048576|1048575&z.__kBitConversionInts[1],F=z.__kBitConversionInts[0];const V=20,$=29-A;if($!==(0|(D-1)%30))throw new Error("implementation bug");let J,ae=0;if(20>$){const fe=V-$;ae=fe+32,J=L>>>fe,L=L<<32-fe|F>>>fe,F<<=32-fe}else if($===20)ae=32,J=L,L=F,F=0;else{const fe=$-V;ae=32-fe,J=L<<fe|F>>>32-fe,L=F<<fe,F=0}if(c>>>=0,J>>>=0,c>J)return z.__absoluteGreater(h);if(c<J)return z.__absoluteLess(h);for(let fe=g-2;0<=fe;fe--){0<ae?(ae-=30,J=L>>>2,L=L<<30|F>>>2,F<<=30):J=0;const ve=n.__unsignedDigit(fe);if(ve>J)return z.__absoluteGreater(h);if(ve<J)return z.__absoluteLess(h)}if(L!==0||F!==0){if(ae===0)throw new Error("implementation bug");return z.__absoluteLess(h)}return 0}static __equalToNumber(n,a){var h=Math.abs;return z.__isOneDigitInt(a)?a===0?n.length===0:n.length===1&&n.sign===0>a&&n.__unsignedDigit(0)===h(a):z.__compareToDouble(n,a)===0}static __comparisonResultToBool(n,a){return a===0?0>n:a===1?0>=n:a===2?0<n:a===3?0<=n:void 0}static __compare(n,a,h){if(n=z.__toPrimitive(n),a=z.__toPrimitive(a),typeof n=="string"&&typeof a=="string")switch(h){case 0:return n<a;case 1:return n<=a;case 2:return n>a;case 3:return n>=a}if(z.__isBigInt(n)&&typeof a=="string")return a=z.__fromString(a),a!==null&&z.__comparisonResultToBool(z.__compareToBigInt(n,a),h);if(typeof n=="string"&&z.__isBigInt(a))return n=z.__fromString(n),n!==null&&z.__comparisonResultToBool(z.__compareToBigInt(n,a),h);if(n=z.__toNumeric(n),a=z.__toNumeric(a),z.__isBigInt(n)){if(z.__isBigInt(a))return z.__comparisonResultToBool(z.__compareToBigInt(n,a),h);if(typeof a!="number")throw new Error("implementation bug");return z.__comparisonResultToBool(z.__compareToNumber(n,a),h)}if(typeof n!="number")throw new Error("implementation bug");if(z.__isBigInt(a))return z.__comparisonResultToBool(z.__compareToNumber(a,n),2^h);if(typeof a!="number")throw new Error("implementation bug");return h===0?n<a:h===1?n<=a:h===2?n>a:h===3?n>=a:void 0}__clzmsd(){return z.__clz30(this.__digit(this.length-1))}static __absoluteAdd(n,a,h){if(n.length<a.length)return z.__absoluteAdd(a,n,h);if(n.length===0)return n;if(a.length===0)return n.sign===h?n:z.unaryMinus(n);let p=n.length;(n.__clzmsd()===0||a.length===n.length&&a.__clzmsd()===0)&&p++;const v=new z(p,h);let g=0,c=0;for(;c<a.length;c++){const A=n.__digit(c)+a.__digit(c)+g;g=A>>>30,v.__setDigit(c,1073741823&A)}for(;c<n.length;c++){const A=n.__digit(c)+g;g=A>>>30,v.__setDigit(c,1073741823&A)}return c<v.length&&v.__setDigit(c,g),v.__trim()}static __absoluteSub(n,a,h){if(n.length===0)return n;if(a.length===0)return n.sign===h?n:z.unaryMinus(n);const p=new z(n.length,h);let v=0,g=0;for(;g<a.length;g++){const c=n.__digit(g)-a.__digit(g)-v;v=1&c>>>30,p.__setDigit(g,1073741823&c)}for(;g<n.length;g++){const c=n.__digit(g)-v;v=1&c>>>30,p.__setDigit(g,1073741823&c)}return p.__trim()}static __absoluteAddOne(n,a,h=null){const p=n.length;h===null?h=new z(p,a):h.sign=a;let v=1;for(let g=0;g<p;g++){const c=n.__digit(g)+v;v=c>>>30,h.__setDigit(g,1073741823&c)}return v!=0&&h.__setDigitGrow(p,1),h}static __absoluteSubOne(n,a){const h=n.length;a=a||h;const p=new z(a,!1);let v=1;for(let g=0;g<h;g++){const c=n.__digit(g)-v;v=1&c>>>30,p.__setDigit(g,1073741823&c)}if(v!=0)throw new Error("implementation bug");for(let g=h;g<a;g++)p.__setDigit(g,0);return p}static __absoluteAnd(n,a,h=null){let p=n.length,v=a.length,g=v;if(p<v){g=p;const D=n,N=p;n=a,p=v,a=D,v=N}let c=g;h===null?h=new z(c,!1):c=h.length;let A=0;for(;A<g;A++)h.__setDigit(A,n.__digit(A)&a.__digit(A));for(;A<c;A++)h.__setDigit(A,0);return h}static __absoluteAndNot(n,a,h=null){const p=n.length,v=a.length;let g=v;p<v&&(g=p);let c=p;h===null?h=new z(c,!1):c=h.length;let A=0;for(;A<g;A++)h.__setDigit(A,n.__digit(A)&~a.__digit(A));for(;A<p;A++)h.__setDigit(A,n.__digit(A));for(;A<c;A++)h.__setDigit(A,0);return h}static __absoluteOr(n,a,h=null){let p=n.length,v=a.length,g=v;if(p<v){g=p;const D=n,N=p;n=a,p=v,a=D,v=N}let c=p;h===null?h=new z(c,!1):c=h.length;let A=0;for(;A<g;A++)h.__setDigit(A,n.__digit(A)|a.__digit(A));for(;A<p;A++)h.__setDigit(A,n.__digit(A));for(;A<c;A++)h.__setDigit(A,0);return h}static __absoluteXor(n,a,h=null){let p=n.length,v=a.length,g=v;if(p<v){g=p;const D=n,N=p;n=a,p=v,a=D,v=N}let c=p;h===null?h=new z(c,!1):c=h.length;let A=0;for(;A<g;A++)h.__setDigit(A,n.__digit(A)^a.__digit(A));for(;A<p;A++)h.__setDigit(A,n.__digit(A));for(;A<c;A++)h.__setDigit(A,0);return h}static __absoluteCompare(n,a){const h=n.length-a.length;if(h!=0)return h;let p=n.length-1;for(;0<=p&&n.__digit(p)===a.__digit(p);)p--;return 0>p?0:n.__unsignedDigit(p)>a.__unsignedDigit(p)?1:-1}static __multiplyAccumulate(n,a,h,p){if(a===0)return;const v=32767&a,g=a>>>15;let c=0,A=0;for(let D,N=0;N<n.length;N++,p++){D=h.__digit(p);const L=n.__digit(N),F=32767&L,V=L>>>15,$=z.__imul(F,v),J=z.__imul(F,g),ae=z.__imul(V,v),fe=z.__imul(V,g);D+=A+$+c,c=D>>>30,D&=1073741823,D+=((32767&J)<<15)+((32767&ae)<<15),c+=D>>>30,A=fe+(J>>>15)+(ae>>>15),h.__setDigit(p,1073741823&D)}for(;c!=0||A!==0;p++){let D=h.__digit(p);D+=c+A,A=0,c=D>>>30,h.__setDigit(p,1073741823&D)}}static __internalMultiplyAdd(n,a,h,p,v){let g=h,c=0;for(let A=0;A<p;A++){const D=n.__digit(A),N=z.__imul(32767&D,a),L=z.__imul(D>>>15,a),F=N+((32767&L)<<15)+c+g;g=F>>>30,c=L>>>15,v.__setDigit(A,1073741823&F)}if(v.length>p)for(v.__setDigit(p++,g+c);p<v.length;)v.__setDigit(p++,0);else if(g+c!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(n,a,h){h>this.length&&(h=this.length);const p=32767&n,v=n>>>15;let g=0,c=a;for(let A=0;A<h;A++){const D=this.__digit(A),N=32767&D,L=D>>>15,F=z.__imul(N,p),V=z.__imul(N,v),$=z.__imul(L,p),J=z.__imul(L,v);let ae=c+F+g;g=ae>>>30,ae&=1073741823,ae+=((32767&V)<<15)+((32767&$)<<15),g+=ae>>>30,c=J+(V>>>15)+($>>>15),this.__setDigit(A,1073741823&ae)}if(g!=0||c!==0)throw new Error("implementation bug")}static __absoluteDivSmall(n,a,h=null){h===null&&(h=new z(n.length,!1));let p=0;for(let v,g=2*n.length-1;0<=g;g-=2){v=(p<<15|n.__halfDigit(g))>>>0;const c=0|v/a;p=0|v%a,v=(p<<15|n.__halfDigit(g-1))>>>0;const A=0|v/a;p=0|v%a,h.__setDigit(g>>>1,c<<15|A)}return h}static __absoluteModSmall(n,a){let h=0;for(let p=2*n.length-1;0<=p;p--)h=0|((h<<15|n.__halfDigit(p))>>>0)%a;return h}static __absoluteDivLarge(n,a,h,p){const v=a.__halfDigitLength(),g=a.length,c=n.__halfDigitLength()-v;let A=null;h&&(A=new z(c+2>>>1,!1),A.__initializeDigits());const D=new z(v+2>>>1,!1);D.__initializeDigits();const N=z.__clz15(a.__halfDigit(v-1));0<N&&(a=z.__specialLeftShift(a,N,0));const L=z.__specialLeftShift(n,N,1),F=a.__halfDigit(v-1);let V=0;for(let $,J=c;0<=J;J--){$=32767;const ae=L.__halfDigit(J+v);if(ae!==F){const ve=(ae<<15|L.__halfDigit(J+v-1))>>>0;$=0|ve/F;let Ce=0|ve%F;const Me=a.__halfDigit(v-2),Te=L.__halfDigit(J+v-2);for(;z.__imul($,Me)>>>0>(Ce<<16|Te)>>>0&&($--,Ce+=F,!(32767<Ce)););}z.__internalMultiplyAdd(a,$,0,g,D);let fe=L.__inplaceSub(D,J,v+1);fe!==0&&(fe=L.__inplaceAdd(a,J,v),L.__setHalfDigit(J+v,32767&L.__halfDigit(J+v)+fe),$--),h&&(1&J?V=$<<15:A.__setDigit(J>>>1,V|$))}if(p)return L.__inplaceRightShift(N),h?{quotient:A,remainder:L}:L;if(h)return A;throw new Error("unreachable")}static __clz15(n){return z.__clz30(n)-15}__inplaceAdd(n,a,h){let p=0;for(let v=0;v<h;v++){const g=this.__halfDigit(a+v)+n.__halfDigit(v)+p;p=g>>>15,this.__setHalfDigit(a+v,32767&g)}return p}__inplaceSub(n,a,h){let p=0;if(1&a){a>>=1;let v=this.__digit(a),g=32767&v,c=0;for(;c<h-1>>>1;c++){const N=n.__digit(c),L=(v>>>15)-(32767&N)-p;p=1&L>>>15,this.__setDigit(a+c,(32767&L)<<15|32767&g),v=this.__digit(a+c+1),g=(32767&v)-(N>>>15)-p,p=1&g>>>15}const A=n.__digit(c),D=(v>>>15)-(32767&A)-p;if(p=1&D>>>15,this.__setDigit(a+c,(32767&D)<<15|32767&g),a+c+1>=this.length)throw new RangeError("out of bounds");!(1&h)&&(v=this.__digit(a+c+1),g=(32767&v)-(A>>>15)-p,p=1&g>>>15,this.__setDigit(a+n.length,1073709056&v|32767&g))}else{a>>=1;let v=0;for(;v<n.length-1;v++){const N=this.__digit(a+v),L=n.__digit(v),F=(32767&N)-(32767&L)-p;p=1&F>>>15;const V=(N>>>15)-(L>>>15)-p;p=1&V>>>15,this.__setDigit(a+v,(32767&V)<<15|32767&F)}const g=this.__digit(a+v),c=n.__digit(v),A=(32767&g)-(32767&c)-p;p=1&A>>>15;let D=0;!(1&h)&&(D=(g>>>15)-(c>>>15)-p,p=1&D>>>15),this.__setDigit(a+v,(32767&D)<<15|32767&A)}return p}__inplaceRightShift(n){if(n===0)return;let a=this.__digit(0)>>>n;const h=this.length-1;for(let p=0;p<h;p++){const v=this.__digit(p+1);this.__setDigit(p,1073741823&v<<30-n|a),a=v>>>n}this.__setDigit(h,a)}static __specialLeftShift(n,a,h){const p=n.length,v=new z(p+h,!1);if(a===0){for(let c=0;c<p;c++)v.__setDigit(c,n.__digit(c));return 0<h&&v.__setDigit(p,0),v}let g=0;for(let c=0;c<p;c++){const A=n.__digit(c);v.__setDigit(c,1073741823&A<<a|g),g=A>>>30-a}return 0<h&&v.__setDigit(p,g),v}static __leftShiftByAbsolute(n,a){const h=z.__toShiftAmount(a);if(0>h)throw new RangeError("BigInt too big");const p=0|h/30,v=h%30,g=n.length,c=v!==0&&n.__digit(g-1)>>>30-v!=0,A=g+p+(c?1:0),D=new z(A,n.sign);if(v===0){let N=0;for(;N<p;N++)D.__setDigit(N,0);for(;N<A;N++)D.__setDigit(N,n.__digit(N-p))}else{let N=0;for(let L=0;L<p;L++)D.__setDigit(L,0);for(let L=0;L<g;L++){const F=n.__digit(L);D.__setDigit(L+p,1073741823&F<<v|N),N=F>>>30-v}if(c)D.__setDigit(g+p,N);else if(N!==0)throw new Error("implementation bug")}return D.__trim()}static __rightShiftByAbsolute(n,a){const h=n.length,p=n.sign,v=z.__toShiftAmount(a);if(0>v)return z.__rightShiftByMaximum(p);const g=0|v/30,c=v%30;let A=h-g;if(0>=A)return z.__rightShiftByMaximum(p);let D=!1;if(p){if(n.__digit(g)&(1<<c)-1)D=!0;else for(let L=0;L<g;L++)if(n.__digit(L)!==0){D=!0;break}}D&&c===0&&!~n.__digit(h-1)&&A++;let N=new z(A,p);if(c===0){N.__setDigit(A-1,0);for(let L=g;L<h;L++)N.__setDigit(L-g,n.__digit(L))}else{let L=n.__digit(g)>>>c;const F=h-g-1;for(let V=0;V<F;V++){const $=n.__digit(V+g+1);N.__setDigit(V,1073741823&$<<30-c|L),L=$>>>c}N.__setDigit(F,L)}return D&&(N=z.__absoluteAddOne(N,!0,N)),N.__trim()}static __rightShiftByMaximum(n){return n?z.__oneDigit(1,!0):z.__zero()}static __toShiftAmount(n){if(1<n.length)return-1;const a=n.__unsignedDigit(0);return a>z.__kMaxLengthBits?-1:a}static __toPrimitive(n,a="default"){if(typeof n!="object"||n.constructor===z)return n;if(typeof Symbol<"u"&&typeof Symbol.toPrimitive=="symbol"){const v=n[Symbol.toPrimitive];if(v){const g=v(a);if(typeof g!="object")return g;throw new TypeError("Cannot convert object to primitive value")}}const h=n.valueOf;if(h){const v=h.call(n);if(typeof v!="object")return v}const p=n.toString;if(p){const v=p.call(n);if(typeof v!="object")return v}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(n){return z.__isBigInt(n)?n:+n}static __isBigInt(n){return typeof n=="object"&&n!==null&&n.constructor===z}static __truncateToNBits(n,a){const h=0|(n+29)/30,p=new z(h,a.sign),v=h-1;for(let c=0;c<v;c++)p.__setDigit(c,a.__digit(c));let g=a.__digit(v);if(n%30!=0){const c=32-n%30;g=g<<c>>>c}return p.__setDigit(v,g),p.__trim()}static __truncateAndSubFromPowerOfTwo(n,a,h){var p=Math.min;const v=0|(n+29)/30,g=new z(v,h);let c=0;const A=v-1;let D=0;for(const V=p(A,a.length);c<V;c++){const $=0-a.__digit(c)-D;D=1&$>>>30,g.__setDigit(c,1073741823&$)}for(;c<A;c++)g.__setDigit(c,0|1073741823&-D);let N=A<a.length?a.__digit(A):0;const L=n%30;let F;if(L==0)F=0-N-D,F&=1073741823;else{const V=32-L;N=N<<V>>>V;const $=1<<32-V;F=$-N-D,F&=$-1}return g.__setDigit(A,F),g.__trim()}__digit(n){return this[n]}__unsignedDigit(n){return this[n]>>>0}__setDigit(n,a){this[n]=0|a}__setDigitGrow(n,a){this[n]=0|a}__halfDigitLength(){const n=this.length;return 32767>=this.__unsignedDigit(n-1)?2*n-1:2*n}__halfDigit(n){return 32767&this[n>>>1]>>>15*(1&n)}__setHalfDigit(n,a){const h=n>>>1,p=this.__digit(h),v=1&n?32767&p|a<<15:1073709056&p|32767&a;this.__setDigit(h,v)}static __digitPow(n,a){let h=1;for(;0<a;)1&a&&(h*=n),a>>>=1,n*=n;return h}static __isOneDigitInt(n){return(1073741823&n)===n}}z.__kMaxLength=33554432,z.__kMaxLengthBits=z.__kMaxLength<<5,z.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],z.__kBitsPerCharTableShift=5,z.__kBitsPerCharTableMultiplier=1<<z.__kBitsPerCharTableShift,z.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],z.__kBitConversionBuffer=new ArrayBuffer(8),z.__kBitConversionDouble=new Float64Array(z.__kBitConversionBuffer),z.__kBitConversionInts=new Int32Array(z.__kBitConversionBuffer),z.__clz30=Math.clz32?function(i){return Math.clz32(i)-2}:function(i){return i===0?30:0|29-(0|Math.log(i>>>0)/Math.LN2)},z.__imul=Math.imul||function(i,n){return 0|i*n};const zb={};function nh(i,n){Object.defineProperty(i.prototype,Symbol.toStringTag,{value:n,writable:!1,enumerable:!1,configurable:!0});for(const a of Object.getOwnPropertyNames(i)){const h=Object.getOwnPropertyDescriptor(i,a);h.configurable&&h.enumerable&&(h.enumerable=!1,Object.defineProperty(i,a,h))}for(const a of Object.getOwnPropertyNames(i.prototype)){const h=Object.getOwnPropertyDescriptor(i.prototype,a);h.configurable&&h.enumerable&&(h.enumerable=!1,Object.defineProperty(i.prototype,a,h))}ur(n,i),ur(`${n}.prototype`,i.prototype)}function ur(i,n){const a=`%${i}%`;if(zb[a]!==void 0)throw new Error(`intrinsic ${i} already exists`);zb[a]=n}function Ct(i){return zb[i]}var mw,gw;const cn="slot-epochNanoSeconds",Gu="slot-timezone-identifier",Gt="slot-year",$t="slot-month",Ht="slot-day",yn="slot-hour",_n="slot-minute",vn="slot-second",bn="slot-millisecond",xn="slot-microsecond",wn="slot-nanosecond",Xe="slot-calendar",X2="slot-date-brand",W2="slot-year-month-brand",Q2="slot-month-day-brand",Qa="slot-cached-instant",fi="slot-time-zone",go="slot-years",Ta="slot-months",Xo="slot-weeks",yo="slot-days",_o="slot-hours",vo="slot-minutes",bo="slot-seconds",xo="slot-milliseconds",wo="slot-microseconds",To="slot-nanoseconds",cr="slot-calendar-identifier",K2=new WeakMap,Ob=Symbol.for("@@Temporal__GetSlots");(mw=globalThis)[Ob]||(mw[Ob]=function(n){return K2.get(n)});const vx=globalThis[Ob],Lb=Symbol.for("@@Temporal__CreateSlots");(gw=globalThis)[Lb]||(gw[Lb]=function(n){K2.set(n,Object.create(null))});const ih=globalThis[Lb];function ha(i,...n){if(!i||typeof i!="object")return!1;const a=vx(i);return!!a&&n.every(h=>h in a)}function k(i,n){var h;const a=(h=vx(i))==null?void 0:h[n];if(a===void 0)throw new TypeError(`Missing internal slot ${n}`);return a}function En(i,n,a){const h=vx(i);if(h===void 0)throw new TypeError("Missing slots for the given container");if(h[n])throw new TypeError(`${n} already has set`);h[n]=a}const yw=/\.[-A-Za-z_]|\.\.[-A-Za-z._]{1,12}|\.[-A-Za-z_][-A-Za-z._]{0,12}|[A-Za-z_][-A-Za-z._]{0,13}/,w_=new RegExp("(?:"+[`(?:${yw.source})(?:\\/(?:${yw.source}))*`,"Etc/GMT(?:0|[-+]\\d{1,2})","GMT[-+]?0","EST5EDT","CST6CDT","MST7MDT","PST8PDT",/(?:[+\u2212-][0-2][0-9](?::?[0-5][0-9](?::?[0-5][0-9](?:[.,]\d{1,9})?)?)?)/.source].join("|")+")"),J2=/(?:[+\u2212-]\d{6}|\d{4})/,U0=/(?:0[1-9]|1[0-2])/,Bb=/(?:0[1-9]|[12]\d|3[01])/,yR=new RegExp(`(${J2.source})(?:-(${U0.source})-(${Bb.source})|(${U0.source})(${Bb.source}))`),eE=/(\d{2})(?::(\d{2})(?::(\d{2})(?:[.,](\d{1,9}))?)?|(\d{2})(?:(\d{2})(?:[.,](\d{1,9}))?)?)?/,tE=/([+\u2212-])([01][0-9]|2[0-3])(?::?([0-5][0-9])(?::?([0-5][0-9])(?:[.,](\d{1,9}))?)?)?/,nE=new RegExp(`([zZ])|${tE.source}?`),Bf=/\[(!)?([a-z_][a-z0-9_-]*)=([A-Za-z0-9]+(?:-[A-Za-z0-9]+)*)\]/g,_R=new RegExp([`^${yR.source}`,`(?:(?:T|\\s+)${eE.source}(?:${nE.source})?)?`,`(?:\\[!?(${w_.source})\\])?`,`((?:${Bf.source})*)$`].join(""),"i"),vR=new RegExp([`^T?${eE.source}`,`(?:${nE.source})?`,`(?:\\[!?${w_.source}\\])?`,`((?:${Bf.source})*)$`].join(""),"i"),bR=new RegExp(`^(${J2.source})-?(${U0.source})(?:\\[!?${w_.source}\\])?((?:${Bf.source})*)$`),xR=new RegExp(`^(?:--)?(${U0.source})-?(${Bb.source})(?:\\[!?${w_.source}\\])?((?:${Bf.source})*)$`),lb=/(\d+)(?:[.,](\d{1,9}))?/,wR=new RegExp(`(?:${lb.source}H)?(?:${lb.source}M)?(?:${lb.source}S)?`),TR=new RegExp(`^([+-])?P${/(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?/.source}(?:T(?!$)${wR.source})?$`,"i"),ER=Array.prototype.includes,iE=Array.prototype.push,rE=globalThis.Intl.DateTimeFormat,SR=Math.min,AR=Math.max,$i=Math.abs,_s=Math.floor,Ig=Math.sign,Kp=Math.trunc,fv=Number.isNaN,Eo=Number.isFinite,CR=Number,T_=String,MR=Number.MAX_SAFE_INTEGER,Ja=Object.create,DR=Object.getOwnPropertyDescriptor,pv=Reflect.apply,IR=Reflect.ownKeys,Sr=z.BigInt(0),Zg=z.BigInt(1),Xu=z.BigInt(60),aE=z.BigInt(24),ti=z.BigInt(1e3),pl=z.BigInt(1e6),Wu=z.BigInt(1e9),kR=z.BigInt(-1),oE=z.multiply(z.BigInt(3600),Wu),sE=z.multiply(Xu,Wu),Ku=z.multiply(oE,aE),c_=z.multiply(z.BigInt(-86400),z.BigInt(1e17)),kg=z.multiply(z.BigInt(86400),z.BigInt(1e17)),V0=-271821,G0=275760,_g=z.multiply(z.BigInt(-388152),z.BigInt(1e13)),RR=z.multiply(Ku,z.BigInt(3660)),lE=z.multiply(Ku,z.BigInt(366)),cE=z.multiply(Ku,z.BigInt(14)),NR=["iso8601","hebrew","islamic","islamic-umalqura","islamic-tbla","islamic-civil","islamic-rgsa","islamicc","persian","ethiopic","ethioaa","coptic","chinese","dangi","roc","indian","buddhist","japanese","gregory"];function dl(i){return z.equal(i,Sr)}function ri(i,n){const a=i[n];if(a!==void 0)return a}function Jt(i,n,a){const h=arguments.length>2?a:[];return pv(i,n,h)}function Yi(i){return typeof i=="object"&&i!==null||typeof i=="function"}function Rg(i){if(typeof i=="bigint")throw new TypeError("Cannot convert BigInt to number");return CR(i)}function qr(i){const n=Rg(i);if(fv(n)||n===0)return 0;if(!Eo(n))return n;const a=_s($i(n));return a===0?0:Ig(n)*a}function Vs(i){if(typeof i!="number"||fv(i)||!Eo(i))return!1;const n=$i(i);return _s(n)===n}function Ao(i){if(typeof i=="symbol")throw new TypeError("Cannot convert a Symbol value to a String");return T_(i)}function Kn(i){const n=Rg(i);if(n===0)return 0;if(fv(n)||!Eo(n))throw new RangeError("invalid number value");const a=Kp(n);return a===0?0:a}function _w(i,n){const a=Kn(i);if(a<=0)throw n!==void 0?new RangeError(`property '${n}' cannot be a a number less than one`):new RangeError("Cannot convert a number less than one to a positive integer");return a}function ca(i){const n=Rg(i);if(!Eo(n))throw new RangeError("infinity is out of range");if(!Vs(n))throw new RangeError(`unsupported fractional value ${i}`);return n===0?0:n}function Vr(i,n){return{quotient:z.divide(i,n),remainder:z.remainder(i,n)}}function Z0(i){return z.lessThan(i,Sr)}function vw(i){return dl(i)?0:Z0(i)?-1:1}function Xc(i){return z.lessThan(i,Sr)?z.multiply(i,kR):i}const bw=new Map([["year",Kn],["month",_w],["monthCode",Ao],["day",_w],["hour",Kn],["minute",Kn],["second",Kn],["millisecond",Kn],["microsecond",Kn],["nanosecond",Kn],["years",ca],["months",ca],["weeks",ca],["days",ca],["hours",ca],["minutes",ca],["seconds",ca],["milliseconds",ca],["microseconds",ca],["nanoseconds",ca],["era",Ao],["eraYear",qr],["offset",Ao]]),PR=new Map([["hour",0],["minute",0],["second",0],["millisecond",0],["microsecond",0],["nanosecond",0]]),E_=[["years","year","date"],["months","month","date"],["weeks","week","date"],["days","day","date"],["hours","hour","time"],["minutes","minute","time"],["seconds","second","time"],["milliseconds","millisecond","time"],["microseconds","microsecond","time"],["nanoseconds","nanosecond","time"]],$0=new Map(E_.map(i=>[i[0],i[1]])),zR=new Map(E_.map(([i,n])=>[n,i])),xw=E_.map(([,i])=>i),ww=Array.from($0.keys()).sort(),Tw=new Map;function uE(i){let n=Tw.get(i);return n===void 0&&(n=new rE("en-us",{timeZone:T_(i),hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),Tw.set(i,n)),n}function Ew(i){if(i==null)throw new TypeError(`Expected object not ${i}`);return Object(i)}function vg(i,n,a,h){if(n==null)return;const p=IR(n);for(const v of p)if(!a.some(g=>Object.is(g,v))&&Object.prototype.propertyIsEnumerable.call(n,v)){const g=n[v];if(h&&h.some(c=>Object.is(c,g)))continue;i[v]=g}}function aa(i){return ha(i,cn)&&!ha(i,fi,Xe)}function hl(i){return ha(i,Gu)}function xr(i){return ha(i,cr)}function Tr(i){return ha(i,go,Ta,yo,_o,vo,bo,xo,wo,To)}function On(i){return ha(i,X2)}function Er(i){return ha(i,yn,_n,vn,bn,xn,wn)&&!ha(i,Gt,$t,Ht)}function mn(i){return ha(i,Gt,$t,Ht,yn,_n,vn,bn,xn,wn)}function ei(i){return ha(i,W2)}function la(i){return ha(i,Q2)}function Qt(i){return ha(i,cn,fi,Xe)}function $g(i){if(ha(i,Xe)||ha(i,fi))throw new TypeError("with() does not support a calendar or timeZone property");if(Er(i))throw new TypeError("with() does not accept Temporal.PlainTime, use withPlainTime() instead");if(i.calendar!==void 0)throw new TypeError("with() does not support a calendar property");if(i.timeZone!==void 0)throw new TypeError("with() does not support a timeZone property")}function OR(i){const{ianaName:n,offset:a,z:h}=function(v){if(new RegExp(`^${w_.source}$`,"i").test(v))return{ianaName:v};try{const g=rh(v);if(g.z||g.offset||g.ianaName)return g}catch{}throw new RangeError(`Invalid time zone: ${v}`)}(i);return n?Ix(n):h?"UTC":Av(kf(a))}function bx(i,n){return n==="never"?"":xx(Ba(i),n)}function xx(i,n){return n==="never"||n==="auto"&&i==="iso8601"?"":`[${n==="critical"?"!":""}u-ca=${i}]`}function rh(i){const n=_R.exec(i);if(!n)throw new RangeError(`invalid ISO 8601 string: ${i}`);let a=n[1];if(a[0]===""&&(a=`-${a.slice(1)}`),a==="-000000")throw new RangeError(`invalid ISO 8601 string: ${i}`);const h=qr(a),p=qr(n[2]||n[4]),v=qr(n[3]||n[5]),g=qr(n[6]),c=n[6]!==void 0,A=qr(n[7]||n[10]);let D=qr(n[8]||n[11]);D===60&&(D=59);const N=(n[9]||n[12])+"000000000",L=qr(N.slice(0,3)),F=qr(N.slice(3,6)),V=qr(N.slice(6,9));let $,J=!1;if(n[13])$=void 0,J=!0;else if(n[14]&&n[15]){const Ce=n[14]==="-"||n[14]===""?"-":"+",Me=n[15]||"00",Te=n[16]||"00",De=n[17]||"00";let Ne=n[18]||"0";if($=`${Ce}${Me}:${Te}`,+Ne){for(;Ne.endsWith("0");)Ne=Ne.slice(0,-1);$+=`:${De}.${Ne}`}else+De&&($+=`:${De}`);$==="-00:00"&&($="+00:00")}const ae=n[19],fe=n[20];let ve;for(const[,Ce,Me,Te]of fe.matchAll(Bf))if(Me==="u-ca")ve===void 0&&(ve=Te);else if(Ce==="!")throw new RangeError(`Unrecognized annotation: !${Me}=${Te}`);return Nx(h,p,v,g,A,D,L,F,V),{year:h,month:p,day:v,hasTime:c,hour:g,minute:A,second:D,millisecond:L,microsecond:F,nanosecond:V,ianaName:ae,offset:$,z:J,calendar:ve}}function wx(i){const n=bR.exec(i);let a,h,p,v;if(n){let g=n[1];if(g[0]===""&&(g=`-${g.slice(1)}`),g==="-000000")throw new RangeError(`invalid ISO 8601 string: ${i}`);a=qr(g),h=qr(n[2]);const c=n[3];for(const[,A,D,N]of c.matchAll(Bf))if(D==="u-ca")p===void 0&&(p=N);else if(A==="!")throw new RangeError(`Unrecognized annotation: !${D}=${N}`);if(p!==void 0&&p!=="iso8601")throw new RangeError("YYYY-MM format is only valid with iso8601 calendar")}else{let g;if({year:a,month:h,calendar:p,day:v,z:g}=rh(i),g)throw new RangeError("Z designator not supported for PlainYearMonth")}return{year:a,month:h,calendar:p,referenceISODay:v}}function Tx(i){const n=xR.exec(i);let a,h,p,v;if(n){a=qr(n[1]),h=qr(n[2]);const g=n[3];for(const[,c,A,D]of g.matchAll(Bf))if(A==="u-ca")p===void 0&&(p=D);else if(c==="!")throw new RangeError(`Unrecognized annotation: !${A}=${D}`);if(p!==void 0&&p!=="iso8601")throw new RangeError("MM-DD format is only valid with iso8601 calendar")}else{let g;if({month:a,day:h,calendar:p,year:v,z:g}=rh(i),g)throw new RangeError("Z designator not supported for PlainMonthDay")}return{month:a,day:h,calendar:p,referenceISOYear:v}}function LR(i){let{year:n,month:a,day:h,hour:p,minute:v,second:g,millisecond:c,microsecond:A,nanosecond:D,offset:N,z:L}=function(J){const ae=rh(J);if(!ae.z&&!ae.offset)throw new RangeError("Temporal.Instant requires a time zone offset");return ae}(i);if(!L&&!N)throw new RangeError("Temporal.Instant requires a time zone offset");const F=L?0:kf(N);({year:n,month:a,day:h,hour:p,minute:v,second:g,millisecond:c,microsecond:A,nanosecond:D}=kx(n,a,h,p,v,g,c,A,D-F));const V=Rf(n,a,h,p,v,g,c,A,D);if(V===null)throw new RangeError("DateTime outside of supported range");return V}function Y0(i,n,a,h){let p=i,v=n,g=a;switch(h){case"reject":Ju(p,v,g);break;case"constrain":({year:p,month:v,day:g}=CE(p,v,g))}return{year:p,month:v,day:g}}function mv(i,n,a,h,p,v,g){let c=i,A=n,D=a,N=h,L=p,F=v;switch(g){case"reject":Mv(c,A,D,N,L,F);break;case"constrain":({hour:c,minute:A,second:D,millisecond:N,microsecond:L,nanosecond:F}=function($,J,ae,fe,ve,Ce){const Me=ys($,0,23),Te=ys(J,0,59),De=ys(ae,0,59),Ne=ys(fe,0,999),je=ys(ve,0,999),ye=ys(Ce,0,999);return{hour:Me,minute:Te,second:De,millisecond:Ne,microsecond:je,nanosecond:ye}}(c,A,D,N,L,F))}return{hour:c,minute:A,second:D,millisecond:N,microsecond:L,nanosecond:F}}function ym(i){if(!Yi(i))return function($){const J=TR.exec($);if(!J)throw new RangeError(`invalid duration: ${$}`);if(J.slice(2).every(dt=>dt===void 0))throw new RangeError(`invalid duration: ${$}`);const ae=J[1]==="-"||J[1]===""?-1:1,fe=J[2]===void 0?0:Kn(J[2])*ae,ve=J[3]===void 0?0:Kn(J[3])*ae,Ce=J[4]===void 0?0:Kn(J[4])*ae,Me=J[5]===void 0?0:Kn(J[5])*ae,Te=J[6]===void 0?0:Kn(J[6])*ae,De=J[7],Ne=J[8],je=J[9],ye=J[10],Qe=J[11];let bt=0,Ot=0,mt=0;if(De!==void 0){if(Ne??je??ye??Qe)throw new RangeError("only the smallest unit can be fractional");mt=3600*qr((De+"000000000").slice(0,9))*ae}else if(bt=Ne===void 0?0:Kn(Ne)*ae,je!==void 0){if(ye??Qe)throw new RangeError("only the smallest unit can be fractional");mt=60*qr((je+"000000000").slice(0,9))*ae}else Ot=ye===void 0?0:Kn(ye)*ae,Qe!==void 0&&(mt=qr((Qe+"000000000").slice(0,9))*ae);const Dt=mt%1e3,vt=Kp(mt/1e3)%1e3,Ge=Kp(mt/1e6)%1e3;return Ot+=Kp(mt/1e9)%60,bt+=Kp(mt/6e10),K0(fe,ve,Ce,Me,Te,bt,Ot,Ge,vt,Dt),{years:fe,months:ve,weeks:Ce,days:Me,hours:Te,minutes:bt,seconds:Ot,milliseconds:Ge,microseconds:vt,nanoseconds:Dt}}(Ao(i));if(Tr(i))return{years:k(i,go),months:k(i,Ta),weeks:k(i,Xo),days:k(i,yo),hours:k(i,_o),minutes:k(i,vo),seconds:k(i,bo),milliseconds:k(i,xo),microseconds:k(i,wo),nanoseconds:k(i,To)};const n={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};let a=function($){if(!Yi($))throw new TypeError("invalid duration-like");const J={years:void 0,months:void 0,weeks:void 0,days:void 0,hours:void 0,minutes:void 0,seconds:void 0,milliseconds:void 0,microseconds:void 0,nanoseconds:void 0};let ae=!1;for(const fe of ww){const ve=$[fe];ve!==void 0&&(ae=!0,J[fe]=ca(ve))}if(!ae)throw new TypeError("invalid duration-like");return J}(i);for(const V of ww){const $=a[V];$!==void 0&&(n[V]=$)}let{years:h,months:p,weeks:v,days:g,hours:c,minutes:A,seconds:D,milliseconds:N,microseconds:L,nanoseconds:F}=n;return K0(h,p,v,g,c,A,D,N,L,F),{years:h,months:p,weeks:v,days:g,hours:c,minutes:A,seconds:D,milliseconds:N,microseconds:L,nanoseconds:F}}function Gr(i){return i===void 0?"constrain":Pf(i,"overflow",["constrain","reject"],"constrain")}function Ng(i){return i===void 0?"compatible":Pf(i,"disambiguation",["compatible","earlier","later","reject"],"compatible")}function Kc(i,n){return Pf(i,"roundingMode",["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"],n)}function q0(i,n){return i===void 0?n:Pf(i,"offset",["prefer","use","ignore","reject"],n)}function S_(i){return Pf(i,"calendarName",["auto","always","never","critical"],"auto")}function Yg(i){let n=i.roundingIncrement;if(n===void 0)return 1;if(n=Rg(n),!Eo(n))throw new RangeError("roundingIncrement must be finite");const a=Kp(n);if(a<1||a>1e9)throw new RangeError(`roundingIncrement must be at least 1 and at most 1e9, not ${n}`);return a}function qg(i,n,a){const h=a?n:n-1;if(i>h)throw new RangeError(`roundingIncrement must be at least 1 and less than ${h}, not ${i}`);if(n%i!=0)throw new RangeError(`Rounding increment must divide evenly into ${n}`)}function A_(i){const n=i.fractionalSecondDigits;if(n===void 0)return"auto";if(typeof n!="number"){if(Ao(n)!=="auto")throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`);return"auto"}const a=_s(n);if(!Eo(a)||a<0||a>9)throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`);return a}function C_(i,n){switch(i){case"minute":return{precision:"minute",unit:"minute",increment:1};case"second":return{precision:0,unit:"second",increment:1};case"millisecond":return{precision:3,unit:"millisecond",increment:1};case"microsecond":return{precision:6,unit:"microsecond",increment:1};case"nanosecond":return{precision:9,unit:"nanosecond",increment:1}}switch(n){case"auto":return{precision:n,unit:"nanosecond",increment:1};case 0:return{precision:n,unit:"second",increment:1};case 1:case 2:case 3:return{precision:n,unit:"millisecond",increment:10**(3-n)};case 4:case 5:case 6:return{precision:n,unit:"microsecond",increment:10**(6-n)};case 7:case 8:case 9:return{precision:n,unit:"nanosecond",increment:10**(9-n)};default:throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${n}`)}}const lm=Symbol("~required~");function vs(i,n,a,h,p=[]){const v=[];for(const[,D,N]of E_)a!=="datetime"&&a!==N||v.push(D);v.push(...p);let g=h;g===lm?g=void 0:g!==void 0&&v.push(g);const c=[...v];for(const D of v){const N=zR.get(D);N!==void 0&&c.push(N)}let A=Pf(i,n,c,g);if(A===void 0&&h===lm)throw new RangeError(`${n} is required`);return $0.has(A)?$0.get(A):A}function D0(i){const n=i.relativeTo;if(n===void 0)return n;let a,h,p,v,g,c,A,D,N,L,F,V,$="option",J=!1;if(Yi(n)){if(Qt(n)||On(n))return n;if(mn(n))return zg(n);L=k_(n);const ae=Hr(L,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);ae.push("timeZone","offset");const fe=Mn(n,ae,[]),ve=Ja(null);ve.overflow="constrain",{year:a,month:h,day:p,hour:v,minute:g,second:c,millisecond:A,microsecond:D,nanosecond:N}=M_(L,fe,ve),V=fe.offset,V===void 0&&($="wall"),F=fe.timeZone,F!==void 0&&(F=Ka(F))}else{let ae,fe;if({year:a,month:h,day:p,hour:v,minute:g,second:c,millisecond:A,microsecond:D,nanosecond:N,calendar:L,ianaName:ae,offset:V,z:fe}=rh(Ao(n)),ae)F=Ka(ae),fe?$="exact":V||($="wall"),J=!0;else if(fe)throw new RangeError("Z designator not supported for PlainDate relativeTo; either remove the Z or add a bracketed time zone");if(L||(L="iso8601"),!fd(L))throw new RangeError(`invalid calendar identifier ${L}`);L=eh(L)}return F===void 0?_l(a,h,p,L):za(X0(a,h,p,v,g,c,A,D,N,$,$==="option"?kf(V):0,F,"compatible","reject",J),F,L)}function jb(i,n,a,h,p,v,g,c,A,D){for(const[N,L]of[["years",i],["months",n],["weeks",a],["days",h],["hours",p],["minutes",v],["seconds",g],["milliseconds",c],["microseconds",A],["nanoseconds",D]])if(L!==0)return $0.get(N);return"nanosecond"}function cm(i,n){return xw.indexOf(i)>xw.indexOf(n)?n:i}function Mn(i,n,a,{emptySourceErrorMessage:h}={emptySourceErrorMessage:"no supported properties found"}){const p=Ja(null);let v=!1;n.sort();for(const g of n){let c=i[g];if(c!==void 0)v=!0,bw.has(g)&&(c=bw.get(g)(c)),p[g]=c;else if(a!=="partial"){if(ER.call(a,g))throw new TypeError(`required property '${g}' missing or undefined`);c=PR.get(g),p[g]=c}}if(a==="partial"&&!v)throw new TypeError(h);return p}function H0(i,n="complete"){const a=["hour","microsecond","millisecond","minute","nanosecond","second"],h=Mn(i,a,"partial",{emptySourceErrorMessage:"invalid time-like"}),p={};for(const v of a){const g=DR(h,v);g!==void 0?p[v]=g.value:n==="complete"&&(p[v]=0)}return p}function xi(i,n){let a=i;if(Yi(a)){if(On(a))return a;if(Qt(a)&&(Gr(n),a=Us(k(a,fi),k(a,Qa),k(a,Xe))),mn(a))return Gr(n),_l(k(a,Gt),k(a,$t),k(a,Ht),k(a,Xe));const A=k_(a);return hd(A,Mn(a,Hr(A,["day","month","monthCode","year"]),[]),n)}Gr(n);let{year:h,month:p,day:v,calendar:g,z:c}=function(D){return rh(D)}(Ao(a));if(c)throw new RangeError("Z designator not supported for PlainDate");if(g||(g="iso8601"),!fd(g))throw new RangeError(`invalid calendar identifier ${g}`);return g=eh(g),_l(h,p,v,g)}function M_(i,n,a){let{hour:h,minute:p,second:v,millisecond:g,microsecond:c,nanosecond:A}=H0(n);const D=Gr(a),N=hd(i,n,a),L=k(N,Gt),F=k(N,$t),V=k(N,Ht);return{hour:h,minute:p,second:v,millisecond:g,microsecond:c,nanosecond:A}=mv(h,p,v,g,c,A,D),{year:L,month:F,day:V,hour:h,minute:p,second:v,millisecond:g,microsecond:c,nanosecond:A}}function Jp(i,n){let a,h,p,v,g,c,A,D,N,L;if(Yi(i)){if(mn(i))return i;if(Qt(i))return Gr(n),Us(k(i,fi),k(i,Qa),k(i,Xe));if(On(i))return Gr(n),gs(k(i,Gt),k(i,$t),k(i,Ht),0,0,0,0,0,0,k(i,Xe));L=k_(i);const F=Mn(i,Hr(L,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),[]);({year:a,month:h,day:p,hour:v,minute:g,second:c,millisecond:A,microsecond:D,nanosecond:N}=M_(L,F,n))}else{let F;if(Gr(n),{year:a,month:h,day:p,hour:v,minute:g,second:c,millisecond:A,microsecond:D,nanosecond:N,calendar:L,z:F}=function($){return rh($)}(Ao(i)),F)throw new RangeError("Z designator not supported for PlainDateTime");if(Nx(a,h,p,v,g,c,A,D,N),L||(L="iso8601"),!fd(L))throw new RangeError(`invalid calendar identifier ${L}`);L=eh(L)}return gs(a,h,p,v,g,c,A,D,N,L)}function bg(i){if(Tr(i))return i;let{years:n,months:a,weeks:h,days:p,hours:v,minutes:g,seconds:c,milliseconds:A,microseconds:D,nanoseconds:N}=ym(i);return new(Ct("%Temporal.Duration%"))(n,a,h,p,v,g,c,A,D,N)}function Wc(i){if(aa(i))return i;if(Qt(i))return new(Ct("%Temporal.Instant%"))(k(i,cn));const n=LR(Ao(i));return new(Ct("%Temporal.Instant%"))(n)}function Sw(i,n){let a=i;if(Yi(a)){if(la(a))return a;let c,A;if(ha(a,Xe))c=k(a,Xe),A=!1;else{let N=a.calendar;A=N===void 0,N===void 0&&(N="iso8601"),c=bs(N)}const D=Mn(a,Hr(c,["day","month","monthCode","year"]),[]);return A&&D.month!==void 0&&D.monthCode===void 0&&D.year===void 0&&(D.year=1972),Pg(c,D,n)}Gr(n);let{month:h,day:p,referenceISOYear:v,calendar:g}=Tx(Ao(a));if(g===void 0&&(g="iso8601"),!fd(g))throw new RangeError(`invalid calendar identifier ${g}`);return g=eh(g),v===void 0?(Ju(1972,h,p),u_(h,p,g)):Pg(g,u_(h,p,g,v))}function ed(i,n="constrain"){let a,h,p,v,g,c,A=i;if(Yi(A)){if(Er(A))return A;if(Qt(A)&&(A=Us(k(A,fi),k(A,Qa),k(A,Xe))),mn(A))return new(Ct("%Temporal.PlainTime%"))(k(A,yn),k(A,_n),k(A,vn),k(A,bn),k(A,xn),k(A,wn));({hour:a,minute:h,second:p,millisecond:v,microsecond:g,nanosecond:c}=H0(A)),{hour:a,minute:h,second:p,millisecond:v,microsecond:g,nanosecond:c}=mv(a,h,p,v,g,c,n)}else({hour:a,minute:h,second:p,millisecond:v,microsecond:g,nanosecond:c}=function(N){const L=vR.exec(N);let F,V,$,J,ae,fe,ve;if(L){F=qr(L[1]),V=qr(L[2]||L[5]),$=qr(L[3]||L[6]),$===60&&($=59);const Ce=(L[4]||L[7])+"000000000";J=qr(Ce.slice(0,3)),ae=qr(Ce.slice(3,6)),fe=qr(Ce.slice(6,9)),ve=L[14];for(const[,Me,Te,De]of ve.matchAll(Bf))if(Te!=="u-ca"&&Me==="!")throw new RangeError(`Unrecognized annotation: !${Te}=${De}`);if(L[8])throw new RangeError("Z designator not supported for PlainTime")}else{let Ce,Me;if({hasTime:Me,hour:F,minute:V,second:$,millisecond:J,microsecond:ae,nanosecond:fe,z:Ce}=rh(N),!Me)throw new RangeError(`time is missing in string: ${N}`);if(Ce)throw new RangeError("Z designator not supported for PlainTime")}if(/[tT ][0-9][0-9]/.test(N))return{hour:F,minute:V,second:$,millisecond:J,microsecond:ae,nanosecond:fe};try{const{month:Ce,day:Me}=Tx(N);Ju(1972,Ce,Me)}catch{try{const{year:Ce,month:Me}=wx(N);Ju(Ce,Me,1)}catch{return{hour:F,minute:V,second:$,millisecond:J,microsecond:ae,nanosecond:fe}}}throw new RangeError(`invalid ISO 8601 time-only string ${N}; may need a T prefix`)}(Ao(A))),Mv(a,h,p,v,g,c);return new(Ct("%Temporal.PlainTime%"))(a,h,p,v,g,c)}function Xy(i,n){if(Yi(i)){if(ei(i))return i;const g=k_(i);return hm(g,Mn(i,Hr(g,["month","monthCode","year"]),[]),n)}Gr(n);let{year:a,month:h,referenceISODay:p,calendar:v}=wx(Ao(i));if(v===void 0&&(v="iso8601"),!fd(v))throw new RangeError(`invalid calendar identifier ${v}`);return v=eh(v),p===void 0?(Ju(a,h,1),h_(a,h,v)):hm(v,h_(a,h,v,p))}function X0(i,n,a,h,p,v,g,c,A,D,N,L,F,V,$){const J=new(Ct("%Temporal.PlainDateTime%"))(i,n,a,h,p,v,g,c,A);if(D==="wall"||V==="ignore")return k(So(L,J,F),cn);if(D==="exact"||V==="use"){const fe=Rf(i,n,a,h,p,v,g,c,A);if(fe===null)throw new RangeError("ZonedDateTime outside of supported range");return z.subtract(fe,z.BigInt(N))}const ae=W0(L,J);for(const fe of ae){const ve=Jc(L,fe),Ce=z.toNumber(Ls(z.BigInt(ve),sE,"halfExpand"));if(ve===N||$&&Ce===N)return k(fe,cn)}if(V==="reject"){const fe=Av(N),ve=hl(L)?k(L,Gu):"time zone";throw new RangeError(`Offset ${fe} is invalid for ${J.toString()} in ${ve}`)}return k(vE(ae,L,J,F),cn)}function Wy(i,n){let a,h,p,v,g,c,A,D,N,L,F,V,$,J,ae=!1,fe="option";if(Yi(i)){if(Qt(i))return i;V=k_(i);const Ce=Hr(V,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);Ce.push("timeZone","offset");const Me=Mn(i,Ce,["timeZone"]);L=Ka(Me.timeZone),F=Me.offset,F===void 0&&(fe="wall"),$=Ng(n),J=q0(n,"reject"),{year:a,month:h,day:p,hour:v,minute:g,second:c,millisecond:A,microsecond:D,nanosecond:N}=M_(V,Me,n)}else{let Ce,Me;if({year:a,month:h,day:p,hour:v,minute:g,second:c,millisecond:A,microsecond:D,nanosecond:N,ianaName:Ce,offset:F,z:Me,calendar:V}=function(De){const Ne=rh(De);if(!Ne.ianaName)throw new RangeError("Temporal.ZonedDateTime requires a time zone ID in brackets");return Ne}(Ao(i)),L=Ka(Ce),Me?fe="exact":F||(fe="wall"),V||(V="iso8601"),!fd(V))throw new RangeError(`invalid calendar identifier ${V}`);V=eh(V),ae=!0,$=Ng(n),J=q0(n,"reject"),Gr(n)}let ve=0;return fe==="option"&&(ve=kf(F)),za(X0(a,h,p,v,g,c,A,D,N,fe,ve,L,$,J,ae),L,V)}function hE(i,n,a,h,p){Ju(n,a,h),ME(n,a,h),ih(i),En(i,Gt,n),En(i,$t,a),En(i,Ht,h),En(i,Xe,p),En(i,X2,!0)}function _l(i,n,a,h="iso8601"){const p=Ct("%Temporal.PlainDate%"),v=Ja(p.prototype);return hE(v,i,n,a,h),v}function dE(i,n,a,h,p,v,g,c,A,D,N){Nx(n,a,h,p,v,g,c,A,D),DE(n,a,h,p,v,g,c,A,D),ih(i),En(i,Gt,n),En(i,$t,a),En(i,Ht,h),En(i,yn,p),En(i,_n,v),En(i,vn,g),En(i,bn,c),En(i,xn,A),En(i,wn,D),En(i,Xe,N)}function gs(i,n,a,h,p,v,g,c,A,D="iso8601"){const N=Ct("%Temporal.PlainDateTime%"),L=Ja(N.prototype);return dE(L,i,n,a,h,p,v,g,c,A,D),L}function fE(i,n,a,h,p){Ju(p,n,a),ME(p,n,a),ih(i),En(i,$t,n),En(i,Ht,a),En(i,Gt,p),En(i,Xe,h),En(i,Q2,!0)}function u_(i,n,a="iso8601",h=1972){const p=Ct("%Temporal.PlainMonthDay%"),v=Ja(p.prototype);return fE(v,i,n,a,h),v}function pE(i,n,a,h,p){Ju(n,a,p),function(g,c){La(g,V0,G0),g===V0?La(c,4,12):g===G0&&La(c,1,9)}(n,a),ih(i),En(i,Gt,n),En(i,$t,a),En(i,Ht,p),En(i,Xe,h),En(i,W2,!0)}function h_(i,n,a="iso8601",h=1){const p=Ct("%Temporal.PlainYearMonth%"),v=Ja(p.prototype);return pE(v,i,n,a,h),v}function mE(i,n,a,h){Xp(n),ih(i),En(i,cn,n),En(i,fi,a),En(i,Xe,h);const p=new(Ct("%Temporal.Instant%"))(k(i,cn));En(i,Qa,p)}function za(i,n,a="iso8601"){const h=Ct("%Temporal.ZonedDateTime%"),p=Ja(h.prototype);return mE(p,i,n,a),p}function Hr(i,n){if(typeof i=="string"){const p=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.fields%"),p,[n])}const a=Jt(ri(i,"fields"),i,[n]),h=[];for(const p of a){if(typeof p!="string")throw new TypeError("bad return from calendar.fields()");iE.call(h,p)}return h}function um(i,n,a){if(typeof i=="string"){const p=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.mergeFields%"),p,[n,a])}const h=Jt(ri(i,"mergeFields"),i,[n,a]);if(!Yi(h))throw new TypeError("bad return from calendar.mergeFields()");return h}function Oa(i,n,a,h,p){let v=p;if(typeof i=="string"){const c=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.dateAdd%"),c,[n,a,h])}v===void 0&&(v=ri(i,"dateAdd"));const g=pv(v,i,[n,a,h]);if(!On(g))throw new TypeError("invalid result");return g}function If(i,n,a,h,p){let v=p;if(typeof i=="string"){const c=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.dateUntil%"),c,[n,a,h])}v===void 0&&(v=ri(i,"dateUntil"));const g=pv(v,i,[n,a,h]);if(!Tr(g))throw new TypeError("invalid result");return g}function gv(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.year%"),h,[n])}let a=Jt(ri(i,"year"),i,[n]);if(typeof a!="number")throw new TypeError("calendar year result must be an integer");if(!Vs(a))throw new RangeError("calendar year result must be an integer");return a}function yv(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.month%"),h,[n])}let a=Jt(ri(i,"month"),i,[n]);if(typeof a!="number")throw new TypeError("calendar month result must be a positive integer");if(!Vs(a)||a<1)throw new RangeError("calendar month result must be a positive integer");return a}function D_(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.monthCode%"),h,[n])}let a=Jt(ri(i,"monthCode"),i,[n]);if(typeof a!="string")throw new TypeError("calendar monthCode result must be a string");return a}function I_(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.day%"),h,[n])}const a=Jt(ri(i,"day"),i,[n]);if(typeof a!="number")throw new TypeError("calendar day result must be a positive integer");if(!Vs(a)||a<1)throw new RangeError("calendar day result must be a positive integer");return a}function _v(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.era%"),h,[n])}let a=Jt(ri(i,"era"),i,[n]);if(a===void 0)return a;if(typeof a!="string")throw new TypeError("calendar era result must be a string or undefined");return a}function vv(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.eraYear%"),h,[n])}let a=Jt(ri(i,"eraYear"),i,[n]);if(a===void 0)return a;if(typeof a!="number")throw new TypeError("calendar eraYear result must be an integer or undefined");if(!Vs(a))throw new RangeError("calendar eraYear result must be an integer or undefined");return a}function Ex(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.dayOfWeek%"),h,[n])}const a=Jt(ri(i,"dayOfWeek"),i,[n]);if(typeof a!="number")throw new TypeError("calendar dayOfWeek result must be a positive integer");if(!Vs(a)||a<1)throw new RangeError("calendar dayOfWeek result must be a positive integer");return a}function Sx(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.dayOfYear%"),h,[n])}const a=Jt(ri(i,"dayOfYear"),i,[n]);if(typeof a!="number")throw new TypeError("calendar dayOfYear result must be a positive integer");if(!Vs(a)||a<1)throw new RangeError("calendar dayOfYear result must be a positive integer");return a}function Ax(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.weekOfYear%"),h,[n])}const a=Jt(ri(i,"weekOfYear"),i,[n]);if(typeof a!="number")throw new TypeError("calendar weekOfYear result must be a positive integer");if(!Vs(a)||a<1)throw new RangeError("calendar weekOfYear result must be a positive integer");return a}function Cx(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.yearOfWeek%"),h,[n])}const a=Jt(ri(i,"yearOfWeek"),i,[n]);if(typeof a!="number")throw new TypeError("calendar yearOfWeek result must be an integer");if(!Vs(a))throw new RangeError("calendar yearOfWeek result must be an integer");return a}function Mx(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.daysInWeek%"),h,[n])}const a=Jt(ri(i,"daysInWeek"),i,[n]);if(typeof a!="number")throw new TypeError("calendar daysInWeek result must be a positive integer");if(!Vs(a)||a<1)throw new RangeError("calendar daysInWeek result must be a positive integer");return a}function bv(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.daysInMonth%"),h,[n])}const a=Jt(ri(i,"daysInMonth"),i,[n]);if(typeof a!="number")throw new TypeError("calendar daysInMonth result must be a positive integer");if(!Vs(a)||a<1)throw new RangeError("calendar daysInMonth result must be a positive integer");return a}function xv(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.daysInYear%"),h,[n])}const a=Jt(ri(i,"daysInYear"),i,[n]);if(typeof a!="number")throw new TypeError("calendar daysInYear result must be a positive integer");if(!Vs(a)||a<1)throw new RangeError("calendar daysInYear result must be a positive integer");return a}function wv(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.monthsInYear%"),h,[n])}const a=Jt(ri(i,"monthsInYear"),i,[n]);if(typeof a!="number")throw new TypeError("calendar monthsInYear result must be a positive integer");if(!Vs(a)||a<1)throw new RangeError("calendar monthsInYear result must be a positive integer");return a}function Tv(i,n){if(typeof i=="string"){const h=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.inLeapYear%"),h,[n])}const a=Jt(ri(i,"inLeapYear"),i,[n]);if(typeof a!="boolean")throw new TypeError("calendar inLeapYear result must be a boolean");return a}function bs(i){if(Yi(i)){if(ha(i,Xe))return k(i,Xe);if(!function(p){return!!xr(p)||"dateAdd"in p&&"dateFromFields"in p&&"dateUntil"in p&&"day"in p&&"dayOfWeek"in p&&"dayOfYear"in p&&"daysInMonth"in p&&"daysInWeek"in p&&"daysInYear"in p&&"fields"in p&&"id"in p&&"inLeapYear"in p&&"mergeFields"in p&&"month"in p&&"monthCode"in p&&"monthDayFromFields"in p&&"monthsInYear"in p&&"weekOfYear"in p&&"year"in p&&"yearMonthFromFields"in p&&"yearOfWeek"in p}(i))throw new TypeError("expected a Temporal.Calendar or object implementing the Temporal.Calendar protocol");return i}const n=Ao(i);if(fd(n))return eh(n);let a;try{({calendar:a}=rh(n))}catch{try{({calendar:a}=wx(n))}catch{({calendar:a}=Tx(n))}}if(a||(a="iso8601"),!fd(a))throw new RangeError(`invalid calendar identifier ${a}`);return eh(a)}function k_(i){if(ha(i,Xe))return k(i,Xe);const{calendar:n}=i;return n===void 0?"iso8601":bs(n)}function Ba(i){if(typeof i=="string")return i;const n=i.id;if(typeof n!="string")throw new TypeError("calendar.id should be a string");return n}function Hg(i){return Yi(i)?i:new(Ct("%Temporal.Calendar%"))(i)}function R_(i,n){return i===n?!0:Ba(i)===Ba(n)}function Ev(i,n,a){if(i===n)return;const h=Ba(i),p=Ba(n);if(h!==p)throw new RangeError(`cannot ${a} of ${h} and ${p} calendars`)}function gE(i,n){if(i===n)return n;const a=Ba(i),h=Ba(n);if(a===h||a==="iso8601")return n;if(h==="iso8601")return i;throw new RangeError("irreconcilable calendars")}function hd(i,n,a,h){if(typeof i=="string"){const v=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.dateFromFields%"),v,[n,a])}const p=Jt(ri(i,"dateFromFields"),i,[n,a]);if(!On(p))throw new TypeError("invalid result");return p}function hm(i,n,a){if(typeof i=="string"){const p=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.yearMonthFromFields%"),p,[n,a])}let h=Jt(ri(i,"yearMonthFromFields"),i,[n,a]);if(!ei(h))throw new TypeError("invalid result");return h}function Pg(i,n,a){if(typeof i=="string"){const p=new(Ct("%Temporal.Calendar%"))(i);return Jt(Ct("%Temporal.Calendar.prototype.monthDayFromFields%"),p,[n,a])}let h=Jt(ri(i,"monthDayFromFields"),i,[n,a]);if(!la(h))throw new TypeError("invalid result");return h}function Ka(i){if(Yi(i)){if(Qt(i))return k(i,fi);if(!function(a){return!!hl(a)||"getOffsetNanosecondsFor"in a&&"getPossibleInstantsFor"in a&&"id"in a}(i))throw new TypeError("expected a Temporal.TimeZone or object implementing the Temporal.TimeZone protocol");return i}return OR(Ao(i))}function d_(i){if(typeof i=="string")return i;const n=i.id;if(typeof n!="string")throw new TypeError("timeZone.id should be a string");return n}function yE(i){return Yi(i)?i:new(Ct("%Temporal.TimeZone%"))(i)}function _E(i,n){return i===n?!0:d_(i)===d_(n)}function zg(i){return _l(k(i,Gt),k(i,$t),k(i,Ht),k(i,Xe))}function Dx(i){return new(Ct("%Temporal.PlainTime%"))(k(i,yn),k(i,_n),k(i,vn),k(i,bn),k(i,xn),k(i,wn))}function Jc(i,n,a){if(typeof i=="string"){const p=new(Ct("%Temporal.TimeZone%"))(i);return Jt(Ct("%Temporal.TimeZone.prototype.getOffsetNanosecondsFor%"),p,[n])}const h=Jt(ri(i,"getOffsetNanosecondsFor"),i,[n]);if(typeof h!="number")throw new TypeError("bad return from getOffsetNanosecondsFor");if(!Vs(h)||$i(h)>=864e11)throw new RangeError("out-of-range return from getOffsetNanosecondsFor");return h}function Fb(i,n){return Av(Jc(i,n))}function Us(i,n,a){const h=k(n,cn),p=Jc(i,n);let{year:v,month:g,day:c,hour:A,minute:D,second:N,millisecond:L,microsecond:F,nanosecond:V}=xE(h);return{year:v,month:g,day:c,hour:A,minute:D,second:N,millisecond:L,microsecond:F,nanosecond:V}=kx(v,g,c,A,D,N,L,F,V+p),gs(v,g,c,A,D,N,L,F,V,a)}function So(i,n,a){return vE(W0(i,n),i,n,a)}function vE(i,n,a,h){const p=Ct("%Temporal.Instant%"),v=i.length;if(v===1)return i[0];if(v)switch(h){case"compatible":case"earlier":return i[0];case"later":return i[v-1];case"reject":throw new RangeError("multiple instants found")}const g=k(a,Gt),c=k(a,$t),A=k(a,Ht),D=k(a,yn),N=k(a,_n),L=k(a,vn),F=k(a,bn),V=k(a,xn),$=k(a,wn),J=Rf(g,c,A,D,N,L,F,V,$);if(J===null)throw new RangeError("DateTime outside of supported range");const ae=new p(z.subtract(J,Ku)),fe=new p(z.add(J,Ku)),ve=Jc(n,ae),Ce=Jc(n,fe)-ve;switch(h){case"earlier":{const Me=k(a,Xe),Te=Ct("%Temporal.PlainDateTime%"),De=Zb(g,c,A,D,N,L,F,V,$,Me,0,0,0,0,0,0,0,0,0,-Ce,void 0);return W0(n,new Te(De.year,De.month,De.day,De.hour,De.minute,De.second,De.millisecond,De.microsecond,De.nanosecond,Me))[0]}case"compatible":case"later":{const Me=k(a,Xe),Te=Ct("%Temporal.PlainDateTime%"),De=Zb(g,c,A,D,N,L,F,V,$,Me,0,0,0,0,0,0,0,0,0,Ce,void 0),Ne=W0(n,new Te(De.year,De.month,De.day,De.hour,De.minute,De.second,De.millisecond,De.microsecond,De.nanosecond,Me));return Ne[Ne.length-1]}case"reject":throw new RangeError("no such instant found")}}function W0(i,n,a){if(typeof i=="string"){const v=new(Ct("%Temporal.TimeZone%"))(i);return Jt(Ct("%Temporal.TimeZone.prototype.getPossibleInstantsFor%"),v,[n])}const h=Jt(ri(i,"getPossibleInstantsFor"),i,[n]),p=[];for(const v of h){if(!aa(v))throw new TypeError("bad return from getPossibleInstantsFor");iE.call(p,v)}return p}function _m(i){let n;return i<0||i>9999?n=(i<0?"-":"+")+`000000${$i(i)}`.slice(-6):n=`0000${i}`.slice(-4),n}function rr(i){return`00${i}`.slice(-2)}function Sv(i,n,a,h,p){if(p==="minute")return"";const v=`:${rr(i)}`;let g,c=1e6*n+1e3*a+h;if(p==="auto"){if(c===0)return v;for(g=`${c}`.padStart(9,"0");g[g.length-1]==="0";)g=g.slice(0,-1)}else{if(p===0)return v;g=`${c}`.padStart(9,"0").slice(0,p)}return`${v}.${g}`}function Aw(i,n,a){let h=n;h===void 0&&(h="UTC");const p=Us(h,i,"iso8601"),v=_m(k(p,Gt)),g=rr(k(p,$t)),c=rr(k(p,Ht)),A=rr(k(p,yn)),D=rr(k(p,_n)),N=Sv(k(p,vn),k(p,bn),k(p,xn),k(p,wn),a);let L="Z";return n!==void 0&&(L=bE(Jc(h,i))),`${v}-${g}-${c}T${A}:${D}${N}${L}`}function cb(i,n="auto",a){function h(ye){return ye<=MR?ye.toString(10):z.BigInt(ye).toString(10)}const p=k(i,go),v=k(i,Ta),g=k(i,Xo),c=k(i,yo),A=k(i,_o),D=k(i,vo);let N=k(i,bo),L=k(i,xo),F=k(i,wo),V=k(i,To);const $=Qu(p,v,g,c,A,D,N,L,F,V);if(a){const{unit:ye,increment:Qe,roundingMode:bt}=a;({seconds:N,milliseconds:L,microseconds:F,nanoseconds:V}=dd(0,0,0,0,0,0,N,L,F,V,Qe,ye,bt))}const J=[];p&&J.push(`${h($i(p))}Y`),v&&J.push(`${h($i(v))}M`),g&&J.push(`${h($i(g))}W`),c&&J.push(`${h($i(c))}D`);const ae=[];A&&ae.push(`${h($i(A))}H`),D&&ae.push(`${h($i(D))}M`);const fe=[];let ve,Ce,Me,Te,De=Og(0,0,0,N,L,F,V,0);({quotient:De,remainder:ve}=Vr(De,ti)),{quotient:De,remainder:Ce}=Vr(De,ti),{quotient:Te,remainder:Me}=Vr(De,ti);const Ne=1e6*$i(z.toNumber(Me))+1e3*$i(z.toNumber(Ce))+$i(z.toNumber(ve));let je;if(n==="auto"){if(Ne!==0)for(je=`${Ne}`.padStart(9,"0");je[je.length-1]==="0";)je=je.slice(0,-1)}else n!==0&&(je=`${Ne}`.padStart(9,"0").slice(0,n));return je&&fe.unshift(".",je),z.equal(Te,Sr)&&!fe.length&&n==="auto"||fe.unshift(Xc(Te).toString()),fe.length&&ae.push(`${fe.join("")}S`),ae.length&&ae.unshift("T"),J.length||ae.length?`${$<0?"-":""}P${J.join("")}${ae.join("")}`:"PT0S"}function Cw(i,n="auto"){return`${_m(k(i,Gt))}-${rr(k(i,$t))}-${rr(k(i,Ht))}${bx(k(i,Xe),n)}`}function Mw(i,n,a="auto",h){let p=k(i,Gt),v=k(i,$t),g=k(i,Ht),c=k(i,yn),A=k(i,_n),D=k(i,vn),N=k(i,bn),L=k(i,xn),F=k(i,wn);if(h){const{unit:V,increment:$,roundingMode:J}=h;({year:p,month:v,day:g,hour:c,minute:A,second:D,millisecond:N,microsecond:L,nanosecond:F}=Lx(p,v,g,c,A,D,N,L,F,$,V,J))}return`${_m(p)}-${rr(v)}-${rr(g)}T${rr(c)}:${rr(A)}${Sv(D,N,L,F,n)}${bx(k(i,Xe),a)}`}function Dw(i,n="auto"){let a=`${rr(k(i,$t))}-${rr(k(i,Ht))}`;const h=Ba(k(i,Xe));(n==="always"||n==="critical"||h!=="iso8601")&&(a=`${_m(k(i,Gt))}-${a}`);const p=xx(h,n);return p&&(a+=p),a}function Iw(i,n="auto"){let a=`${_m(k(i,Gt))}-${rr(k(i,$t))}`;const h=Ba(k(i,Xe));(n==="always"||n==="critical"||h!=="iso8601")&&(a+=`-${rr(k(i,Ht))}`);const p=xx(h,n);return p&&(a+=p),a}function kw(i,n,a="auto",h="auto",p="auto",v){let g=k(i,Qa);if(v){const{unit:N,increment:L,roundingMode:F}=v,V=J0(k(i,cn),L,N,F);g=new(Ct("%Temporal.Instant%"))(V)}const c=k(i,fi),A=Us(c,g,"iso8601");let D=`${_m(k(A,Gt))}-${rr(k(A,$t))}-${rr(k(A,Ht))}T${rr(k(A,yn))}:${rr(k(A,_n))}${Sv(k(A,vn),k(A,bn),k(A,xn),k(A,wn),n)}`;return p!=="never"&&(D+=bE(Jc(c,g))),h!=="never"&&(D+=`[${h==="critical"?"!":""}${d_(c)}]`),D+=bx(k(i,Xe),a),D}function mg(i){return OE.test(T_(i))}function kf(i){const n=OE.exec(T_(i));if(!n)throw new RangeError(`invalid time zone offset: ${i}`);return(n[1]==="-"||n[1]===""?-1:1)*(1e9*(60*(60*+n[2]+ +(n[3]||0))+ +(n[4]||0))+ +((n[5]||0)+"000000000").slice(0,9))}function Ix(i){return mg(i)?Av(kf(i)):uE(T_(i)).resolvedOptions().timeZone}function ad(i,n){const{year:a,month:h,day:p,hour:v,minute:g,second:c,millisecond:A,microsecond:D,nanosecond:N}=wE(i,n),L=a%400,F=(a-L)/400,V=z.multiply(z.BigInt(146097),Ku),$=Rf(L,h,p,v,g,c,A,D,N),J=z.add($,z.multiply(V,z.BigInt(F)));return z.toNumber(z.subtract(J,n))}function Av(i){const n=i<0?"-":"+",a=$i(i),h=a%1e9,p=_s(a/1e9)%60,v=_s(a/6e10)%60,g=rr(_s(a/36e11)),c=rr(v),A=rr(p);let D="";if(h){let N=`${h}`.padStart(9,"0");for(;N[N.length-1]==="0";)N=N.slice(0,-1);D=`:${A}.${N}`}else p&&(D=`:${A}`);return`${n}${g}:${c}${D}`}function bE(i){let n=z.toNumber(Ls(z.BigInt(i),sE,"halfExpand"));const a=n<0?"-":"+";n=$i(n);const h=n/6e10%60;return`${a}${rr(_s(n/36e11))}:${rr(h)}`}function Rf(i,n,a,h,p,v,g,c,A){const D=new Date;D.setUTCHours(h,p,v,g),D.setUTCFullYear(i,n-1,a);const N=D.getTime();if(fv(N))return null;let L=z.multiply(z.BigInt(N),pl);return L=z.add(L,z.multiply(z.BigInt(c),ti)),L=z.add(L,z.BigInt(A)),z.lessThan(L,c_)||z.greaterThan(L,kg)?null:L}function xE(i){const{quotient:n,remainder:a}=Vr(i,pl);let h=z.toNumber(n),p=z.toNumber(a);p<0&&(p+=1e6,h-=1);const v=_s(p/1e3)%1e3,g=p%1e3,c=new Date(h);return{epochMilliseconds:h,year:c.getUTCFullYear(),month:c.getUTCMonth()+1,day:c.getUTCDate(),hour:c.getUTCHours(),minute:c.getUTCMinutes(),second:c.getUTCSeconds(),millisecond:c.getUTCMilliseconds(),microsecond:v,nanosecond:g}}function wE(i,n){const{epochMilliseconds:a,millisecond:h,microsecond:p,nanosecond:v}=xE(n),{year:g,month:c,day:A,hour:D,minute:N,second:L}=function(V,$){const J=uE(V).format(new Date($));return function(fe){const ve=fe.split(/[^\w]+/);if(ve.length!==7)throw new RangeError(`expected 7 parts in "${fe}`);const Ce=+ve[0],Me=+ve[1];let Te=+ve[2];const De=ve[3].toUpperCase();if(De==="B"||De==="BC")Te=1-Te;else if(De!=="A"&&De!=="AD")throw new RangeError(`Unknown era ${De} in "${fe}`);let Ne=+ve[4];Ne===24&&(Ne=0);const je=+ve[5],ye=+ve[6];if(!(Eo(Te)&&Eo(Ce)&&Eo(Me)&&Eo(Ne)&&Eo(je)&&Eo(ye)))throw new RangeError(`Invalid number in "${fe}`);return{year:Te,month:Ce,day:Me,hour:Ne,minute:je,second:ye}}(J)}(i,a);return kx(g,c,A,D,N,L,h,p,v)}function Rw(i,n){return z.lessThan(i,n)?n:i}function TE(){return z.add(jx(),RR)}function EE(i,n){if(z.lessThan(n,_g))return EE(i,_g);const a=z.add(n,lE),h=Rw(TE(),a);let p=Rw(_g,n);const v=ad(i,p);let g=p,c=v;for(;v===c&&z.lessThan(z.BigInt(p),h);){if(g=z.add(p,cE),z.greaterThan(g,kg))return null;c=ad(i,g),v===c&&(p=g)}return v===c?null:LE(A=>ad(i,A),p,g,v,c)}function Ub(i,n){const a=TE(),h=z.greaterThan(n,a),p=h?z.subtract(n,lE):_g;if(i==="Africa/Casablanca"||i==="Africa/El_Aaiun"){const D=k(Wc("2088-01-01T00Z"),cn);if(z.lessThan(D,n))return Ub(i,D)}let v=z.subtract(n,Zg);if(z.lessThan(v,_g))return null;const g=ad(i,v);let c=v,A=g;for(;g===A&&z.greaterThan(v,p);){if(c=z.subtract(v,cE),z.lessThan(c,_g))return null;A=ad(i,c),g===A&&(v=c)}if(g===A){if(h){const D=z.subtract(a,Ku);return Ub(i,D)}return null}return LE(D=>ad(i,D),c,v,A,g)}function Nf(i){return i===void 0?!1:i%4==0&&(i%100!=0||i%400==0)}function od(i,n){return{standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]}[Nf(i)?"leapyear":"standard"][n-1]}function Vb(i,n,a){const h=n+(n<3?10:-2),p=i-(n<3?1:0),v=_s(p/100),g=p-100*v,c=(a+_s(2.6*h-.2)+(g+_s(g/4))+(_s(v/4)-2*v))%7;return c+(c<=0?7:0)}function Q0(i,n,a){let h=a;for(let p=n-1;p>0;p--)h+=od(i,p);return h}function Nw(i,n,a){const h=Q0(i,n,a),p=Vb(i,n,a)||7,v=Vb(i,1,1),g=_s((h-p+10)/7);return g<1?v===5||v===6&&Nf(i-1)?{week:53,year:i-1}:{week:52,year:i-1}:g===53&&(Nf(i)?366:365)-h<4-p?{week:1,year:i+1}:{week:g,year:i}}function Qu(i,n,a,h,p,v,g,c,A,D){for(const N of[i,n,a,h,p,v,g,c,A,D])if(N!==0)return N<0?-1:1;return 0}function I0(i,n){let a=i,h=n;if(!Eo(a)||!Eo(h))throw new RangeError("infinity is out of range");return h-=1,a+=_s(h/12),h%=12,h<0&&(h+=12),h+=1,{year:a,month:h}}function Cv(i,n,a){let h=i,p=n,v=a;if(!Eo(v))throw new RangeError("infinity is out of range");({year:h,month:p}=I0(h,p));const g=146097;if($i(v)>g){const D=Kp(v/g);h+=400*D,v-=D*g}let c=0,A=p>2?h:h-1;for(;c=Nf(A)?366:365,v<-c;)h-=1,A-=1,v+=c;for(A+=1;c=Nf(A)?366:365,v>c;)h+=1,A+=1,v-=c;for(;v<1;)({year:h,month:p}=I0(h,p-1)),v+=od(h,p);for(;v>od(h,p);)v-=od(h,p),{year:h,month:p}=I0(h,p+1);return{year:h,month:p,day:v}}function kx(i,n,a,h,p,v,g,c,A){const{deltaDays:D,hour:N,minute:L,second:F,millisecond:V,microsecond:$,nanosecond:J}=Qh(h,p,v,g,c,A),{year:ae,month:fe,day:ve}=Cv(i,n,a+D);return{year:ae,month:fe,day:ve,hour:N,minute:L,second:F,millisecond:V,microsecond:$,nanosecond:J}}function Qh(i,n,a,h,p,v){let g,c=z.BigInt(i),A=z.BigInt(n),D=z.BigInt(a),N=z.BigInt(h),L=z.BigInt(p),F=z.BigInt(v);return{quotient:g,remainder:F}=Hp(F,ti),L=z.add(L,g),{quotient:g,remainder:L}=Hp(L,ti),N=z.add(N,g),{quotient:g,remainder:N}=Hp(N,ti),D=z.add(D,g),{quotient:g,remainder:D}=Hp(D,Xu),A=z.add(A,g),{quotient:g,remainder:A}=Hp(A,Xu),c=z.add(c,g),{quotient:g,remainder:c}=Hp(c,aE),{deltaDays:z.toNumber(g),hour:z.toNumber(c),minute:z.toNumber(A),second:z.toNumber(D),millisecond:z.toNumber(N),microsecond:z.toNumber(L),nanosecond:z.toNumber(F)}}function Og(i,n,a,h,p,v,g,c){const A=z.BigInt(i);let D=z.BigInt(g);i!==0&&(D=z.subtract(z.BigInt(g),z.BigInt(c)));const N=z.add(z.BigInt(n),z.multiply(A,z.BigInt(24))),L=z.add(z.BigInt(a),z.multiply(N,Xu)),F=z.add(z.BigInt(h),z.multiply(L,Xu)),V=z.add(z.BigInt(p),z.multiply(F,ti)),$=z.add(z.BigInt(v),z.multiply(V,ti));return z.add(z.BigInt(D),z.multiply($,ti))}function Rx(i,n){const a=Ct("%Temporal.Instant%"),h=Ig(z.toNumber(i));let p=z.BigInt(i),v=864e11;if(h===0)return{days:0,nanoseconds:Sr,dayLengthNs:v};if(!Qt(n)){let Ce;return{quotient:Ce,remainder:p}=Vr(p,z.BigInt(v)),{days:z.toNumber(Ce),nanoseconds:p,dayLengthNs:v}}const g=k(n,cn),c=k(n,Qa),A=z.add(g,p),D=new a(A),N=k(n,fi),L=k(n,Xe),F=Us(N,c,L),V=Us(N,D,L);let{days:$}=Ox(k(F,Gt),k(F,$t),k(F,Ht),k(F,yn),k(F,_n),k(F,vn),k(F,bn),k(F,xn),k(F,wn),k(V,Gt),k(V,$t),k(V,Ht),k(V,yn),k(V,_n),k(V,vn),k(V,bn),k(V,xn),k(V,wn),L,"day",Ja(null)),J=ml(c,N,L,0,0,0,$,0,0,0,0,0,0),ae=z.BigInt($);if(h===1)for(;z.greaterThan(ae,Sr)&&z.greaterThan(J,A);)ae=z.subtract(ae,Zg),J=ml(c,N,L,0,0,0,z.toNumber(ae),0,0,0,0,0,0);p=z.subtract(A,J);let fe=!1,ve=new a(J);do{const Ce=ml(ve,N,L,0,0,0,h,0,0,0,0,0,0),Me=k(ve,cn);v=z.toNumber(z.subtract(Ce,Me)),fe=z.greaterThanOrEqual(z.multiply(z.subtract(p,z.BigInt(v)),z.BigInt(h)),Sr),fe&&(p=z.subtract(p,z.BigInt(v)),ve=new a(Ce),ae=z.add(ae,z.BigInt(h)))}while(fe);if(!dl(ae)&&vw(ae)!==h)throw new RangeError("Time zone or calendar converted nanoseconds into a number of days with the opposite sign");if(!dl(p)&&vw(p)!==h)throw Z0(p)&&h===1?new Error("assert not reached"):new RangeError("Time zone or calendar ended up with a remainder of nanoseconds with the opposite sign");if(z.greaterThanOrEqual(Xc(p),Xc(z.BigInt(v))))throw new Error("assert not reached");return{days:z.toNumber(ae),nanoseconds:p,dayLengthNs:$i(v)}}function ic(i,n,a,h,p,v,g,c,A){let D=SE(i,n,a,h,p,v,g,c,A);if(D==="positive overflow"||D==="negative overflow")throw new RangeError("Duration out of range");return D}function SE(i,n,a,h,p,v,g,c,A){let D,N,L,F,V,$,J=i;if(Qt(A)){const Ne=ml(k(A,Qa),k(A,fi),k(A,Xe),0,0,0,J,n,a,h,p,v,g),je=k(A,cn);D=z.subtract(Ne,je)}else D=Og(J,n,a,h,p,v,g,0);c==="year"||c==="month"||c==="week"||c==="day"?{days:J,nanoseconds:D}=Rx(D,A):J=0;const ae=z.lessThan(D,Sr)?-1:1;switch(D=Xc(D),N=L=F=V=$=Sr,c){case"year":case"month":case"week":case"day":case"hour":({quotient:N,remainder:D}=Vr(D,ti)),{quotient:L,remainder:N}=Vr(N,ti),{quotient:F,remainder:L}=Vr(L,ti),{quotient:V,remainder:F}=Vr(F,Xu),{quotient:$,remainder:V}=Vr(V,Xu);break;case"minute":({quotient:N,remainder:D}=Vr(D,ti)),{quotient:L,remainder:N}=Vr(N,ti),{quotient:F,remainder:L}=Vr(L,ti),{quotient:V,remainder:F}=Vr(F,Xu);break;case"second":({quotient:N,remainder:D}=Vr(D,ti)),{quotient:L,remainder:N}=Vr(N,ti),{quotient:F,remainder:L}=Vr(L,ti);break;case"millisecond":({quotient:N,remainder:D}=Vr(D,ti)),{quotient:L,remainder:N}=Vr(N,ti);break;case"microsecond":({quotient:N,remainder:D}=Vr(D,ti));break;case"nanosecond":break;default:throw new Error("assert not reached")}const fe=z.toNumber($)*ae,ve=z.toNumber(V)*ae,Ce=z.toNumber(F)*ae,Me=z.toNumber(L)*ae,Te=z.toNumber(N)*ae,De=z.toNumber(D)*ae;for(const Ne of[J,fe,ve,Ce,Me,Te,De])if(!Eo(Ne))return ae===1?"positive overflow":"negative overflow";return{days:J,hours:fe,minutes:ve,seconds:Ce,milliseconds:Me,microseconds:Te,nanoseconds:De}}function T0(i,n,a,h,p,v){const g=Ct("%Temporal.Duration%"),c=Qu(i,n,a,h,0,0,0,0,0,0);if(c===0)return{years:i,months:n,weeks:a,days:h};const A=z.BigInt(c);let D,N,L=z.BigInt(i),F=z.BigInt(n),V=z.BigInt(a),$=z.BigInt(h);v&&(N=xi(v),D=k(N,Xe));const J=new g(c),ae=new g(0,c),fe=new g(0,0,c);switch(p){case"year":break;case"month":{if(!D)throw new RangeError("a starting point is required for months balancing");let ve,Ce;for(typeof D!="string"&&(ve=ri(D,"dateAdd"),Ce=ri(D,"dateUntil"));!dl(L);){const Me=Oa(D,N,J,void 0,ve),Te=Ja(null);Te.largestUnit="month";const De=If(D,N,Me,Te,Ce),Ne=z.BigInt(k(De,Ta));N=Me,F=z.add(F,Ne),L=z.subtract(L,A)}}break;case"week":{if(!D)throw new RangeError("a starting point is required for weeks balancing");const ve=typeof D!="string"?ri(D,"dateAdd"):void 0;for(;!dl(L);){let Ce;({relativeTo:N,days:Ce}=Xa(D,N,J,ve)),$=z.add($,z.BigInt(Ce)),L=z.subtract(L,A)}for(;!dl(F);){let Ce;({relativeTo:N,days:Ce}=Xa(D,N,ae,ve)),$=z.add($,z.BigInt(Ce)),F=z.subtract(F,A)}break}default:{if(dl(L)&&dl(F)&&dl(V))break;if(!D)throw new RangeError("a starting point is required for balancing calendar units");const ve=typeof D!="string"?ri(D,"dateAdd"):void 0;for(;!dl(L);){let Ce;({relativeTo:N,days:Ce}=Xa(D,N,J,ve)),$=z.add($,z.BigInt(Ce)),L=z.subtract(L,A)}for(;!dl(F);){let Ce;({relativeTo:N,days:Ce}=Xa(D,N,ae,ve)),$=z.add($,z.BigInt(Ce)),F=z.subtract(F,A)}for(;!dl(V);){let Ce;({relativeTo:N,days:Ce}=Xa(D,N,fe,ve)),$=z.add($,z.BigInt(Ce)),V=z.subtract(V,A)}break}}return{years:z.toNumber(L),months:z.toNumber(F),weeks:z.toNumber(V),days:z.toNumber($)}}function Pw(i,n,a,h,p){if(Qt(i)){const v=k(i,Qa),g=k(i,fi),c=k(i,Xe),A=Jc(g,v),D=ml(v,g,c,n,a,h,p,0,0,0,0,0,0);return Jc(g,new(Ct("%Temporal.Instant%"))(D))-A}return 0}function AE(i){return new(Ct("%Temporal.Duration%"))(-k(i,go),-k(i,Ta),-k(i,Xo),-k(i,yo),-k(i,_o),-k(i,vo),-k(i,bo),-k(i,xo),-k(i,wo),-k(i,To))}function ys(i,n,a){return SR(a,AR(n,i))}function CE(i,n,a){const h=ys(n,1,12);return{year:i,month:h,day:ys(a,1,od(i,h))}}function La(i,n,a){if(i<n||i>a)throw new RangeError(`value out of range: ${n} <= ${i} <= ${a}`)}function Ju(i,n,a){La(n,1,12),La(a,1,od(i,n))}function ME(i,n,a){DE(i,n,a,12,0,0,0,0,0)}function Mv(i,n,a,h,p,v){La(i,0,23),La(n,0,59),La(a,0,59),La(h,0,999),La(p,0,999),La(v,0,999)}function Nx(i,n,a,h,p,v,g,c,A){Ju(i,n,a),Mv(h,p,v,g,c,A)}function DE(i,n,a,h,p,v,g,c,A){if(La(i,V0,G0),i===V0&&Rf(i,n,a+1,h,p,v,g,c,A-1)==null||i===G0&&Rf(i,n,a-1,h,p,v,g,c,A+1)==null)throw new RangeError("DateTime outside of supported range")}function Xp(i){if(z.lessThan(i,c_)||z.greaterThan(i,kg))throw new RangeError("Instant outside of supported range")}function K0(i,n,a,h,p,v,g,c,A,D){const N=Qu(i,n,a,h,p,v,g,c,A,D);for(const L of[i,n,a,h,p,v,g,c,A,D]){if(!Eo(L))throw new RangeError("infinite values not allowed as duration fields");const F=Ig(L);if(F!==0&&F!==N)throw new RangeError("mixed-sign values not allowed as duration fields")}}function Px(i,n,a,h,p,v,g){switch(g){case"year":case"month":{const c=-Sf(i,n,a,h,p,v);if(c===0)return{years:0,months:0,weeks:0,days:0};const A={year:i,month:n},D={year:h,month:p,day:v};let N=D.year-A.year,L=tm(i,n,a,N,0,0,0,"constrain"),F=-Sf(L.year,L.month,L.day,h,p,v);if(F===0)return g==="year"?{years:N,months:0,weeks:0,days:0}:{years:0,months:12*N,weeks:0,days:0};let V=D.month-A.month;if(F!==c&&(N-=c,V+=12*c),L=tm(i,n,a,N,V,0,0,"constrain"),F=-Sf(L.year,L.month,L.day,h,p,v),F===0)return g==="year"?{years:N,months:V,weeks:0,days:0}:{years:0,months:V+12*N,weeks:0,days:0};F!==c&&(V-=c,V===-c&&(N-=c,V=11*c),L=tm(i,n,a,N,V,0,0,"constrain"));let $=0;return $=L.month===D.month?D.day-L.day:c<0?-L.day-(od(D.year,D.month)-D.day):D.day+(od(L.year,L.month)-L.day),g==="month"&&(V+=12*N,N=0),{years:N,months:V,weeks:0,days:$}}case"week":case"day":{let c,A,D;Sf(i,n,a,h,p,v)<0?(A={year:i,month:n,day:a},c={year:h,month:p,day:v},D=1):(A={year:h,month:p,day:v},c={year:i,month:n,day:a},D=-1);let N=Q0(c.year,c.month,c.day)-Q0(A.year,A.month,A.day);for(let F=A.year;F<c.year;++F)N+=Nf(F)?366:365;let L=0;return g==="week"&&(L=_s(N/7),N%=7),L*=D,N*=D,{years:0,months:0,weeks:L,days:N}}default:throw new Error("assert not reached")}}function IE(i,n,a,h,p,v,g,c,A,D,N,L){let F=g-i,V=c-n,$=A-a,J=D-h,ae=N-p,fe=L-v;const ve=Qu(0,0,0,0,F,V,$,J,ae,fe);F*=ve,V*=ve,$*=ve,J*=ve,ae*=ve,fe*=ve;let Ce=0;if({deltaDays:Ce,hour:F,minute:V,second:$,millisecond:J,microsecond:ae,nanosecond:fe}=Qh(F,V,$,J,ae,fe),Ce!=0)throw new Error("assertion failure in DifferenceTime: _bt_.[[Days]] should be 0");return F*=ve,V*=ve,$*=ve,J*=ve,ae*=ve,fe*=ve,{hours:F,minutes:V,seconds:$,milliseconds:J,microseconds:ae,nanoseconds:fe}}function zx(i,n,a,h,p,v){const g=z.subtract(n,i);let c=0,A=0,D=z.toNumber(z.remainder(g,ti)),N=z.toNumber(z.remainder(z.divide(g,ti),ti)),L=z.toNumber(z.remainder(z.divide(g,pl),ti)),F=z.toNumber(z.divide(g,Wu));return{hours:c,minutes:A,seconds:F,milliseconds:L,microseconds:N,nanoseconds:D}=dd(0,0,0,0,0,0,F,L,N,D,a,h,v),ic(0,c,A,F,L,N,D,p)}function Ox(i,n,a,h,p,v,g,c,A,D,N,L,F,V,$,J,ae,fe,ve,Ce,Me){let Te=i,De=n,Ne=a,{hours:je,minutes:ye,seconds:Qe,milliseconds:bt,microseconds:Ot,nanoseconds:mt}=IE(h,p,v,g,c,A,F,V,$,J,ae,fe);const Dt=Qu(0,0,0,0,je,ye,Qe,bt,Ot,mt);Sf(D,N,L,Te,De,Ne)===-Dt&&({year:Te,month:De,day:Ne}=Cv(Te,De,Ne-Dt),{hours:je,minutes:ye,seconds:Qe,milliseconds:bt,microseconds:Ot,nanoseconds:mt}=ic(-Dt,je,ye,Qe,bt,Ot,mt,Ce));const vt=_l(Te,De,Ne,ve),Ge=_l(D,N,L,ve),dt=cm("day",Ce),ot=jf(Me);ot.largestUnit=dt;let{years:Ut,months:Ie,weeks:ut,days:Bt}=If(ve,vt,Ge,ot);return{days:Bt,hours:je,minutes:ye,seconds:Qe,milliseconds:bt,microseconds:Ot,nanoseconds:mt}=ic(Bt,je,ye,Qe,bt,Ot,mt,Ce),{years:Ut,months:Ie,weeks:ut,days:Bt,hours:je,minutes:ye,seconds:Qe,milliseconds:bt,microseconds:Ot,nanoseconds:mt}}function kE(i,n,a,h,p,v){const g=z.subtract(n,i);if(z.equal(g,Sr))return{years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};const c=Ct("%Temporal.Instant%"),A=new c(i),D=new c(n),N=Us(a,A,h),L=Us(a,D,h);let{years:F,months:V,weeks:$,days:J}=Ox(k(N,Gt),k(N,$t),k(N,Ht),k(N,yn),k(N,_n),k(N,vn),k(N,bn),k(N,xn),k(N,wn),k(L,Gt),k(L,$t),k(L,Ht),k(L,yn),k(L,_n),k(L,vn),k(L,bn),k(L,xn),k(L,wn),h,p,v);const ae=ml(A,a,h,F,V,$,0,0,0,0,0,0,0);let fe=z.subtract(n,ae);const ve=za(ae,a,h);({nanoseconds:fe,days:J}=Rx(fe,ve));const{hours:Ce,minutes:Me,seconds:Te,milliseconds:De,microseconds:Ne,nanoseconds:je}=ic(0,0,0,0,0,0,z.toNumber(fe),"hour");return{years:F,months:V,weeks:$,days:J,hours:Ce,minutes:Me,seconds:Te,milliseconds:De,microseconds:Ne,nanoseconds:je}}function Xg(i,n,a,h,p,v){const g=E_.reduce((V,$)=>{const J=$[0],ae=$[1],fe=$[2];return a!=="datetime"&&fe!==a||h.includes(ae)||V.push(ae,J),V},[]);let c=vs(n,"largestUnit",a,"auto");if(h.includes(c))throw new RangeError(`largestUnit must be one of ${g.join(", ")}, not ${c}`);const A=Yg(n);let D=Kc(n,"trunc");i==="since"&&(D=function($){switch($){case"ceil":return"floor";case"floor":return"ceil";case"halfCeil":return"halfFloor";case"halfFloor":return"halfCeil";default:return $}}(D));const N=vs(n,"smallestUnit",a,p);if(h.includes(N))throw new RangeError(`smallestUnit must be one of ${g.join(", ")}, not ${N}`);const L=cm(v,N);if(c==="auto"&&(c=L),cm(c,N)!==c)throw new RangeError(`largestUnit ${c} cannot be smaller than smallestUnit ${N}`);const F={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[N];return F!==void 0&&qg(A,F,!1),{largestUnit:c,roundingIncrement:A,roundingMode:D,smallestUnit:N}}function zw(i,n,a,h){const p=i==="since"?-1:1,v=Wc(a),g=Xg(i,jf(h),"time",[],"nanosecond","second"),c=k(n,cn),A=k(v,cn);let{hours:D,minutes:N,seconds:L,milliseconds:F,microseconds:V,nanoseconds:$}=zx(c,A,g.roundingIncrement,g.smallestUnit,g.largestUnit,g.roundingMode);return new(Ct("%Temporal.Duration%"))(0,0,0,0,p*D,p*N,p*L,p*F,p*V,p*$)}function Ow(i,n,a,h){const p=i==="since"?-1:1,v=xi(a),g=k(n,Xe);Ev(g,k(v,Xe),"compute difference between dates");const c=jf(h),A=Xg(i,c,"date",[],"day","day");c.largestUnit=A.largestUnit;let{years:D,months:N,weeks:L,days:F}=If(g,n,v,c);return A.smallestUnit==="day"&&A.roundingIncrement===1||({years:D,months:N,weeks:L,days:F}=dd(D,N,L,F,0,0,0,0,0,0,A.roundingIncrement,A.smallestUnit,A.roundingMode,n)),new(Ct("%Temporal.Duration%"))(p*D,p*N,p*L,p*F,0,0,0,0,0,0)}function Lw(i,n,a,h){const p=i==="since"?-1:1,v=Jp(a),g=k(n,Xe);Ev(g,k(v,Xe),"compute difference between dates");const c=jf(h),A=Xg(i,c,"datetime",[],"nanosecond","day");let{years:D,months:N,weeks:L,days:F,hours:V,minutes:$,seconds:J,milliseconds:ae,microseconds:fe,nanoseconds:ve}=Ox(k(n,Gt),k(n,$t),k(n,Ht),k(n,yn),k(n,_n),k(n,vn),k(n,bn),k(n,xn),k(n,wn),k(v,Gt),k(v,$t),k(v,Ht),k(v,yn),k(v,_n),k(v,vn),k(v,bn),k(v,xn),k(v,wn),g,A.largestUnit,c);const Ce=zg(n);return{years:D,months:N,weeks:L,days:F,hours:V,minutes:$,seconds:J,milliseconds:ae,microseconds:fe,nanoseconds:ve}=dd(D,N,L,F,V,$,J,ae,fe,ve,A.roundingIncrement,A.smallestUnit,A.roundingMode,Ce),{days:F,hours:V,minutes:$,seconds:J,milliseconds:ae,microseconds:fe,nanoseconds:ve}=ic(F,V,$,J,ae,fe,ve,A.largestUnit),new(Ct("%Temporal.Duration%"))(p*D,p*N,p*L,p*F,p*V,p*$,p*J,p*ae,p*fe,p*ve)}function Bw(i,n,a,h){const p=i==="since"?-1:1,v=ed(a),g=Xg(i,jf(h),"time",[],"nanosecond","hour");let{hours:c,minutes:A,seconds:D,milliseconds:N,microseconds:L,nanoseconds:F}=IE(k(n,yn),k(n,_n),k(n,vn),k(n,bn),k(n,xn),k(n,wn),k(v,yn),k(v,_n),k(v,vn),k(v,bn),k(v,xn),k(v,wn));return{hours:c,minutes:A,seconds:D,milliseconds:N,microseconds:L,nanoseconds:F}=dd(0,0,0,0,c,A,D,N,L,F,g.roundingIncrement,g.smallestUnit,g.roundingMode),{hours:c,minutes:A,seconds:D,milliseconds:N,microseconds:L,nanoseconds:F}=ic(0,c,A,D,N,L,F,g.largestUnit),new(Ct("%Temporal.Duration%"))(0,0,0,0,p*c,p*A,p*D,p*N,p*L,p*F)}function jw(i,n,a,h){const p=i==="since"?-1:1,v=Xy(a),g=k(n,Xe);Ev(g,k(v,Xe),"compute difference between months");const c=jf(h),A=Xg(i,c,"date",["week","day"],"month","year");c.largestUnit=A.largestUnit;const D=Hr(g,["monthCode","year"]),N=Mn(n,D,[]);N.day=1;const L=hd(g,N),F=Mn(v,D,[]);F.day=1;const V=hd(g,F);let{years:$,months:J}=If(g,L,V,c);return A.smallestUnit==="month"&&A.roundingIncrement===1||({years:$,months:J}=dd($,J,0,0,0,0,0,0,0,0,A.roundingIncrement,A.smallestUnit,A.roundingMode,L)),new(Ct("%Temporal.Duration%"))(p*$,p*J,0,0,0,0,0,0,0,0)}function Fw(i,n,a,h){const p=i==="since"?-1:1,v=Wy(a),g=k(n,Xe);Ev(g,k(v,Xe),"compute difference between dates");const c=jf(h),A=Xg(i,c,"datetime",[],"nanosecond","hour");c.largestUnit=A.largestUnit;const D=k(n,cn),N=k(v,cn);let L,F,V,$,J,ae,fe,ve,Ce,Me;if(A.largestUnit!=="year"&&A.largestUnit!=="month"&&A.largestUnit!=="week"&&A.largestUnit!=="day")L=0,F=0,V=0,$=0,{hours:J,minutes:ae,seconds:fe,milliseconds:ve,microseconds:Ce,nanoseconds:Me}=zx(D,N,A.roundingIncrement,A.smallestUnit,A.largestUnit,A.roundingMode);else{const Te=k(n,fi);if(!_E(Te,k(v,fi)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");({years:L,months:F,weeks:V,days:$,hours:J,minutes:ae,seconds:fe,milliseconds:ve,microseconds:Ce,nanoseconds:Me}=kE(D,N,Te,g,A.largestUnit,c)),{years:L,months:F,weeks:V,days:$,hours:J,minutes:ae,seconds:fe,milliseconds:ve,microseconds:Ce,nanoseconds:Me}=dd(L,F,V,$,J,ae,fe,ve,Ce,Me,A.roundingIncrement,A.smallestUnit,A.roundingMode,n),{years:L,months:F,weeks:V,days:$,hours:J,minutes:ae,seconds:fe,milliseconds:ve,microseconds:Ce,nanoseconds:Me}=zE(L,F,V,$,J,ae,fe,ve,Ce,Me,A.roundingIncrement,A.smallestUnit,A.roundingMode,n)}return new(Ct("%Temporal.Duration%"))(p*L,p*F,p*V,p*$,p*J,p*ae,p*fe,p*ve,p*Ce,p*Me)}function tm(i,n,a,h,p,v,g,c){let A=i,D=n,N=a,L=v,F=g;return A+=h,D+=p,{year:A,month:D}=I0(A,D),{year:A,month:D,day:N}=Y0(A,D,N,c),F+=7*L,N+=F,{year:A,month:D,day:N}=Cv(A,D,N),{year:A,month:D,day:N}}function RE(i,n,a,h,p,v,g,c,A,D,N,L){let F=i,V=n,$=a,J=h,ae=p,fe=v;F+=g,V+=c,$+=A,J+=D,ae+=N,fe+=L;let ve=0;return{deltaDays:ve,hour:F,minute:V,second:$,millisecond:J,microsecond:ae,nanosecond:fe}=Qh(F,V,$,J,ae,fe),{deltaDays:ve,hour:F,minute:V,second:$,millisecond:J,microsecond:ae,nanosecond:fe}}function NE(i,n,a,h,p,v,g,c,A,D,N,L,F,V,$,J,ae,fe,ve,Ce,Me){const Te=cm(jb(i,n,a,h,p,v,g,c,A,D),jb(N,L,F,V,$,J,ae,fe,ve,Ce));let De,Ne,je,ye,Qe,bt,Ot,mt,Dt,vt;if(Me)if(On(Me)){const Ge=Ct("%Temporal.Duration%"),dt=k(Me,Xe),ot=new Ge(i,n,a,h,0,0,0,0,0,0),Ut=new Ge(N,L,F,V,0,0,0,0,0,0),Ie=typeof dt!="string"?ri(dt,"dateAdd"):void 0,ut=Oa(dt,Me,ot,void 0,Ie),Bt=Oa(dt,ut,Ut,void 0,Ie),Lt=cm("day",Te),Tt=Ja(null);Tt.largestUnit=Lt,{years:De,months:Ne,weeks:je,days:ye}=If(dt,Me,Bt,Tt),{days:ye,hours:Qe,minutes:bt,seconds:Ot,milliseconds:mt,microseconds:Dt,nanoseconds:vt}=ic(ye,z.add(z.BigInt(p),z.BigInt($)),z.add(z.BigInt(v),z.BigInt(J)),z.add(z.BigInt(g),z.BigInt(ae)),z.add(z.BigInt(c),z.BigInt(fe)),z.add(z.BigInt(A),z.BigInt(ve)),z.add(z.BigInt(D),z.BigInt(Ce)),Te)}else{const Ge=Ct("%Temporal.Instant%"),dt=k(Me,fi),ot=k(Me,Xe),Ut=ml(k(Me,Qa),dt,ot,i,n,a,h,p,v,g,c,A,D),Ie=ml(new Ge(Ut),dt,ot,N,L,F,V,$,J,ae,fe,ve,Ce);Te!=="year"&&Te!=="month"&&Te!=="week"&&Te!=="day"?(De=0,Ne=0,je=0,ye=0,{hours:Qe,minutes:bt,seconds:Ot,milliseconds:mt,microseconds:Dt,nanoseconds:vt}=zx(k(Me,cn),Ie,1,"nanosecond",Te,"halfExpand")):{years:De,months:Ne,weeks:je,days:ye,hours:Qe,minutes:bt,seconds:Ot,milliseconds:mt,microseconds:Dt,nanoseconds:vt}=kE(k(Me,cn),Ie,dt,ot,Te,Ja(null))}else{if(Te==="year"||Te==="month"||Te==="week")throw new RangeError("relativeTo is required for years, months, or weeks arithmetic");De=Ne=je=0,{days:ye,hours:Qe,minutes:bt,seconds:Ot,milliseconds:mt,microseconds:Dt,nanoseconds:vt}=ic(h+V,z.add(z.BigInt(p),z.BigInt($)),z.add(z.BigInt(v),z.BigInt(J)),z.add(z.BigInt(g),z.BigInt(ae)),z.add(z.BigInt(c),z.BigInt(fe)),z.add(z.BigInt(A),z.BigInt(ve)),z.add(z.BigInt(D),z.BigInt(Ce)),Te)}return K0(De,Ne,je,ye,Qe,bt,Ot,mt,Dt,vt),{years:De,months:Ne,weeks:je,days:ye,hours:Qe,minutes:bt,seconds:Ot,milliseconds:mt,microseconds:Dt,nanoseconds:vt}}function Gb(i,n,a,h,p,v,g){let c=Sr;c=z.add(c,z.BigInt(g)),c=z.add(c,z.multiply(z.BigInt(v),ti)),c=z.add(c,z.multiply(z.BigInt(p),pl)),c=z.add(c,z.multiply(z.BigInt(h),Wu)),c=z.add(c,z.multiply(z.BigInt(a),z.BigInt(6e10))),c=z.add(c,z.multiply(z.BigInt(n),z.BigInt(36e11)));const A=z.add(i,c);return Xp(A),A}function Zb(i,n,a,h,p,v,g,c,A,D,N,L,F,V,$,J,ae,fe,ve,Ce,Me){let Te=V,{deltaDays:De,hour:Ne,minute:je,second:ye,millisecond:Qe,microsecond:bt,nanosecond:Ot}=RE(h,p,v,g,c,A,$,J,ae,fe,ve,Ce);Te+=De;const mt=Ct("%Temporal.Duration%"),Dt=Oa(D,_l(i,n,a,D),new mt(N,L,F,Te,0,0,0,0,0,0),Me);return{year:k(Dt,Gt),month:k(Dt,$t),day:k(Dt,Ht),hour:Ne,minute:je,second:ye,millisecond:Qe,microsecond:bt,nanosecond:Ot}}function ml(i,n,a,h,p,v,g,c,A,D,N,L,F,V){const $=Ct("%Temporal.Duration%");if(Qu(h,p,v,g,0,0,0,0,0,0)===0)return Gb(k(i,cn),c,A,D,N,L,F);const J=Us(n,i,a),ae=Oa(a,_l(k(J,Gt),k(J,$t),k(J,Ht),a),new $(h,p,v,g,0,0,0,0,0,0),V),fe=gs(k(ae,Gt),k(ae,$t),k(ae,Ht),k(J,yn),k(J,_n),k(J,vn),k(J,bn),k(J,xn),k(J,wn),a);return Gb(k(So(n,fe,"compatible"),cn),c,A,D,N,L,F)}function Uw(i,n,a,h){const p=i==="subtract"?-1:1;let{years:v,months:g,weeks:c,days:A,hours:D,minutes:N,seconds:L,milliseconds:F,microseconds:V,nanoseconds:$}=ym(a);const J=D0(Fn(h));return{years:v,months:g,weeks:c,days:A,hours:D,minutes:N,seconds:L,milliseconds:F,microseconds:V,nanoseconds:$}=NE(k(n,go),k(n,Ta),k(n,Xo),k(n,yo),k(n,_o),k(n,vo),k(n,bo),k(n,xo),k(n,wo),k(n,To),p*v,p*g,p*c,p*A,p*D,p*N,p*L,p*F,p*V,p*$,J),new(Ct("%Temporal.Duration%"))(v,g,c,A,D,N,L,F,V,$)}function Vw(i,n,a){const h=i==="subtract"?-1:1,{hours:p,minutes:v,seconds:g,milliseconds:c,microseconds:A,nanoseconds:D}=function(F,V){let $=ym(F);for(const J of V)if($[J]!==0)throw new RangeError(`Duration field ${J} not supported by Temporal.Instant. Try Temporal.ZonedDateTime instead.`);return $}(a,["years","months","weeks","days"]),N=Gb(k(n,cn),h*p,h*v,h*g,h*c,h*A,h*D);return new(Ct("%Temporal.Instant%"))(N)}function Gw(i,n,a,h){const p=i==="subtract"?-1:1,{years:v,months:g,weeks:c,days:A,hours:D,minutes:N,seconds:L,milliseconds:F,microseconds:V,nanoseconds:$}=ym(a),J=Fn(h),ae=k(n,Xe),{year:fe,month:ve,day:Ce,hour:Me,minute:Te,second:De,millisecond:Ne,microsecond:je,nanosecond:ye}=Zb(k(n,Gt),k(n,$t),k(n,Ht),k(n,yn),k(n,_n),k(n,vn),k(n,bn),k(n,xn),k(n,wn),ae,p*v,p*g,p*c,p*A,p*D,p*N,p*L,p*F,p*V,p*$,J);return gs(fe,ve,Ce,Me,Te,De,Ne,je,ye,ae)}function Zw(i,n,a){const h=i==="subtract"?-1:1,{hours:p,minutes:v,seconds:g,milliseconds:c,microseconds:A,nanoseconds:D}=ym(a);let{hour:N,minute:L,second:F,millisecond:V,microsecond:$,nanosecond:J}=RE(k(n,yn),k(n,_n),k(n,vn),k(n,bn),k(n,xn),k(n,wn),h*p,h*v,h*g,h*c,h*A,h*D);return{hour:N,minute:L,second:F,millisecond:V,microsecond:$,nanosecond:J}=mv(N,L,F,V,$,J,"reject"),new(Ct("%Temporal.PlainTime%"))(N,L,F,V,$,J)}function $w(i,n,a,h){let p=ym(a);i==="subtract"&&(p={years:-p.years,months:-p.months,weeks:-p.weeks,days:-p.days,hours:-p.hours,minutes:-p.minutes,seconds:-p.seconds,milliseconds:-p.milliseconds,microseconds:-p.microseconds,nanoseconds:-p.nanoseconds});let{years:v,months:g,weeks:c,days:A,hours:D,minutes:N,seconds:L,milliseconds:F,microseconds:V,nanoseconds:$}=p;({days:A}=ic(A,D,N,L,F,V,$,"day"));const J=Fn(h),ae=k(n,Xe),fe=Hr(ae,["monthCode","year"]),ve=Mn(n,fe,[]),Ce=Ja(null);vg(Ce,ve,[]),ve.day=1;let Me=hd(ae,ve);const Te=Qu(v,g,c,A,0,0,0,0,0,0),De=ri(ae,"dateAdd"),Ne=Ct("%Temporal.Duration%");if(Te<0){const Qe=Oa(ae,Me,new Ne(0,1,0,0,0,0,0,0,0,0),void 0,De),bt=Oa(ae,Qe,new Ne(0,0,0,-1,0,0,0,0,0,0),void 0,De);Ce.day=I_(ae,bt),Me=hd(ae,Ce)}const je=new Ne(v,g,c,A,0,0,0,0,0,0),ye=jf(J);return hm(ae,Mn(Oa(ae,Me,je,J,De),fe,[]),ye)}function Yw(i,n,a,h){const p=i==="subtract"?-1:1,{years:v,months:g,weeks:c,days:A,hours:D,minutes:N,seconds:L,milliseconds:F,microseconds:V,nanoseconds:$}=ym(a),J=Fn(h),ae=k(n,fi),fe=k(n,Xe);return za(ml(k(n,Qa),ae,fe,p*v,p*g,p*c,p*A,p*D,p*N,p*L,p*F,p*V,p*$,J),ae,fe)}function Ls(i,n,a){if(z.equal(n,Zg))return i;let{quotient:h,remainder:p}=Vr(i,n);if(z.equal(p,Sr))return i;const v=z.lessThan(p,Sr)?-1:1,g=Xc(z.multiply(p,z.BigInt(2))),c=z.equal(g,n),A=z.greaterThan(g,n);switch(a){case"ceil":v>0&&(h=z.add(h,z.BigInt(v)));break;case"floor":v<0&&(h=z.add(h,z.BigInt(v)));break;case"expand":h=z.add(h,z.BigInt(v));break;case"trunc":break;case"halfCeil":(A||c&&v>0)&&(h=z.add(h,z.BigInt(v)));break;case"halfFloor":(A||c&&v<0)&&(h=z.add(h,z.BigInt(v)));break;case"halfExpand":(A||c)&&(h=z.add(h,z.BigInt(v)));break;case"halfTrunc":A&&(h=z.add(h,z.BigInt(v)));break;case"halfEven":(A||c&&z.toNumber(z.remainder(Xc(h),z.BigInt(2)))===1)&&(h=z.add(h,z.BigInt(v)))}return z.multiply(h,n)}function J0(i,n,a,h){let{remainder:p}=Hp(i,Ku);const v=z.subtract(i,p),g=Ls(p,z.BigInt(BE[a]*n),h);return z.add(v,g)}function Lx(i,n,a,h,p,v,g,c,A,D,N,L,F=864e11){const{deltaDays:V,hour:$,minute:J,second:ae,millisecond:fe,microsecond:ve,nanosecond:Ce}=Bx(h,p,v,g,c,A,D,N,L,F),{year:Me,month:Te,day:De}=Cv(i,n,a+V);return{year:Me,month:Te,day:De,hour:$,minute:J,second:ae,millisecond:fe,microsecond:ve,nanosecond:Ce}}function Bx(i,n,a,h,p,v,g,c,A,D=864e11){let N=Sr;switch(c){case"day":case"hour":N=z.BigInt(i);case"minute":N=z.add(z.multiply(N,Xu),z.BigInt(n));case"second":N=z.add(z.multiply(N,Xu),z.BigInt(a));case"millisecond":N=z.add(z.multiply(N,ti),z.BigInt(h));case"microsecond":N=z.add(z.multiply(N,ti),z.BigInt(p));case"nanosecond":N=z.add(z.multiply(N,ti),z.BigInt(v))}const L=c==="day"?D:BE[c],F=Ls(N,z.BigInt(L*g),A),V=z.toNumber(z.divide(F,z.BigInt(L)));switch(c){case"day":return{deltaDays:V,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0};case"hour":return Qh(V,0,0,0,0,0);case"minute":return Qh(i,V,0,0,0,0);case"second":return Qh(i,n,V,0,0,0);case"millisecond":return Qh(i,n,a,V,0,0);case"microsecond":return Qh(i,n,a,h,V,0);case"nanosecond":return Qh(i,n,a,h,p,V);default:throw new Error(`Invalid unit ${c}`)}}function k0(i,n){return Px(k(i,Gt),k(i,$t),k(i,Ht),k(n,Gt),k(n,$t),k(n,Ht),"day").days}function Xa(i,n,a,h){const p=Oa(i,n,a,void 0,h);return{relativeTo:p,days:k0(n,p)}}function PE(i,n,a,h,p){const v=k(i,fi),g=k(i,Xe);return za(ml(k(i,Qa),v,g,n,a,h,p,0,0,0,0,0,0),v,g)}function zE(i,n,a,h,p,v,g,c,A,D,N,L,F,V){let $=i,J=n,ae=a,fe=h,ve=p,Ce=v,Me=g,Te=c,De=A,Ne=D;if(!Qt(V)||L==="year"||L==="month"||L==="week"||L==="day"||L==="nanosecond"&&N===1)return{years:$,months:J,weeks:ae,days:fe,hours:ve,minutes:Ce,seconds:Me,milliseconds:Te,microseconds:De,nanoseconds:Ne};let je=Og(0,ve,Ce,Me,Te,De,Ne,0);const ye=Ig(z.toNumber(je)),Qe=k(V,fi),bt=k(V,Xe),Ot=ml(k(V,Qa),Qe,bt,$,J,ae,fe,0,0,0,0,0,0),mt=ml(new(Ct("%Temporal.Instant%"))(Ot),Qe,bt,0,0,0,ye,0,0,0,0,0,0),Dt=z.subtract(mt,Ot);return z.greaterThanOrEqual(z.multiply(z.subtract(je,Dt),z.BigInt(ye)),Sr)&&({years:$,months:J,weeks:ae,days:fe}=NE($,J,ae,fe,0,0,0,0,0,0,0,0,0,ye,0,0,0,0,0,0,V),je=J0(z.subtract(je,Dt),N,L,F),{hours:ve,minutes:Ce,seconds:Me,milliseconds:Te,microseconds:De,nanoseconds:Ne}=ic(0,0,0,0,0,0,z.toNumber(je),"hour")),{years:$,months:J,weeks:ae,days:fe,hours:ve,minutes:Ce,seconds:Me,milliseconds:Te,microseconds:De,nanoseconds:Ne}}function dd(i,n,a,h,p,v,g,c,A,D,N,L,F,V){let $=i,J=n,ae=a,fe=h,ve=p,Ce=v,Me=g,Te=c,De=A,Ne=z.BigInt(D);const je=Ct("%Temporal.Duration%");let ye,Qe,bt,Ot,mt=V;if(mt){if(Qt(mt))Qe=mt,mt=xi(mt);else if(!On(mt))throw new TypeError("starting point must be PlainDate or ZonedDateTime");ye=k(mt,Xe)}if(L==="year"||L==="month"||L==="week"||L==="day"){let Dt,vt,Ge;Ne=Og(0,ve,Ce,Me,Te,De,D,0),Qe&&(Dt=PE(Qe,$,J,ae,fe)),{days:vt,nanoseconds:Ne,dayLengthNs:Ge}=Rx(Ne,Dt),bt=z.BigInt(Ge),fe+=vt,ve=Ce=Me=Te=De=0}switch(L){case"year":{if(!ye)throw new RangeError("A starting point is required for years rounding");const Dt=new je($),vt=typeof ye!="string"?ri(ye,"dateAdd"):void 0,Ge=Oa(ye,mt,Dt,void 0,vt),dt=Oa(ye,mt,new je($,J,ae),void 0,vt);mt=Ge,fe+=k0(Ge,dt);const ot=Oa(ye,mt,new je(0,0,0,fe),void 0,vt),Ut=Ja(null);Ut.largestUnit="year";const Ie=If(ye,mt,ot,Ut).years;$+=Ie;const ut=mt;mt=Oa(ye,mt,new je(Ie),void 0,vt),fe-=k0(ut,mt);const Bt=new je(fe<0?-1:1);let{days:Lt}=Xa(ye,mt,Bt,vt);Lt=$i(Lt);const Tt=z.multiply(z.BigInt(Lt),bt);Ne=z.add(z.add(z.multiply(Tt,z.BigInt($)),z.multiply(z.BigInt(fe),bt)),Ne);const jt=Ls(Ne,z.multiply(Tt,z.BigInt(N)),F);Ot=Vu(Ne,Tt),$=z.toNumber(z.divide(jt,Tt)),Ne=Sr,J=ae=fe=0;break}case"month":{if(!ye)throw new RangeError("A starting point is required for months rounding");const Dt=new je($,J),vt=typeof ye!="string"?ri(ye,"dateAdd"):void 0,Ge=Oa(ye,mt,Dt,void 0,vt),dt=Oa(ye,mt,new je($,J,ae),void 0,vt);mt=Ge,fe+=k0(Ge,dt);const ot=Ig(fe),Ut=new je(0,fe<0?-1:1);let Ie;for({relativeTo:mt,days:Ie}=Xa(ye,mt,Ut,vt);$i(fe)>=$i(Ie);)J+=ot,fe-=Ie,{relativeTo:mt,days:Ie}=Xa(ye,mt,Ut,vt);Ie=$i(Ie);const ut=z.multiply(z.BigInt(Ie),bt);Ne=z.add(z.add(z.multiply(ut,z.BigInt(J)),z.multiply(z.BigInt(fe),bt)),Ne);const Bt=Ls(Ne,z.multiply(ut,z.BigInt(N)),F);Ot=Vu(Ne,ut),J=z.toNumber(z.divide(Bt,ut)),Ne=Sr,ae=fe=0;break}case"week":{if(!ye)throw new RangeError("A starting point is required for weeks rounding");const Dt=Ig(fe),vt=new je(0,0,fe<0?-1:1),Ge=typeof ye!="string"?ri(ye,"dateAdd"):void 0;let dt;for({relativeTo:mt,days:dt}=Xa(ye,mt,vt,Ge);$i(fe)>=$i(dt);)ae+=Dt,fe-=dt,{relativeTo:mt,days:dt}=Xa(ye,mt,vt,Ge);dt=$i(dt);const ot=z.multiply(z.BigInt(dt),bt);Ne=z.add(z.add(z.multiply(ot,z.BigInt(ae)),z.multiply(z.BigInt(fe),bt)),Ne);const Ut=Ls(Ne,z.multiply(ot,z.BigInt(N)),F);Ot=Vu(Ne,ot),ae=z.toNumber(z.divide(Ut,ot)),Ne=Sr,fe=0;break}case"day":{const Dt=bt;Ne=z.add(z.multiply(Dt,z.BigInt(fe)),Ne);const vt=Ls(Ne,z.multiply(Dt,z.BigInt(N)),F);Ot=Vu(Ne,Dt),fe=z.toNumber(z.divide(vt,Dt)),Ne=Sr;break}case"hour":{let vt=z.multiply(z.BigInt(ve),z.BigInt(36e11));vt=z.add(vt,z.multiply(z.BigInt(Ce),z.BigInt(6e10))),vt=z.add(vt,z.multiply(z.BigInt(Me),Wu)),vt=z.add(vt,z.multiply(z.BigInt(Te),pl)),vt=z.add(vt,z.multiply(z.BigInt(De),ti)),vt=z.add(vt,Ne),Ot=Vu(vt,z.BigInt(36e11));const Ge=Ls(vt,z.BigInt(36e11*N),F);ve=z.toNumber(z.divide(Ge,z.BigInt(36e11))),Ne=Sr,Ce=Me=Te=De=0;break}case"minute":{let vt=z.multiply(z.BigInt(Ce),z.BigInt(6e10));vt=z.add(vt,z.multiply(z.BigInt(Me),Wu)),vt=z.add(vt,z.multiply(z.BigInt(Te),pl)),vt=z.add(vt,z.multiply(z.BigInt(De),ti)),vt=z.add(vt,Ne),Ot=Vu(vt,z.BigInt(6e10));const Ge=Ls(vt,z.BigInt(6e10*N),F);Ce=z.toNumber(z.divide(Ge,z.BigInt(6e10))),Ne=Sr,Me=Te=De=0;break}case"second":{let vt=z.multiply(z.BigInt(Me),Wu);vt=z.add(vt,z.multiply(z.BigInt(Te),pl)),vt=z.add(vt,z.multiply(z.BigInt(De),ti)),vt=z.add(vt,Ne),Ot=Vu(vt,z.BigInt(1e9));const Ge=Ls(vt,z.BigInt(1e9*N),F);Me=z.toNumber(z.divide(Ge,z.BigInt(1e9))),Ne=Sr,Te=De=0;break}case"millisecond":{let vt=z.multiply(z.BigInt(Te),pl);vt=z.add(vt,z.multiply(z.BigInt(De),ti)),vt=z.add(vt,Ne),Ot=Vu(vt,z.BigInt(1e6));const Ge=Ls(vt,z.BigInt(1e6*N),F);Te=z.toNumber(z.divide(Ge,z.BigInt(1e6))),Ne=Sr,De=0;break}case"microsecond":{let vt=z.multiply(z.BigInt(De),ti);vt=z.add(vt,Ne),Ot=Vu(vt,z.BigInt(1e3));const Ge=Ls(vt,z.BigInt(1e3*N),F);De=z.toNumber(z.divide(Ge,z.BigInt(1e3))),Ne=Sr;break}case"nanosecond":Ot=z.toNumber(Ne),Ne=Ls(z.BigInt(Ne),z.BigInt(N),F)}return{years:$,months:J,weeks:ae,days:fe,hours:ve,minutes:Ce,seconds:Me,milliseconds:Te,microseconds:De,nanoseconds:z.toNumber(Ne),total:Ot}}function Sf(i,n,a,h,p,v){for(const[g,c]of[[i,h],[n,p],[a,v]])if(g!==c)return nm(g-c);return 0}function Hp(i,n){let{quotient:a,remainder:h}=Vr(i,n);return z.lessThan(h,Sr)&&(a=z.subtract(a,Zg),h=z.add(h,n)),{quotient:a,remainder:h}}function xg(i,n){const{quotient:a,remainder:h}=Vr(i,n);return dl(h)||!Z0(i)==!Z0(n)?a:z.subtract(a,Zg)}function Vu(i,n){const{quotient:a,remainder:h}=Vr(i,n);return z.toNumber(a)+z.toNumber(h)/z.toNumber(n)}function ev(i){const n=t_(i);return globalThis.BigInt!==void 0?globalThis.BigInt(n.toString(10)):n}function t_(i){let n=i;if(typeof i=="object"){const a=i[Symbol.toPrimitive];a&&typeof a=="function"&&(n=pv(a,i,["number"]))}if(typeof n=="number")throw new TypeError("cannot convert number to bigint");return typeof n=="bigint"?z.BigInt(n.toString(10)):z.BigInt(n)}const jx=(()=>{let i=z.BigInt(Date.now()%1e6);return()=>{const n=z.BigInt(Date.now()),a=z.add(z.multiply(n,pl),i);return i=z.remainder(n,pl),z.greaterThan(a,kg)?kg:z.lessThan(a,c_)?c_:a}})();function Ef(){return new rE().resolvedOptions().timeZone}function nm(i){return i<0?-1:i>0?1:i}function Fn(i){if(i===void 0)return Ja(null);if(Yi(i)&&i!==null)return i;throw new TypeError("Options parameter must be an object, not "+(i===null?"null":typeof i))}function Lg(i,n){const a=Ja(null);return a[i]=n,a}function jf(i){const n=Ja(null);return vg(n,Fn(i),[]),n}function Pf(i,n,a,h){let p=i[n];if(p!==void 0){if(p=Ao(p),!a.includes(p))throw new RangeError(`${n} must be one of ${a.join(", ")}, not ${p}`);return p}return h}function fd(i){return NR.includes(eh(i))}function eh(i){return i.replace(/[A-Z]/g,n=>{const a=n.charCodeAt(0);return String.fromCharCode(a+32)})}const OE=new RegExp(`^${tE.source}$`);function LE(i,n,a,h=i(n),p=i(a)){let v=z.BigInt(n),g=z.BigInt(a),c=h,A=p;for(;z.greaterThan(z.subtract(g,v),Zg);){const D=z.divide(z.add(v,g),z.BigInt(2)),N=i(D);if(N===c)v=D,c=N;else{if(N!==A)throw new Error(`invalid state in bisection ${c} - ${N} - ${A}`);g=D,A=N}}return g}const BE={hour:36e11,minute:6e10,second:1e9,millisecond:1e6,microsecond:1e3,nanosecond:1},jE=Symbol("date"),FE=Symbol("ym"),UE=Symbol("md"),VE=Symbol("time"),GE=Symbol("datetime"),ZE=Symbol("instant"),wg=Symbol("original"),pg=Symbol("timezone"),Kl=Symbol("calendar-id"),$E=Symbol("locale"),$b=Symbol("options"),n_=i=>({value:i,enumerable:!0,writable:!1,configurable:!0}),Tg=globalThis.Intl.DateTimeFormat,pd=Object.assign,BR=Object.prototype.hasOwnProperty,jR=Reflect.apply;function fg(i,n){let a=i[n];return typeof a=="function"&&(a=new Tg(i[$E],a(i[$b])),i[n]=a),a}function dm(i,n={}){if(!(this instanceof dm))return new dm(i,n);const a=n!==void 0,h=a?pd({},n):{},p=new Tg(i,h),v=p.resolvedOptions();if(a){const g=pd({},v);for(const c in g)jR(BR,h,[c])||delete g[c];this[$b]=g}else this[$b]=h;this[$E]=v.locale,this[wg]=p,this[pg]=v.timeZone,this[Kl]=v.calendar,this[jE]=GR,this[FE]=UR,this[UE]=VR,this[VE]=FR,this[GE]=ZR,this[ZE]=$R}Object.defineProperty(dm,"name",{writable:!0,value:"DateTimeFormat"}),dm.supportedLocalesOf=function(i,n){return Tg.supportedLocalesOf(i,n)};const ub={resolvedOptions:n_(function(){return this[wg].resolvedOptions()}),format:n_(function(n,...a){let{instant:h,formatter:p}=Eg(n,this);return h&&p?p.format(h.epochMilliseconds):this[wg].format(n,...a)}),formatRange:n_(function(n,a){if(Bg(n)||Bg(a)){if(!YE(n,a))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");const{instant:h,formatter:p}=Eg(n,this),{instant:v,formatter:g}=Eg(a,this);if(h&&v&&p&&g&&p===g)return p.formatRange(h.epochMilliseconds,v.epochMilliseconds)}return this[wg].formatRange(n,a)})};"formatToParts"in Tg.prototype&&(ub.formatToParts=n_(function(n,...a){let{instant:h,formatter:p}=Eg(n,this);return h&&p?p.formatToParts(h.epochMilliseconds):this[wg].formatToParts(n,...a)})),"formatRangeToParts"in Tg.prototype&&(ub.formatRangeToParts=n_(function(n,a){if(Bg(n)||Bg(a)){if(!YE(n,a))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");const{instant:h,formatter:p}=Eg(n,this),{instant:v,formatter:g}=Eg(a,this);if(h&&v&&p&&g&&p===g)return p.formatRangeToParts(h.epochMilliseconds,v.epochMilliseconds)}return this[wg].formatRangeToParts(n,a)})),dm.prototype=Object.create(Tg.prototype,ub),Object.defineProperty(dm,"prototype",{writable:!1,enumerable:!1,configurable:!1});const Ff=dm;function N_(i={},n={}){const a=pd({},i);for(const h of["year","month","day","hour","minute","second","weekday","dayPeriod","timeZoneName","dateStyle","timeStyle"])a[h]=h in n?n[h]:a[h],a[h]!==!1&&a[h]!==void 0||delete a[h];return a}function FR(i){let n=N_(i,{year:!1,month:!1,day:!1,weekday:!1,timeZoneName:!1,dateStyle:!1});return Ux(n)||(n=pd({},n,{hour:"numeric",minute:"numeric",second:"numeric"})),n}function UR(i){let n=N_(i,{day:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,dateStyle:!1,timeStyle:!1});return"year"in n||"month"in n||(n=pd(n,{year:"numeric",month:"numeric"})),n}function VR(i){let n=N_(i,{year:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,dateStyle:!1,timeStyle:!1});return"month"in n||"day"in n||(n=pd({},n,{month:"numeric",day:"numeric"})),n}function GR(i){let n=N_(i,{hour:!1,minute:!1,second:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});return Fx(n)||(n=pd({},n,{year:"numeric",month:"numeric",day:"numeric"})),n}function ZR(i){let n=N_(i,{timeZoneName:!1});return Ux(n)||Fx(n)||(n=pd({},n,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),n}function $R(i){let n=i;return Ux(n)||Fx(n)||(n=pd({},n,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),n}function Fx(i){return"year"in i||"month"in i||"day"in i||"weekday"in i||"dateStyle"in i}function Ux(i){return"hour"in i||"minute"in i||"second"in i||"timeStyle"in i||"dayPeriod"in i}function Bg(i){return On(i)||Er(i)||mn(i)||Qt(i)||ei(i)||la(i)||aa(i)}function YE(i,n){return!(!Bg(i)||!Bg(n))&&!(Er(i)&&!Er(n))&&!(On(i)&&!On(n))&&!(mn(i)&&!mn(n))&&!(Qt(i)&&!Qt(n))&&!(ei(i)&&!ei(n))&&!(la(i)&&!la(n))&&!(aa(i)&&!aa(n))}function Eg(i,n){const a=Ct("%Temporal.PlainDateTime%");if(Er(i)){const h=new a(1970,1,1,k(i,yn),k(i,_n),k(i,vn),k(i,bn),k(i,xn),k(i,wn),n[Kl]);return{instant:So(n[pg],h,"compatible"),formatter:fg(n,VE)}}if(ei(i)){const h=k(i,Gt),p=k(i,$t),v=k(i,Ht),g=Ba(k(i,Xe));if(g!==n[Kl])throw new RangeError(`cannot format PlainYearMonth with calendar ${g} in locale with calendar ${n[Kl]}`);const c=new a(h,p,v,12,0,0,0,0,0,g);return{instant:So(n[pg],c,"compatible"),formatter:fg(n,FE)}}if(la(i)){const h=k(i,Gt),p=k(i,$t),v=k(i,Ht),g=Ba(k(i,Xe));if(g!==n[Kl])throw new RangeError(`cannot format PlainMonthDay with calendar ${g} in locale with calendar ${n[Kl]}`);const c=new a(h,p,v,12,0,0,0,0,0,g);return{instant:So(n[pg],c,"compatible"),formatter:fg(n,UE)}}if(On(i)){const h=k(i,Gt),p=k(i,$t),v=k(i,Ht),g=Ba(k(i,Xe));if(g!=="iso8601"&&g!==n[Kl])throw new RangeError(`cannot format PlainDate with calendar ${g} in locale with calendar ${n[Kl]}`);const c=new a(h,p,v,12,0,0,0,0,0,n[Kl]);return{instant:So(n[pg],c,"compatible"),formatter:fg(n,jE)}}if(mn(i)){const h=k(i,Gt),p=k(i,$t),v=k(i,Ht),g=k(i,yn),c=k(i,_n),A=k(i,vn),D=k(i,bn),N=k(i,xn),L=k(i,wn),F=Ba(k(i,Xe));if(F!=="iso8601"&&F!==n[Kl])throw new RangeError(`cannot format PlainDateTime with calendar ${F} in locale with calendar ${n[Kl]}`);let V=i;return F==="iso8601"&&(V=new a(h,p,v,g,c,A,D,N,L,n[Kl])),{instant:So(n[pg],V,"compatible"),formatter:fg(n,GE)}}if(Qt(i))throw new TypeError("Temporal.ZonedDateTime not supported in DateTimeFormat methods. Use toLocaleString() instead.");return aa(i)?{instant:i,formatter:fg(n,ZE)}:{}}class Yc{constructor(n){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");const a=t_(n);Xp(a),ih(this),En(this,cn,a)}get epochSeconds(){if(!aa(this))throw new TypeError("invalid receiver");const n=k(this,cn);return z.toNumber(xg(n,Wu))}get epochMilliseconds(){if(!aa(this))throw new TypeError("invalid receiver");const n=z.BigInt(k(this,cn));return z.toNumber(xg(n,pl))}get epochMicroseconds(){if(!aa(this))throw new TypeError("invalid receiver");return ev(xg(z.BigInt(k(this,cn)),ti))}get epochNanoseconds(){if(!aa(this))throw new TypeError("invalid receiver");return ev(z.BigInt(k(this,cn)))}add(n){if(!aa(this))throw new TypeError("invalid receiver");return Vw("add",this,n)}subtract(n){if(!aa(this))throw new TypeError("invalid receiver");return Vw("subtract",this,n)}until(n,a){if(!aa(this))throw new TypeError("invalid receiver");return zw("until",this,n,a)}since(n,a){if(!aa(this))throw new TypeError("invalid receiver");return zw("since",this,n,a)}round(n){if(!aa(this))throw new TypeError("invalid receiver");if(n===void 0)throw new TypeError("options parameter is required");const a=typeof n=="string"?Lg("smallestUnit",n):Fn(n),h=Yg(a),p=Kc(a,"halfExpand"),v=vs(a,"smallestUnit","time",lm);qg(h,{hour:24,minute:1440,second:86400,millisecond:864e5,microsecond:864e8,nanosecond:864e11}[v],!0);const g=J0(k(this,cn),h,v,p);return new Yc(g)}equals(n){if(!aa(this))throw new TypeError("invalid receiver");const a=Wc(n),h=k(this,cn),p=k(a,cn);return z.equal(z.BigInt(h),z.BigInt(p))}toString(n){if(!aa(this))throw new TypeError("invalid receiver");const a=Fn(n),h=A_(a),p=Kc(a,"trunc"),v=vs(a,"smallestUnit","time",void 0);if(v==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');let g=a.timeZone;g!==void 0&&(g=Ka(g));const{precision:c,unit:A,increment:D}=C_(v,h),N=J0(k(this,cn),D,A,p);return Aw(new Yc(N),g,c)}toJSON(){if(!aa(this))throw new TypeError("invalid receiver");return Aw(this,void 0,"auto")}toLocaleString(n,a){if(!aa(this))throw new TypeError("invalid receiver");return new Ff(n,a).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.Instant")}toZonedDateTime(n){if(!aa(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("invalid argument in toZonedDateTime");const a=n.calendar;if(a===void 0)throw new TypeError("missing calendar property in toZonedDateTime");const h=bs(a),p=n.timeZone;if(p===void 0)throw new TypeError("missing timeZone property in toZonedDateTime");const v=Ka(p);return za(k(this,cn),v,h)}toZonedDateTimeISO(n){if(!aa(this))throw new TypeError("invalid receiver");const a=Ka(n);return za(k(this,cn),a,"iso8601")}static fromEpochSeconds(n){const a=Rg(n),h=z.multiply(z.BigInt(a),Wu);return Xp(h),new Yc(h)}static fromEpochMilliseconds(n){const a=Rg(n),h=z.multiply(z.BigInt(a),pl);return Xp(h),new Yc(h)}static fromEpochMicroseconds(n){const a=t_(n),h=z.multiply(a,ti);return Xp(h),new Yc(h)}static fromEpochNanoseconds(n){const a=t_(n);return Xp(a),new Yc(a)}static from(n){return aa(n)?new Yc(k(n,cn)):Wc(n)}static compare(n,a){const h=Wc(n),p=Wc(a),v=k(h,cn),g=k(p,cn);return z.lessThan(v,g)?-1:z.greaterThan(v,g)?1:0}}nh(Yc,"Temporal.Instant");const qE=Array.prototype.includes,YR=Array.prototype.push,qR=globalThis.Intl.DateTimeFormat,HR=Array.prototype.sort,XR=Math.abs,WR=Math.floor,hb=Object.create,Yb=Object.entries,HE=Set,qw=Reflect.ownKeys,Ha=Set.prototype.add,XE=Set.prototype.values,ir={};class wr{constructor(n){if(arguments.length<1)throw new RangeError("missing argument: id is required");const a=Ao(n);if(!fd(a))throw new RangeError(`invalid calendar identifier ${a}`);ih(this),En(this,cr,eh(a))}get id(){if(!xr(this))throw new TypeError("invalid receiver");return k(this,cr)}dateFromFields(n,a){if(!xr(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("invalid fields");const h=Fn(a),p=k(this,cr);return ir[p].dateFromFields(n,h,p)}yearMonthFromFields(n,a){if(!xr(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("invalid fields");const h=Fn(a),p=k(this,cr);return ir[p].yearMonthFromFields(n,h,p)}monthDayFromFields(n,a){if(!xr(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("invalid fields");const h=Fn(a),p=k(this,cr);return ir[p].monthDayFromFields(n,h,p)}fields(n){if(!xr(this))throw new TypeError("invalid receiver");const a=[],h=new Set(["year","month","monthCode","day","hour","minute","second","millisecond","microsecond","nanosecond"]);for(const p of n){if(typeof p!="string")throw new TypeError("invalid fields");if(!h.has(p))throw new RangeError(`invalid field name ${p}`);h.delete(p),YR.call(a,p)}return ir[k(this,cr)].fields(a)}mergeFields(n,a){if(!xr(this))throw new TypeError("invalid receiver");const h=Ew(n),p=hb(null);vg(p,h,[],[void 0]);const v=Ew(a),g=hb(null);vg(g,v,[],[void 0]);const c=qw(g),A=ir[k(this,cr)].fieldKeysToIgnore(c),D=hb(null),N=qw(p);for(const L of N){let F;F=Jt(qE,A,[L])?g[L]:p[L],F!==void 0&&(D[L]=F)}return vg(D,g,[]),D}dateAdd(n,a,h){if(!xr(this))throw new TypeError("invalid receiver");const p=xi(n),v=bg(a),g=Gr(Fn(h)),{days:c}=ic(k(v,yo),k(v,_o),k(v,vo),k(v,bo),k(v,xo),k(v,wo),k(v,To),"day"),A=k(this,cr);return ir[A].dateAdd(p,k(v,go),k(v,Ta),k(v,Xo),c,g,A)}dateUntil(n,a,h){if(!xr(this))throw new TypeError("invalid receiver");const p=xi(n),v=xi(a);let g=vs(Fn(h),"largestUnit","date","auto");g==="auto"&&(g="day");const{years:c,months:A,weeks:D,days:N}=ir[k(this,cr)].dateUntil(p,v,g);return new(Ct("%Temporal.Duration%"))(c,A,D,N,0,0,0,0,0,0)}year(n){let a=n;if(!xr(this))throw new TypeError("invalid receiver");return ei(a)||(a=xi(a)),ir[k(this,cr)].year(a)}month(n){let a=n;if(!xr(this))throw new TypeError("invalid receiver");if(la(a))throw new TypeError("use monthCode on PlainMonthDay instead");return ei(a)||(a=xi(a)),ir[k(this,cr)].month(a)}monthCode(n){let a=n;if(!xr(this))throw new TypeError("invalid receiver");return ei(a)||la(a)||(a=xi(a)),ir[k(this,cr)].monthCode(a)}day(n){let a=n;if(!xr(this))throw new TypeError("invalid receiver");return la(a)||(a=xi(a)),ir[k(this,cr)].day(a)}era(n){let a=n;if(!xr(this))throw new TypeError("invalid receiver");return ei(a)||(a=xi(a)),ir[k(this,cr)].era(a)}eraYear(n){let a=n;if(!xr(this))throw new TypeError("invalid receiver");return ei(a)||(a=xi(a)),ir[k(this,cr)].eraYear(a)}dayOfWeek(n){if(!xr(this))throw new TypeError("invalid receiver");const a=xi(n);return ir[k(this,cr)].dayOfWeek(a)}dayOfYear(n){if(!xr(this))throw new TypeError("invalid receiver");const a=xi(n);return ir[k(this,cr)].dayOfYear(a)}weekOfYear(n){if(!xr(this))throw new TypeError("invalid receiver");const a=xi(n);return ir[k(this,cr)].weekOfYear(a)}yearOfWeek(n){if(!xr(this))throw new TypeError("invalid receiver");const a=xi(n);return ir[k(this,cr)].yearOfWeek(a)}daysInWeek(n){if(!xr(this))throw new TypeError("invalid receiver");const a=xi(n);return ir[k(this,cr)].daysInWeek(a)}daysInMonth(n){let a=n;if(!xr(this))throw new TypeError("invalid receiver");return ei(a)||(a=xi(a)),ir[k(this,cr)].daysInMonth(a)}daysInYear(n){let a=n;if(!xr(this))throw new TypeError("invalid receiver");return ei(a)||(a=xi(a)),ir[k(this,cr)].daysInYear(a)}monthsInYear(n){let a=n;if(!xr(this))throw new TypeError("invalid receiver");return ei(a)||(a=xi(a)),ir[k(this,cr)].monthsInYear(a)}inLeapYear(n){let a=n;if(!xr(this))throw new TypeError("invalid receiver");return ei(a)||(a=xi(a)),ir[k(this,cr)].inLeapYear(a)}toString(){if(!xr(this))throw new TypeError("invalid receiver");return k(this,cr)}toJSON(){if(!xr(this))throw new TypeError("invalid receiver");return k(this,cr)}static from(n){return Hg(bs(n))}}function Vx(i){if(!i.startsWith("M"))throw new RangeError(`Invalid month code: ${i}.  Month codes must start with M.`);const n=+i.slice(1);if(isNaN(n))throw new RangeError(`Invalid month code: ${i}`);return n}function sd(i,n=!1){return`M${i.toString().padStart(2,"0")}${n?"L":""}`}function R0(i,n,a=12){let{month:h,monthCode:p}=i;if(p===void 0){if(h===void 0)throw new TypeError("Either month or monthCode are required");n==="reject"&&La(h,1,a),n==="constrain"&&(h=ys(h,1,a)),p=sd(h)}else{const v=Vx(p);if(h!==void 0&&h!==v)throw new RangeError(`monthCode ${p} and month ${h} must match if both are present`);if(p!==sd(v))throw new RangeError(`Invalid month code: ${p}`);if(h=v,h<1||h>a)throw new RangeError(`Invalid monthCode: ${p}`)}return{...i,month:h,monthCode:p}}nh(wr,"Temporal.Calendar"),ur("Temporal.Calendar.from",wr.from),ur("Temporal.Calendar.prototype.dateAdd",wr.prototype.dateAdd),ur("Temporal.Calendar.prototype.dateFromFields",wr.prototype.dateFromFields),ur("Temporal.Calendar.prototype.dateUntil",wr.prototype.dateUntil),ur("Temporal.Calendar.prototype.day",wr.prototype.day),ur("Temporal.Calendar.prototype.dayOfWeek",wr.prototype.dayOfWeek),ur("Temporal.Calendar.prototype.dayOfYear",wr.prototype.dayOfYear),ur("Temporal.Calendar.prototype.daysInMonth",wr.prototype.daysInMonth),ur("Temporal.Calendar.prototype.daysInWeek",wr.prototype.daysInWeek),ur("Temporal.Calendar.prototype.daysInYear",wr.prototype.daysInYear),ur("Temporal.Calendar.prototype.era",wr.prototype.era),ur("Temporal.Calendar.prototype.eraYear",wr.prototype.eraYear),ur("Temporal.Calendar.prototype.fields",wr.prototype.fields),ur("Temporal.Calendar.prototype.inLeapYear",wr.prototype.inLeapYear),ur("Temporal.Calendar.prototype.mergeFields",wr.prototype.mergeFields),ur("Temporal.Calendar.prototype.month",wr.prototype.month),ur("Temporal.Calendar.prototype.monthCode",wr.prototype.monthCode),ur("Temporal.Calendar.prototype.monthDayFromFields",wr.prototype.monthDayFromFields),ur("Temporal.Calendar.prototype.monthsInYear",wr.prototype.monthsInYear),ur("Temporal.Calendar.prototype.weekOfYear",wr.prototype.weekOfYear),ur("Temporal.Calendar.prototype.year",wr.prototype.year),ur("Temporal.Calendar.prototype.yearMonthFromFields",wr.prototype.yearMonthFromFields),ur("Temporal.Calendar.prototype.yearOfWeek",wr.prototype.yearOfWeek),ir.iso8601={dateFromFields(i,n,a){let h=Mn(i,["day","month","monthCode","year"],["year","day"]);const p=Gr(n);h=R0(h);let{year:v,month:g,day:c}=h;return{year:v,month:g,day:c}=Y0(v,g,c,p),_l(v,g,c,a)},yearMonthFromFields(i,n,a){let h=Mn(i,["month","monthCode","year"],["year"]);const p=Gr(n);h=R0(h);let{year:v,month:g}=h;return{year:v,month:g}=function(A,D,N){let L=A,F=D;switch(N){case"reject":Ju(L,F,1);break;case"constrain":({year:L,month:F}=CE(L,F))}return{year:L,month:F}}(v,g,p),h_(v,g,a,1)},monthDayFromFields(i,n,a){let h=Mn(i,["day","month","monthCode","year"],["day"]);const p=Gr(n);if(h.month!==void 0&&h.year===void 0&&h.monthCode===void 0)throw new TypeError("either year or monthCode required with month");const v=h.monthCode===void 0;h=R0(h);let{month:g,day:c,year:A}=h;return{month:g,day:c}=Y0(v?A:1972,g,c,p),u_(g,c,a,1972)},fields:i=>i,fieldKeysToIgnore(i){const n=new HE;for(let a=0;a<i.length;a++){const h=i[a];Jt(Ha,n,[h]),h==="month"?Jt(Ha,n,["monthCode"]):h==="monthCode"&&Jt(Ha,n,["month"])}return[...Jt(XE,n,[])]},dateAdd(i,n,a,h,p,v,g){let c=k(i,Gt),A=k(i,$t),D=k(i,Ht);return{year:c,month:A,day:D}=tm(c,A,D,n,a,h,p,v),_l(c,A,D,g)},dateUntil:(i,n,a)=>Px(k(i,Gt),k(i,$t),k(i,Ht),k(n,Gt),k(n,$t),k(n,Ht),a),year:i=>k(i,Gt),era(){},eraYear(){},month:i=>k(i,$t),monthCode:i=>sd(k(i,$t)),day:i=>k(i,Ht),dayOfWeek:i=>Vb(k(i,Gt),k(i,$t),k(i,Ht)),dayOfYear:i=>Q0(k(i,Gt),k(i,$t),k(i,Ht)),weekOfYear:i=>Nw(k(i,Gt),k(i,$t),k(i,Ht)).week,yearOfWeek:i=>Nw(k(i,Gt),k(i,$t),k(i,Ht)).year,daysInWeek:()=>7,daysInMonth:i=>od(k(i,Gt),k(i,$t)),daysInYear(i){let n=i;return ha(n,Gt)||(n=xi(n)),Nf(k(n,Gt))?366:365},monthsInYear:()=>12,inLeapYear(i){let n=i;return ha(n,Gt)||(n=xi(n)),Nf(k(n,Gt))}};class hr{constructor(n){if(this.map=new Map,this.calls=0,this.hits=0,this.misses=0,this.now=globalThis.performance?globalThis.performance.now():Date.now(),n!==void 0){let a=0;for(const h of n.map.entries()){if(++a>hr.MAX_CACHE_ENTRIES)break;this.map.set(...h)}}}get(n){const a=this.map.get(n);return a&&(this.hits++,this.report()),this.calls++,a}set(n,a){this.map.set(n,a),this.misses++,this.report()}report(){}setObject(n){if(hr.objectMap.get(n))throw new RangeError("object already cached");hr.objectMap.set(n,this),this.report()}static getCacheForObject(n){let a=hr.objectMap.get(n);return a||(a=new hr,hr.objectMap.set(n,a)),a}}function WE({isoYear:i,isoMonth:n,isoDay:a}){return`${_m(i)}-${rr(n)}-${rr(a)}T00:00Z`}function db(i,n){return{years:i.year-n.year,months:i.month-n.month,days:i.day-n.day}}hr.objectMap=new WeakMap,hr.MAX_CACHE_ENTRIES=1e3;class Wg{constructor(){this.eraLength="short",this.hasEra=!0,this.erasBeginMidYear=!1}getFormatter(){return this.formatter===void 0&&(this.formatter=new qR(`en-US-u-ca-${this.id}`,{day:"numeric",month:"numeric",year:"numeric",era:this.eraLength,timeZone:"UTC"})),this.formatter}isoToCalendarDate(n,a){const{year:h,month:p,day:v}=n,g=JSON.stringify({func:"isoToCalendarDate",isoYear:h,isoMonth:p,isoDay:v,id:this.id}),c=a.get(g);if(c)return c;const A=this.getFormatter();let D,N;try{N=WE({isoYear:h,isoMonth:p,isoDay:v}),D=A.formatToParts(new Date(N))}catch{throw new RangeError(`Invalid ISO date: ${JSON.stringify({isoYear:h,isoMonth:p,isoDay:v})}`)}const L={};for(let{type:V,value:$}of D){if(V==="year"&&(L.eraYear=+$),V==="relatedYear"&&(L.eraYear=+$),V==="month"){const J=/^([0-9]*)(.*?)$/.exec($);if(!J||J.length!=3||!J[1]&&!J[2])throw new RangeError(`Unexpected month: ${$}`);if(L.month=J[1]?+J[1]:1,L.month<1)throw new RangeError(`Invalid month ${$} from ${N}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10527)`);if(L.month>13)throw new RangeError(`Invalid month ${$} from ${N}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10529)`);J[2]&&(L.monthExtra=J[2])}V==="day"&&(L.day=+$),this.hasEra&&V==="era"&&$!=null&&$!==""&&($=$.split(" (")[0],L.era=$.normalize("NFD").replace(/[^-0-9 \p{L}]/gu,"").replace(" ","-").toLowerCase())}if(L.eraYear===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);if(this.reviseIntlEra){const{era:V,eraYear:$}=this.reviseIntlEra(L,n);L.era=V,L.eraYear=$}this.checkIcuBugs&&this.checkIcuBugs(n);const F=this.adjustCalendarDate(L,a,"constrain",!0);if(F.year===void 0)throw new RangeError(`Missing year converting ${JSON.stringify(n)}`);if(F.month===void 0)throw new RangeError(`Missing month converting ${JSON.stringify(n)}`);if(F.day===void 0)throw new RangeError(`Missing day converting ${JSON.stringify(n)}`);return a.set(g,F),["constrain","reject"].forEach(V=>{const $=JSON.stringify({func:"calendarToIsoDate",year:F.year,month:F.month,day:F.day,overflow:V,id:this.id});a.set($,n)}),F}validateCalendarDate(n){const{era:a,month:h,year:p,day:v,eraYear:g,monthCode:c,monthExtra:A}=n;if(A!==void 0)throw new RangeError("Unexpected `monthExtra` value");if(p===void 0&&g===void 0)throw new TypeError("year or eraYear is required");if(h===void 0&&c===void 0)throw new TypeError("month or monthCode is required");if(v===void 0)throw new RangeError("Missing day");if(c!==void 0){if(typeof c!="string")throw new RangeError("monthCode must be a string, not "+typeof c);if(!/^M([01]?\d)(L?)$/.test(c))throw new RangeError(`Invalid monthCode: ${c}`)}if(this.constantEra){if(a!==void 0&&a!==this.constantEra)throw new RangeError(`era must be ${this.constantEra}, not ${a}`);if(g!==void 0&&p!==void 0&&g!==p)throw new RangeError(`eraYear ${g} does not match year ${p}`)}if(this.hasEra&&n.era===void 0!=(n.eraYear===void 0))throw new RangeError("properties 'era' and 'eraYear' must be provided together")}adjustCalendarDate(n,a,h="constrain",p=!1){if(this.calendarType==="lunisolar")throw new RangeError("Override required for lunisolar calendars");let v=n;if(this.validateCalendarDate(v),this.constantEra){const{year:D,eraYear:N}=v;v={...v,era:this.constantEra,year:D!==void 0?D:N,eraYear:N!==void 0?N:D}}const g=this.monthsInYear(v,a);let{month:c,monthCode:A}=v;return{month:c,monthCode:A}=R0(v,h,g),{...v,month:c,monthCode:A}}regulateMonthDayNaive(n,a,h){const p=this.monthsInYear(n,h);let{month:v,day:g}=n;return a==="reject"?(La(v,1,p),La(g,1,this.maximumMonthLength(n))):(v=ys(v,1,p),g=ys(g,1,this.maximumMonthLength({...n,month:v}))),{...n,month:v,day:g}}calendarToIsoDate(n,a="constrain",h){const p=n;let v=this.adjustCalendarDate(n,h,a,!1);v=this.regulateMonthDayNaive(v,a,h);const{year:g,month:c,day:A}=v,D=JSON.stringify({func:"calendarToIsoDate",year:g,month:c,day:A,overflow:a,id:this.id});let N,L=h.get(D);if(L||p.year!==void 0&&p.month!==void 0&&p.day!==void 0&&(p.year!==v.year||p.month!==v.month||p.day!==v.day)&&(N=JSON.stringify({func:"calendarToIsoDate",year:p.year,month:p.month,day:p.day,overflow:a,id:this.id}),L=h.get(N),L))return L;let F=this.estimateIsoDate({year:g,month:c,day:A});const V=ve=>{let Ce=this.addDaysIso(F,ve);if(v.day>this.minimumMonthLength(v)){let Me=this.isoToCalendarDate(Ce,h);for(;Me.month!==c||Me.year!==g;){if(a==="reject")throw new RangeError(`day ${A} does not exist in month ${c} of year ${g}`);Ce=this.addDaysIso(Ce,-1),Me=this.isoToCalendarDate(Ce,h)}}return Ce};let $=0,J=this.isoToCalendarDate(F,h),ae=db(v,J);if(ae.years!==0||ae.months!==0||ae.days!==0){const ve=365*ae.years+30*ae.months+ae.days;F=this.addDaysIso(F,ve),J=this.isoToCalendarDate(F,h),ae=db(v,J),ae.years===0&&ae.months===0?F=V(ae.days):$=this.compareCalendarDates(v,J)}let fe=8;for(;$;){F=this.addDaysIso(F,$*fe);const ve=J;J=this.isoToCalendarDate(F,h);const Ce=$;if($=this.compareCalendarDates(v,J),$){if(ae=db(v,J),ae.years===0&&ae.months===0)F=V(ae.days),$=0;else if(Ce&&$!==Ce)if(fe>1)fe/=2;else{if(a==="reject")throw new RangeError(`Can't find ISO date from calendar date: ${JSON.stringify({...p})}`);this.compareCalendarDates(J,ve)>0&&(F=this.addDaysIso(F,-1)),$=0}}}if(h.set(D,F),N&&h.set(N,F),v.year===void 0||v.month===void 0||v.day===void 0||v.monthCode===void 0||this.hasEra&&(v.era===void 0||v.eraYear===void 0))throw new RangeError("Unexpected missing property");return F}temporalToCalendarDate(n,a){const h={year:k(n,Gt),month:k(n,$t),day:k(n,Ht)};return this.isoToCalendarDate(h,a)}compareCalendarDates(n,a){const h=Mn(n,["day","month","year"],["day","month","year"]),p=Mn(a,["day","month","year"],["day","month","year"]);return h.year!==p.year?nm(h.year-p.year):h.month!==p.month?nm(h.month-p.month):h.day!==p.day?nm(h.day-p.day):0}regulateDate(n,a="constrain",h){const p=this.calendarToIsoDate(n,a,h);return this.isoToCalendarDate(p,h)}addDaysIso(n,a){return tm(n.year,n.month,n.day,0,0,0,a,"constrain")}addDaysCalendar(n,a,h){const p=this.calendarToIsoDate(n,"constrain",h),v=this.addDaysIso(p,a);return this.isoToCalendarDate(v,h)}addMonthsCalendar(n,a,h,p){let v=n;const{day:g}=v;for(let c=0,A=XR(a);c<A;c++){const{month:D}=v,N=v,L=a<0?-Math.max(g,this.daysInPreviousMonth(v,p)):this.daysInMonth(v,p),F=this.calendarToIsoDate(v,"constrain",p);let V=this.addDaysIso(F,L);if(v=this.isoToCalendarDate(V,p),a>0){const $=this.monthsInYear(N,p);for(;v.month-1!=D%$;)V=this.addDaysIso(V,-1),v=this.isoToCalendarDate(V,p)}v.day!==g&&(v=this.regulateDate({...v,day:g},"constrain",p))}if(h==="reject"&&v.day!==g)throw new RangeError(`Day ${g} does not exist in resulting calendar month`);return v}addCalendar(n,{years:a=0,months:h=0,weeks:p=0,days:v=0},g,c){const{year:A,day:D,monthCode:N}=n,L=this.adjustCalendarDate({year:A+a,monthCode:N,day:D},c),F=this.addMonthsCalendar(L,h,g,c),V=v+7*p;return this.addDaysCalendar(F,V,c)}untilCalendar(n,a,h,p){let v=0,g=0,c=0,A=0;switch(h){case"day":v=this.calendarDaysUntil(n,a,p);break;case"week":{const D=this.calendarDaysUntil(n,a,p);v=D%7,g=(D-v)/7;break}case"month":case"year":{const D=this.compareCalendarDates(a,n);if(!D)return{years:0,months:0,weeks:0,days:0};const N=a.year-n.year,L=a.day-n.day;if(h==="year"&&N){let $=0;a.monthCode>n.monthCode&&($=1),a.monthCode<n.monthCode&&($=-1),$||($=Math.sign(L)),A=$*D<0?N-D:N}let F,V=A?this.addCalendar(n,{years:A},"constrain",p):n;do c+=D,F=V,V=this.addMonthsCalendar(F,D,"constrain",p),V.day!==n.day&&(V=this.regulateDate({...V,day:n.day},"constrain",p));while(this.compareCalendarDates(a,V)*D>=0);c-=D,v=this.calendarDaysUntil(F,a,p);break}}return{years:A,months:c,weeks:g,days:v}}daysInMonth(n,a){const{day:h}=n,p=this.maximumMonthLength(n),v=this.minimumMonthLength(n);if(v===p)return v;const g=h<=p-v?p:v,c=this.calendarToIsoDate(n,"constrain",a),A=this.addDaysIso(c,g),D=this.isoToCalendarDate(A,a),N=this.addDaysIso(A,-D.day);return this.isoToCalendarDate(N,a).day}daysInPreviousMonth(n,a){const{day:h,month:p,year:v}=n;let g={year:p>1?v:v-1,month:p,day:1};const c=p>1?p-1:this.monthsInYear(g,a);g={...g,month:c};const A=this.minimumMonthLength(g),D=this.maximumMonthLength(g);if(A===D)return D;const N=this.calendarToIsoDate(n,"constrain",a),L=this.addDaysIso(N,-h);return this.isoToCalendarDate(L,a).day}startOfCalendarYear(n){return{year:n.year,month:1,monthCode:"M01",day:1}}startOfCalendarMonth(n){return{year:n.year,month:n.month,day:1}}calendarDaysUntil(n,a,h){const p=this.calendarToIsoDate(n,"constrain",h),v=this.calendarToIsoDate(a,"constrain",h);return this.isoDaysUntil(p,v)}isoDaysUntil(n,a){return Px(n.year,n.month,n.day,a.year,a.month,a.day,"day").days}monthDayFromFields(n,a,h){let p,v,g,c,A,{monthCode:D,day:N}=n;if(D===void 0){let{year:V,era:$,eraYear:J}=n;if(V===void 0&&($===void 0||J===void 0))throw new TypeError("when `monthCode` is omitted, `year` (or `era` and `eraYear`) and `month` are required");({monthCode:D,day:N}=this.isoToCalendarDate(this.calendarToIsoDate(n,a,h),h))}const L=this.isoToCalendarDate({year:1972,month:12,day:31},h),F=L.monthCode>D||L.monthCode===D&&L.day>=N?L.year:L.year-1;for(let V=0;V<100;V++){const $=this.adjustCalendarDate({day:N,monthCode:D,year:F-V},h),J=this.calendarToIsoDate($,"constrain",h),ae=this.isoToCalendarDate(J,h);if({year:p,month:v,day:g}=J,ae.monthCode===D&&ae.day===N)return{month:v,day:g,year:p};a==="constrain"&&(c===void 0||ae.monthCode===c.monthCode&&ae.day>c.day)&&(c=ae,A=J)}if(a==="constrain"&&A!==void 0)return A;throw new RangeError(`No recent ${this.id} year with monthCode ${D} and day ${N}`)}}class QR extends Wg{constructor(){super(...arguments),this.id="hebrew",this.calendarType="lunisolar",this.months={Tishri:{leap:1,regular:1,monthCode:"M01",days:30},Heshvan:{leap:2,regular:2,monthCode:"M02",days:{min:29,max:30}},Kislev:{leap:3,regular:3,monthCode:"M03",days:{min:29,max:30}},Tevet:{leap:4,regular:4,monthCode:"M04",days:29},Shevat:{leap:5,regular:5,monthCode:"M05",days:30},Adar:{leap:void 0,regular:6,monthCode:"M06",days:29},"Adar I":{leap:6,regular:void 0,monthCode:"M05L",days:30},"Adar II":{leap:7,regular:void 0,monthCode:"M06",days:29},Nisan:{leap:8,regular:7,monthCode:"M07",days:30},Iyar:{leap:9,regular:8,monthCode:"M08",days:29},Sivan:{leap:10,regular:9,monthCode:"M09",days:30},Tamuz:{leap:11,regular:10,monthCode:"M10",days:29},Av:{leap:12,regular:11,monthCode:"M11",days:30},Elul:{leap:13,regular:12,monthCode:"M12",days:29}},this.hasEra=!1}inLeapYear(n){const{year:a}=n;return(7*a+1)%19<7}monthsInYear(n){return this.inLeapYear(n)?13:12}minimumMonthLength(n){return this.minMaxMonthLength(n,"min")}maximumMonthLength(n){return this.minMaxMonthLength(n,"max")}minMaxMonthLength(n,a){const{month:h,year:p}=n,v=this.getMonthCode(p,h),g=Yb(this.months).find(A=>A[1].monthCode===v);if(g===void 0)throw new RangeError(`unmatched Hebrew month: ${h}`);const c=g[1].days;return typeof c=="number"?c:c[a]}estimateIsoDate(n){const{year:a}=n;return{year:a-3760,month:1,day:1}}getMonthCode(n,a){return this.inLeapYear({year:n})?a===6?sd(5,!0):sd(a<6?a:a-1):sd(a)}adjustCalendarDate(n,a,h="constrain",p=!1){let{year:v,eraYear:g,month:c,monthCode:A,day:D,monthExtra:N}=n;if(v===void 0&&g!==void 0&&(v=g),g===void 0&&v!==void 0&&(g=v),p){if(N){const L=this.months[N];if(!L)throw new RangeError(`Unrecognized month from formatToParts: ${N}`);c=this.inLeapYear({year:v})?L.leap:L.regular}return A=this.getMonthCode(v,c),{year:v,month:c,day:D,era:void 0,eraYear:g,monthCode:A}}if(this.validateCalendarDate(n),c===void 0)if(A.endsWith("L")){if(A!=="M05L")throw new RangeError(`Hebrew leap month must have monthCode M05L, not ${A}`);if(c=6,!this.inLeapYear({year:v})){if(h==="reject")throw new RangeError(`Hebrew monthCode M05L is invalid in year ${v} which is not a leap year`);c=6,A="M06"}}else{c=Vx(A),this.inLeapYear({year:v})&&c>=6&&c++;const L=this.monthsInYear({year:v});if(c<1||c>L)throw new RangeError(`Invalid monthCode: ${A}`)}else if(h==="reject"?(La(c,1,this.monthsInYear({year:v})),La(D,1,this.maximumMonthLength({year:v,month:c}))):(c=ys(c,1,this.monthsInYear({year:v})),D=ys(D,1,this.maximumMonthLength({year:v,month:c}))),A===void 0)A=this.getMonthCode(v,c);else if(this.getMonthCode(v,c)!==A)throw new RangeError(`monthCode ${A} doesn't correspond to month ${c} in Hebrew year ${v}`);return{...n,day:D,month:c,monthCode:A,year:v,eraYear:g}}}class Qg extends Wg{constructor(){super(...arguments),this.calendarType="lunar",this.DAYS_PER_ISLAMIC_YEAR=354+11/30,this.DAYS_PER_ISO_YEAR=365.2425,this.constantEra="ah"}inLeapYear(n,a){return this.daysInMonth({year:n.year,month:12,day:1},a)===30}monthsInYear(){return 12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}estimateIsoDate(n){const{year:a}=this.adjustCalendarDate(n);return{year:WR(a*this.DAYS_PER_ISLAMIC_YEAR/this.DAYS_PER_ISO_YEAR)+622,month:1,day:1}}}class QE extends Qg{constructor(){super(...arguments),this.id="islamic"}}class KR extends Qg{constructor(){super(...arguments),this.id="islamic-umalqura"}}class JR extends Qg{constructor(){super(...arguments),this.id="islamic-tbla"}}class e3 extends Qg{constructor(){super(...arguments),this.id="islamic-civil"}}class t3 extends Qg{constructor(){super(...arguments),this.id="islamic-rgsa"}}class n3 extends Qg{constructor(){super(...arguments),this.id="islamicc"}}class i3 extends Wg{constructor(){super(...arguments),this.id="persian",this.calendarType="solar",this.constantEra="ap"}inLeapYear(n,a){return QE.prototype.inLeapYear.call(this,n,a)}monthsInYear(){return 12}minimumMonthLength(n){const{month:a}=n;return a===12?29:a<=6?31:30}maximumMonthLength(n){const{month:a}=n;return a===12?30:a<=6?31:30}estimateIsoDate(n){const{year:a}=this.adjustCalendarDate(n);return{year:a+621,month:1,day:1}}}class r3 extends Wg{constructor(){super(...arguments),this.id="indian",this.calendarType="solar",this.constantEra="saka",this.months={1:{length:30,month:3,day:22,leap:{length:31,month:3,day:21}},2:{length:31,month:4,day:21},3:{length:31,month:5,day:22},4:{length:31,month:6,day:22},5:{length:31,month:7,day:23},6:{length:31,month:8,day:23},7:{length:30,month:9,day:23},8:{length:30,month:10,day:23},9:{length:30,month:11,day:22},10:{length:30,month:12,day:22},11:{length:30,month:1,nextYear:!0,day:21},12:{length:30,month:2,nextYear:!0,day:20}},this.vulnerableToBceBug=new Date("0000-01-01T00:00Z").toLocaleDateString("en-US-u-ca-indian",{timeZone:"UTC"})!=="10/11/-79 Saka"}inLeapYear(n){return KE(n.year+78)}monthsInYear(){return 12}minimumMonthLength(n){return this.getMonthInfo(n).length}maximumMonthLength(n){return this.getMonthInfo(n).length}getMonthInfo(n){const{month:a}=n;let h=this.months[a];if(h===void 0)throw new RangeError(`Invalid month: ${a}`);return this.inLeapYear(n)&&h.leap&&(h=h.leap),h}estimateIsoDate(n){const a=this.adjustCalendarDate(n),h=this.getMonthInfo(a);return tm(a.year+78+(h.nextYear?1:0),h.month,h.day,0,0,0,a.day-1,"constrain")}checkIcuBugs(n){if(this.vulnerableToBceBug&&n.year<1)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 0001-01-01 (see https://bugs.chromium.org/p/v8/issues/detail?id=10529)`)}}function KE(i){return i%4==0&&(i%100!=0||i%400==0)}class P_ extends Wg{constructor(n,a){super(),this.calendarType="solar",this.v8IsVulnerableToJulianBug=new Date("+001001-01-01T00:00Z").toLocaleDateString("en-US-u-ca-japanese",{timeZone:"UTC"}).startsWith("12"),this.calendarIsVulnerableToJulianBug=!1,this.id=n;const{eras:h,anchorEra:p}=function(g){let c,A=g;if(A.length===0)throw new RangeError("Invalid era data: eras are required");if(A.length===1&&A[0].reverseOf)throw new RangeError("Invalid era data: anchor era cannot count years backwards");if(A.length===1&&!A[0].name)throw new RangeError("Invalid era data: at least one named era is required");if(A.filter(N=>N.reverseOf!=null).length>1)throw new RangeError("Invalid era data: only one era can count years backwards");A.forEach(N=>{if(N.isAnchor||!N.anchorEpoch&&!N.reverseOf){if(c)throw new RangeError("Invalid era data: cannot have multiple anchor eras");c=N,N.anchorEpoch={year:N.hasYearZero?0:1}}else if(!N.name)throw new RangeError("If era name is blank, it must be the anchor era")}),A=A.filter(N=>N.name),A.forEach(N=>{const{reverseOf:L}=N;if(L){const F=A.find(V=>V.name===L);if(F===void 0)throw new RangeError(`Invalid era data: unmatched reverseOf era: ${L}`);N.reverseOf=F,N.anchorEpoch=F.anchorEpoch,N.isoEpoch=F.isoEpoch}N.anchorEpoch.month===void 0&&(N.anchorEpoch.month=1),N.anchorEpoch.day===void 0&&(N.anchorEpoch.day=1)}),HR.call(A,(N,L)=>{if(N.reverseOf)return 1;if(L.reverseOf)return-1;if(!N.isoEpoch||!L.isoEpoch)throw new RangeError("Invalid era data: missing ISO epoch");return L.isoEpoch.year-N.isoEpoch.year});const D=A[A.length-1].reverseOf;if(D&&D!==A[A.length-2])throw new RangeError("Invalid era data: invalid reverse-sign era");return A.forEach((N,L)=>{N.genericName="era"+(A.length-1-L)}),{eras:A,anchorEra:c||A[0]}}(a);this.anchorEra=p,this.eras=h}inLeapYear(n){const{year:a}=this.estimateIsoDate({month:1,day:1,year:n.year});return KE(a)}monthsInYear(){return 12}minimumMonthLength(n){const{month:a}=n;return a===2?this.inLeapYear(n)?29:28:[4,6,9,11].indexOf(a)>=0?30:31}maximumMonthLength(n){return this.minimumMonthLength(n)}completeEraYear(n){const a=(c,A)=>{const D=n[c];if(D!=null&&D!=A)throw new RangeError(`Input ${c} ${D} doesn't match calculated value ${A}`)},h=c=>{let A;const D={...n,year:c},N=this.eras.find((L,F)=>{if(F===this.eras.length-1){if(L.reverseOf){if(c>0)throw new RangeError(`Signed year ${c} is invalid for era ${L.name}`);return A=L.anchorEpoch.year-c,!0}return A=c-L.anchorEpoch.year+(L.hasYearZero?0:1),!0}return this.compareCalendarDates(D,L.anchorEpoch)>=0&&(A=c-L.anchorEpoch.year+(L.hasYearZero?0:1),!0)});if(!N)throw new RangeError(`Year ${c} was not matched by any era`);return{eraYear:A,era:N.name}};let{year:p,eraYear:v,era:g}=n;if(p!=null)({eraYear:v,era:g}=h(p)),a("era",g),a("eraYear",v);else{if(v==null)throw new RangeError("Either `year` or `eraYear` and `era` are required");{const c=g===void 0?void 0:this.eras.find(A=>A.name===g||A.genericName===g);if(!c)throw new RangeError(`Era ${g} (ISO year ${v}) was not matched by any era`);if(v<1&&c.reverseOf)throw new RangeError(`Years in ${g} era must be positive, not ${p}`);p=c.reverseOf?c.anchorEpoch.year-v:v+c.anchorEpoch.year-(c.hasYearZero?0:1),a("year",p),{eraYear:v,era:g}=h(p)}}return{...n,year:p,eraYear:v,era:g}}adjustCalendarDate(n,a,h="constrain"){let p=n;const{month:v,monthCode:g}=p;return v===void 0&&(p={...p,month:Vx(g)}),this.validateCalendarDate(p),p=this.completeEraYear(p),super.adjustCalendarDate(p,a,h)}estimateIsoDate(n){const a=this.adjustCalendarDate(n),{year:h,month:p,day:v}=a,{anchorEra:g}=this;return Y0(h+g.isoEpoch.year-(g.hasYearZero?0:1),p,v,"constrain")}checkIcuBugs(n){if(this.calendarIsVulnerableToJulianBug&&this.v8IsVulnerableToJulianBug&&Sf(n.year,n.month,n.day,1582,10,15)<0)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 1582-10-15 (see https://bugs.chromium.org/p/chromium/issues/detail?id=1173158)`)}}class Gx extends P_{constructor(n,a){super(n,a)}inLeapYear(n){const{year:a}=n;return(a+1)%4==0}monthsInYear(){return 13}minimumMonthLength(n){const{month:a}=n;return a===13?this.inLeapYear(n)?6:5:30}maximumMonthLength(n){return this.minimumMonthLength(n)}}class a3 extends Gx{constructor(){super("ethioaa",[{name:"era0",isoEpoch:{year:-5492,month:7,day:17}}])}}class o3 extends Gx{constructor(){super("coptic",[{name:"era1",isoEpoch:{year:284,month:8,day:29}},{name:"era0",reverseOf:"era1"}])}}class s3 extends Gx{constructor(){super("ethiopic",[{name:"era0",isoEpoch:{year:-5492,month:7,day:17}},{name:"era1",isoEpoch:{year:8,month:8,day:27},anchorEpoch:{year:5501}}])}}class l3 extends P_{constructor(){super("roc",[{name:"minguo",isoEpoch:{year:1912,month:1,day:1}},{name:"before-roc",reverseOf:"minguo"}]),this.calendarIsVulnerableToJulianBug=!0}}class c3 extends P_{constructor(){super("buddhist",[{name:"be",hasYearZero:!0,isoEpoch:{year:-543,month:1,day:1}}]),this.calendarIsVulnerableToJulianBug=!0}}class u3 extends P_{constructor(){super("gregory",[{name:"ce",isoEpoch:{year:1,month:1,day:1}},{name:"bce",reverseOf:"ce"}])}reviseIntlEra(n){let{era:a,eraYear:h}=n;return a!=="bc"&&a!=="b"||(a="bce"),a!=="ad"&&a!=="a"||(a="ce"),{era:a,eraYear:h}}}class h3 extends P_{constructor(){super("japanese",[{name:"reiwa",isoEpoch:{year:2019,month:5,day:1},anchorEpoch:{year:2019,month:5,day:1}},{name:"heisei",isoEpoch:{year:1989,month:1,day:8},anchorEpoch:{year:1989,month:1,day:8}},{name:"showa",isoEpoch:{year:1926,month:12,day:25},anchorEpoch:{year:1926,month:12,day:25}},{name:"taisho",isoEpoch:{year:1912,month:7,day:30},anchorEpoch:{year:1912,month:7,day:30}},{name:"meiji",isoEpoch:{year:1868,month:9,day:8},anchorEpoch:{year:1868,month:9,day:8}},{name:"ce",isoEpoch:{year:1,month:1,day:1}},{name:"bce",reverseOf:"ce"}]),this.calendarIsVulnerableToJulianBug=!0,this.eraLength="long",this.erasBeginMidYear=!0}reviseIntlEra(n,a){const{era:h,eraYear:p}=n,{year:v}=a;return this.eras.find(g=>g.name===h)?{era:h,eraYear:p}:v<1?{era:"bce",eraYear:1-v}:{era:"ce",eraYear:v}}}class JE extends Wg{constructor(){super(...arguments),this.calendarType="lunisolar",this.hasEra=!1}inLeapYear(n,a){const h=this.getMonthList(n.year,a);return Yb(h).length===13}monthsInYear(n,a){return this.inLeapYear(n,a)?13:12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}getMonthList(n,a){if(n===void 0)throw new TypeError("Missing year");const h=JSON.stringify({func:"getMonthList",calendarYear:n,id:this.id}),p=a.get(h);if(p)return p;const v=this.getFormatter(),g=(ae,fe)=>{const ve=WE({isoYear:ae,isoMonth:2,isoDay:1}),Ce=new Date(ve);Ce.setUTCDate(fe+1);const Me=v.formatToParts(Ce),Te=Me.find(je=>je.type==="month").value,De=+Me.find(je=>je.type==="day").value;let Ne=Me.find(je=>je.type==="relatedYear");if(Ne===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);return Ne=+Ne.value,{calendarMonthString:Te,calendarDay:De,calendarYearToVerify:Ne}};let c=17,{calendarMonthString:A,calendarDay:D,calendarYearToVerify:N}=g(n,c);A!=="1"&&(c+=29,{calendarMonthString:A,calendarDay:D}=g(n,c)),c-=D-5;const L={};let F,V,$=1,J=!1;do({calendarMonthString:A,calendarDay:D,calendarYearToVerify:N}=g(n,c)),F&&(L[V].daysInMonth=F+30-D),N!==n?J=!0:(L[A]={monthIndex:$++},c+=30),F=D,V=A;while(!J);return L[V].daysInMonth=F+30-D,a.set(h,L),L}estimateIsoDate(n){const{year:a,month:h}=n;return{year:a,month:h>=12?12:h+1,day:1}}adjustCalendarDate(n,a,h="constrain",p=!1){let{year:v,month:g,monthExtra:c,day:A,monthCode:D,eraYear:N}=n;if(p){if(v=N,c&&c!=="bis")throw new RangeError(`Unexpected leap month suffix: ${c}`);const L=sd(g,c!==void 0),F=`${g}${c||""}`,V=this.getMonthList(v,a)[F];if(V===void 0)throw new RangeError(`Unmatched month ${F} in Chinese year ${v}`);return g=V.monthIndex,{year:v,month:g,day:A,era:void 0,eraYear:N,monthCode:L}}if(this.validateCalendarDate(n),v===void 0&&(v=N),N===void 0&&(N=v),g===void 0){const L=this.getMonthList(v,a);let F=D.replace("L","bis").slice(1);F[0]==="0"&&(F=F.slice(1));let V=L[F];if(g=V&&V.monthIndex,g===void 0&&D.endsWith("L")&&D!="M13L"&&h==="constrain"){let $=D.slice(1,-1);$[0]==="0"&&($=$.slice(1)),V=L[$],V&&(g=V.monthIndex,D=sd($))}if(g===void 0)throw new RangeError(`Unmatched month ${D} in Chinese year ${v}`)}else if(D===void 0){const L=this.getMonthList(v,a),F=Yb(L),V=F.length;h==="reject"?(La(g,1,V),La(A,1,this.maximumMonthLength())):(g=ys(g,1,V),A=ys(A,1,this.maximumMonthLength()));const $=F.find(([,J])=>J.monthIndex===g);if($===void 0)throw new RangeError(`Invalid month ${g} in Chinese year ${v}`);D=sd($[0].replace("bis",""),$[0].indexOf("bis")!==-1)}else{const L=this.getMonthList(v,a);let F=D.replace("L","bis").slice(1);F[0]==="0"&&(F=F.slice(1));const V=L[F];if(!V)throw new RangeError(`Unmatched monthCode ${D} in Chinese year ${v}`);if(g!==V.monthIndex)throw new RangeError(`monthCode ${D} doesn't correspond to month ${g} in Chinese year ${v}`)}return{...n,year:v,eraYear:N,month:g,monthCode:D,day:A}}}class d3 extends JE{constructor(){super(...arguments),this.id="chinese"}}class f3 extends JE{constructor(){super(...arguments),this.id="dangi"}}class p3{constructor(n){this.helper=n}dateFromFields(n,a,h){const p=new hr,v=Mn(n,this.fields(["day","month","monthCode","year"]),[]),g=Gr(a),{year:c,month:A,day:D}=this.helper.calendarToIsoDate(v,g,p),N=_l(c,A,D,h);return p.setObject(N),N}yearMonthFromFields(n,a,h){const p=new hr,v=Mn(n,this.fields(["month","monthCode","year"]),[]),g=Gr(a),{year:c,month:A,day:D}=this.helper.calendarToIsoDate({...v,day:1},g,p),N=h_(c,A,h,D);return p.setObject(N),N}monthDayFromFields(n,a,h){const p=new hr,v=Mn(n,this.fields(["day","month","monthCode","year"]),[]),g=Gr(a),{year:c,month:A,day:D}=this.helper.monthDayFromFields(v,g,p),N=u_(A,D,h,c);return p.setObject(N),N}fields(n){let a=n;return qE.call(a,"year")&&(a=[...a,"era","eraYear"]),a}fieldKeysToIgnore(n){const a=new HE;for(let h=0;h<n.length;h++){const p=n[h];switch(Jt(Ha,a,[p]),p){case"era":Jt(Ha,a,["eraYear"]),Jt(Ha,a,["year"]);break;case"eraYear":Jt(Ha,a,["era"]),Jt(Ha,a,["year"]);break;case"year":Jt(Ha,a,["era"]),Jt(Ha,a,["eraYear"]);break;case"month":Jt(Ha,a,["monthCode"]),this.helper.erasBeginMidYear&&(Jt(Ha,a,["era"]),Jt(Ha,a,["eraYear"]));break;case"monthCode":Jt(Ha,a,["month"]),this.helper.erasBeginMidYear&&(Jt(Ha,a,["era"]),Jt(Ha,a,["eraYear"]));break;case"day":this.helper.erasBeginMidYear&&(Jt(Ha,a,["era"]),Jt(Ha,a,["eraYear"]))}}return[...Jt(XE,a,[])]}dateAdd(n,a,h,p,v,g,c){const A=hr.getCacheForObject(n),D=this.helper.temporalToCalendarDate(n,A),N=this.helper.addCalendar(D,{years:a,months:h,weeks:p,days:v},g,A),L=this.helper.calendarToIsoDate(N,"constrain",A),{year:F,month:V,day:$}=L,J=_l(F,V,$,c);return new hr(A).setObject(J),J}dateUntil(n,a,h){const p=hr.getCacheForObject(n),v=hr.getCacheForObject(a),g=this.helper.temporalToCalendarDate(n,p),c=this.helper.temporalToCalendarDate(a,v);return this.helper.untilCalendar(g,c,h,p)}year(n){const a=hr.getCacheForObject(n);return this.helper.temporalToCalendarDate(n,a).year}month(n){const a=hr.getCacheForObject(n);return this.helper.temporalToCalendarDate(n,a).month}day(n){const a=hr.getCacheForObject(n);return this.helper.temporalToCalendarDate(n,a).day}era(n){if(!this.helper.hasEra)return;const a=hr.getCacheForObject(n);return this.helper.temporalToCalendarDate(n,a).era}eraYear(n){if(!this.helper.hasEra)return;const a=hr.getCacheForObject(n);return this.helper.temporalToCalendarDate(n,a).eraYear}monthCode(n){const a=hr.getCacheForObject(n);return this.helper.temporalToCalendarDate(n,a).monthCode}dayOfWeek(n){return ir.iso8601.dayOfWeek(n)}dayOfYear(n){const a=hr.getCacheForObject(n),h=this.helper.isoToCalendarDate(n,a),p=this.helper.startOfCalendarYear(h);return this.helper.calendarDaysUntil(p,h,a)+1}weekOfYear(n){return ir.iso8601.weekOfYear(n)}yearOfWeek(n){return ir.iso8601.yearOfWeek(n)}daysInWeek(n){return ir.iso8601.daysInWeek(n)}daysInMonth(n){const a=hr.getCacheForObject(n),h=this.helper.temporalToCalendarDate(n,a),p=this.helper.maximumMonthLength(h);if(p===this.helper.minimumMonthLength(h))return p;const v=this.helper.startOfCalendarMonth(h),g=this.helper.addMonthsCalendar(v,1,"constrain",a);return this.helper.calendarDaysUntil(v,g,a)}daysInYear(n){let a=n;ha(a,Gt)||(a=xi(a));const h=hr.getCacheForObject(a),p=this.helper.temporalToCalendarDate(a,h),v=this.helper.startOfCalendarYear(p),g=this.helper.addCalendar(v,{years:1},"constrain",h);return this.helper.calendarDaysUntil(v,g,h)}monthsInYear(n){const a=hr.getCacheForObject(n),h=this.helper.temporalToCalendarDate(n,a);return this.helper.monthsInYear(h,a)}inLeapYear(n){let a=n;ha(a,Gt)||(a=xi(a));const h=hr.getCacheForObject(a),p=this.helper.temporalToCalendarDate(a,h);return this.helper.inLeapYear(p,h)}}for(const i of[QR,i3,s3,a3,o3,d3,f3,l3,r3,c3,u3,h3,QE,KR,JR,e3,t3,n3]){const n=new i;ir[n.id]=new p3(n)}class z_{constructor(n,a,h,p="iso8601"){hE(this,Kn(n),Kn(a),Kn(h),bs(p))}get calendarId(){if(!On(this))throw new TypeError("invalid receiver");return Ba(k(this,Xe))}get era(){if(!On(this))throw new TypeError("invalid receiver");return _v(k(this,Xe),this)}get eraYear(){if(!On(this))throw new TypeError("invalid receiver");return vv(k(this,Xe),this)}get year(){if(!On(this))throw new TypeError("invalid receiver");return gv(k(this,Xe),this)}get month(){if(!On(this))throw new TypeError("invalid receiver");return yv(k(this,Xe),this)}get monthCode(){if(!On(this))throw new TypeError("invalid receiver");return D_(k(this,Xe),this)}get day(){if(!On(this))throw new TypeError("invalid receiver");return I_(k(this,Xe),this)}get dayOfWeek(){if(!On(this))throw new TypeError("invalid receiver");return Ex(k(this,Xe),this)}get dayOfYear(){if(!On(this))throw new TypeError("invalid receiver");return Sx(k(this,Xe),this)}get weekOfYear(){if(!On(this))throw new TypeError("invalid receiver");return Ax(k(this,Xe),this)}get yearOfWeek(){if(!On(this))throw new TypeError("invalid receiver");return Cx(k(this,Xe),this)}get daysInWeek(){if(!On(this))throw new TypeError("invalid receiver");return Mx(k(this,Xe),this)}get daysInMonth(){if(!On(this))throw new TypeError("invalid receiver");return bv(k(this,Xe),this)}get daysInYear(){if(!On(this))throw new TypeError("invalid receiver");return xv(k(this,Xe),this)}get monthsInYear(){if(!On(this))throw new TypeError("invalid receiver");return wv(k(this,Xe),this)}get inLeapYear(){if(!On(this))throw new TypeError("invalid receiver");return Tv(k(this,Xe),this)}with(n,a){if(!On(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("invalid argument");$g(n);const h=Fn(a),p=k(this,Xe),v=Hr(p,["day","month","monthCode","year"]);let g=Mn(this,v,[]);return g=um(p,g,Mn(n,v,"partial")),g=Mn(g,v,[]),hd(p,g,h)}withCalendar(n){if(!On(this))throw new TypeError("invalid receiver");const a=bs(n);return new z_(k(this,Gt),k(this,$t),k(this,Ht),a)}add(n,a){if(!On(this))throw new TypeError("invalid receiver");const h=bg(n),p=Fn(a);return Oa(k(this,Xe),this,h,p)}subtract(n,a){if(!On(this))throw new TypeError("invalid receiver");const h=AE(bg(n)),p=Fn(a);return Oa(k(this,Xe),this,h,p)}until(n,a){if(!On(this))throw new TypeError("invalid receiver");return Ow("until",this,n,a)}since(n,a){if(!On(this))throw new TypeError("invalid receiver");return Ow("since",this,n,a)}equals(n){if(!On(this))throw new TypeError("invalid receiver");const a=xi(n);for(const h of[Gt,$t,Ht])if(k(this,h)!==k(a,h))return!1;return R_(k(this,Xe),k(a,Xe))}toString(n){if(!On(this))throw new TypeError("invalid receiver");return Cw(this,S_(Fn(n)))}toJSON(){if(!On(this))throw new TypeError("invalid receiver");return Cw(this)}toLocaleString(n,a){if(!On(this))throw new TypeError("invalid receiver");return new Ff(n,a).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainDate")}toPlainDateTime(n){if(!On(this))throw new TypeError("invalid receiver");const a=k(this,Gt),h=k(this,$t),p=k(this,Ht),v=k(this,Xe);if(n===void 0)return gs(a,h,p,0,0,0,0,0,0,v);const g=ed(n);return gs(a,h,p,k(g,yn),k(g,_n),k(g,vn),k(g,bn),k(g,xn),k(g,wn),v)}toZonedDateTime(n){if(!On(this))throw new TypeError("invalid receiver");let a,h;if(Yi(n))if(hl(n))a=n;else{const $=n.timeZone;$===void 0?a=Ka(n):(a=Ka($),h=n.plainTime)}else a=Ka(n);const p=k(this,Gt),v=k(this,$t),g=k(this,Ht),c=k(this,Xe);let A=0,D=0,N=0,L=0,F=0,V=0;return h!==void 0&&(h=ed(h),A=k(h,yn),D=k(h,_n),N=k(h,vn),L=k(h,bn),F=k(h,xn),V=k(h,wn)),za(k(So(a,gs(p,v,g,A,D,N,L,F,V,c),"compatible"),cn),a,c)}toPlainYearMonth(){if(!On(this))throw new TypeError("invalid receiver");const n=k(this,Xe);return hm(n,Mn(this,Hr(n,["monthCode","year"]),[]))}toPlainMonthDay(){if(!On(this))throw new TypeError("invalid receiver");const n=k(this,Xe);return Pg(n,Mn(this,Hr(n,["day","monthCode"]),[]))}getISOFields(){if(!On(this))throw new TypeError("invalid receiver");return{calendar:k(this,Xe),isoDay:k(this,Ht),isoMonth:k(this,$t),isoYear:k(this,Gt)}}getCalendar(){if(!On(this))throw new TypeError("invalid receiver");return Hg(k(this,Xe))}static from(n,a){const h=Fn(a);return On(n)?(Gr(h),_l(k(n,Gt),k(n,$t),k(n,Ht),k(n,Xe))):xi(n,h)}static compare(n,a){const h=xi(n),p=xi(a);return Sf(k(h,Gt),k(h,$t),k(h,Ht),k(p,Gt),k(p,$t),k(p,Ht))}}nh(z_,"Temporal.PlainDate");class O_{constructor(n,a,h,p=0,v=0,g=0,c=0,A=0,D=0,N="iso8601"){dE(this,Kn(n),Kn(a),Kn(h),p===void 0?0:Kn(p),v===void 0?0:Kn(v),g===void 0?0:Kn(g),c===void 0?0:Kn(c),A===void 0?0:Kn(A),D===void 0?0:Kn(D),bs(N))}get calendarId(){if(!mn(this))throw new TypeError("invalid receiver");return Ba(k(this,Xe))}get year(){if(!mn(this))throw new TypeError("invalid receiver");return gv(k(this,Xe),this)}get month(){if(!mn(this))throw new TypeError("invalid receiver");return yv(k(this,Xe),this)}get monthCode(){if(!mn(this))throw new TypeError("invalid receiver");return D_(k(this,Xe),this)}get day(){if(!mn(this))throw new TypeError("invalid receiver");return I_(k(this,Xe),this)}get hour(){if(!mn(this))throw new TypeError("invalid receiver");return k(this,yn)}get minute(){if(!mn(this))throw new TypeError("invalid receiver");return k(this,_n)}get second(){if(!mn(this))throw new TypeError("invalid receiver");return k(this,vn)}get millisecond(){if(!mn(this))throw new TypeError("invalid receiver");return k(this,bn)}get microsecond(){if(!mn(this))throw new TypeError("invalid receiver");return k(this,xn)}get nanosecond(){if(!mn(this))throw new TypeError("invalid receiver");return k(this,wn)}get era(){if(!mn(this))throw new TypeError("invalid receiver");return _v(k(this,Xe),this)}get eraYear(){if(!mn(this))throw new TypeError("invalid receiver");return vv(k(this,Xe),this)}get dayOfWeek(){if(!mn(this))throw new TypeError("invalid receiver");return Ex(k(this,Xe),this)}get dayOfYear(){if(!mn(this))throw new TypeError("invalid receiver");return Sx(k(this,Xe),this)}get weekOfYear(){if(!mn(this))throw new TypeError("invalid receiver");return Ax(k(this,Xe),this)}get yearOfWeek(){if(!mn(this))throw new TypeError("invalid receiver");return Cx(k(this,Xe),this)}get daysInWeek(){if(!mn(this))throw new TypeError("invalid receiver");return Mx(k(this,Xe),this)}get daysInYear(){if(!mn(this))throw new TypeError("invalid receiver");return xv(k(this,Xe),this)}get daysInMonth(){if(!mn(this))throw new TypeError("invalid receiver");return bv(k(this,Xe),this)}get monthsInYear(){if(!mn(this))throw new TypeError("invalid receiver");return wv(k(this,Xe),this)}get inLeapYear(){if(!mn(this))throw new TypeError("invalid receiver");return Tv(k(this,Xe),this)}with(n,a){if(!mn(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("invalid argument");$g(n);const h=Fn(a),p=k(this,Xe),v=Hr(p,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);let g=Mn(this,v,[]);g=um(p,g,Mn(n,v,"partial")),g=Mn(g,v,[]);const{year:c,month:A,day:D,hour:N,minute:L,second:F,millisecond:V,microsecond:$,nanosecond:J}=M_(p,g,h);return gs(c,A,D,N,L,F,V,$,J,p)}withPlainTime(n){if(!mn(this))throw new TypeError("invalid receiver");const a=k(this,Gt),h=k(this,$t),p=k(this,Ht),v=k(this,Xe);if(n===void 0)return gs(a,h,p,0,0,0,0,0,0,v);const g=ed(n);return gs(a,h,p,k(g,yn),k(g,_n),k(g,vn),k(g,bn),k(g,xn),k(g,wn),v)}withPlainDate(n){if(!mn(this))throw new TypeError("invalid receiver");const a=xi(n),h=k(a,Gt),p=k(a,$t),v=k(a,Ht);let g=k(a,Xe);const c=k(this,yn),A=k(this,_n),D=k(this,vn),N=k(this,bn),L=k(this,xn),F=k(this,wn);return g=gE(k(this,Xe),g),gs(h,p,v,c,A,D,N,L,F,g)}withCalendar(n){if(!mn(this))throw new TypeError("invalid receiver");const a=bs(n);return new O_(k(this,Gt),k(this,$t),k(this,Ht),k(this,yn),k(this,_n),k(this,vn),k(this,bn),k(this,xn),k(this,wn),a)}add(n,a){if(!mn(this))throw new TypeError("invalid receiver");return Gw("add",this,n,a)}subtract(n,a){if(!mn(this))throw new TypeError("invalid receiver");return Gw("subtract",this,n,a)}until(n,a){if(!mn(this))throw new TypeError("invalid receiver");return Lw("until",this,n,a)}since(n,a){if(!mn(this))throw new TypeError("invalid receiver");return Lw("since",this,n,a)}round(n){if(!mn(this))throw new TypeError("invalid receiver");if(n===void 0)throw new TypeError("options parameter is required");const a=typeof n=="string"?Lg("smallestUnit",n):Fn(n),h=Yg(a),p=Kc(a,"halfExpand"),v=vs(a,"smallestUnit","time",lm,["day"]),g={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[v];qg(h,g,g===1);let c=k(this,Gt),A=k(this,$t),D=k(this,Ht),N=k(this,yn),L=k(this,_n),F=k(this,vn),V=k(this,bn),$=k(this,xn),J=k(this,wn);return{year:c,month:A,day:D,hour:N,minute:L,second:F,millisecond:V,microsecond:$,nanosecond:J}=Lx(c,A,D,N,L,F,V,$,J,h,v,p),gs(c,A,D,N,L,F,V,$,J,k(this,Xe))}equals(n){if(!mn(this))throw new TypeError("invalid receiver");const a=Jp(n);for(const h of[Gt,$t,Ht,yn,_n,vn,bn,xn,wn])if(k(this,h)!==k(a,h))return!1;return R_(k(this,Xe),k(a,Xe))}toString(n){if(!mn(this))throw new TypeError("invalid receiver");const a=Fn(n),h=S_(a),p=A_(a),v=Kc(a,"trunc"),g=vs(a,"smallestUnit","time",void 0);if(g==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:c,unit:A,increment:D}=C_(g,p);return Mw(this,c,h,{unit:A,increment:D,roundingMode:v})}toJSON(){if(!mn(this))throw new TypeError("invalid receiver");return Mw(this,"auto")}toLocaleString(n,a){if(!mn(this))throw new TypeError("invalid receiver");return new Ff(n,a).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainDateTime")}toZonedDateTime(n,a){if(!mn(this))throw new TypeError("invalid receiver");const h=Ka(n);return za(k(So(h,this,Ng(Fn(a))),cn),h,k(this,Xe))}toPlainDate(){if(!mn(this))throw new TypeError("invalid receiver");return zg(this)}toPlainYearMonth(){if(!mn(this))throw new TypeError("invalid receiver");const n=k(this,Xe);return hm(n,Mn(this,Hr(n,["monthCode","year"]),[]))}toPlainMonthDay(){if(!mn(this))throw new TypeError("invalid receiver");const n=k(this,Xe);return Pg(n,Mn(this,Hr(n,["day","monthCode"]),[]))}toPlainTime(){if(!mn(this))throw new TypeError("invalid receiver");return Dx(this)}getISOFields(){if(!mn(this))throw new TypeError("invalid receiver");return{calendar:k(this,Xe),isoDay:k(this,Ht),isoHour:k(this,yn),isoMicrosecond:k(this,xn),isoMillisecond:k(this,bn),isoMinute:k(this,_n),isoMonth:k(this,$t),isoNanosecond:k(this,wn),isoSecond:k(this,vn),isoYear:k(this,Gt)}}getCalendar(){if(!mn(this))throw new TypeError("invalid receiver");return Hg(k(this,Xe))}static from(n,a){const h=Fn(a);return mn(n)?(Gr(h),gs(k(n,Gt),k(n,$t),k(n,Ht),k(n,yn),k(n,_n),k(n,vn),k(n,bn),k(n,xn),k(n,wn),k(n,Xe))):Jp(n,h)}static compare(n,a){const h=Jp(n),p=Jp(a);for(const v of[Gt,$t,Ht,yn,_n,vn,bn,xn,wn]){const g=k(h,v),c=k(p,v);if(g!==c)return nm(g-c)}return 0}}nh(O_,"Temporal.PlainDateTime");class Af{constructor(n=0,a=0,h=0,p=0,v=0,g=0,c=0,A=0,D=0,N=0){const L=n===void 0?0:ca(n),F=a===void 0?0:ca(a),V=h===void 0?0:ca(h),$=p===void 0?0:ca(p),J=v===void 0?0:ca(v),ae=g===void 0?0:ca(g),fe=c===void 0?0:ca(c),ve=A===void 0?0:ca(A),Ce=D===void 0?0:ca(D),Me=N===void 0?0:ca(N);K0(L,F,V,$,J,ae,fe,ve,Ce,Me),ih(this),En(this,go,L),En(this,Ta,F),En(this,Xo,V),En(this,yo,$),En(this,_o,J),En(this,vo,ae),En(this,bo,fe),En(this,xo,ve),En(this,wo,Ce),En(this,To,Me)}get years(){if(!Tr(this))throw new TypeError("invalid receiver");return k(this,go)}get months(){if(!Tr(this))throw new TypeError("invalid receiver");return k(this,Ta)}get weeks(){if(!Tr(this))throw new TypeError("invalid receiver");return k(this,Xo)}get days(){if(!Tr(this))throw new TypeError("invalid receiver");return k(this,yo)}get hours(){if(!Tr(this))throw new TypeError("invalid receiver");return k(this,_o)}get minutes(){if(!Tr(this))throw new TypeError("invalid receiver");return k(this,vo)}get seconds(){if(!Tr(this))throw new TypeError("invalid receiver");return k(this,bo)}get milliseconds(){if(!Tr(this))throw new TypeError("invalid receiver");return k(this,xo)}get microseconds(){if(!Tr(this))throw new TypeError("invalid receiver");return k(this,wo)}get nanoseconds(){if(!Tr(this))throw new TypeError("invalid receiver");return k(this,To)}get sign(){if(!Tr(this))throw new TypeError("invalid receiver");return Qu(k(this,go),k(this,Ta),k(this,Xo),k(this,yo),k(this,_o),k(this,vo),k(this,bo),k(this,xo),k(this,wo),k(this,To))}get blank(){if(!Tr(this))throw new TypeError("invalid receiver");return Qu(k(this,go),k(this,Ta),k(this,Xo),k(this,yo),k(this,_o),k(this,vo),k(this,bo),k(this,xo),k(this,wo),k(this,To))===0}with(n){if(!Tr(this))throw new TypeError("invalid receiver");const a=Mn(n,["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"],"partial"),{years:h=k(this,go),months:p=k(this,Ta),weeks:v=k(this,Xo),days:g=k(this,yo),hours:c=k(this,_o),minutes:A=k(this,vo),seconds:D=k(this,bo),milliseconds:N=k(this,xo),microseconds:L=k(this,wo),nanoseconds:F=k(this,To)}=a;return new Af(h,p,v,g,c,A,D,N,L,F)}negated(){if(!Tr(this))throw new TypeError("invalid receiver");return AE(this)}abs(){if(!Tr(this))throw new TypeError("invalid receiver");return new Af(Math.abs(k(this,go)),Math.abs(k(this,Ta)),Math.abs(k(this,Xo)),Math.abs(k(this,yo)),Math.abs(k(this,_o)),Math.abs(k(this,vo)),Math.abs(k(this,bo)),Math.abs(k(this,xo)),Math.abs(k(this,wo)),Math.abs(k(this,To)))}add(n,a){if(!Tr(this))throw new TypeError("invalid receiver");return Uw("add",this,n,a)}subtract(n,a){if(!Tr(this))throw new TypeError("invalid receiver");return Uw("subtract",this,n,a)}round(n){if(!Tr(this))throw new TypeError("invalid receiver");if(n===void 0)throw new TypeError("options parameter is required");let a=k(this,go),h=k(this,Ta),p=k(this,Xo),v=k(this,yo),g=k(this,_o),c=k(this,vo),A=k(this,bo),D=k(this,xo),N=k(this,wo),L=k(this,To),F=jb(a,h,p,v,g,c,A,D,N,L);const V=typeof n=="string"?Lg("smallestUnit",n):Fn(n);let $=vs(V,"largestUnit","datetime",void 0,["auto"]),J=D0(V);const ae=Yg(V),fe=Kc(V,"halfExpand");let ve=vs(V,"smallestUnit","datetime",void 0),Ce=!0;ve||(Ce=!1,ve="nanosecond"),F=cm(F,ve);let Me=!0;if($||(Me=!1,$=F),$==="auto"&&($=F),!Ce&&!Me)throw new RangeError("at least one of smallestUnit or largestUnit is required");if(cm($,ve)!==$)throw new RangeError(`largestUnit ${$} cannot be smaller than smallestUnit ${ve}`);const Te={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[ve];return Te!==void 0&&qg(ae,Te,!1),{years:a,months:h,weeks:p,days:v}=T0(a,h,p,v,$,J),{years:a,months:h,weeks:p,days:v,hours:g,minutes:c,seconds:A,milliseconds:D,microseconds:N,nanoseconds:L}=dd(a,h,p,v,g,c,A,D,N,L,ae,ve,fe,J),{years:a,months:h,weeks:p,days:v,hours:g,minutes:c,seconds:A,milliseconds:D,microseconds:N,nanoseconds:L}=zE(a,h,p,v,g,c,A,D,N,L,ae,ve,fe,J),{days:v,hours:g,minutes:c,seconds:A,milliseconds:D,microseconds:N,nanoseconds:L}=ic(v,g,c,A,D,N,L,$,J),{years:a,months:h,weeks:p,days:v}=function(Ne,je,ye,Qe,bt,Ot){const mt=Ct("%Temporal.Duration%"),Dt=Qu(Ne,je,ye,Qe,0,0,0,0,0,0);if(Dt===0)return{years:Ne,months:je,weeks:ye,days:Qe};const vt=z.BigInt(Dt);let Ge,dt,ot=z.BigInt(Ne),Ut=z.BigInt(je),Ie=z.BigInt(ye),ut=z.BigInt(Qe);Ot&&(dt=xi(Ot),Ge=k(dt,Xe));const Bt=new mt(Dt),Lt=new mt(0,Dt),Tt=new mt(0,0,Dt);switch(bt){case"year":{if(!Ge)throw new RangeError("a starting point is required for years balancing");const jt=typeof Ge!="string"?ri(Ge,"dateAdd"):void 0;let qt,Sn,dn;for({relativeTo:qt,days:Sn}=Xa(Ge,dt,Bt,jt);z.greaterThanOrEqual(Xc(ut),z.BigInt($i(Sn)));)ut=z.subtract(ut,z.BigInt(Sn)),ot=z.add(ot,vt),dt=qt,{relativeTo:qt,days:Sn}=Xa(Ge,dt,Bt,jt);for({relativeTo:qt,days:dn}=Xa(Ge,dt,Lt,jt);z.greaterThanOrEqual(Xc(ut),z.BigInt($i(dn)));)ut=z.subtract(ut,z.BigInt(dn)),Ut=z.add(Ut,vt),dt=qt,{relativeTo:qt,days:dn}=Xa(Ge,dt,Lt,jt);qt=Oa(Ge,dt,Bt,void 0,jt);const An=typeof Ge!="string"?ri(Ge,"dateUntil"):void 0,Un=Ja(null);Un.largestUnit="month";let Wn=If(Ge,dt,qt,Un,An),ai=k(Wn,Ta);for(;z.greaterThanOrEqual(Xc(Ut),z.BigInt($i(ai)));){Ut=z.subtract(Ut,z.BigInt(ai)),ot=z.add(ot,vt),dt=qt,qt=Oa(Ge,dt,Bt,void 0,jt);const Ni=Ja(null);Ni.largestUnit="month",Wn=If(Ge,dt,qt,Ni,An),ai=k(Wn,Ta)}break}case"month":{if(!Ge)throw new RangeError("a starting point is required for months balancing");const jt=typeof Ge!="string"?ri(Ge,"dateAdd"):void 0;let qt,Sn;for({relativeTo:qt,days:Sn}=Xa(Ge,dt,Lt,jt);z.greaterThanOrEqual(Xc(ut),z.BigInt($i(Sn)));)ut=z.subtract(ut,z.BigInt(Sn)),Ut=z.add(Ut,vt),dt=qt,{relativeTo:qt,days:Sn}=Xa(Ge,dt,Lt,jt);break}case"week":{if(!Ge)throw new RangeError("a starting point is required for weeks balancing");const jt=typeof Ge!="string"?ri(Ge,"dateAdd"):void 0;let qt,Sn;for({relativeTo:qt,days:Sn}=Xa(Ge,dt,Tt,jt);z.greaterThanOrEqual(Xc(ut),z.BigInt($i(Sn)));)ut=z.subtract(ut,z.BigInt(Sn)),Ie=z.add(Ie,vt),dt=qt,{relativeTo:qt,days:Sn}=Xa(Ge,dt,Tt,jt);break}}return{years:z.toNumber(ot),months:z.toNumber(Ut),weeks:z.toNumber(Ie),days:z.toNumber(ut)}}(a,h,p,v,$,J),new Af(a,h,p,v,g,c,A,D,N,L)}total(n){if(!Tr(this))throw new TypeError("invalid receiver");let a=k(this,go),h=k(this,Ta),p=k(this,Xo),v=k(this,yo),g=k(this,_o),c=k(this,vo),A=k(this,bo),D=k(this,xo),N=k(this,wo),L=k(this,To);if(n===void 0)throw new TypeError("options argument is required");const F=typeof n=="string"?Lg("unit",n):Fn(n),V=D0(F),$=vs(F,"unit","datetime",lm);let J;({years:a,months:h,weeks:p,days:v}=T0(a,h,p,v,$,V)),Qt(V)&&(J=PE(V,a,h,p,0));let ae=SE(v,g,c,A,D,N,L,$,J);if(ae==="positive overflow")return 1/0;if(ae==="negative overflow")return-1/0;({days:v,hours:g,minutes:c,seconds:A,milliseconds:D,microseconds:N,nanoseconds:L}=ae);const{total:fe}=dd(a,h,p,v,g,c,A,D,N,L,1,$,"trunc",V);return fe}toString(n){if(!Tr(this))throw new TypeError("invalid receiver");const a=Fn(n),h=A_(a),p=Kc(a,"trunc"),v=vs(a,"smallestUnit","time",void 0);if(v==="hour"||v==="minute")throw new RangeError('smallestUnit must be a time unit other than "hours" or "minutes"');const{precision:g,unit:c,increment:A}=C_(v,h);return cb(this,g,{unit:c,increment:A,roundingMode:p})}toJSON(){if(!Tr(this))throw new TypeError("invalid receiver");return cb(this)}toLocaleString(n,a){if(!Tr(this))throw new TypeError("invalid receiver");return typeof Intl<"u"&&Intl.DurationFormat!==void 0?new Intl.DurationFormat(n,a).format(this):(console.warn("Temporal.Duration.prototype.toLocaleString() requires Intl.DurationFormat."),cb(this))}valueOf(){throw new TypeError("use compare() to compare Temporal.Duration")}static from(n){return Tr(n)?new Af(k(n,go),k(n,Ta),k(n,Xo),k(n,yo),k(n,_o),k(n,vo),k(n,bo),k(n,xo),k(n,wo),k(n,To)):bg(n)}static compare(n,a,h){const p=bg(n),v=bg(a),g=D0(Fn(h)),c=k(p,go),A=k(p,Ta),D=k(p,Xo);let N=k(p,yo);const L=k(p,_o),F=k(p,vo),V=k(p,bo),$=k(p,xo),J=k(p,wo);let ae=k(p,To);const fe=k(v,go),ve=k(v,Ta),Ce=k(v,Xo);let Me=k(v,yo);const Te=k(v,_o),De=k(v,vo),Ne=k(v,bo),je=k(v,xo),ye=k(v,wo);let Qe=k(v,To);const bt=Pw(g,c,A,D,N),Ot=Pw(g,fe,ve,Ce,Me);c===0&&fe===0&&A===0&&ve===0&&D===0&&Ce===0||({days:N}=T0(c,A,D,N,"day",g),{days:Me}=T0(fe,ve,Ce,Me,"day",g));const mt=Og(N,L,F,V,$,J,ae,bt),Dt=Og(Me,Te,De,Ne,je,ye,Qe,Ot);return nm(z.toNumber(z.subtract(mt,Dt)))}}nh(Af,"Temporal.Duration");const m3=Object.create;class Zx{constructor(n,a,h="iso8601",p=1972){fE(this,Kn(n),Kn(a),bs(h),Kn(p))}get monthCode(){if(!la(this))throw new TypeError("invalid receiver");return D_(k(this,Xe),this)}get day(){if(!la(this))throw new TypeError("invalid receiver");return I_(k(this,Xe),this)}get calendarId(){if(!la(this))throw new TypeError("invalid receiver");return Ba(k(this,Xe))}with(n,a){if(!la(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("invalid argument");$g(n);const h=Fn(a),p=k(this,Xe),v=Hr(p,["day","month","monthCode","year"]);let g=Mn(this,v,[]);return g=um(p,g,Mn(n,v,"partial")),g=Mn(g,v,[]),Pg(p,g,h)}equals(n){if(!la(this))throw new TypeError("invalid receiver");const a=Sw(n);for(const h of[$t,Ht,Gt])if(k(this,h)!==k(a,h))return!1;return R_(k(this,Xe),k(a,Xe))}toString(n){if(!la(this))throw new TypeError("invalid receiver");return Dw(this,S_(Fn(n)))}toJSON(){if(!la(this))throw new TypeError("invalid receiver");return Dw(this)}toLocaleString(n,a){if(!la(this))throw new TypeError("invalid receiver");return new Ff(n,a).format(this)}valueOf(){throw new TypeError("use equals() to compare Temporal.PlainMonthDay")}toPlainDate(n){if(!la(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("argument should be an object");const a=k(this,Xe),h=Hr(a,["day","monthCode"]),p=Mn(this,h,[]),v=Hr(a,["year"]);let g=um(a,p,Mn(n,v,[]));g=Mn(g,[...new Set([...h,...v])],[]);const c=m3(null);return c.overflow="reject",hd(a,g,c)}getISOFields(){if(!la(this))throw new TypeError("invalid receiver");return{calendar:k(this,Xe),isoDay:k(this,Ht),isoMonth:k(this,$t),isoYear:k(this,Gt)}}getCalendar(){if(!la(this))throw new TypeError("invalid receiver");return Hg(k(this,Xe))}static from(n,a){const h=Fn(a);return la(n)?(Gr(h),u_(k(n,$t),k(n,Ht),k(n,Xe),k(n,Gt))):Sw(n,h)}}nh(Zx,"Temporal.PlainMonthDay");const $x=()=>new(Ct("%Temporal.Instant%"))(jx()),Hw=(i,n=Ef())=>{const a=Ka(n),h=bs(i);return Us(a,$x(),h)},fb=(i=Ef())=>Us(Ka(i),$x(),"iso8601"),Xw=(i,n=Ef())=>{const a=Ka(n),h=bs(i);return za(jx(),a,h)},eS={instant:$x,plainDateTime:Hw,plainDateTimeISO:fb,plainDate:(i,n=Ef())=>zg(Hw(i,n)),plainDateISO:(i=Ef())=>zg(fb(i)),plainTimeISO:(i=Ef())=>Dx(fb(i)),timeZoneId:()=>Ef(),zonedDateTime:Xw,zonedDateTimeISO:(i=Ef())=>Xw("iso8601",i),[Symbol.toStringTag]:"Temporal.Now"};Object.defineProperty(eS,Symbol.toStringTag,{value:"Temporal.Now",writable:!1,enumerable:!1,configurable:!0});const g3=Object.assign;function Ww(i,n,a){let h=k(i,yn),p=k(i,_n),v=k(i,vn),g=k(i,bn),c=k(i,xn),A=k(i,wn);if(a){const{unit:D,increment:N,roundingMode:L}=a;({hour:h,minute:p,second:v,millisecond:g,microsecond:c,nanosecond:A}=Bx(h,p,v,g,c,A,N,D,L))}return`${rr(h)}:${rr(p)}${Sv(v,g,c,A,n)}`}class im{constructor(n=0,a=0,h=0,p=0,v=0,g=0){const c=n===void 0?0:Kn(n),A=a===void 0?0:Kn(a),D=h===void 0?0:Kn(h),N=p===void 0?0:Kn(p),L=v===void 0?0:Kn(v),F=g===void 0?0:Kn(g);Mv(c,A,D,N,L,F),ih(this),En(this,yn,c),En(this,_n,A),En(this,vn,D),En(this,bn,N),En(this,xn,L),En(this,wn,F)}get hour(){if(!Er(this))throw new TypeError("invalid receiver");return k(this,yn)}get minute(){if(!Er(this))throw new TypeError("invalid receiver");return k(this,_n)}get second(){if(!Er(this))throw new TypeError("invalid receiver");return k(this,vn)}get millisecond(){if(!Er(this))throw new TypeError("invalid receiver");return k(this,bn)}get microsecond(){if(!Er(this))throw new TypeError("invalid receiver");return k(this,xn)}get nanosecond(){if(!Er(this))throw new TypeError("invalid receiver");return k(this,wn)}with(n,a){if(!Er(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("invalid argument");$g(n);const h=Gr(Fn(a)),p=H0(n,"partial"),v=H0(this);let{hour:g,minute:c,second:A,millisecond:D,microsecond:N,nanosecond:L}=g3(v,p);return{hour:g,minute:c,second:A,millisecond:D,microsecond:N,nanosecond:L}=mv(g,c,A,D,N,L,h),new im(g,c,A,D,N,L)}add(n){if(!Er(this))throw new TypeError("invalid receiver");return Zw("add",this,n)}subtract(n){if(!Er(this))throw new TypeError("invalid receiver");return Zw("subtract",this,n)}until(n,a){if(!Er(this))throw new TypeError("invalid receiver");return Bw("until",this,n,a)}since(n,a){if(!Er(this))throw new TypeError("invalid receiver");return Bw("since",this,n,a)}round(n){if(!Er(this))throw new TypeError("invalid receiver");if(n===void 0)throw new TypeError("options parameter is required");const a=typeof n=="string"?Lg("smallestUnit",n):Fn(n),h=Yg(a),p=Kc(a,"halfExpand"),v=vs(a,"smallestUnit","time",lm);qg(h,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[v],!1);let g=k(this,yn),c=k(this,_n),A=k(this,vn),D=k(this,bn),N=k(this,xn),L=k(this,wn);return{hour:g,minute:c,second:A,millisecond:D,microsecond:N,nanosecond:L}=Bx(g,c,A,D,N,L,h,v,p),new im(g,c,A,D,N,L)}equals(n){if(!Er(this))throw new TypeError("invalid receiver");const a=ed(n);for(const h of[yn,_n,vn,bn,xn,wn])if(k(this,h)!==k(a,h))return!1;return!0}toString(n){if(!Er(this))throw new TypeError("invalid receiver");const a=Fn(n),h=A_(a),p=Kc(a,"trunc"),v=vs(a,"smallestUnit","time",void 0);if(v==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const{precision:g,unit:c,increment:A}=C_(v,h);return Ww(this,g,{unit:c,increment:A,roundingMode:p})}toJSON(){if(!Er(this))throw new TypeError("invalid receiver");return Ww(this,"auto")}toLocaleString(n,a){if(!Er(this))throw new TypeError("invalid receiver");return new Ff(n,a).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainTime")}toPlainDateTime(n){if(!Er(this))throw new TypeError("invalid receiver");const a=xi(n),h=k(a,Gt),p=k(a,$t),v=k(a,Ht),g=k(a,Xe);return gs(h,p,v,k(this,yn),k(this,_n),k(this,vn),k(this,bn),k(this,xn),k(this,wn),g)}toZonedDateTime(n){if(!Er(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("invalid argument");const a=n.plainDate;if(a===void 0)throw new TypeError("missing date property");const h=xi(a),p=n.timeZone;if(p===void 0)throw new TypeError("missing timeZone property");const v=Ka(p),g=k(h,Gt),c=k(h,$t),A=k(h,Ht),D=k(h,Xe),N=k(this,yn),L=k(this,_n),F=k(this,vn),V=k(this,bn),$=k(this,xn),J=k(this,wn);return za(k(So(v,new(Ct("%Temporal.PlainDateTime%"))(g,c,A,N,L,F,V,$,J,D),"compatible"),cn),v,D)}getISOFields(){if(!Er(this))throw new TypeError("invalid receiver");return{isoHour:k(this,yn),isoMicrosecond:k(this,xn),isoMillisecond:k(this,bn),isoMinute:k(this,_n),isoNanosecond:k(this,wn),isoSecond:k(this,vn)}}static from(n,a){const h=Gr(Fn(a));return Er(n)?new im(k(n,yn),k(n,_n),k(n,vn),k(n,bn),k(n,xn),k(n,wn)):ed(n,h)}static compare(n,a){const h=ed(n),p=ed(a);for(const v of[yn,_n,vn,bn,xn,wn]){const g=k(h,v),c=k(p,v);if(g!==c)return nm(g-c)}return 0}}nh(im,"Temporal.PlainTime");class i_{constructor(n){if(arguments.length<1)throw new RangeError("missing argument: identifier is required");const a=Ix(n);ih(this),En(this,Gu,a)}get id(){if(!hl(this))throw new TypeError("invalid receiver");return k(this,Gu)}getOffsetNanosecondsFor(n){if(!hl(this))throw new TypeError("invalid receiver");const a=Wc(n),h=k(this,Gu);return mg(h)?kf(h):ad(h,k(a,cn))}getOffsetStringFor(n){if(!hl(this))throw new TypeError("invalid receiver");return Fb(this,Wc(n))}getPlainDateTimeFor(n,a="iso8601"){if(!hl(this))throw new TypeError("invalid receiver");return Us(this,Wc(n),bs(a))}getInstantFor(n,a){if(!hl(this))throw new TypeError("invalid receiver");return So(this,Jp(n),Ng(Fn(a)))}getPossibleInstantsFor(n){if(!hl(this))throw new TypeError("invalid receiver");const a=Jp(n),h=Ct("%Temporal.Instant%"),p=k(this,Gu);if(mg(p)){const g=Rf(k(a,Gt),k(a,$t),k(a,Ht),k(a,yn),k(a,_n),k(a,vn),k(a,bn),k(a,xn),k(a,wn));if(g===null)throw new RangeError("DateTime outside of supported range");const c=kf(p);return[new h(z.subtract(g,z.BigInt(c)))]}return function(c,A,D,N,L,F,V,$,J,ae){const fe=Rf(A,D,N,L,F,V,$,J,ae);if(fe===null)throw new RangeError("DateTime outside of supported range");let ve=z.subtract(fe,Ku);z.lessThan(ve,c_)&&(ve=fe);let Ce=z.add(fe,Ku);z.greaterThan(Ce,kg)&&(Ce=fe);const Me=ad(c,ve),Te=ad(c,Ce);return(Me===Te?[Me]:[Me,Te]).map(De=>{const Ne=z.subtract(fe,z.BigInt(De)),je=wE(c,Ne);if(A===je.year&&D===je.month&&N===je.day&&L===je.hour&&F===je.minute&&V===je.second&&$===je.millisecond&&J===je.microsecond&&ae===je.nanosecond)return Ne}).filter(De=>De!==void 0)}(p,k(a,Gt),k(a,$t),k(a,Ht),k(a,yn),k(a,_n),k(a,vn),k(a,bn),k(a,xn),k(a,wn)).map(g=>new h(g))}getNextTransition(n){if(!hl(this))throw new TypeError("invalid receiver");const a=Wc(n),h=k(this,Gu);if(mg(h)||h==="UTC")return null;let p=k(a,cn);const v=Ct("%Temporal.Instant%");return p=EE(h,p),p===null?null:new v(p)}getPreviousTransition(n){if(!hl(this))throw new TypeError("invalid receiver");const a=Wc(n),h=k(this,Gu);if(mg(h)||h==="UTC")return null;let p=k(a,cn);const v=Ct("%Temporal.Instant%");return p=Ub(h,p),p===null?null:new v(p)}toString(){if(!hl(this))throw new TypeError("invalid receiver");return k(this,Gu)}toJSON(){if(!hl(this))throw new TypeError("invalid receiver");return k(this,Gu)}static from(n){return yE(Ka(n))}}nh(i_,"Temporal.TimeZone"),ur("Temporal.TimeZone.prototype.getOffsetNanosecondsFor",i_.prototype.getOffsetNanosecondsFor),ur("Temporal.TimeZone.prototype.getPossibleInstantsFor",i_.prototype.getPossibleInstantsFor);const y3=Object.create;class Yx{constructor(n,a,h="iso8601",p=1){pE(this,Kn(n),Kn(a),bs(h),Kn(p))}get year(){if(!ei(this))throw new TypeError("invalid receiver");return gv(k(this,Xe),this)}get month(){if(!ei(this))throw new TypeError("invalid receiver");return yv(k(this,Xe),this)}get monthCode(){if(!ei(this))throw new TypeError("invalid receiver");return D_(k(this,Xe),this)}get calendarId(){if(!ei(this))throw new TypeError("invalid receiver");return Ba(k(this,Xe))}get era(){if(!ei(this))throw new TypeError("invalid receiver");return _v(k(this,Xe),this)}get eraYear(){if(!ei(this))throw new TypeError("invalid receiver");return vv(k(this,Xe),this)}get daysInMonth(){if(!ei(this))throw new TypeError("invalid receiver");return bv(k(this,Xe),this)}get daysInYear(){if(!ei(this))throw new TypeError("invalid receiver");return xv(k(this,Xe),this)}get monthsInYear(){if(!ei(this))throw new TypeError("invalid receiver");return wv(k(this,Xe),this)}get inLeapYear(){if(!ei(this))throw new TypeError("invalid receiver");return Tv(k(this,Xe),this)}with(n,a){if(!ei(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("invalid argument");$g(n);const h=Fn(a),p=k(this,Xe),v=Hr(p,["month","monthCode","year"]);let g=Mn(this,v,[]);return g=um(p,g,Mn(n,v,"partial")),g=Mn(g,v,[]),hm(p,g,h)}add(n,a){if(!ei(this))throw new TypeError("invalid receiver");return $w("add",this,n,a)}subtract(n,a){if(!ei(this))throw new TypeError("invalid receiver");return $w("subtract",this,n,a)}until(n,a){if(!ei(this))throw new TypeError("invalid receiver");return jw("until",this,n,a)}since(n,a){if(!ei(this))throw new TypeError("invalid receiver");return jw("since",this,n,a)}equals(n){if(!ei(this))throw new TypeError("invalid receiver");const a=Xy(n);for(const h of[Gt,$t,Ht])if(k(this,h)!==k(a,h))return!1;return R_(k(this,Xe),k(a,Xe))}toString(n){if(!ei(this))throw new TypeError("invalid receiver");return Iw(this,S_(Fn(n)))}toJSON(){if(!ei(this))throw new TypeError("invalid receiver");return Iw(this)}toLocaleString(n,a){if(!ei(this))throw new TypeError("invalid receiver");return new Ff(n,a).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainYearMonth")}toPlainDate(n){if(!ei(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("argument should be an object");const a=k(this,Xe),h=Hr(a,["monthCode","year"]),p=Mn(this,h,[]),v=Hr(a,["day"]);let g=um(a,p,Mn(n,v,[]));g=Mn(g,[...new Set([...h,...v])],[]);const c=y3(null);return c.overflow="reject",hd(a,g,c)}getISOFields(){if(!ei(this))throw new TypeError("invalid receiver");return{calendar:k(this,Xe),isoDay:k(this,Ht),isoMonth:k(this,$t),isoYear:k(this,Gt)}}getCalendar(){if(!ei(this))throw new TypeError("invalid receiver");return Hg(k(this,Xe))}static from(n,a){const h=Fn(a);return ei(n)?(Gr(h),h_(k(n,Gt),k(n,$t),k(n,Xe),k(n,Ht))):Xy(n,h)}static compare(n,a){const h=Xy(n),p=Xy(a);return Sf(k(h,Gt),k(h,$t),k(h,Ht),k(p,Gt),k(p,$t),k(p,Ht))}}nh(Yx,"Temporal.PlainYearMonth");const _3=Ff.prototype.resolvedOptions,v3=Object.create;class qx{constructor(n,a,h="iso8601"){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");mE(this,t_(n),Ka(a),bs(h))}get calendarId(){if(!Qt(this))throw new TypeError("invalid receiver");return Ba(k(this,Xe))}get timeZoneId(){if(!Qt(this))throw new TypeError("invalid receiver");return d_(k(this,fi))}get year(){if(!Qt(this))throw new TypeError("invalid receiver");return gv(k(this,Xe),Oi(this))}get month(){if(!Qt(this))throw new TypeError("invalid receiver");return yv(k(this,Xe),Oi(this))}get monthCode(){if(!Qt(this))throw new TypeError("invalid receiver");return D_(k(this,Xe),Oi(this))}get day(){if(!Qt(this))throw new TypeError("invalid receiver");return I_(k(this,Xe),Oi(this))}get hour(){if(!Qt(this))throw new TypeError("invalid receiver");return k(Oi(this),yn)}get minute(){if(!Qt(this))throw new TypeError("invalid receiver");return k(Oi(this),_n)}get second(){if(!Qt(this))throw new TypeError("invalid receiver");return k(Oi(this),vn)}get millisecond(){if(!Qt(this))throw new TypeError("invalid receiver");return k(Oi(this),bn)}get microsecond(){if(!Qt(this))throw new TypeError("invalid receiver");return k(Oi(this),xn)}get nanosecond(){if(!Qt(this))throw new TypeError("invalid receiver");return k(Oi(this),wn)}get era(){if(!Qt(this))throw new TypeError("invalid receiver");return _v(k(this,Xe),Oi(this))}get eraYear(){if(!Qt(this))throw new TypeError("invalid receiver");return vv(k(this,Xe),Oi(this))}get epochSeconds(){if(!Qt(this))throw new TypeError("invalid receiver");const n=k(this,cn);return z.toNumber(xg(n,Wu))}get epochMilliseconds(){if(!Qt(this))throw new TypeError("invalid receiver");const n=k(this,cn);return z.toNumber(xg(n,pl))}get epochMicroseconds(){if(!Qt(this))throw new TypeError("invalid receiver");return ev(xg(k(this,cn),ti))}get epochNanoseconds(){if(!Qt(this))throw new TypeError("invalid receiver");return ev(k(this,cn))}get dayOfWeek(){if(!Qt(this))throw new TypeError("invalid receiver");return Ex(k(this,Xe),Oi(this))}get dayOfYear(){if(!Qt(this))throw new TypeError("invalid receiver");return Sx(k(this,Xe),Oi(this))}get weekOfYear(){if(!Qt(this))throw new TypeError("invalid receiver");return Ax(k(this,Xe),Oi(this))}get yearOfWeek(){if(!Qt(this))throw new TypeError("invalid receiver");return Cx(k(this,Xe),Oi(this))}get hoursInDay(){if(!Qt(this))throw new TypeError("invalid receiver");const n=Oi(this),a=Ct("%Temporal.PlainDateTime%"),h=k(n,Gt),p=k(n,$t),v=k(n,Ht),g=new a(h,p,v,0,0,0,0,0,0),c=tm(h,p,v,0,0,0,1,"reject"),A=new a(c.year,c.month,c.day,0,0,0,0,0,0),D=k(this,fi),N=k(So(D,g,"compatible"),cn),L=k(So(D,A,"compatible"),cn);return Vu(z.subtract(L,N),oE)}get daysInWeek(){if(!Qt(this))throw new TypeError("invalid receiver");return Mx(k(this,Xe),Oi(this))}get daysInMonth(){if(!Qt(this))throw new TypeError("invalid receiver");return bv(k(this,Xe),Oi(this))}get daysInYear(){if(!Qt(this))throw new TypeError("invalid receiver");return xv(k(this,Xe),Oi(this))}get monthsInYear(){if(!Qt(this))throw new TypeError("invalid receiver");return wv(k(this,Xe),Oi(this))}get inLeapYear(){if(!Qt(this))throw new TypeError("invalid receiver");return Tv(k(this,Xe),Oi(this))}get offset(){if(!Qt(this))throw new TypeError("invalid receiver");return Fb(k(this,fi),k(this,Qa))}get offsetNanoseconds(){if(!Qt(this))throw new TypeError("invalid receiver");return Jc(k(this,fi),k(this,Qa))}with(n,a){if(!Qt(this))throw new TypeError("invalid receiver");if(!Yi(n))throw new TypeError("invalid zoned-date-time-like");$g(n);const h=Fn(a),p=k(this,Xe);let v=Hr(p,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);v.push("offset");let g=Mn(this,v,["offset"]);g=um(p,g,Mn(n,v,"partial")),g=Mn(g,v,["offset"]);const c=Ng(h),A=q0(h,"prefer");let{year:D,month:N,day:L,hour:F,minute:V,second:$,millisecond:J,microsecond:ae,nanosecond:fe}=M_(p,g,h);const ve=kf(g.offset),Ce=k(this,fi);return za(X0(D,N,L,F,V,$,J,ae,fe,"option",ve,Ce,c,A,!1),Ce,p)}withPlainDate(n){if(!Qt(this))throw new TypeError("invalid receiver");const a=xi(n),h=k(a,Gt),p=k(a,$t),v=k(a,Ht);let g=k(a,Xe);const c=Oi(this),A=k(c,yn),D=k(c,_n),N=k(c,vn),L=k(c,bn),F=k(c,xn),V=k(c,wn);g=gE(k(this,Xe),g);const $=k(this,fi);return za(k(So($,new(Ct("%Temporal.PlainDateTime%"))(h,p,v,A,D,N,L,F,V,g),"compatible"),cn),$,g)}withPlainTime(n){if(!Qt(this))throw new TypeError("invalid receiver");const a=Ct("%Temporal.PlainTime%"),h=n===void 0?new a:ed(n),p=Oi(this),v=k(p,Gt),g=k(p,$t),c=k(p,Ht),A=k(this,Xe),D=k(h,yn),N=k(h,_n),L=k(h,vn),F=k(h,bn),V=k(h,xn),$=k(h,wn),J=k(this,fi);return za(k(So(J,new(Ct("%Temporal.PlainDateTime%"))(v,g,c,D,N,L,F,V,$,A),"compatible"),cn),J,A)}withTimeZone(n){if(!Qt(this))throw new TypeError("invalid receiver");const a=Ka(n);return za(k(this,cn),a,k(this,Xe))}withCalendar(n){if(!Qt(this))throw new TypeError("invalid receiver");const a=bs(n);return za(k(this,cn),k(this,fi),a)}add(n,a){if(!Qt(this))throw new TypeError("invalid receiver");return Yw("add",this,n,a)}subtract(n,a){if(!Qt(this))throw new TypeError("invalid receiver");return Yw("subtract",this,n,a)}until(n,a){if(!Qt(this))throw new TypeError("invalid receiver");return Fw("until",this,n,a)}since(n,a){if(!Qt(this))throw new TypeError("invalid receiver");return Fw("since",this,n,a)}round(n){if(!Qt(this))throw new TypeError("invalid receiver");if(n===void 0)throw new TypeError("options parameter is required");const a=typeof n=="string"?Lg("smallestUnit",n):Fn(n),h=Yg(a),p=Kc(a,"halfExpand"),v=vs(a,"smallestUnit","time",lm,["day"]),g={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[v];qg(h,g,g===1);const c=Oi(this);let A=k(c,Gt),D=k(c,$t),N=k(c,Ht),L=k(c,yn),F=k(c,_n),V=k(c,vn),$=k(c,bn),J=k(c,xn),ae=k(c,wn);const fe=Ct("%Temporal.PlainDateTime%"),ve=k(this,fi),Ce=k(this,Xe),Me=So(ve,new fe(k(c,Gt),k(c,$t),k(c,Ht),0,0,0,0,0,0),"compatible"),Te=ml(Me,ve,Ce,0,0,0,1,0,0,0,0,0,0),De=z.subtract(Te,z.BigInt(k(Me,cn)));if(z.lessThanOrEqual(De,Sr))throw new RangeError("cannot round a ZonedDateTime in a calendar with zero or negative length days");return{year:A,month:D,day:N,hour:L,minute:F,second:V,millisecond:$,microsecond:J,nanosecond:ae}=Lx(A,D,N,L,F,V,$,J,ae,h,v,p,z.toNumber(De)),za(X0(A,D,N,L,F,V,$,J,ae,"option",Jc(ve,k(this,Qa)),ve,"compatible","prefer",!1),ve,k(this,Xe))}equals(n){if(!Qt(this))throw new TypeError("invalid receiver");const a=Wy(n),h=k(this,cn),p=k(a,cn);return!!z.equal(z.BigInt(h),z.BigInt(p))&&!!_E(k(this,fi),k(a,fi))&&R_(k(this,Xe),k(a,Xe))}toString(n){if(!Qt(this))throw new TypeError("invalid receiver");const a=Fn(n),h=S_(a),p=A_(a),v=function(V){return Pf(V,"offset",["auto","never"],"auto")}(a),g=Kc(a,"trunc"),c=vs(a,"smallestUnit","time",void 0);if(c==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');const A=function(V){return Pf(V,"timeZoneName",["auto","never","critical"],"auto")}(a),{precision:D,unit:N,increment:L}=C_(c,p);return kw(this,D,h,A,v,{unit:N,increment:L,roundingMode:g})}toLocaleString(n,a){if(!Qt(this))throw new TypeError("invalid receiver");const h=Fn(a),p=v3(null);if(vg(p,h,["timeZone"]),h.timeZone!==void 0)throw new TypeError("ZonedDateTime toLocaleString does not accept a timeZone option");p.year===void 0&&p.month===void 0&&p.day===void 0&&p.weekday===void 0&&p.dateStyle===void 0&&p.hour===void 0&&p.minute===void 0&&p.second===void 0&&p.timeStyle===void 0&&p.dayPeriod===void 0&&p.timeZoneName===void 0&&(p.timeZoneName="short");let v=d_(k(this,fi));if(mg(v))throw new RangeError("toLocaleString does not support offset string time zones");v=Ix(v),p.timeZone=v;const g=new Ff(n,p),c=Jt(_3,g,[]).calendar,A=Ba(k(this,Xe));if(A!=="iso8601"&&c!=="iso8601"&&c!==A)throw new RangeError(`cannot format ZonedDateTime with calendar ${A} in locale with calendar ${c}`);return g.format(k(this,Qa))}toJSON(){if(!Qt(this))throw new TypeError("invalid receiver");return kw(this,"auto")}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.ZonedDateTime")}startOfDay(){if(!Qt(this))throw new TypeError("invalid receiver");const n=Oi(this),a=Ct("%Temporal.PlainDateTime%"),h=k(this,Xe),p=new a(k(n,Gt),k(n,$t),k(n,Ht),0,0,0,0,0,0,h),v=k(this,fi);return za(k(So(v,p,"compatible"),cn),v,h)}toInstant(){if(!Qt(this))throw new TypeError("invalid receiver");return new(Ct("%Temporal.Instant%"))(k(this,cn))}toPlainDate(){if(!Qt(this))throw new TypeError("invalid receiver");return zg(Oi(this))}toPlainTime(){if(!Qt(this))throw new TypeError("invalid receiver");return Dx(Oi(this))}toPlainDateTime(){if(!Qt(this))throw new TypeError("invalid receiver");return Oi(this)}toPlainYearMonth(){if(!Qt(this))throw new TypeError("invalid receiver");const n=k(this,Xe);return hm(n,Mn(this,Hr(n,["monthCode","year"]),[]))}toPlainMonthDay(){if(!Qt(this))throw new TypeError("invalid receiver");const n=k(this,Xe);return Pg(n,Mn(this,Hr(n,["day","monthCode"]),[]))}getISOFields(){if(!Qt(this))throw new TypeError("invalid receiver");const n=Oi(this),a=k(this,fi);return{calendar:k(this,Xe),isoDay:k(n,Ht),isoHour:k(n,yn),isoMicrosecond:k(n,xn),isoMillisecond:k(n,bn),isoMinute:k(n,_n),isoMonth:k(n,$t),isoNanosecond:k(n,wn),isoSecond:k(n,vn),isoYear:k(n,Gt),offset:Fb(a,k(this,Qa)),timeZone:a}}getCalendar(){if(!Qt(this))throw new TypeError("invalid receiver");return Hg(k(this,Xe))}getTimeZone(){if(!Qt(this))throw new TypeError("invalid receiver");return yE(k(this,fi))}static from(n,a){const h=Fn(a);return Qt(n)?(Ng(h),q0(h,"reject"),Gr(h),za(k(n,cn),k(n,fi),k(n,Xe))):Wy(n,h)}static compare(n,a){const h=Wy(n),p=Wy(a),v=k(h,cn),g=k(p,cn);return z.lessThan(z.BigInt(v),z.BigInt(g))?-1:z.greaterThan(z.BigInt(v),z.BigInt(g))?1:0}}function Oi(i){return Us(k(i,fi),k(i,Qa),k(i,Xe))}nh(qx,"Temporal.ZonedDateTime");var Qw=Object.freeze({__proto__:null,Calendar:wr,Duration:Af,Instant:Yc,Now:eS,PlainDate:z_,PlainDateTime:O_,PlainMonthDay:Zx,PlainTime:im,PlainYearMonth:Yx,TimeZone:i_,ZonedDateTime:qx});const b3=[Yc,wr,z_,O_,Af,Zx,im,i_,Yx,qx];for(const i of b3){const n=Object.getOwnPropertyDescriptor(i,"prototype");(n.configurable||n.enumerable||n.writable)&&(n.configurable=!1,n.enumerable=!1,n.writable=!1,Object.defineProperty(i,"prototype",n))}function x3({tripQueryVariables:i,setTripQueryVariables:n}){const a=he.useContext(x_),h=Qw.Instant.from(i.dateTime).toZonedDateTimeISO(a).toPlainDateTime().toString({smallestUnit:"minute",calendarName:"never"}),p=he.useCallback(v=>{const g=Qw.PlainDateTime.from(v.target.value).toZonedDateTime(a).toString({calendarName:"never",timeZoneName:"never"});n({...i,dateTime:g})},[i,n,a]);return se.jsxs(ji.Group,{children:[se.jsx(ji.Label,{column:"sm",htmlFor:"timePicker",title:"Time zone: "+a,children:"Time"}),se.jsx(ji.Control,{type:"datetime-local",id:"timePicker",size:"sm",onChange:p,value:h})]})}function w3({tripQueryVariables:i,setTripQueryVariables:n}){return se.jsxs(ji.Group,{children:[se.jsx(ji.Label,{column:"sm",htmlFor:"searchWindowInput",children:"Search window"}),se.jsx(ji.Control,{type:"number",id:"searchWindowInput",size:"sm",placeholder:"(in minutes)",min:1,className:"input-small",value:i.searchWindow||"",onChange:a=>n({...i,searchWindow:Number(a.target.value)>0?Number(a.target.value):void 0})})]})}function T3({tripQueryVariables:i,setTripQueryVariables:n}){var a;return se.jsxs(ji.Group,{children:[se.jsx(ji.Label,{column:"sm",htmlFor:"accessSelect",children:"Access"}),se.jsxs(ji.Select,{id:"accessSelect",size:"sm",onChange:h=>{var p,v;h.target.value!=="not_selected"?n({...i,modes:{...i.modes,accessMode:h.target.value}}):n({...i,modes:(p=i.modes)!=null&&p.directMode||(v=i.modes)!=null&&v.transportModes?{...i.modes,accessMode:void 0}:void 0})},value:((a=i.modes)==null?void 0:a.accessMode)||"not_selected",children:[se.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(sv).map(h=>se.jsx("option",{value:h,children:h},h))]})]})}function E3({tripQueryVariables:i,setTripQueryVariables:n}){var a;return se.jsxs(ji.Group,{children:[se.jsx(ji.Label,{column:"sm",htmlFor:"egressSelect",children:"Egress"}),se.jsxs(ji.Select,{id:"egressSelect",size:"sm",onChange:h=>{var p,v;h.target.value!=="not_selected"?n({...i,modes:{...i.modes,egressMode:h.target.value}}):n({...i,modes:(p=i.modes)!=null&&p.directMode||(v=i.modes)!=null&&v.transportModes?{...i.modes,egressMode:void 0}:void 0})},value:((a=i.modes)==null?void 0:a.egressMode)||"not_selected",children:[se.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(sv).map(h=>se.jsx("option",{value:h,children:h},h))]})]})}function S3({tripQueryVariables:i,setTripQueryVariables:n}){var a;return se.jsxs(ji.Group,{children:[se.jsx(ji.Label,{column:"sm",htmlFor:"directModeSelect",children:"Direct mode"}),se.jsxs(ji.Select,{id:"directModeSelect",size:"sm",onChange:h=>{var p,v,g;h.target.value!=="not_selected"?n({...i,modes:{...i.modes,directMode:h.target.value}}):n({...i,modes:(p=i.modes)!=null&&p.accessMode||(v=i.modes)!=null&&v.egressMode||(g=i.modes)!=null&&g.transportModes?{...i.modes,directMode:void 0}:void 0})},value:((a=i.modes)==null?void 0:a.directMode)||"not_selected",children:[se.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(sv).map(h=>se.jsx("option",{value:h,children:h},h))]})]})}const A3=({label:i,options:n,values:a,onChange:h})=>{const[p,v]=he.useState(!1),g=()=>{v(!p)},c=A=>{const D=A.target.value,N=A.target.checked;h(N?[...a,D]:a.filter(L=>L!==D))};return se.jsxs("div",{className:`dropdown ${p?"show":""}`,children:[se.jsx(ji.Label,{column:"sm",htmlFor:"multiSelectDropdown",children:i}),se.jsx(ji.Control,{type:"text",id:"multiSelectDropdown",size:"sm",value:a.length>0?a.join(", "):"Not selected",onClick:g,onChange:()=>{}}),se.jsx("div",{style:{width:"20%"},className:`dropdown-menu ${p?"show":""}`,children:n.map(A=>se.jsx(ji.Check,{style:{marginLeft:"10%"},type:"checkbox",id:`option_${A.id}`,label:A.label,checked:a.includes(A.id),onChange:c,value:`${A.id}`},`${A.id}`))})]})};function C3({tripQueryVariables:i,setTripQueryVariables:n}){var p;const a=he.useMemo(()=>{var v,g;return((g=(v=i==null?void 0:i.modes)==null?void 0:v.transportModes)==null?void 0:g.map(c=>c==null?void 0:c.transportMode).filter(c=>!!c))||[]},[(p=i.modes)==null?void 0:p.transportModes]),h=he.useCallback(v=>{var c,A,D;const g=v.map(N=>({transportMode:N}));g.length===0?n({...i,modes:(c=i.modes)!=null&&c.directMode||(A=i.modes)!=null&&A.accessMode||(D=i.modes)!=null&&D.egressMode?{...i.modes}:void 0}):n({...i,modes:{...i.modes,transportModes:g.length>0?g:void 0}})},[i,n]);return se.jsx(A3,{label:"Transit mode",options:Object.values(VT).map(v=>({id:v,label:v.toString()})),values:a,onChange:h})}function M3({tripQueryVariables:i,setTripQueryVariables:n}){return se.jsxs(ji.Group,{children:[se.jsx(ji.Label,{column:"sm",htmlFor:"numTripPatternsInput",children:"#"}),se.jsx(ji.Control,{type:"number",id:"numTripPatternsInput",size:"sm",placeholder:"12",min:1,className:"input-tiny",value:i.numTripPatterns||"",onChange:a=>n({...i,numTripPatterns:Number(a.target.value)>0?Number(a.target.value):void 0})})]})}function D3({tripQueryVariables:i,setTripQueryVariables:n}){var a;return se.jsxs(ji.Group,{children:[se.jsx(ji.Label,{column:"sm",htmlFor:"itineraryDebugFilterSelect",children:"Filter debug"}),se.jsxs(ji.Select,{id:"itineraryDebugFilterSelect",size:"sm",className:"input-medium",onChange:h=>{n({...i,itineraryFilters:{debug:h.target.value}})},value:((a=i.itineraryFilters)==null?void 0:a.debug)||"not_selected",children:[se.jsx("option",{value:"not_selected",children:"Not selected"}),Object.values(UT).map(h=>se.jsx("option",{value:h,children:h},h))]})]})}const I3="https://www.opentripplanner.org/debug-client-assets/2025/02/2025-02-21T08:26/assets/graphql-solid-B1mrnAEK.svg",k3="/graphiql?flavor=transmodel";function R3({tripQueryVariables:i}){const n=encodeURIComponent(JSON.stringify(i)),a=encodeURIComponent(eR),h="Open in GraphiQL";return se.jsx(om,{title:h,href:k3+"&query="+a+"&variables="+n,target:"_blank",children:se.jsx("img",{alt:h,title:h,src:I3,width:"20",height:"20",className:"d-inline-block align-middle"})})}function N3({tripQueryVariables:i,setTripQueryVariables:n,onRoute:a,loading:h}){return se.jsxs("div",{className:"box input-group search-bar",children:[se.jsxs("div",{className:"input-family",children:[se.jsx(pw,{label:"From",id:"fromInputField",locationFieldKey:"from",tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(mR,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(pw,{label:"To",id:"toInputField",locationFieldKey:"to",tripQueryVariables:i,setTripQueryVariables:n})]}),se.jsxs("div",{className:"input-family",children:[se.jsx(gR,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(x3,{tripQueryVariables:i,setTripQueryVariables:n})]}),se.jsxs("div",{className:"input-family",children:[se.jsx(M3,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(w3,{tripQueryVariables:i,setTripQueryVariables:n})]}),se.jsxs("div",{className:"input-family",children:[se.jsx(T3,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(C3,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(E3,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx(S3,{tripQueryVariables:i,setTripQueryVariables:n})]}),se.jsx(D3,{tripQueryVariables:i,setTripQueryVariables:n}),se.jsx("div",{className:"search-bar-route-button-wrapper",children:se.jsxs(ax,{children:[se.jsxs(om,{variant:"primary",onClick:()=>a(),disabled:h,children:[h&&se.jsxs(se.Fragment,{children:[se.jsx(q2,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"})," "]}),"Route"]}),se.jsx(R3,{tripQueryVariables:i})]})})]})}const tS=he.createContext(void 0);function P3(){const i=he.useContext(tS);if(!i)throw new Error("useTripSchema must be used within a TripSchemaProvider");return i}function ms(i,n){return n.split(".").reduce((a,h)=>{if(a!=null){if(Array.isArray(a)){const p=Number(h);return Number.isNaN(p)?void 0:a[p]}else if(typeof a=="object")return a[h]}},i)}function wf(i,n,a){const h=n.split(".");function p(v,g){const c=h[g],A=!isNaN(Number(c));if(g===h.length-1){if(Array.isArray(v)&&A){const F=[...v];return F[Number(c)]=a,F}if(pb(v)&&!A)return{...v,[c]:a};if(A){const F=Array.isArray(v)?[...v]:[];return F[Number(c)]=a,F}else return{...pb(v)?v:{},[c]:a}}const D=g+1,N=h[D],L=!isNaN(Number(N));if(Array.isArray(v)&&A){const F=[...v],V=v[Number(c)];return F[Number(c)]=p(V!==void 0?V:L?[]:{},D),F}else if(pb(v)&&!A){const F={...v},V=v[c];return F[c]=p(V!==void 0?V:L?[]:{},D),F}else if(A){const F=[];return F[Number(c)]=p(L?[]:{},D),F}else return{[c]:p(L?[]:{},D)}}return i==null&&(i=!isNaN(Number(h[0]))?[]:{}),p(i,0)}function pb(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}const z3="data:image/svg+xml,%3csvg%20height='36'%20preserveAspectRatio='xMidYMid%20meet'%20viewBox='0%200%2036%2036'%20width='36'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='20.75'%20cy='6'%20r='4'/%3e%3cpath%20d='m24.84%2026.23a1%201%200%200%200%20-1.4.29%2016.6%2016.6%200%200%201%20-3.51%203.77c-.33.25-1.56%201.2-2.08%201-.36-.11-.15-.82-.08-1.12l.53-1.57c.22-.64%204.05-12%204.47-13.3.62-1.9.35-3.77-2.48-3.32-.77.08-8.58%201.09-8.72%201.1a1%201%200%200%200%20.13%202s3-.39%203.33-.42a.88.88%200%200%201%20.85.44%202.47%202.47%200%200%201%20-.07%201.71c-.26%201-4.37%2012.58-4.5%2013.25a2.78%202.78%200%200%200%201.18%203%205%205%200%200%200%203.08.83%208.53%208.53%200%200%200%203.09-.62c2.49-1%205.09-3.66%206.46-5.75a1%201%200%200%200%20-.28-1.29z'/%3e%3cpath%20d='m0%200h36v36h-36z'%20fill='none'/%3e%3c/svg%3e",O3="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M6.5%201C6.22386%201%206%201.22386%206%201.5C6%201.77614%206.22386%202%206.5%202C7.12671%202%207.45718%202.20028%207.65563%202.47812C7.8781%202.78957%208%203.28837%208%204V11C8%2011.7116%207.8781%2012.2104%207.65563%2012.5219C7.45718%2012.7997%207.12671%2013%206.5%2013C6.22386%2013%206%2013.2239%206%2013.5C6%2013.7761%206.22386%2014%206.5%2014C7.37329%2014%208.04282%2013.7003%208.46937%2013.1031C8.47976%2013.0886%208.48997%2013.0739%208.5%2013.0591C8.51003%2013.0739%208.52024%2013.0886%208.53063%2013.1031C8.95718%2013.7003%209.62671%2014%2010.5%2014C10.7761%2014%2011%2013.7761%2011%2013.5C11%2013.2239%2010.7761%2013%2010.5%2013C9.87329%2013%209.54282%2012.7997%209.34437%2012.5219C9.1219%2012.2104%209%2011.7116%209%2011V4C9%203.28837%209.1219%202.78957%209.34437%202.47812C9.54282%202.20028%209.87329%202%2010.5%202C10.7761%202%2011%201.77614%2011%201.5C11%201.22386%2010.7761%201%2010.5%201C9.62671%201%208.95718%201.29972%208.53063%201.89688C8.52024%201.91143%208.51003%201.92611%208.5%201.9409C8.48997%201.92611%208.47976%201.91143%208.46937%201.89688C8.04282%201.29972%207.37329%201%206.5%201ZM14%205H11V4H14C14.5523%204%2015%204.44772%2015%205V10C15%2010.5523%2014.5523%2011%2014%2011H11V10H14V5ZM6%204V5H1L1%2010H6V11H1C0.447715%2011%200%2010.5523%200%2010V5C0%204.44772%200.447715%204%201%204H6Z'%20fill='currentColor'%20/%3e%3c/svg%3e",L3="data:image/svg+xml,%3csvg%20width='15'%20height='15'%20viewBox='0%200%2015%2015'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M5.49998%200.5C5.49998%200.223858%205.72383%200%205.99998%200H7.49998H8.99998C9.27612%200%209.49998%200.223858%209.49998%200.5C9.49998%200.776142%209.27612%201%208.99998%201H7.99998V2.11922C9.09832%202.20409%2010.119%202.56622%2010.992%203.13572C11.0116%203.10851%2011.0336%203.08252%2011.058%203.05806L12.058%202.05806C12.3021%201.81398%2012.6978%201.81398%2012.9419%202.05806C13.186%202.30214%2013.186%202.69786%2012.9419%202.94194L11.967%203.91682C13.1595%205.07925%2013.9%206.70314%2013.9%208.49998C13.9%2012.0346%2011.0346%2014.9%207.49998%2014.9C3.96535%2014.9%201.09998%2012.0346%201.09998%208.49998C1.09998%205.13361%203.69904%202.3743%206.99998%202.11922V1H5.99998C5.72383%201%205.49998%200.776142%205.49998%200.5ZM2.09998%208.49998C2.09998%205.51764%204.51764%203.09998%207.49998%203.09998C10.4823%203.09998%2012.9%205.51764%2012.9%208.49998C12.9%2011.4823%2010.4823%2013.9%207.49998%2013.9C4.51764%2013.9%202.09998%2011.4823%202.09998%208.49998ZM7.49998%208.49998V4.09998C5.06992%204.09998%203.09998%206.06992%203.09998%208.49998C3.09998%2010.93%205.06992%2012.9%207.49998%2012.9C8.715%2012.9%209.815%2012.4075%2010.6112%2011.6112L7.49998%208.49998Z'%20fill='currentColor'%20/%3e%3c/svg%3e",B3=({defaultValue:i,type:n})=>se.jsxs("span",{children:[i!=null&&se.jsx("span",{title:`Default: ${i??"None"}`,children:se.jsx("img",{alt:"Info",src:z3,className:"default-tooltip-icon"})}),n!=null&&n.subtype==="DoubleFunction"&&se.jsx("span",{title:`Type: ${n.subtype??"None"}
 Format: \`a + b t\`. Example: \`30m + 2.0 t\``,children:se.jsx("img",{alt:"Info",src:O3,className:"default-tooltip-icon"})}),n!=null&&n.subtype==="Duration"&&se.jsx("span",{className:"default-tooltip-icon",title:`Type: ${n.subtype??"None"}
 Duration in a lenient ISO-8601 duration format.
Example P2DT2H12M40S, 2d2h12m40s or 1h`,children:se.jsx("img",{alt:"Info",src:L3,className:"default-tooltip-icon"})})]}),nS=new Set(["numTripPatterns","arriveBy","from","to","dateTime","searchWindow","modes.accessMode","modes.directMode","modes.egressMode"]),iS=({tripQueryVariables:i,setTripQueryVariables:n})=>{function a(){let h={};nS.forEach(p=>{const v=ms(i,p);v!==void 0&&(h=wf(h,p,v))}),n(h)}return se.jsx("button",{className:"reset-button",onClick:a,children:"Reset"})};function mb(i){if(!i)return" ";const n=i.split(".");return n[n.length-1].replace(/([A-Z])/g," $1").trim().replace(/\b\w/g,h=>h.toUpperCase())+" "}function N0(i,n=[]){let a=[];return i?(Object.entries(i).forEach(([h,p])=>{const v=[...n,h].join(".");a=a.concat(j3(h,p,v,n))}),a):[]}function j3(i,n,a,h){var v;let p=[];if(typeof n=="object"&&n.type)if(n.type.type==="Enum"){const g=["Not selected",...n.type.values||[]],c=n.defaultValue!==void 0?n.defaultValue:"Not selected";p.push({path:a,type:{type:"Enum"},defaultValue:c,enumValues:g,isList:n.isList})}else n.type.type==="InputObject"&&n.isList?(p.push({path:a,type:{type:"Group",name:n.type.name},defaultValue:n.defaultValue,isComplex:!0,isList:!0}),p=p.concat(N0(n.type.fields,[...h,`${i}.*`]))):n.type.type==="InputObject"?(p.push({path:a,type:{type:"Group",name:n.type.name},isComplex:!0,isList:!1}),p=p.concat(N0(n.type.fields,[...h,i]))):n.type.type==="Scalar"&&p.push({path:a,type:{type:n.type.type,subtype:n.type.subtype},defaultValue:n.defaultValue,isList:n.isList});else typeof n=="object"&&((v=n.type)!=null&&v.fields)?(p.push({path:a,type:{type:"Group"},isComplex:!0}),p=p.concat(N0(n.type.fields,[...h,i]))):p.push({path:a,type:n.type??typeof n,defaultValue:n.defaultValue});return p}const F3=({tripQueryVariables:i,setTripQueryVariables:n})=>{const[a,h]=he.useState([]),[p,v]=he.useState({}),[g]=he.useState(""),{tripArgs:c,loading:A,error:D}=P3();he.useEffect(()=>{if(!c||A||D)return;const Te=N0(c.trip.arguments);h(Te)},[c,A,D]);function N(Te){return Te.replace(/\.\d+/g,".*")}function L(Te,De){const Ne=N(Te),je=a.find(Qe=>Qe.path===Ne);if(!je){console.error(`No matching argumentConfig found for path: ${Te}`);return}if(je.type.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(je.type.subtype)&&je.isList&&typeof De=="string"){const Qe=De.split(",").map(Ot=>Ot.trim());let bt=wf(i,Te,Qe);bt=V(bt,Te),n(bt);return}let ye=wf(i,Te,De);ye=V(ye,Te),n(ye)}function F(Te){return typeof Te=="object"&&Te!==null&&!Array.isArray(Te)}function V(Te,De){if(!De.includes(".")){const je=ms(Te,De);if(Array.isArray(je)&&je.length===0){const ye={...Te};return delete ye[De],ye}if(F(je)&&Object.keys(je).every(Qe=>{const bt=je[Qe];return bt==null||Array.isArray(bt)&&bt.length===0})){const Qe={...Te};return delete Qe[De],Qe}return Te}const Ne=De.split(".");for(let je=Ne.length-1;je>0;je--){const ye=Ne.slice(0,je).join("."),Qe=ms(Te,ye);Qe!=null&&(Array.isArray(Qe)?Qe.length===0&&(Te=wf(Te,ye,void 0)):F(Qe)&&Object.keys(Qe).every(Ot=>{const mt=`${ye}.${Ot}`,Dt=ms(Te,mt);return Dt==null||Array.isArray(Dt)&&Dt.length===0})&&(Te=wf(Te,ye,void 0)))}return Te}function $(Te){v(De=>({...De,[Te]:!De[Te]}))}const J=a.filter(({path:Te})=>mb(Te).toLowerCase().includes(g.toLowerCase())).filter(({path:Te})=>!nS.has(Te));function ae(Te,De,Ne,je){const ye=ms(i,Te)??[],Qe=je.name;return se.jsxs("div",{children:[ye.map((bt,Ot)=>{const mt=`${Te}.${Ot}`,Dt=De.filter(dt=>dt.path.startsWith(`${Te}.*.`)&&dt.path!==`${Te}.*`).map(dt=>({...dt,path:dt.path.replace(`${Te}.*`,mt)})),vt=Dt.filter(dt=>dt.path.split(".").length===mt.split(".").length+1),Ge=p[mt];return se.jsxs("div",{style:{marginLeft:15},children:[se.jsxs("span",{style:{cursor:"pointer"},onClick:()=>$(mt),children:[Ge?" ":" "," [#",Ot+1,"]"]}),se.jsx("button",{style:{marginLeft:10},onClick:()=>ve(Te,Ot),children:"Remove"}),Ge&&se.jsx("div",{style:{marginLeft:20},children:Me(vt,Ne+1,Dt)})]},mt)}),se.jsxs("button",{onClick:()=>fe(Te),children:["+ Add ",Qe]})]})}function fe(Te){const Ne=[...ms(i,Te)??[],{}],je=wf(i,Te,Ne);n(je)}function ve(Te,De){const je=(ms(i,Te)??[]).filter((Qe,bt)=>bt!==De);let ye=wf(i,Te,je);ye=V(ye,Te),n(ye)}function Ce(Te){let De=wf(i,Te,void 0);De=V(De,Te),n(De)}function Me(Te,De,Ne){return Te.map(({path:je,type:ye,defaultValue:Qe,enumValues:bt,isComplex:Ot,isList:mt})=>{const Dt=p[je],vt=je.split(".").length,Ge=Ne.filter(ot=>{const Ut=ot.path.split(".").length;return ot.path.startsWith(`${je}.`)&&ot.path!==je&&Ut===vt+1}),dt=De+1;return se.jsx("div",{style:{marginLeft:`${De*15}px`,marginBottom:"10px"},children:Ot?se.jsxs("div",{children:[se.jsxs("span",{style:{cursor:"pointer"},onClick:()=>$(je),children:[Dt?" ":" "," ",mb(je)]}),Dt&&mt?se.jsx("div",{style:{marginLeft:20},children:ae(je,Ne,dt,ye)}):Dt?Me(Ge,dt,Ne):null]}):se.jsxs("div",{children:[se.jsxs("label",{className:"argument-label",htmlFor:je,children:[mb(je)," ",se.jsx(B3,{defaultValue:Qe,type:ye})]}),ye.subtype==="Boolean"&&(()=>{const ot=ms(i,je),Ut=ot!==void 0;return se.jsxs("span",{children:[se.jsx("input",{type:"checkbox",id:je,checked:ot??!1,onChange:Ie=>L(je,Ie.target.checked)}),Ut&&se.jsx("a",{onClick:()=>Ce(je),className:"remove-argument",children:"x"})]})})(),ye.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(ye.subtype)&&mt&&se.jsx("input",{className:"comma-separated-input",type:"text",id:je,value:(()=>{const ot=ms(i,je);return Array.isArray(ot)?ot.join(", "):""})(),onChange:ot=>L(je,ot.target.value),placeholder:"Comma-separated list"}),ye.subtype!=null&&["String","DoubleFunction","ID","Duration"].includes(ye.subtype)&&!mt&&se.jsx("input",{type:"text",id:je,value:ms(i,je)??"",onChange:ot=>L(je,ot.target.value||void 0)}),ye.subtype==="Int"&&se.jsx("input",{type:"number",id:je,value:ms(i,je)??"",onChange:ot=>{const Ut=parseInt(ot.target.value,10);L(je,Number.isNaN(Ut)?void 0:Ut)}}),ye.subtype==="Float"&&se.jsx("input",{type:"number",id:je,step:"any",value:ms(i,je)??"",onChange:ot=>{const Ut=parseFloat(ot.target.value);L(je,Number.isNaN(Ut)?void 0:Ut)}}),ye.subtype==="DateTime"&&se.jsx("input",{type:"datetime-local",id:je,value:(ms(i,je)??"").slice(0,16),onChange:ot=>{const Ut=ot.target.value?new Date(ot.target.value).toISOString():void 0;L(je,Ut)}}),ye.type==="Enum"&&bt&&mt&&se.jsx("select",{id:je,multiple:!0,value:(()=>{const ot=ms(i,je);return Array.isArray(ot)?ot:[]})(),onChange:ot=>{const Ut=Array.from(ot.target.selectedOptions,Ie=>Ie.value);L(je,Ut)},children:bt.map(ot=>se.jsx("option",{value:ot,children:ot},ot))}),ye.type==="Enum"&&bt&&!mt&&se.jsx("select",{id:je,value:ms(i,je)??"Not selected",onChange:ot=>{L(je,ot.target.value||void 0)},children:bt.map(ot=>se.jsx("option",{value:ot,children:ot},ot))})]})},je)})}return se.jsxs("div",{className:"left-pane-container below-content",children:[se.jsxs("div",{className:"panel-header",children:["Filters",se.jsx(iS,{tripQueryVariables:i,setTripQueryVariables:n})]}),J.length===0?se.jsx("p",{children:"No arguments found."}):se.jsx("div",{className:"argument-list",children:Me(J.filter(Te=>Te.path.split(".").length===1),0,J)})]})},U3="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20class='icon%20icon-tabler%20icon-tabler-route'%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20stroke-width='2'%20stroke='currentColor'%20fill='none'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20stroke='none'%20d='M0%200h24v24H0z'%20fill='none'/%3e%3ccircle%20cx='6'%20cy='19'%20r='2'%20/%3e%3ccircle%20cx='18'%20cy='5'%20r='2'%20/%3e%3cpath%20d='M12%2019h4.5a3.5%203.5%200%200%200%200%20-7h-8a3.5%203.5%200%200%201%200%20-7h3.5'%20/%3e%3c/svg%3e",V3="data:image/svg+xml,%3csvg%20width='24'%20height='24'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M15%2010.5A3.502%203.502%200%200%200%2018.355%208H21a1%201%200%201%200%200-2h-2.645a3.502%203.502%200%200%200-6.71%200H3a1%201%200%200%200%200%202h8.645A3.502%203.502%200%200%200%2015%2010.5zM3%2016a1%201%200%201%200%200%202h2.145a3.502%203.502%200%200%200%206.71%200H21a1%201%200%201%200%200-2h-9.145a3.502%203.502%200%200%200-6.71%200H3z'%20fill='currentColor'/%3e%3c/svg%3e",G3="data:image/svg+xml,%3csvg%20height='16'%20viewBox='0%200%2016%2016'%20width='16'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='m1%202h4v2h-2v2l-1%202%201%202v2h2v2h-4v-4l-1-2%201-2zm4%205c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.55228475%200%201%20.44771525%201%201s-.44771525%201-1%201-1-.44771525-1-1%20.44771525-1%201-1zm3%200c.5522847%200%201%20.44771525%201%201s-.4477153%201-1%201-1-.44771525-1-1%20.4477153-1%201-1zm0-3v-2h4v4l1%202-1%202v4h-4v-2h2v-2l1-2-1-2v-2z'%20fill='%23293040'/%3e%3c/svg%3e",Z3=({children:i})=>{const[n,a]=he.useState(0),h=v=>{switch(v){case 0:return se.jsx("img",{src:U3,alt:"Itineray list",title:"Itineray"});case 1:return se.jsx("img",{src:V3,alt:"Filters",title:"Filters"});case 2:return se.jsx("img",{width:"25",height:"25",src:G3,alt:"Filters",title:"Filters"});default:return null}},p=ec.Children.toArray(i).filter(v=>ec.isValidElement(v));return se.jsxs("div",{className:"sidebar-container",children:[se.jsx("div",{className:"sidebar",children:p.map((v,g)=>se.jsx("div",{className:`sidebar-button ${g===n?"active":""}`,onClick:()=>a(g),children:h(g)},g))}),se.jsx("div",{className:"sidebar-content",children:p.map((v,g)=>g===n?se.jsx("div",{children:v},g):null)})]})},$3=({tripQueryVariables:i,setTripQueryVariables:n})=>se.jsxs("div",{className:"left-pane-container below-content",style:{fontSize:"14px"},children:[se.jsxs("div",{className:"panel-header",children:["Arguments raw",se.jsx(iS,{tripQueryVariables:i,setTripQueryVariables:n})]}),se.jsx("pre",{children:JSON.stringify(i,null,2)})]});function Y3(i){let n=i;for(;;)if(nd(n))n=n.ofType;else if(zf(n))n=n.ofType;else break;return n}function rS(i){const n=Y3(i);if(Ug(n))return{type:"Scalar",subtype:n.name};if(Mf(n))return{type:"Enum",values:n.getValues().map(a=>a.name)};if(td(n)){const a=n.getFields(),h={};for(const p of Object.keys(a)){const v=a[p];if(v.deprecationReason)continue;const g=zf(v.type),c=v.defaultValue!==void 0?v.defaultValue:null;h[p]={type:rS(v.type),defaultValue:c,isList:g}}return{type:"InputObject",name:n.name,fields:h}}return{type:"Scalar",subtype:"String"}}function q3(i){const n=i.getQueryType();if(!n)throw new Error("No Query type found in the schema.");const a=n.getFields().trip;if(!a)throw new Error("No trip query found in the schema.");const h={};return a.args.forEach(p=>{if(p.deprecationReason)return;const v=p.name,g=rS(p.type),c=p.defaultValue!==null?p.defaultValue:null,A=zf(p.type);h[v]={type:g,...c!==null&&{defaultValue:c},isList:A}}),{trip:{arguments:h}}}async function H3(i){const n=mC(),a=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:n})});if(!a.ok)throw new Error(`Failed to fetch schema. HTTP error: ${a.status}`);const{data:h}=await a.json(),p=gC(h);return q3(p)}function X3({endpoint:i,children:n}){const[a,h]=he.useState(null),[p,v]=he.useState(!0),[g,c]=he.useState(null);he.useEffect(()=>{let D=!0;async function N(){v(!0),c(null);try{const L=await H3(i);D&&h(L)}catch(L){console.error("Error loading trip arguments:",L),D&&c("Failed to load trip schema")}finally{D&&v(!1)}}return N(),()=>{D=!1}},[i]);const A={tripArgs:a,loading:p,error:g};return se.jsx(tS.Provider,{value:A,children:n})}function W3(){const i=iR(),{tripQueryVariables:n,setTripQueryVariables:a}=sR(),[h,p,v]=tR(n),[g,c]=he.useState(0),A=(i==null?void 0:i.internalTransitModelTimeZone)||Intl.DateTimeFormat().resolvedOptions().timeZone;return se.jsx("div",{className:"app",children:se.jsx(x_.Provider,{value:A,children:se.jsxs("div",{className:"layout",children:[se.jsx("div",{className:"box logo-section",children:se.jsx(uR,{serverInfo:i})}),se.jsx("div",{className:"box input-section",children:se.jsx(N3,{onRoute:v,tripQueryVariables:n,setTripQueryVariables:a,loading:p})}),se.jsx("div",{className:"box trip-section",children:se.jsxs(Z3,{children:[se.jsx(Jk,{tripQueryResult:h,selectedTripPatternIndex:g,setSelectedTripPatternIndex:c,pageResults:v,loading:p}),se.jsx(X3,{endpoint:a_(),children:se.jsx(F3,{tripQueryVariables:n,setTripQueryVariables:a})}),se.jsx($3,{tripQueryVariables:n,setTripQueryVariables:a})]})}),se.jsx("div",{className:"box map-section",children:se.jsx(ik,{tripQueryResult:h,tripQueryVariables:n,setTripQueryVariables:a,selectedTripPatternIndex:g,loading:p})})]})})})}yS.createRoot(document.getElementById("root")).render(se.jsx(ec.StrictMode,{children:se.jsx(W3,{})}));
